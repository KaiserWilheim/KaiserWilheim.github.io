<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>äºšå…°å­—æ¯æ‹¼å†™è‹±è¯­</title>
    <url>/hebrew-english/</url>
    <content><![CDATA[<p>ä¸€ç§ä½¿ç”¨äºšå…°å­—æ¯æ¥æ‹¼å†™è‹±è¯­çš„æ–¹æ¡ˆã€‚<br>ï¼ˆæµ‹è¯•åšå®¢æ˜¾ç¤ºæƒ…å†µç”¨ï¼‰<br>ğ—¼‡ğ—Ÿ²</p>
<span id="more"></span>

<p>é¦–å…ˆå±•ç¤º Note æ¡†ï¼Œä»¥ä¾¿ä½¿ç”¨ï¼š</p>
<details class="note "><summary><p>Without Class</p>
</summary>

</details>

<details class="note default"><summary><p>Default</p>
</summary>

</details>

<details class="note primary"><summary><p>Primary</p>
</summary>

</details>

<details class="note info"><summary><p>Info</p>
</summary>

</details>

<details class="note success"><summary><p>Success</p>
</summary>

</details>

<details class="note warning"><summary><p>Warning</p>
</summary>

</details>

<details class="note danger"><summary><p>Danger</p>
</summary>

</details>

<p>ç„¶åæ˜¯ Tabsï¼š</p>
<div class="tabs" id="test"><ul class="nav-tabs"><li class="tab active"><a href="#test-1"><i class="fa fa-heart"></i>ç¬¬ä¸€é¡µ</a></li><li class="tab"><a href="#test-2">Page 2</a></li></ul><div class="tab-content"><div class="tab-pane active" id="test-1"><p>è¿™æ˜¯ç¬¬ä¸€ä¸ª Tab ã€‚</p></div><div class="tab-pane" id="test-2"><p>Tab è¯­æ³•é‡Œé¢çš„ <code>&lt;!--</code> ä¹‹åå’Œ <code>--&gt;</code> ä¹‹å‰å¥½åƒå¯ä»¥æœ‰ç©ºæ ¼ã€‚</p></div></div></div>

<div class="tabs" id="tabs-å¥—-note"><ul class="nav-tabs"><li class="tab active"><a href="#tabs-å¥—-note-1">æ—  Class</a></li><li class="tab"><a href="#tabs-å¥—-note-2">default</a></li><li class="tab"><a href="#tabs-å¥—-note-3">primary</a></li><li class="tab"><a href="#tabs-å¥—-note-4">info</a></li><li class="tab"><a href="#tabs-å¥—-note-5">success</a></li><li class="tab"><a href="#tabs-å¥—-note-6">warning</a></li><li class="tab"><a href="#tabs-å¥—-note-7">danger</a></li></ul><div class="tab-content"><div class="tab-pane active" id="tabs-å¥—-note-1"><details class="note "><summary><p>Without Class</p>
</summary>

</details></div><div class="tab-pane" id="tabs-å¥—-note-2"><details class="note default"><summary><p>Default</p>
</summary>

</details></div><div class="tab-pane" id="tabs-å¥—-note-3"><details class="note primary"><summary><p>Primary</p>
</summary>

</details></div><div class="tab-pane" id="tabs-å¥—-note-4"><details class="note info"><summary><p>Info</p>
</summary>

</details></div><div class="tab-pane" id="tabs-å¥—-note-5"><details class="note success"><summary><p>Success</p>
</summary>

</details></div><div class="tab-pane" id="tabs-å¥—-note-6"><details class="note warning"><summary><p>Warning</p>
</summary>

</details></div><div class="tab-pane" id="tabs-å¥—-note-7"><details class="note danger"><summary><p>Danger</p>
</summary>

</details></div></div></div>

<hr>
<h1 id="äºšå…°å­—æ¯"><a href="#äºšå…°å­—æ¯" class="headerlink" title="äºšå…°å­—æ¯"></a>äºšå…°å­—æ¯</h1><p>é¦–å…ˆæ˜¯å…ƒéŸ³ã€‚</p>
<p>&#x2F;ÊŒ&#x2F;-&gt;×Ö²  &#x2F;Ã¦&#x2F;-&gt;×Öµ  &#x2F;Î±:&#x2F;-&gt;×Ö·</p>
<p>&#x2F;i&#x2F;-&gt;×™  &#x2F;i:&#x2F;-&gt;×™Ö´</p>
<p>&#x2F;u&#x2F;-&gt;×•  &#x2F;u:&#x2F;-&gt;×•Ö´</p>
<p>&#x2F;e&#x2F;-&gt;×Ö¶  &#x2F;É™&#x2F;-&gt;×¢  &#x2F;É™:&#x2F;-&gt;×¢Ö´</p>
<p>&#x2F;É”&#x2F;-&gt;×Ö³  &#x2F;É”:&#x2F;-&gt;×Ö¸</p>
<p>åŒå…ƒéŸ³ç›´æ¥ç»„åˆå³å¯ã€‚</p>
<p>&#x2F;ei&#x2F;-&gt;×¢Ö¹  &#x2F;ai&#x2F;-&gt;×Ö·Ö¹  &#x2F;au&#x2F;-&gt;×Ö·×•  &#x2F;É™u&#x2F;-&gt;×¢×•  &#x2F;uÉ™&#x2F;-&gt;×•Ö¶  &#x2F;iÉ™&#x2F;-&gt;×™Ö¶  &#x2F;eÉ™&#x2F;-&gt;×¢Ö¶  &#x2F;É”i&#x2F;-&gt;×Ö¸Ö¹</p>
<p>ç„¶åæ˜¯è¾…éŸ³ã€‚</p>
<p>&#x2F;k&#x2F;-&gt;×§  &#x2F;t&#x2F;-&gt;×˜  &#x2F;p&#x2F;-&gt;×¤Ö¼</p>
<p>&#x2F;g&#x2F;-&gt;×’  &#x2F;d&#x2F;-&gt;×“  &#x2F;b&#x2F;-&gt;×‘Ö¼</p>
<p>&#x2F;s&#x2F;-&gt;×¡  &#x2F;Î¸&#x2F;-&gt;×ª  &#x2F;f&#x2F;-&gt;×¤  &#x2F;Êƒ&#x2F;-&gt;×©</p>
<p>&#x2F;z&#x2F;-&gt;×–  &#x2F;Ã°&#x2F;-&gt;×“Ö¼  &#x2F;v&#x2F;-&gt;×‘  &#x2F;Ê’&#x2F;-&gt;×©×</p>
<p>&#x2F;tÊƒ&#x2F;-&gt;×˜×©  &#x2F;tr&#x2F;-&gt;×˜×¨  &#x2F;ts&#x2F;-&gt;×¦</p>
<p>&#x2F;dÊ’&#x2F;-&gt;×“×©×  &#x2F;dr&#x2F;-&gt;×“×¨  &#x2F;dz&#x2F;-&gt;×¦Ö¼</p>
<p>&#x2F;m&#x2F;-&gt;×  &#x2F;n&#x2F;-&gt;×   &#x2F;Å‹&#x2F;-&gt;× Ö¼</p>
<p>&#x2F;h&#x2F;-&gt;×”  &#x2F;l&#x2F;-&gt;×œ  &#x2F;r&#x2F;-&gt;×¨</p>
<p>æœ€åæ˜¯åŠå…ƒéŸ³ã€‚</p>
<p>&#x2F;w&#x2F;-&gt;×•Ö¼  &#x2F;j&#x2F;-&gt;×™Ö¼</p>
<p>è¾…éŸ³ä¸­çš„×›ä¸×—å’Œå…ƒéŸ³ä¸­çš„×Ö»æ²¡æœ‰ç”¨åˆ°ï¼Œä½†æˆ‘å‡†å¤‡äº†é€‚é…å…¶ä»–è¯­è¨€çš„éŸ³ç´ ï¼š</p>
<p>&#x2F;Ã§&#x2F;-&gt;×›  &#x2F;x&#x2F;-&gt;×›Ö¼  &#x2F;Ê€&#x2F;-&gt;×—  &#x2F;y&#x2F;-&gt;×Ö»</p>
<p>è¿˜æœ‰é‡éŸ³ç¬¦å·ï¼š<br>&#x2F;Ëˆ&#x2F;-&gt;×Ö«<br>&#x2F;ËŒ&#x2F;-&gt;×Ö½ ?</p>
<p>å¤‡æ³¨ï¼š</p>
<p>æ²¡æƒ³åˆ°tsadeeæ²¡æœ‰åŠæ³•ç±»ä¼¼×©×è¿™æ ·å‘å³ä¸Šæ–¹åŠ ç‚¹ï¼Œæ‰€ä»¥é‡‡ç”¨äº†ä¸­é—´åŠ ç‚¹çš„æ–¹å¼æ¥ä½¿å…¶å¯ä»¥æ‰“åˆ°ç”µè„‘ä¸Šã€‚</p>
<p>ç¤ºä¾‹ï¼š</p>
<p>åŸæ–‡ï¼š</p>
<p>To be, or not to be- that is the question:<br>Whether â€˜tis nobler in the mind to suffer<br>The slings and arrows of outrageous fortune<br>Or to take arms against a sea of troubles,<br>And by opposing end them. To die- to sleep-<br>No more; and by a sleep to say we end<br>The heartache, and the thousand natural shocks<br>That flesh is heir to. â€˜Tis a consummation<br>Devoutly to be wishâ€™d. To die- to sleep.</p>
<p>éŸ³æ ‡ï¼š</p>
<p>[tuË] [biË]<strong>,</strong> [É”Ë] [nÉ”t] [tuË] [biË]<strong>-</strong> [Ã°Ã¦t] [Éªz] [Ã°É™] [ËˆkwesÊ§É™n]<strong>:</strong><br>[ËˆweÃ°É™] [tÉªz] [ËˆnÉ™ublÉ™r] [Éªn] [Ã°É™] [maÉªnd] [tuË] [ËˆsÊŒfÉ™]<br>[Ã°É™] [slÉªÅ‹z] [Ã¦nd] [ËˆÃ¦rÉ™uz] [É”v] [autËˆreÉªÊ¤É™s] [ËˆfÉ”ËÊ§É™n]<br>[É”Ë] [tuË] [teÉªk] [É‘Ëmz] [É™Ëˆgenst] [É™] [siË] [É”v] [ËˆtrÊŒblz]<strong>,</strong><br>[Ã¦nd] [baÉª] [É™ËˆpÉ™uzÉªÅ‹] [end] [Ã°em]<strong>.</strong> [tuË] [daÉª]<strong>-</strong> [tuË] [sliËp]<strong>-</strong><br>[nÉ™u] [mÉ”Ë]<strong>;</strong> [Ã¦nd] [baÉª] [É™] [sliËp] [tuË] [seÉª] [wiË] [end]<br>[Ã°É™] [ËˆhÉ‘ËteÉªk]<strong>,</strong> [Ã¦nd] [Ã°É™] [ËˆÎ¸auzÉ™nd] [ËˆnÃ¦Ê§rÉ™l] [ÊƒÉ”ks]<br>[Ã°Ã¦t] [fleÊƒ] [Éªz] [eÉ™] [tuË]<strong>.</strong> [tÉªz] [É™] [ËŒkÉ”nsÉ™ËˆmeÉªÊƒÉ™n]<br>[dÉªËˆvautli] [tuË] [biË] [wÉªÊƒt]<strong>.</strong> [tuË] [daÉª]<strong>-</strong> [tuË] [sliËp]<strong>.</strong></p>
<p>è½¬å†™ï¼š</p>
<p dir="rtl">
×˜×•Ö´ ×‘Ö¼×™Ö´, ×Ö¸ × Ö³×˜ ×˜×•Ö´ ×‘Ö¼×™Ö´- ×“Ö¼Öµ×˜ ×™×– ×“Ö¼×¢ ×§Ö«×•Ö¼Ö¶×¡×˜×©×¢×Ÿ: <br>
×•Ö¼Ö¶Ö«×“Ö¼×¢ ×˜×™×– × Ö«×¢×•×‘Ö¼×œ×¢×¨ ×™×Ÿ ×“Ö¼×¢ ×Ö·Ö¹× ×“ ×˜×•Ö´ ×¡Ö²Ö«×¤×¢ <br>
×“Ö¼×¢ ×¡×œ×™× Ö¼×– ×Öµ× ×“ ×ÖµÖ«×¨×¢Ö»×– ×Ö³×‘ ×Ö·×•×˜×¨Ö«×¢Ö¹×“×¦Ö¼×¢×¡ ×¤Ö¸Ö«×˜×©×¢×Ÿ <br>
×Ö¸ ×˜×•Ö´ ×˜×¢Ö¹×§ ×Ö·××– ×¢Ö«×’Ö¶× ×¡×˜ ×Ö¶ ×¡×™Ö´ ×Ö³×‘ ×˜Ö«×¨Ö²×‘Ö¼×œ×–, <br>
×Öµ× Ö¼×“ ×‘Ö¼Ö·Ö¹ ×¢×¤Ö¼Ö«×¢Ö»×–×™×ŸÖ¼ ×Ö¶× ×“ ×“Ö¼Ö¶×. ×˜×•Ö´ ×“Ö·Ö¹- ×˜×•Ö´ ×¡×œ×™Ö´×£Ö¼- <br>
× ×¢×• ×Ö¸; ×Öµ× ×“ ×‘Ö¼Ö·Ö¹ ×¢ ×¡×œ×™Ö´×¤Ö¼ ×˜×•Ö´ ×¡×¢Ö¹ ×•Ö¼×™Ö´ ×Ö¶× ×“ <br>
×“Ö¼×¢ ×”Ö·Ö«×˜×¢Ö¹×§, ×“Ö¼×¢ ×ªÖ·Ö«×•×–×¢× ×“ × ÖµÖ«×˜×©×¨×¢×œ ×©Ö¸×§×¡ <br>
×“Ö¼Öµ×˜ ×¤×œÖ¶×© ×™×– ×¢Ö¶ ×˜×•Ö´. ×˜×™×– ×¢ ×§Ö³× ×¡×¢×Ö«×¢Ö¹×©×¢×Ÿ <br>
×“×™×‘Ö·Ö«×•×˜×œ×™ ×˜×•Ö´ ×‘Ö¼×™Ö´ ×•Ö¼×™×©×˜. ×˜×•Ö´ ×“Ö·Ö¹- ×˜×•Ö´ ×¡×œ×™Ö´×£Ö¼.
</p>

<p><del>çŠ¹å¤ªå²è¯—ï¼ˆç¡®ä¿¡ï¼‰</del></p>
<h1 id="é˜¿æ‹‰ä¼¯å­—æ¯"><a href="#é˜¿æ‹‰ä¼¯å­—æ¯" class="headerlink" title="é˜¿æ‹‰ä¼¯å­—æ¯"></a>é˜¿æ‹‰ä¼¯å­—æ¯</h1><p>æ—¢ç„¶é˜¿æ‹‰ä¼¯å­—æ¯ä¸å¸Œä¼¯æ¥å­—æ¯åŒæ ¹åŒæºï¼Œé‚£ä¹ˆâ€¦â€¦</p>
<p>ï¼ˆtbcï¼‰</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>çŸ©é˜µ</title>
    <url>/matrix/</url>
    <content><![CDATA[<p>çŸ©é˜µä¸çŸ©é˜µç›¸å…³è¿ç®—ã€‚</p>
<span id="more"></span>

<p>åœ¨æ•°å­¦ä¸­ï¼ŒçŸ©é˜µæ˜¯ä¸€ç§å¾ˆé‡è¦çš„è¡¨ç°å½¢å¼ï¼›åœ¨OIä¸­ï¼ŒçŸ©é˜µä¹Ÿæ˜¯ä¸€ç§å¾ˆé‡è¦çš„æ•°æ®ç»“æ„ã€‚<br>çŸ©é˜µé€šå¸¸å¯ä»¥ç”¨åœ¨çº¿æ€§é½æ¬¡é€’æ¨å¼çš„åŠ é€Ÿä¸Šï¼Œæ¯”å¦‚è¯´åŠ é€Ÿæ–æ³¢é‚£å¥‘æ•°åˆ—çš„é€’æ¨è¿‡ç¨‹ã€‚<br>çŸ©é˜µè¿˜å¯ä»¥è®©å¤šä¸ªæ•°æ®å…³è”èµ·æ¥ï¼Œå¹¶ç®€ä¾¿åœ°è¿›è¡ŒåŒºé—´ç»´æŠ¤ã€‚</p>
<h1 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h1><p>ä¸ºäº†æ›´å¥½åœ°åŒºåˆ†çŸ©é˜µä¸å…¶ä»–é‡ï¼Œæˆ‘ä»¬è¿™é‡Œå°†ä»£è¡¨çŸ©é˜µçš„ç¬¦å·è¿›è¡Œäº†ç‰¹æ®Šå¤„ç†ï¼Œå°±åƒè¿™ä¸ªæ ·å­ï¼š</p>
<p>$A \to \mathbf{A}$</p>
<h2 id="çŸ©é˜µæ˜¯ä»€ä¹ˆ"><a href="#çŸ©é˜µæ˜¯ä»€ä¹ˆ" class="headerlink" title="çŸ©é˜µæ˜¯ä»€ä¹ˆ"></a>çŸ©é˜µæ˜¯ä»€ä¹ˆ</h2><p>ç”± $n \times m$ ä¸ªå…ƒç´ ç»„æˆçš„ï¼Œå½¢å¦‚<br>$$<br>\mathbf{A} &#x3D;<br>\begin{bmatrix}<br>a_{1,1} &amp; a_{1,2} &amp; a_{1,3} &amp; \dots &amp; a_{1,m} \\<br>a_{2,1} &amp; a_{2,2} &amp; a_{2,3} &amp; \dots &amp; a_{2,m} \\<br>a_{3,1} &amp; a_{3,2} &amp; a_{3,3} &amp; \dots &amp; a_{3,m} \\<br>\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\<br>a_{n,1} &amp; a_{n,2} &amp; a_{n,3} &amp; \dots &amp; a_{n,m}<br>\end{bmatrix}<br>$$<br>çš„ $n$ è¡Œ $m$ åˆ—çš„æ•°è¡¨ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºå¤§å°ä¸º $n \times m$ çš„çŸ©é˜µï¼Œå¯ä»¥ç®€è®°ä¸º $\mathbf{A_{\mathcal{n \times m}}}$ ã€‚</p>
<h2 id="ç‰¹æ®Šçš„çŸ©é˜µ"><a href="#ç‰¹æ®Šçš„çŸ©é˜µ" class="headerlink" title="ç‰¹æ®Šçš„çŸ©é˜µ"></a>ç‰¹æ®Šçš„çŸ©é˜µ</h2><p>ç‰¹æ®Šçš„çŸ©é˜µç”±å¾ˆå¤šç§ï¼Œæ¯”å¦‚å•ä½çŸ©é˜µã€ä¸Šä¸‰è§’çŸ©é˜µç­‰ç­‰ã€‚</p>
<h3 id="è¡ŒçŸ©é˜µä¸åˆ—çŸ©é˜µ"><a href="#è¡ŒçŸ©é˜µä¸åˆ—çŸ©é˜µ" class="headerlink" title="è¡ŒçŸ©é˜µä¸åˆ—çŸ©é˜µ"></a>è¡ŒçŸ©é˜µä¸åˆ—çŸ©é˜µ</h3><p>è¡ŒçŸ©é˜µå°±æ˜¯åªæœ‰ä¸€è¡Œçš„çŸ©é˜µï¼Œåˆ—çŸ©é˜µå°±æ˜¯åªæœ‰ä¸€åˆ—çš„çŸ©é˜µã€‚</p>
<h3 id="é›¶çŸ©é˜µ"><a href="#é›¶çŸ©é˜µ" class="headerlink" title="é›¶çŸ©é˜µ"></a>é›¶çŸ©é˜µ</h3><p>å…ƒç´ å…¨ä¸º $0$ çš„çŸ©é˜µã€‚<br>é›¶çŸ©é˜µç®€è®°ä¸º $\mathbf{0}$ã€‚</p>
<h3 id="è´ŸçŸ©é˜µ"><a href="#è´ŸçŸ©é˜µ" class="headerlink" title="è´ŸçŸ©é˜µ"></a>è´ŸçŸ©é˜µ</h3><p>å¯¹äºä¸€ä¸ªçŸ©é˜µ $\mathbf{A}$ çš„è´ŸçŸ©é˜µ $-\mathbf{A}$ï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç´ éƒ½ä¸çŸ©é˜µ $\mathbf{A}$ å†…ç›¸åŒä½ç½®çš„å…ƒç´ äº’ä¸ºç›¸åæ•°ã€‚</p>
<h3 id="æ–¹é˜µ"><a href="#æ–¹é˜µ" class="headerlink" title="æ–¹é˜µ"></a>æ–¹é˜µ</h3><p>æ–¹é˜µæŒ‡çš„å°±æ˜¯æ­£æ–¹å½¢çš„çŸ©é˜µï¼Œå…¶è¡Œæ•°ä¸åˆ—æ•°ç›¸ç­‰ã€‚<br>æ­¤æ—¶ï¼Œå…¶è¡Œæ•°ï¼ˆæˆ–åˆ—æ•°ï¼Œåæ­£ä»–ä»¬ç›¸ç­‰ï¼‰å°±å¯ä»¥è¢«ç§°ä½œè¯¥çŸ©é˜µçš„é˜¶ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼Œä¸€ä¸ª $n$ é˜¶æ–¹é˜µ $\mathbf{A_{\mathcal{n}}}$ å…¶å®å°±æ˜¯ç›¸å½“äºä¸€ä¸ª $n \times n$ çš„çŸ©é˜µ $\mathbf{A_{\mathcal{n \times n}}}$ã€‚</p>
<h3 id="å•ä½çŸ©é˜µ"><a href="#å•ä½çŸ©é˜µ" class="headerlink" title="å•ä½çŸ©é˜µ"></a>å•ä½çŸ©é˜µ</h3><p>å•ä½çŸ©é˜µå°±æ˜¯æŒ‡ï¼Œåœ¨ä¸»å¯¹è§’çº¿ä¸Šçš„å…ƒç´ éƒ½æ˜¯ $1$ï¼Œå…¶ä½™å…ƒç´ éƒ½ä¸º $0$ çš„çŸ©é˜µã€‚<br>ä¸»å¯¹è§’çº¿å°±æ˜¯æŒ‡ $(1,1)$ åˆ° $(n,n)$ã€‚è¿™ä¹Ÿè¯´æ˜å•ä½çŸ©é˜µéƒ½æ˜¯æ­£æ–¹å½¢çš„ã€‚</p>
<p>å•ä½çŸ©é˜µç®€è®°ä¸º $\mathbf{I}$ã€‚</p>
<p>å•ä½çŸ©é˜µä¹Ÿæœ‰å…¶ç›¸åº”çš„é˜¶ï¼Œæ¯”å¦‚1åˆ°4é˜¶çš„å•ä½çŸ©é˜µåˆ†åˆ«æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š$\mathbf{I_{\mathrm{1}}}&#x3D;\begin{bmatrix}1\end{bmatrix}$ï¼Œ$\mathbf{I_{\mathrm{2}}}&#x3D;\begin{bmatrix}1&amp;\\&amp;1\end{bmatrix}$ï¼Œ$\mathbf{I_{\mathrm{3}}}&#x3D;\begin{bmatrix}1&amp;&amp;\\&amp;1&amp;\\&amp;&amp;1\end{bmatrix}$ï¼Œ$\mathbf{I_{\mathrm{4}}}&#x3D;\begin{bmatrix}1&amp;&amp;&amp;\\&amp;1&amp;&amp;\\&amp;&amp;1&amp;\\&amp;&amp;&amp;1\end{bmatrix}$ã€‚</p>
<p>å½¢è±¡ä¸€ç‚¹ï¼Œå°±æ˜¯è¿™æ ·ï¼š<br>ï¼ˆä¸º $0$ çš„å…ƒç´ å¤ªå¤šæ—¶ä¸€èˆ¬å°†å…¶çœç•¥ï¼‰</p>
<p>$$<br>\mathbf{I} &#x3D;<br>\begin{bmatrix}<br>1&amp; &amp; &amp; \\<br> &amp;1&amp; &amp; \\<br> &amp; &amp; \ddots &amp; \\<br> &amp; &amp; &amp;1<br>\end{bmatrix}<br>$$</p>
<p>å•ä½çŸ©é˜µçš„ä¸€ä¸ªå¾ˆé‡è¦çš„æ€§è´¨å°±æ˜¯ï¼Œä»»ä½•çŸ©é˜µä¹˜ä»¥å•ä½çŸ©é˜µçš„ç»“æœè¿˜æ˜¯å…¶æœ¬èº«ï¼Œå³ $\mathbf{AI} &#x3D; \mathbf{IA} &#x3D; \mathbf{A}$ã€‚</p>
<p>æœ‰æ—¶å€™è¿˜å¯èƒ½å°†å•ä½çŸ©é˜µç§°ä¸º $\mathbf{E}$ï¼Œä½†æ˜¯å¾ˆå°‘è§ï¼Œæˆ‘ç›®å‰è¿˜æ²¡æœ‰è§è¿‡ã€‚</p>
<h2 id="çŸ©é˜µçš„è¿ç®—"><a href="#çŸ©é˜µçš„è¿ç®—" class="headerlink" title="çŸ©é˜µçš„è¿ç®—"></a>çŸ©é˜µçš„è¿ç®—</h2><p>çŸ©é˜µå¯ä»¥è¿›è¡Œå››åˆ™è¿ç®—ï¼Œä½†æ˜¯ä¸æ­£å¸¸çš„æ•°å­—è¿˜æ˜¯æœ‰æ‰€ä¸åŒã€‚</p>
<h3 id="åŠ å‡"><a href="#åŠ å‡" class="headerlink" title="åŠ å‡"></a>åŠ å‡</h3><p>çŸ©é˜µçš„åŠ å‡è¦æ±‚ä¸¤ä¸ªçŸ©é˜µå¿…é¡»è¡Œæ•°åˆ—æ•°å‡ç›¸åŒæ‰å¯ä»¥è¿›è¡Œã€‚</p>
<p>åŠ å‡çš„æ—¶å€™ï¼Œæ¯ä¸€å¯¹ä½ç½®ç›¸åŒçš„å…ƒç´ ç›¸åŠ æˆ–è€…ç›¸å‡ã€‚</p>
<p>å½¢è±¡ä¸€ç‚¹å°±æ˜¯è¿™ä¸ªæ ·å­ï¼š</p>
<p>$$<br>\mathbf{A} \pm \mathbf{B}<br>&#x3D;<br>\begin{bmatrix}<br>a &amp; b &amp; c \\<br>d &amp; e &amp; f<br>\end{bmatrix}<br>\pm<br>\begin{bmatrix}<br>g &amp; h &amp; i \\<br>j &amp; k &amp; l<br>\end{bmatrix}<br>&#x3D;<br>\begin{bmatrix}<br>a \pm g &amp; b \pm h &amp; c \pm i \\<br>d \pm j &amp; e \pm k &amp; f \pm l<br>\end{bmatrix}<br>$$</p>
<p>çŸ©é˜µçš„åŠ æ³•æ»¡è¶³äº¤æ¢å¾‹å’Œç»“åˆå¾‹ã€‚</p>
<h3 id="æ•°ä¹˜"><a href="#æ•°ä¹˜" class="headerlink" title="æ•°ä¹˜"></a>æ•°ä¹˜</h3><p>å°±æ˜¯ä¸€ä¸ªçŸ©é˜µä¹˜ä»¥ä¸€ä¸ªæ•°ã€‚</p>
<p>ä¹˜èµ·æ¥çš„æ—¶å€™ï¼ŒçŸ©é˜µå†…çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½è¦ä¹˜ä»¥è¿™ä¸ªæ•°ã€‚</p>
<p>å½¢è±¡ä¸€ç‚¹å°±æ˜¯è¿™æ ·ï¼š</p>
<p>$$<br>Î»\mathbf{A}<br>&#x3D;<br>Î» \times<br>\begin{bmatrix}<br>a &amp; b &amp; c \\<br>d &amp; e &amp; f<br>\end{bmatrix}<br>&#x3D;<br>\begin{bmatrix}<br>Î»a &amp; Î»b &amp; Î»c \\<br>Î»d &amp; Î»e &amp; Î»f<br>\end{bmatrix}<br>$$</p>
<p>çŸ©é˜µçš„æ•°ä¹˜æ»¡è¶³äº¤æ¢å¾‹ã€ç»“åˆå¾‹å’Œåˆ†é…å¾‹ã€‚</p>
<p>å¦‚æœå°†åˆšæ‰è¿™ä¸ªè¿‡ç¨‹åè¿‡æ¥çš„è¯ï¼Œå°±å«åšçŸ©é˜µæå…¬å› å­ã€‚</p>
<h3 id="ç‚¹ä¹˜"><a href="#ç‚¹ä¹˜" class="headerlink" title="ç‚¹ä¹˜"></a>ç‚¹ä¹˜</h3><p>ç‚¹ä¹˜æ˜¯çŸ©é˜µè¿ç®—ä¸­å¾ˆé‡è¦çš„ä¸€éƒ¨åˆ†ã€‚</p>
<p>ç‚¹ä¹˜åˆå«åšçŸ©é˜µä¹˜æ³•ï¼Œï¼ˆåŸºæœ¬ä¸Šï¼‰æ˜¯OIä¸­çŸ©é˜µçš„ç²¾é«“ã€‚</p>
<p>çŸ©é˜µä¹˜æ³•ä¸æ»¡è¶³äº¤æ¢å¾‹ï¼Œæ˜¯å› ä¸ºå…¶éœ€è¦æ»¡è¶³å·¦ä¾§çŸ©é˜µçš„åˆ—æ•°ä¸å³ä¾§çŸ©é˜µçš„è¡Œæ•°ç›¸ç­‰ã€‚</p>
<p>å½¢è±¡ä¸€ç‚¹ï¼Œå°±æ˜¯ $\mathbf{A_{\mathcal{n \times p}}} \times \mathbf{B_{\mathcal{p \times m}}} &#x3D; \mathbf{C_{\mathcal{n \times m}}}$ã€‚</p>
<p>å…·ä½“æ“ä½œçš„æ—¶å€™æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š</p>
<p>æˆ‘ä»¬ä»¥ $\mathbf{A_{\mathrm{3 \times 3}}} \times \mathbf{B_{\mathrm{3 \times 2}}}$ ä¸ºä¾‹ã€‚</p>
<p>$$<br>\begin{align}<br>&amp; \mathbf{A_{\mathrm{3 \times 3}}} \times \mathbf{B_{\mathrm{3 \times 2}}} \\<br>&#x3D;{} &amp;<br>\begin{bmatrix}<br>a_{1,1} &amp; a_{1,2} &amp; a_{1,3} \\ a_{2,1} &amp; a_{2,2} &amp; a_{2,3} \\ a_{3,1} &amp; a_{3,2} &amp; a_{3,3}<br>\end{bmatrix}<br>\times<br>\begin{bmatrix}<br>b_{1,1} &amp; b_{1,2} \\ b_{2,1} &amp; b_{2,2} \\ b_{3,1} &amp; b_{3,2}<br>\end{bmatrix}\\<br>&#x3D;{} &amp;<br>\begin{bmatrix}<br>a_{1,1}b_{1,1}+a_{1,2}b_{2,1}+a_{1,3}b_{3,1} &amp; a_{2,1}b_{1,1}+a_{2,2}b_{2,1}+a_{2,3}b_{3,1} &amp; a_{3,1}b_{1,1}+a_{3,2}b_{2,1}+a_{3,3}b_{3,1} \\<br>a_{1,1}b_{1,2}+a_{1,2}b_{2,2}+a_{1,3}b_{3,2} &amp; a_{2,1}b_{1,2}+a_{2,2}b_{2,2}+a_{2,3}b_{3,2} &amp; a_{3,1}b_{1,2}+a_{3,2}b_{2,2}+a_{3,3}b_{3,2}<br>\end{bmatrix}<br>\end{align}<br>$$</p>
<p>é™¤äº†äº¤æ¢å¾‹ä»¥å¤–ï¼ŒçŸ©é˜µä¹˜æ³•åªæ»¡è¶³ç»“åˆå¾‹å’Œå·¦ã€å³åˆ†é…å¾‹ã€‚</p>
<h3 id="å¹‚"><a href="#å¹‚" class="headerlink" title="å¹‚"></a>å¹‚</h3><p>çŸ©é˜µçš„å¹‚è¿ç®—ä¸æ­£å¸¸çš„å¹‚è¿ç®—ä¸€æ ·ï¼Œéƒ½æ˜¯è‡ªä¹˜å¤šå°‘æ¬¡ï¼Œä½†æ˜¯ç”±äºçŸ©é˜µä¹˜æ³•çš„ç‰¹æ®Šæ€§è´¨ï¼Œæˆ‘ä»¬åªèƒ½ç»™æ–¹é˜µæ±‚å¹‚ã€‚</p>
<p>$\mathbf{A^{\mathcal{k}}} &#x3D; \underbrace{\mathbf{AAAA \cdots AA}}_{\text{k of}}$</p>
<p>æ ¹æ®è¿™ç§æ€§è´¨ï¼Œæˆ‘ä»¬å¯ä»¥åƒå¯¹æ•°å­—ä¸€æ ·è¿›è¡Œå¿«é€Ÿå¹‚ï¼Œé€»è¾‘ä¸ä¹‹å‰ä¸€æ ·ã€‚</p>
<h3 id="è½¬ç½®"><a href="#è½¬ç½®" class="headerlink" title="è½¬ç½®"></a>è½¬ç½®</h3><p>è½¬ç½®å°±æ˜¯å°†ä¸€ä¸ªçŸ©é˜µé¡ºæ—¶é’ˆæ—‹è½¬90åº¦ã€‚</p>
<p>ä¾‹ï¼š<br>$$<br>\begin{bmatrix}<br>1&amp;1&amp;4\\5&amp;1&amp;4<br>\end{bmatrix}^T<br>&#x3D;<br>\begin{bmatrix}<br>5&amp;1\\1&amp;1\\4&amp;4<br>\end{bmatrix}<br>$$</p>
<p>æˆ‘ä»¬ä½¿ç”¨ $\mathbf{A}^T$ æ¥è¡¨ç¤ºçŸ©é˜µ $\mathbf{A}$ çš„è½¬ç½®ã€‚</p>
<p>è½¬ç½®æ»¡è¶³ä»¥ä¸‹æ³•åˆ™ï¼š<br>$$<br>\begin{align}<br>(\mathbf{A}^T)^T &amp;&#x3D; \mathbf{A} \\<br>(\lambda \mathbf{A})^T &amp;&#x3D; \lambda \mathbf{A}^T \\<br>(\mathbf{AB})^T &amp;&#x3D; \mathbf{B}^T \mathbf{A}^T<br>\end{align}<br>$$</p>
<h1 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h1><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªäºŒç»´æ•°ç»„æ¥å­˜å‚¨çŸ©é˜µã€‚</p>
<p>å°±åƒè¿™ä¸ªæ ·å­ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Matrix</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> n, m;</span><br><span class="line">    <span class="type">int</span> a[N][N];</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>å®šä¹‰ä¸€ä¸ªåˆå§‹åŒ–å‡½æ•°ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Matrix</span>() &#123;&#125;;</span><br><span class="line"><span class="built_in">Matrix</span>(<span class="type">int</span> n, <span class="type">int</span> m) : <span class="built_in">n</span>(n), <span class="built_in">m</span>(m) &#123; <span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="built_in">sizeof</span>(a)) &#125;;</span><br></pre></td></tr></table></figure>

<p>é‡è½½ä¸€ä¸‹è¿ç®—ç¬¦ï¼š</p>
<p>åŠ ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">friend</span> Matrix <span class="keyword">operator</span> + (<span class="type">const</span> Matrix &amp;lhs, <span class="type">const</span> Matrix &amp;rhs)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function">Matrix <span class="title">res</span><span class="params">(lhs.n, lhs.m)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= lhs.n; i++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= lhs.m; j++)</span><br><span class="line">            res.a[i][j] = lhs.a[i][j] + rhs.a[i][j];</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¹˜ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">friend</span> Matrix <span class="keyword">operator</span> * (<span class="type">const</span> Matrix &amp;lhs, <span class="type">const</span> Matrix &amp;rhs)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function">Matrix <span class="title">res</span><span class="params">(lhs.n, rhs.m)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= lhs.n; i++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= rhs.m; j++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">1</span>; k &lt;= lhs.m; k++)</span><br><span class="line">                res.a[i][j] += lhs.a[i][k] * rhs.a[k][j];</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¹˜æ–¹ï¼ˆå¿«é€Ÿå¹‚ï¼‰ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">friend</span> Matrix <span class="keyword">operator</span> ^ (Matrix rhs, <span class="type">int</span> x)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function">Matrix <span class="title">res</span><span class="params">(rhs.n, rhs.n)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= rhs.n; i++)res.a[i][i] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(x)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(x &amp; <span class="number">1</span>) res = res * rhs;</span><br><span class="line">        rhs = rhs * rhs;</span><br><span class="line">        x &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å†ç»§ç»­åŠ ä¸€äº›å…¶ä»–çš„é‡è½½è¿ç®—ç¬¦ä¹‹åå°±æ˜¯è¿™ä¸ªæ ·å­ï¼š</p>
<details class="note default"><summary><p>çŸ©é˜µç»“æ„ä½“</p>
</summary>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Matrix</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> n, m;</span><br><span class="line">    <span class="type">int</span> a[N][N];</span><br><span class="line">    <span class="built_in">Matrix</span>() &#123;&#125;;</span><br><span class="line">    <span class="built_in">Matrix</span>(<span class="type">int</span> n, <span class="type">int</span> m) : <span class="built_in">n</span>(n), <span class="built_in">m</span>(m) &#123; <span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="built_in">sizeof</span>(a)) &#125;;</span><br><span class="line">    <span class="keyword">friend</span> Matrix <span class="keyword">operator</span> + (<span class="type">const</span> Matrix &amp;lhs, <span class="type">const</span> Matrix &amp;rhs)</span><br><span class="line">    &#123;<span class="comment">//åŠ </span></span><br><span class="line">        <span class="function">Matrix <span class="title">res</span><span class="params">(lhs.n, lhs.m)</span></span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= lhs.n; i++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= lhs.m; j++)</span><br><span class="line">                res.a[i][j] = lhs.a[i][j] + rhs.a[i][j];</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> Matrix <span class="keyword">operator</span> - (<span class="type">const</span> Matrix &amp;lhs, <span class="type">const</span> Matrix &amp;rhs)</span><br><span class="line">    &#123;<span class="comment">//å‡</span></span><br><span class="line">        <span class="function">Matrix <span class="title">res</span><span class="params">(lhs.n, lhs.m)</span></span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= lhs.n; i++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= lhs.m; j++)</span><br><span class="line">                res.a[i][j] = lhs.a[i][j] - rhs.a[i][j];</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    Matrix <span class="keyword">operator</span> -() <span class="type">const</span></span><br><span class="line">    &#123;<span class="comment">//å–å</span></span><br><span class="line">        <span class="function">Matrix <span class="title">res</span><span class="params">(n, m)</span></span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; j++)</span><br><span class="line">                res.a[i][j] = -a[i][j];</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> Matrix <span class="keyword">operator</span> * (<span class="type">const</span> Matrix &amp;lhs, <span class="type">const</span> Matrix &amp;rhs)</span><br><span class="line">    &#123;<span class="comment">//ç‚¹ä¹˜</span></span><br><span class="line">        <span class="function">Matrix <span class="title">res</span><span class="params">(lhs.n, rhs.m)</span></span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= lhs.n; i++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= rhs.m; j++)</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">1</span>; k &lt;= lhs.m; k++)</span><br><span class="line">                    res.a[i][j] += lhs.a[i][k] * rhs.a[k][j];</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> Matrix <span class="keyword">operator</span> * (<span class="type">const</span> Matrix &amp;lhs, <span class="type">int</span> k)</span><br><span class="line">    &#123;<span class="comment">//æ•°ä¹˜</span></span><br><span class="line">        <span class="function">Matrix <span class="title">res</span><span class="params">(lhs.n, lhs.m)</span></span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= lhs.n; i++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= lhs.m; j++)</span><br><span class="line">                res.a[i][j] = lhs.a[i][j] * k;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> Matrix <span class="keyword">operator</span> ^ (Matrix lhs, <span class="type">int</span> n)</span><br><span class="line">    &#123;<span class="comment">//å¿«é€Ÿå¹‚</span></span><br><span class="line">        <span class="function">Matrix <span class="title">res</span><span class="params">(lhs.n, lhs.n)</span></span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= lhs.n; i++)res.a[i][i] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(x)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(n &amp; <span class="number">1</span>) res = res * lhs;</span><br><span class="line">            lhs = lhs * lhs;</span><br><span class="line">            x &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</details>

<p>ä½†å…¶å®æ›´å¸¸è§çš„æ˜¯è¿™æ ·å­ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Matrix</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> n, m;</span><br><span class="line">    <span class="type">int</span> a[N][N];</span><br><span class="line">    <span class="built_in">Matrix</span>() &#123;&#125;;</span><br><span class="line">    <span class="built_in">Matrix</span>(<span class="type">int</span> n, <span class="type">int</span> m) : <span class="built_in">n</span>(n), <span class="built_in">m</span>(m) &#123; <span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="built_in">sizeof</span>(a)) &#125;;</span><br><span class="line">    <span class="keyword">friend</span> Matrix <span class="keyword">operator</span> + (<span class="type">const</span> Matrix &amp;lhs, <span class="type">const</span> Matrix &amp;rhs)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function">Matrix <span class="title">res</span><span class="params">(lhs.n, lhs.m)</span></span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= lhs.n; i++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= lhs.m; j++)</span><br><span class="line">                res.a[i][j] = lhs.a[i][j] + rhs.a[i][j];</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> Matrix <span class="keyword">operator</span> * (<span class="type">const</span> Matrix &amp;lhs, <span class="type">const</span> Matrix &amp;rhs)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function">Matrix <span class="title">res</span><span class="params">(lhs.n, rhs.m)</span></span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= lhs.n; i++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= rhs.m; j++)</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">1</span>; k &lt;= lhs.m; k++)</span><br><span class="line">                    res.a[i][j] += lhs.a[i][k] * rhs.a[k][j];</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> Matrix <span class="keyword">operator</span> ^ (Matrix lhs, <span class="type">int</span> n)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function">Matrix <span class="title">res</span><span class="params">(lhs.n, lhs.n)</span></span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= lhs.n; i++)res.a[i][i] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(x)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(n &amp; <span class="number">1</span>) res = res * lhs;</span><br><span class="line">            lhs = lhs * lhs;</span><br><span class="line">            x &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h1 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h1><h2 id="çŸ©é˜µåŠ é€Ÿé€’æ¨"><a href="#çŸ©é˜µåŠ é€Ÿé€’æ¨" class="headerlink" title="çŸ©é˜µåŠ é€Ÿé€’æ¨"></a>çŸ©é˜µåŠ é€Ÿé€’æ¨</h2><p>å°±ä»¥çŸ©é˜µåŠ é€Ÿæ–æ³¢é‚£å¥‘æ•°åˆ—é€’æ¨ä¸ºä¾‹å§ã€‚</p>
<p>æˆ‘ä»¬å°†ç¬¬ $n$ é¡¹æ–æ³¢é‚£å¥‘æ•°ç®€å†™ä¸º $F_n$ã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“ $F_n &#x3D; F_{n-1} + F_{n-2}$ï¼Œæˆ‘ä»¬å°±è€ƒè™‘æŠŠæ–æ³¢é‚£å¥‘æ•°åˆ—çš„ç›¸é‚»ä¸¤é¡¹æ”¾åœ¨ä¸€ä¸ªè¡Œï¼ˆæˆ–è€…åˆ—ï¼Œæ ¹æ®ä¸ªäººä¹ æƒ¯ï¼‰çŸ©é˜µé‡Œé¢ï¼Œå°±åƒè¿™ä¸ªæ ·å­ï¼š$\begin{bmatrix}F_i&amp;F_{i-1}\end{bmatrix}$ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦æŠŠ $\begin{bmatrix}F_i&amp;F_{i-1}\end{bmatrix}$ å˜æˆ $\begin{bmatrix}F_{i-1}+F_i&amp;F_i\end{bmatrix}$ï¼ŒåŒæ—¶éœ€è¦ç”¨åˆ°çŸ©é˜µä¹˜æ³•ã€‚</p>
<p>å› ä¸º<br>$$<br>\begin{bmatrix}<br>a &amp; b<br>\end{bmatrix}<br>\times<br>\begin{bmatrix}<br>x &amp; y\\<br>z &amp; w<br>\end{bmatrix}<br>&#x3D;<br>\begin{bmatrix}<br>ax+bz &amp; ay+bw<br>\end{bmatrix}<br>$$</p>
<p>æ‰€ä»¥æˆ‘ä»¬å¦‚æœæƒ³è®© $\begin{bmatrix}a&amp;b\end{bmatrix}$ å˜æˆ $\begin{bmatrix}a+b&amp;a\end{bmatrix}$ çš„è¯ï¼Œæˆ‘ä»¬å°±éœ€è¦å°†å…¶ä¹˜ä»¥ $\begin{bmatrix}1&amp;1\\1&amp;0\end{bmatrix}$ã€‚</p>
<p>ç„¶åå°±æ˜¯çŸ©é˜µå¿«é€Ÿå¹‚äº†ã€‚<br>å› ä¸ºæˆ‘ä»¬ä¸€å¼€å§‹çš„ $\begin{bmatrix}1&amp;1\end{bmatrix}$ æ˜¯ $\begin{bmatrix}F_2&amp;F_1\end{bmatrix}$ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦å°†å…¶ä¹˜ä»¥ $\begin{bmatrix}1&amp;1\\1&amp;0\end{bmatrix}^{n-2}$ å³å¯å¾—åˆ° $F_n$ã€‚</p>
<h3 id="å¦‚ä½•æ„å»ºè½¬ç§»çŸ©é˜µ"><a href="#å¦‚ä½•æ„å»ºè½¬ç§»çŸ©é˜µ" class="headerlink" title="å¦‚ä½•æ„å»ºè½¬ç§»çŸ©é˜µ"></a>å¦‚ä½•æ„å»ºè½¬ç§»çŸ©é˜µ</h3><p>æˆ‘ä»¬è€ƒè™‘æˆ‘ä»¬æ˜¯å¦‚ä½•ä»ä¸€ä¸ªçŠ¶æ€è½¬ç§»åˆ°ä¸‹ä¸€ä¸ªçŠ¶æ€çš„ã€‚</p>
<p>å¯¹äºä¸€ä¸ªå‡½æ•° $f(x)$ï¼Œæˆ‘ä»¬å‡å®šå®ƒå…·æœ‰è¿™æ ·çš„è½¬ç§»å¼å­ï¼š</p>
<p>$$<br>f(x) &#x3D; f(x-1) + 2f(x-2) + 2^x + 2<br>$$</p>
<p>æˆ‘ä»¬çš„çŠ¶æ€çŸ©é˜µå°±æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š$\begin{bmatrix}f(x)&amp;f(x-1)&amp;2^x&amp;1\end{bmatrix}$ã€‚</p>
<p>ç„¶åæˆ‘ä»¬è€ƒè™‘æˆ‘ä»¬å¦‚ä½•ä» $\begin{bmatrix}f(x-1)&amp;f(x-2)&amp;2^{x-1}&amp;1\end{bmatrix}$ å˜ä¸º $\begin{bmatrix}f(x)&amp;f(x-1)&amp;2^x&amp;1\end{bmatrix}$</p>
<p>æˆ‘ä»¬å°† $\begin{bmatrix}f(x)&amp;f(x-1)&amp;2^x&amp;1\end{bmatrix}$ å±•å¼€ï¼Œå¾—</p>
<p>$$<br>\begin{align}<br>f(x) &amp;&#x3D; f(x-1) \times 1 + f(x-2) \times 2 + 2^{x-1} \times 2 + 1 \times 2 \\<br>f(x-1) &amp;&#x3D; f(x-1) \times 1 + f(x-2) \times 0 + 2^{x-1} \times 0 + 1 \times 0 \\<br>2^x &amp;&#x3D; f(x-1) \times 0 + f(x-2) \times 0 + 2^{x-1} \times 2 + 1 \times 0 \\<br>1 &amp;&#x3D; f(x-1) \times 0 + f(x-2) \times 0 + 2^{x-1} \times 0 + 1 \times 1<br>\end{align}<br>$$</p>
<p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°æˆ‘ä»¬çš„è½¬ç§»çŸ©é˜µäº†ï¼š</p>
<p>$$<br>\begin{bmatrix}<br>1&amp;1&amp;0&amp;0\\<br>2&amp;0&amp;0&amp;0\\<br>2&amp;0&amp;2&amp;0\\<br>2&amp;0&amp;0&amp;1<br>\end{bmatrix}<br>$$</p>
<h2 id="çŸ©é˜µè¾…åŠ©ç»´æŠ¤ä¿¡æ¯"><a href="#çŸ©é˜µè¾…åŠ©ç»´æŠ¤ä¿¡æ¯" class="headerlink" title="çŸ©é˜µè¾…åŠ©ç»´æŠ¤ä¿¡æ¯"></a>çŸ©é˜µè¾…åŠ©ç»´æŠ¤ä¿¡æ¯</h2><p>è¿™ç§ä¸€èˆ¬å°±æ˜¯å¯¹äºé‚£ç§åŒæ—¶éœ€è¦ç»´æŠ¤å¤šç§ä¿¡æ¯ï¼Œè¿˜éœ€è¦æ”¯æŒä¸€å¤§å †å¤æ‚çš„æ“ä½œï¼Œä½†æ˜¯æ¨å¼å­çš„æ—¶å€™ä¸ä¼šè¶…è¿‡ä¸€æ¬¡çš„é‚£ç§é¢˜ï¼Œå°±æ¯”å¦‚è¯´è¿™ä¸€ä¸ªï¼š</p>
<p><a href="/solutions/solution-l2980/">THUSC å¤§é­”æ³•å¸ˆ</a></p>
<p>æˆ‘ä»¬å¯ä»¥å‘ç°å…¶æ“ä½œï¼ˆ$A_i &#x3D; A_i + k$ï¼Œ$B_i &#x3D; B_i \times k$ï¼Œ$C_i &#x3D; k$ï¼‰å‡æœªå‡ºç°ä¸¤ä¸ªæœªçŸ¥é‡ç›¸ä¹˜çš„æƒ…å†µï¼Œå³å¯åˆ¤å®šå…¶å¯ä»¥åˆ©ç”¨çŸ©é˜µä¹˜æ³•æ¥ç»´æŠ¤ã€‚</p>
]]></content>
      <categories>
        <category>çº¿æ€§ä»£æ•°</category>
      </categories>
      <tags>
        <tag>æ•°å­¦</tag>
        <tag>çº¿æ€§ä»£æ•°</tag>
      </tags>
  </entry>
  <entry>
    <title>æ›¿ç½ªç¾Šæ ‘</title>
    <url>/scapegoat-tree/</url>
    <content><![CDATA[<p>æ›¿ç½ªç¾Šæ ‘ã€‚</p>
<span id="more"></span>

<p>æ›¿ç½ªç¾Šæ ‘æ˜¯ä¸€ç§å¹³è¡¡æ ‘ã€‚</p>
<h1 id="çƒ­èº«"><a href="#çƒ­èº«" class="headerlink" title="çƒ­èº«"></a>çƒ­èº«</h1><p>å¹³è¡¡æ ‘ä¸€èˆ¬éƒ½æ˜¯ä¸€ä¸ªäºŒå‰æœç´¢æ ‘ï¼Œå…¶æ»¡è¶³ä¸­åºéå†å¾—åˆ°çš„åºåˆ—å°±æ˜¯æˆ‘ä»¬éœ€è¦ç»´æŠ¤çš„åŸåºåˆ—ã€‚</p>
<p>å½“ç„¶ï¼ŒäºŒå‰æœç´¢æ ‘å¯ä»¥ä¸å¹³è¡¡ï¼Œè¿™æ ·å°±å¯ä»¥æ„é€ ä¸€ä¸ªç‰¹æ®Šçš„æ•°æ®ä½¿ä¹‹é€€åŒ–æˆä¸ºä¸€æ¡é“¾ã€‚</p>
<p>é‚£æˆ‘ä»¬æ€ä¹ˆå®šä¹‰ä¸€æ£µäºŒå‰æœç´¢æ ‘â€œä¸å¹³è¡¡â€å‘¢ï¼Ÿ</p>
<p>è¿™é‡Œéœ€è¦å¼•å…¥ä¸€ä¸ªæ¦‚å¿µï¼šå¹³è¡¡æŒ‡æ•° $\alpha$ã€‚</p>
<p>ä¸€æ£µäºŒå‰æœç´¢æ ‘çš„å¹³è¡¡å¸¸æ•°ç­‰äºå…¶å­èŠ‚ç‚¹å¤§å°ä¸å…¶å¤§å°çš„æ¯”å€¼ã€‚<br>è¿™é‡Œå–çš„æ˜¯æœ€å¤§å€¼ã€‚</p>
<p>å¹³è¡¡å¸¸æ•° $\alpha$ çš„å–å€¼æ˜¯ $\alpha \in [ 0.5 , 1 ]$ã€‚<br>å…¶ä¸¤ä¸ªè¾¹ç•Œä»£è¡¨äº†ä¸¤ä¸ªæç«¯æƒ…å†µï¼š</p>
<p>å½“ $\alpha &#x3D; 1$ æ—¶ï¼Œæˆ‘ä»¬ä¸ç®¡æ€æ ·å»ºé€ æœç´¢æ ‘éƒ½ä¼šè¢«è®¤ä¸ºæ˜¯å¹³è¡¡çš„ï¼Œå› ä¸ºå…¶å­èŠ‚ç‚¹çš„å­æ ‘å¤§å°æ°¸è¿œä¸å¯èƒ½è¶…è¿‡å…¶æœ¬èº«çš„å­æ ‘å¤§å°ã€‚</p>
<p>å½“ $\alpha &#x3D; 0.5$ æ—¶ï¼Œæˆ‘ä»¬æ¯ä¸€ä¸ªèŠ‚ç‚¹çš„å­èŠ‚ç‚¹çš„å­æ ‘å¤§å°å¿…é¡»æ°å¥½æ˜¯å…¶æœ¬èº«çš„å­æ ‘å¤§å°çš„ä¸€åŠã€‚<br>AVLæ ‘å°±åœ¨å°½åŠ›ç»´æŒè¿™æ ·çš„å¹³è¡¡ï¼Œè¿™å°±å¯¼è‡´å…¶ä»£ç ååˆ†å†—é•¿ï¼Œæ²¡æœ‰èƒ½åœ¨OIä¸Šæœ‰å¤ªå¤šå®é™…çš„åº”ç”¨ã€‚<br>åœ¨<span class="exturl" data-url="aHR0cHM6Ly93d3cuY3MudXNmY2EuZWR1L35nYWxsZXMvdmlzdWFsaXphdGlvbi9BVkx0cmVlLmh0bWw=">è¿™é‡Œ<i class="fa fa-external-link-alt"></i></span>æœ‰ä¸€ä¸ªAVLæ ‘çš„å¯è§†åŒ–ã€‚</p>
<p>çº¢é»‘æ ‘æ¯”è¾ƒç‰¹æ®Šï¼Œé€šè¿‡æ”¾å®½ä¸€äº›è¿‡äºä¸¥è‹›çš„è¦æ±‚ï¼Œå…¶è¿½æ±‚çš„æ˜¯ $\alpha &#x3D; \frac{2}{3}$ï¼ŒåŒæ—¶é™ä½äº†å¸¸æ•°å’Œä»£ç é•¿åº¦ã€‚<br>åœ¨<span class="exturl" data-url="aHR0cHM6Ly93d3cuY3MudXNmY2EuZWR1L35nYWxsZXMvdmlzdWFsaXphdGlvbi9SZWRCbGFjay5odG1s">è¿™é‡Œ<i class="fa fa-external-link-alt"></i></span>æœ‰ä¸€ä¸ªçº¢é»‘æ ‘çš„å¯è§†åŒ–ã€‚</p>
<p>å…¶ä»–çš„å¹³è¡¡æ ‘éƒ½æ˜¯é€šè¿‡ä¸€äº›æ€æƒ³æ¥ç»´æŒ $\alpha$ çš„å°½é‡ä½ã€‚</p>
<p>åŸºäº<span class="exturl" data-url="aHR0cHM6Ly9yaXRlbWUuc2l0ZS9ibG9nLzIwMTYtNC02L3NjYXBlZ29hdC5odG1s">è¿™é‡Œ<i class="fa fa-external-link-alt"></i></span>çš„æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥å¤§æ¦‚å¾—çŸ¥ä¸åŒå¹³è¡¡æ ‘çš„ $\alpha$ å¤§å°ï¼š</p>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="center">1</th>
<th align="center">2</th>
<th align="center">3</th>
<th align="center">4</th>
<th align="center">5</th>
<th align="center">å¹³å‡</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Splay</td>
<td align="center">0.758</td>
<td align="center">0.588</td>
<td align="center">0.582</td>
<td align="center">0.612</td>
<td align="center">0.759</td>
<td align="center">0.659</td>
</tr>
<tr>
<td align="center">Treap</td>
<td align="center">0.766</td>
<td align="center">0.578</td>
<td align="center">0.601</td>
<td align="center">0.587</td>
<td align="center">0.781</td>
<td align="center">0.662</td>
</tr>
<tr>
<td align="center">FHQ-Treap</td>
<td align="center">0.914</td>
<td align="center">0.860</td>
<td align="center">0.613</td>
<td align="center">0.678</td>
<td align="center">0.803</td>
<td align="center">0.773</td>
</tr>
</tbody></table>
<p>å¯è§ï¼Œä¸€èˆ¬çš„å¹³è¡¡æ ‘éƒ½èƒ½å°† $\alpha$ ç»´æŒåˆ° 0.6 åˆ° 0.8 èŒƒå›´å†…ã€‚</p>
<h2 id="æ›¿ç½ªç¾Šæ ‘"><a href="#æ›¿ç½ªç¾Šæ ‘" class="headerlink" title="æ›¿ç½ªç¾Šæ ‘"></a>æ›¿ç½ªç¾Šæ ‘</h2><p>æ›¿ç½ªç¾Šæ ‘æœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯æš´åŠ›ã€‚</p>
<p>æ€ä¹ˆæš´åŠ›å‘¢ï¼Ÿ</p>
<p>æ›¿ç½ªç¾Šæ ‘ä¼šå°†ä¸å¹³è¡¡çš„å­æ ‘è¿›è¡Œé‡æ„æ¥ä¿è¯å…¶å¹³è¡¡ã€‚<br>è€Œå…¶åˆ¤æ–­å­æ ‘å¹³è¡¡ä¸å¦å°±æ˜¯æ ¹æ®åˆšæ‰è®²çš„å¹³è¡¡å› æ•° $\alpha$ï¼Œåªä¸è¿‡è¿™é‡Œæ˜¯äººä¸ºè®¾å®šçš„ï¼Œç§°ä¹‹ä¸ºå¹³è¡¡å¸¸æ•°ã€‚</p>
<h1 id="æ€æƒ³"><a href="#æ€æƒ³" class="headerlink" title="æ€æƒ³"></a>æ€æƒ³</h1><h2 id="æš´åŠ›é‡æ„"><a href="#æš´åŠ›é‡æ„" class="headerlink" title="æš´åŠ›é‡æ„"></a>æš´åŠ›é‡æ„</h2><p>æ›¿ç½ªç¾Šæ ‘ä¹‹æ‰€ä»¥èƒ½å¤Ÿå¹³è¡¡ï¼Œæ˜¯åœ¨äºå…¶é‡æ„æ—¶ä¸æ˜¯çé‡æ„ï¼Œè€Œæ˜¯å°†è¢«é‡æ„çš„å­æ ‘é‡æ„ä¸ºä¸€æ£µ<strong>å®Œå…¨äºŒå‰æ ‘</strong>ã€‚</p>
<p>å½“ç„¶æˆ‘ä»¬éƒ½çŸ¥é“è¿™æ ·è´¹æ—¶åˆè´¹åŠ›ï¼Œæ›´ä½•å†µè¿˜æ˜¯æš´åŠ›é‡æ„çš„ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬è®¤ä¸ºè®¾å®šçš„å¹³è¡¡å¸¸æ•° $\alpha$ åœ¨æ­¤æ—¶å°±èµ·åˆ°äº†å†³å®šæ€§çš„ä½œç”¨ã€‚<br>å½“å…¶å€¼åˆé€‚çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†æ‰€æœ‰çš„æ—¶é—´å¤æ‚åº¦å‡æ‘Šåˆ°ä¸€ä¸ª $O(\log n)$ çš„æ°´å¹³ã€‚</p>
<p>å…·ä½“å¦‚ä½•æš´åŠ›é‡æ„å°±ä¸ç”¨å¤ªå¤šèµ˜è¿°äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç®€å•çš„æ–¹æ³•æ¥ä¿è¯çº¿æ€§å»ºæ ‘ï¼Œç„¶åå°†æ–°å»ºçš„æ ‘æ¥è¿‡æ¥å³å¯ã€‚</p>
<h2 id="æŸ¥è¯¢"><a href="#æŸ¥è¯¢" class="headerlink" title="æŸ¥è¯¢"></a>æŸ¥è¯¢</h2><p>æ›¿ç½ªç¾Šæ ‘çš„æŸ¥è¯¢ä¸å…¶ä»–äºŒå‰æœç´¢æ ‘ä¸€æ ·ï¼Œå¹¶ä¸”å› ä¸ºå…¶æ²¡æœ‰å¯¹æ ‘è¿›è¡Œä¿®æ”¹ï¼Œè¿˜ä¸ä¼šå¯¼è‡´äº§ç”Ÿé‡æ„æ“ä½œï¼Œæ‰€ä»¥æœ€ç»ˆæ—¶é—´å¤æ‚åº¦ä¸º $O(\log n)$ã€‚</p>
<h2 id="æ’å…¥"><a href="#æ’å…¥" class="headerlink" title="æ’å…¥"></a>æ’å…¥</h2><p>æ›¿ç½ªç¾Šæ ‘çš„æ’å…¥æ“ä½œä¸å…¶ä»–çš„äºŒå‰æœç´¢æ ‘å·®ä¸å¤šã€‚åªä¸è¿‡å› ä¸ºå…¶å¯¼è‡´äº†æ ‘å½¢æ€çš„æ”¹å˜ï¼Œæˆ‘ä»¬åœ¨æ’å…¥å®Œå›æº¯çš„è¿‡ç¨‹ä¸­è¿˜éœ€è¦åˆ¤æ–­ä¸€ä¸‹æ˜¯å¦éœ€è¦é‡æ„ã€‚</p>
<p>å½“ç„¶ï¼Œè¿˜ä¼šæœ‰ä¸€æ¡é“¾ä¸Šå¤šæ£µå­æ ‘ä¸å¹³è¡¡çš„æƒ…å†µã€‚<br>æˆ‘ä»¬å¯ä»¥å°†æœ€å¤§çš„å­æ ‘é‡æ„ï¼Œä½†æ˜¯è¿™æ ·åœ¨å®é™…å†™ä»£ç çš„æ—¶å€™ä¼šç•¥æ˜¾å¤æ‚ã€‚<br>å¦‚æœä½ çœŸçš„å¾ˆæ‡’çš„è¯ï¼Œåªéœ€è¦åœ¨å›æº¯çš„æ—¶å€™æ‰¾åˆ°ç¬¬ä¸€æ£µä¸å¹³è¡¡çš„æ ‘é‡æ„å³å¯ï¼Œå¹¶ä¸”æ®è¯´è¿™ä¸ªæ ·å­å¯¹äºæ—¶é—´å¤æ‚åº¦çš„å½±å“ä¸ä¼šå¾ˆå¤§ã€‚</p>
<h2 id="åˆ é™¤"><a href="#åˆ é™¤" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h2><p>æ›¿ç½ªç¾Šæ ‘ä½¿ç”¨æƒ°æ€§åˆ é™¤ï¼Œåªéœ€è¦å°†å¯¹åº”èŠ‚ç‚¹ä¸Šä»£è¡¨èŠ‚ç‚¹å†…æ•°æ®æ•°é‡çš„æ ‡è®°è‡ªå‡ä¸€å³å¯ã€‚</p>
<p>å¯¹äºä¸€ä¸ªèŠ‚ç‚¹å†…æ•°æ®æ•°é‡ä¸º0çš„ç‚¹ï¼Œæˆ‘ä»¬ä¼šå¿½ç•¥å¯¹å…¶çš„ä»»ä½•æ“ä½œï¼Œå¹¶åœ¨ä¸‹ä¸€æ¬¡é‡æ„æ—¶å°†å…¶ä¸¢å¼ƒæ‰ï¼Œé™¤éå†æœ‰æ’å…¥æ“ä½œå°†å…¶æ’å…¥å›å»ã€‚</p>
<h1 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h1><h2 id="èŠ‚ç‚¹"><a href="#èŠ‚ç‚¹" class="headerlink" title="èŠ‚ç‚¹"></a>èŠ‚ç‚¹</h2><p>æ›¿ç½ªç¾Šæ ‘çš„ä¸€ä¸ªèŠ‚ç‚¹å†…éœ€è¦å­˜å‚¨å¾ˆå¤šä¿¡æ¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Scapegoat</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> ls, rs;</span><br><span class="line">    <span class="type">int</span> w, wn;</span><br><span class="line">    <span class="type">int</span> s, sz, sd;</span><br><span class="line">&#125;tr[N];</span><br></pre></td></tr></table></figure>

<p>è§£é‡Šä¸€ä¸‹ï¼š</p>
<ul>
<li><code>ls</code>&amp;<code>rs</code>ï¼šå·¦å³å„¿å­ã€‚</li>
<li><code>w</code>ï¼šèŠ‚ç‚¹æƒå€¼ã€‚</li>
<li><code>wn</code>ï¼šèŠ‚ç‚¹å†…æ•°æ®æ•°é‡ã€‚</li>
<li><code>s</code>ï¼šå­æ ‘å†…èŠ‚ç‚¹ä¸ªæ•°ã€‚</li>
<li><code>sz</code>ï¼šå­æ ‘å†…æ•°æ®ä¸ªæ•°ã€‚</li>
<li><code>sd</code>ï¼šå­æ ‘å†…ä¸è®¡åˆ é™¤èŠ‚ç‚¹çš„èŠ‚ç‚¹ä¸ªæ•°ã€‚</li>
</ul>
<p>æˆ‘ä»¬è¿™æ ·æ¥ï¼ˆé‡æ–°ï¼‰è®¡ç®—å½“å‰èŠ‚ç‚¹çš„å­æ ‘å¤§å°ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">calc</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tr[p].s = tr[tr[p].ls].s + tr[tr[p].rs].s + <span class="number">1</span>;</span><br><span class="line">    tr[p].sz = tr[tr[p].ls].sz + tr[tr[p].rs].sz + tr[p].wn;</span><br><span class="line">    tr[p].sd = tr[tr[p].ls].sd + tr[tr[p].rs].sd + (tr[p].wn != <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="é‡æ„"><a href="#é‡æ„" class="headerlink" title="é‡æ„"></a>é‡æ„</h2><p>æˆ‘ä»¬é‡æ„åˆ†ä¸¤ç§æƒ…å†µï¼šä¸€æ˜¯å­æ ‘ä¸å¹³è¡¡äº†ï¼Œå³å·¦å³å­æ ‘ä¹‹ä¸€çš„å¤§å°å å…¶æœ¬èº«å­æ ‘å¤§å°çš„æ¯”ä¾‹è¶…è¿‡ $\alpha$ï¼›äºŒæ˜¯è¢«åˆ é™¤çš„èŠ‚ç‚¹å¤ªå¤šäº†ï¼Œè¿™æ ·ä¹Ÿä¼šå½±å“æ•ˆç‡ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬éœ€è¦åˆ¤æ–­æ˜¯å¦éœ€è¦é‡æ„ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">canrbu</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!tr[p].wn)<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span>(alpha * tr[p].s &lt;= <span class="built_in">double</span>(<span class="built_in">max</span>(tr[tr[p].ls].s, tr[tr[p].rs].s)))<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">double</span>(tr[p].sd) &lt;= alpha * tr[p].s)<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;<span class="comment">//can rebuild</span></span><br></pre></td></tr></table></figure>

<p>ä¸€å¥è¯ç‰ˆï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">CanRbu</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> tr[k].wn &amp;&amp; (alpha * tr[k].s &lt;= ( <span class="type">double</span> )<span class="built_in">max</span>(tr[tr[k].ls].s, tr[tr[k].rs].s) || ( <span class="type">double</span> )tr[k].sd &lt;= alpha * tr[k].s);</span><br><span class="line">&#125;<span class="comment">//can rebuild</span></span><br></pre></td></tr></table></figure>

<p>ç„¶åå°±æ˜¯é‡æ„çš„å…·ä½“æ“ä½œï¼š</p>
<p>é¦–å…ˆæˆ‘ä»¬å°†éœ€è¦é‡æ„çš„å­æ ‘ç»ä¸­åºéå†å±•å¼€ä¹‹åå­˜å…¥æ•°ç»„ä¸­ï¼Œç„¶åå°†æ–°å¾—åˆ°çš„æ•°ç»„äºŒåˆ†å»ºæ ‘ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">rbuunf</span><span class="params">(<span class="type">int</span> &amp;ldc, <span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!p)<span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">rbuunf</span>(ldc, tr[p].ls);</span><br><span class="line">    <span class="keyword">if</span>(tr[p].wn)ldr[++ldc] = p;</span><br><span class="line">    <span class="built_in">rbuunf</span>(ldc, tr[p].rs);</span><br><span class="line">&#125;<span class="comment">//rebuild-unfold</span></span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">rbubld</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l &gt;= r)<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    tr[ldr[mid]].ls = <span class="built_in">rbubld</span>(l, mid);</span><br><span class="line">    tr[ldr[mid]].rs = <span class="built_in">rbubld</span>(mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="built_in">calc</span>(ldr[mid]);</span><br><span class="line">    <span class="keyword">return</span> ldr[mid];</span><br><span class="line">&#125;<span class="comment">//rebuild-build</span></span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">rbuild</span><span class="params">(<span class="type">int</span> &amp;p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> ldc = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">rbuunf</span>(ldc, p);</span><br><span class="line">    p = <span class="built_in">rbubld</span>(<span class="number">1</span>, ldc);</span><br><span class="line">&#125;<span class="comment">//rebuild</span></span><br></pre></td></tr></table></figure>

<h2 id="æ’å…¥-1"><a href="#æ’å…¥-1" class="headerlink" title="æ’å…¥"></a>æ’å…¥</h2><p>æ’å…¥æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°å¯¹åº”èŠ‚ç‚¹å¹¶ <code>tr[p].wn++</code>ã€‚å¦‚æœæ²¡æœ‰èŠ‚ç‚¹å°±æ–°å»ºä¸€ä¸ªï¼Œå›æº¯æ—¶éœ€è¦åˆ¤æ–­æ˜¯å¦èƒ½å¤Ÿé‡æ„ï¼Œå¦‚æœå¯ä»¥çš„è¯å°±é‡æ„ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!p)</span><br><span class="line">    &#123;</span><br><span class="line">        p = ++cnt;</span><br><span class="line">        <span class="keyword">if</span>(!rt)rt = <span class="number">1</span>;</span><br><span class="line">        tr[p].w = k;</span><br><span class="line">        tr[p].ls = tr[p].rs = <span class="number">0</span>;</span><br><span class="line">        tr[p].wn = tr[p].s = tr[p].sz = tr[p].sd = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(tr[p].w == k)tr[p].wn++;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(tr[p].w &lt; k)<span class="built_in">insert</span>(tr[p].rs, k);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">insert</span>(tr[p].ls, k);</span><br><span class="line">        <span class="built_in">calc</span>(p);</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">canrbu</span>(p))<span class="built_in">rbuild</span>(p);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="åˆ é™¤-1"><a href="#åˆ é™¤-1" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h2><p>æ›¿ç½ªç¾Šæ ‘ä½¿ç”¨æƒ°æ€§åˆ é™¤ï¼Œæ‰¾åˆ°å¯¹åº”èŠ‚ç‚¹ä¹‹ååªéœ€è¦ <code>tr[p].wn--</code> å³å¯ã€‚å½“ç„¶ï¼Œå›æº¯æ—¶å€™é‡åˆ°å¯ä»¥é‡æ„çš„èŠ‚ç‚¹æ—¶è¦é‡æ„ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">loschn</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!p)<span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span>(tr[p].w == k)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(tr[p].wn)tr[p].wn--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(tr[p].w &lt; k)<span class="built_in">loschn</span>(tr[p].rs, k);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">loschn</span>(tr[p].ls, k);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">calc</span>(p);</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">canrbu</span>(p))<span class="built_in">rbuild</span>(p);</span><br><span class="line">&#125;<span class="comment">//lÃ¶schenï¼Œdeleteæ˜¯å…³é”®å­—å°±ä¸ç”¨äº†</span></span><br></pre></td></tr></table></figure>

<p>ç„¶åå°±æ˜¯ä¸€äº›å…¶ä»–å‡½æ•°ï¼š</p>
<h2 id="upper-bound"><a href="#upper-bound" class="headerlink" title="upper_bound"></a><code>upper_bound</code></h2><p>ä¸åŸæ¥upper_boundçš„ç”¨é€”ä¸€æ ·ï¼Œè¿”å›ç¬¬ä¸€ä¸ªå¤§äºå…¶æƒå€¼çš„ä½ç½®ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">uprbnd</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!p)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(tr[p].w == k &amp;&amp; tr[p].wn)</span><br><span class="line">        <span class="keyword">return</span> tr[tr[p].ls].sz + tr[p].wn + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(tr[p].w &gt; k)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">uprbnd</span>(tr[p].ls, k);</span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">        <span class="keyword">return</span> tr[tr[p].ls].sz + tr[p].wn + <span class="built_in">uprbnd</span>(tr[p].rs, k);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿˜æœ‰ä¸€ä¸ªå…¶åä¹‰å‡½æ•°ï¼Œç›¸å½“äºæ˜¯å¯¹å½“å‰åºåˆ—åè½¬ä¹‹åçš„ç»“æœè¿›è¡Œupper_boundï¼Œè¿”å›çš„æ˜¯ç¬¬ä¸€ä¸ªå°äºå…¶æƒå€¼çš„ä½ç½®ã€‚</p>
<p>æŸ¥è¯¢æŸä¸€ä¸ªæ•°å­—çš„æ’åçš„æ—¶å€™å¯ä»¥ä½¿ç”¨ <code>uprgtr(rt,k)+1</code>ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">uprgtr</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!p)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(tr[p].w == k &amp;&amp; tr[p].wn)</span><br><span class="line">        <span class="keyword">return</span> tr[tr[p].ls].sz;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(tr[p].w &lt; p)</span><br><span class="line">        <span class="keyword">return</span> tr[tr[p].ls].sz + tr[p].wn + <span class="built_in">uprgtr</span>(tr[p].rs, k);</span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">uprgtr</span>(tr[p].ls, k);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="getk"><a href="#getk" class="headerlink" title="getk"></a><code>getk</code></h2><p>getkå‡½æ•°è¿”å›çš„æ˜¯å½“å‰æ’åä¸Šçš„æ•°å­—ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">getk</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!p)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(tr[tr[p].ls].sz &lt; k &amp;&amp; k &lt;= tr[tr[p].ls].sz + tr[p].wn)</span><br><span class="line">        <span class="keyword">return</span> tr[p].w;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(tr[tr[p].ls].sz + tr[p].wn &lt; p)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">getk</span>(tr[p].rs, k - tr[tr[p].ls].sz - tr[p].wn);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">getk</span>(tr[p].ls, k);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å‰é©±ä¸åç»§"><a href="#å‰é©±ä¸åç»§" class="headerlink" title="å‰é©±ä¸åç»§"></a>å‰é©±ä¸åç»§</h2><p>å°†ä¸Šé¢ä¸¤ä¸ªå‡½æ•°ç»“åˆèµ·æ¥å°±å¯ä»¥äº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">precrs</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">getk</span>(p, <span class="built_in">uprgtr</span>(p, k));</span><br><span class="line">&#125;<span class="comment">//precursor</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">succsr</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">getk</span>(p, <span class="built_in">uprbnd</span>(p, k));</span><br><span class="line">&#125;<span class="comment">//successor</span></span><br></pre></td></tr></table></figure>

<h1 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h1><p>æ´›è°·ä¸Šçš„<span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL3Byb2JsZW0vUDMzNjk=">æ¿å­<i class="fa fa-external-link-alt"></i></span>ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">100010</span>;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">double</span> alpha = <span class="number">0.75</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Scapegoat</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> ls, rs;</span><br><span class="line">    <span class="type">int</span> w, wn;</span><br><span class="line">    <span class="type">int</span> s, sz, sd;</span><br><span class="line">&#125;tr[N];</span><br><span class="line"><span class="type">int</span> cnt, rt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">calc</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tr[p].s = tr[tr[p].ls].s + tr[tr[p].rs].s + <span class="number">1</span>;</span><br><span class="line">    tr[p].sz = tr[tr[p].ls].sz + tr[tr[p].rs].sz + tr[p].wn;</span><br><span class="line">    tr[p].sd = tr[tr[p].ls].sd + tr[tr[p].rs].sd + (tr[p].wn != <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">canrbu</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> tr[p].wn &amp;&amp; (alpha * tr[p].s &lt;= ( <span class="type">double</span> )<span class="built_in">max</span>(tr[tr[p].ls].s, tr[tr[p].rs].s) || ( <span class="type">double</span> )tr[p].sd &lt;= alpha * tr[p].s);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> ldr[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rbuunf</span><span class="params">(<span class="type">int</span> &amp;ldc, <span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!p)<span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">rbuunf</span>(ldc, tr[p].ls);</span><br><span class="line">    <span class="keyword">if</span>(tr[p].wn)ldr[ldc++] = p;</span><br><span class="line">    <span class="built_in">rbuunf</span>(ldc, tr[p].rs);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">rbubld</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l &gt;= r)<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    tr[ldr[mid]].ls = <span class="built_in">rbubld</span>(l, mid);</span><br><span class="line">    tr[ldr[mid]].rs = <span class="built_in">rbubld</span>(mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="built_in">calc</span>(ldr[mid]);</span><br><span class="line">    <span class="keyword">return</span> ldr[mid];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rbuild</span><span class="params">(<span class="type">int</span> &amp;p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> ldc = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">rbuunf</span>(ldc, p);</span><br><span class="line">    p = <span class="built_in">rbubld</span>(<span class="number">0</span>, ldc);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!p)</span><br><span class="line">    &#123;</span><br><span class="line">        p = ++cnt;</span><br><span class="line">        <span class="keyword">if</span>(!rt)rt = <span class="number">1</span>;</span><br><span class="line">        tr[p].w = k;</span><br><span class="line">        tr[p].ls = tr[p].rs = <span class="number">0</span>;</span><br><span class="line">        tr[p].wn = tr[p].s = tr[p].sz = tr[p].sd = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(tr[p].w == k)tr[p].wn++;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(tr[p].w &lt; k)<span class="built_in">insert</span>(tr[p].rs, k);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">insert</span>(tr[p].ls, k);</span><br><span class="line">        <span class="built_in">calc</span>(p);</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">canrbu</span>(p))<span class="built_in">rbuild</span>(p);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">loschn</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!p)<span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span>(tr[p].w == k)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(tr[p].wn)tr[p].wn--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(tr[p].w &lt; k)<span class="built_in">loschn</span>(tr[p].rs, k);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">loschn</span>(tr[p].ls, k);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">calc</span>(p);</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">canrbu</span>(p))<span class="built_in">rbuild</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">uprbnd</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!p)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(tr[p].w == k &amp;&amp; tr[p].wn)</span><br><span class="line">        <span class="keyword">return</span> tr[tr[p].ls].sz + tr[p].wn + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(tr[p].w &gt; k)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">uprbnd</span>(tr[p].ls, k);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> tr[tr[p].ls].sz + tr[p].wn + <span class="built_in">uprbnd</span>(tr[p].rs, k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">uprgtr</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!p)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(tr[p].w == k &amp;&amp; tr[p].wn)</span><br><span class="line">        <span class="keyword">return</span> tr[tr[p].ls].sz;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(tr[p].w &lt; k)</span><br><span class="line">        <span class="keyword">return</span> tr[tr[p].ls].sz + tr[p].wn + <span class="built_in">uprgtr</span>(tr[p].rs, k);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">uprgtr</span>(tr[p].ls, k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">getk</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!p)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(tr[tr[p].ls].sz &lt; k &amp;&amp; k &lt;= tr[tr[p].ls].sz + tr[p].wn)</span><br><span class="line">        <span class="keyword">return</span> tr[p].w;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(tr[tr[p].ls].sz + tr[p].wn &lt; k)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">getk</span>(tr[p].rs, k - tr[tr[p].ls].sz - tr[p].wn);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">getk</span>(tr[p].ls, k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">precrs</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">getk</span>(p, <span class="built_in">uprgtr</span>(p, k));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">succsr</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">getk</span>(p, <span class="built_in">uprbnd</span>(p, k));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> op, x;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;op, &amp;x);</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">insert</span>(rt, x);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">loschn</span>(rt, x);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">3</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> rnk = <span class="built_in">uprgtr</span>(rt, x) + <span class="number">1</span>;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, rnk);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">4</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> k = <span class="built_in">getk</span>(rt, x);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, k);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">5</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> pre = <span class="built_in">precrs</span>(rt, x);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, pre);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">6</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> suc = <span class="built_in">succsr</span>(rt, x);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, suc);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



















































]]></content>
      <categories>
        <category>æ•°æ®ç»“æ„</category>
      </categories>
      <tags>
        <tag>æ•°æ®ç»“æ„</tag>
        <tag>å¹³è¡¡æ ‘</tag>
      </tags>
  </entry>
  <entry>
    <title>åšå®¢ç´¢å¼•</title>
    <url>/suoyin/</url>
    <content><![CDATA[<p>æ–‡ç« çš„ç´¢å¼•ã€‚</p>
<span id="more"></span>

<h1 id="å¼•å­"><a href="#å¼•å­" class="headerlink" title="å¼•å­"></a>å¼•å­</h1><p>$\rm{OI}$ ä¸ $\rm{Ch}$ çš„äº¤æ±‡ï¼Œèƒ½è¿¸å‘å‡ºæ€æ ·çš„ç«èŠ±å‘¢ï¼Ÿ</p>
<p>ä¸ºäº†ä¾¿äº<del>æˆ‘è‡ªå·±åŠæ—¶æ›´æ–°</del>è¯»è€…ä»¬æŒ‘é€‰åˆé€‚çš„æ–‡ç« ï¼Œä¸‹é¢æœ‰å‡ ä¸ªç¬¦å·ï¼Œå¯ä»¥å¸®åŠ©è¯»è€…å¤§äººä»¬æŒ‘é€‰ã€‚<del>ï¼ˆæˆ‘æœ‰è¯»è€…å—ï¼Ÿï¼‰</del></p>
<ul>
<li>$\color[rgb]{0,0.5,1}{\sharp}$ ä»£è¡¨å·²ç»å†™å®Œäº†</li>
<li>$\color[rgb]{0.067,0.270588,0.078431}{\natural}$ è¡¨ç¤ºé•¿æœŸæ›´æ–°</li>
<li>$\color[rgb]{1,0,0}{\flat}$ è¡¨ç¤ºæˆ‘è¿™ä¸ªè’Ÿè’»è¿˜æ²¡å†™å®Œ</li>
<li><strong>æ­¢ã¾ã‚Œ</strong> è¡¨ç¤ºæˆ‘å› æŸç§åŸå› æš‚åœæ›´æ–°<del>ä¹Ÿå°±æ˜¯å’•å’•å’•äº†</del></li>
<li>$\color[rgb]{0.5,0.4,0.4}{Ï†}$ è¡¨ç¤ºæˆ‘è™½ç„¶å†™å®Œäº†ï¼Œä½†æ˜¯æŸäº›åœ°æ–¹è¿˜éœ€è¦å®Œå–„ï¼Œå®Œå–„å®Œäº†ä¼šæ¢æˆ $\color[rgb]{0,0.5,1}{\sharp}$ æ ‡å¿—ã€‚</li>
<li>$\color[rgb]{1,1,0.0625}{\aleph}$ è¡¨ç¤ºæˆ‘è¿™ä¸ªè’Ÿè’»è§‰å¾—æˆ‘è‡ªå·±å†™çš„å¾ˆå¥½ã€‚</li>
</ul>
<p>é˜…è¯»åšå®¢çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šçœ‹åˆ°ä¸€äº›æ¿å­ã€‚</p>
<p>å¦‚æœæŸä¸€ä¸ªæ¿å­æ˜¯æˆ‘è‡ªå·±å†™çš„ï¼Œåœ¨å®ƒçš„é™„è¿‘ä¼šæœ‰ä¸€ä¸ª $\color[rgb]{1,1,0.0625}{Ï†}$ çš„æ ‡å¿—ã€‚è¿™äº›æ¿å­ä¿è¯è¿è¡Œçš„æ­£ç¡®æ€§ã€‚å¤§èƒ†è¤ï¼Œä¸ä¼šæœ‰äº‹çš„ï¼ˆæŒ‡è¿è¡Œç»“æœï¼‰ã€‚<br>å¦‚æœæŸä¸€ä¸ªæ¿å­ä¸æ˜¯æˆ‘å†™çš„ï¼Œåœ¨å®ƒçš„é™„è¿‘ä¼šæœ‰ä¸€ä¸ª $\blacktriangleright$ æŒ‡å‘å®ƒçš„å‡ºå¤„ã€‚è¿™äº›æ¿å­ä¸ä¿è¯è¿è¡Œçš„æ­£ç¡®æ€§ã€‚ä½¿ç”¨ä¹‹å‰è¯·æ–Ÿé…Œã€‚ </p>
<p>æœ€åä¸€æ¬¡ç»´æŠ¤ï¼š20220522 åˆ å»æ´›è°·ç´«é¢˜ä»¥ä¸‹çš„æ‰€æœ‰é¢˜è§£</p>
<h1 id="OI"><a href="#OI" class="headerlink" title="OI"></a>OI</h1><h2 id="æ•°å­¦"><a href="#æ•°å­¦" class="headerlink" title="æ•°å­¦"></a>æ•°å­¦</h2><p>æ•°å­¦æ˜¯ç®—æ³•çš„åŸºçŸ³ã€‚</p>
<ul>
<li><p><a href="/maths/mathematics">æ‚é¡¹æ•´ç†</a> $\color[rgb]{0.067,0.270588,0.078431}{\natural}$<br>å†™ä¸æˆåšå®¢çš„ä¸œè¥¿éƒ½åœ¨è¿™é‡Œã€‚</p>
</li>
<li><p><a href="/OI/prime-sieves">è´¨æ•°ç­›</a> $\color[rgb]{0,0.5,1}{\sharp}$<br>åŒ…å«åŸƒæ°ç­›ï¼Œæ¬§æ‹‰ç­›ä¸ $Miller-Rabin$ ç®—æ³•ã€‚</p>
</li>
<li><p><a href="/maths/eular-and-m%C3%B6bius">æ¬§æ‹‰ä¸è«æ¯”ä¹Œæ–¯</a> $\color[rgb]{0,0.5,1}{\sharp}$<br>åŒ…å«æ¬§æ‹‰å‡½æ•°ã€æ¬§æ‹‰å®šç†ã€è«æ¯”ä¹Œæ–¯å‡½æ•°ä¸è«æ¯”ä¹Œæ–¯åæ¼”ã€‚</p>
</li>
<li><p><a href="/maths/special-numbers">ç‰¹æ®Šçš„æ•°</a> $\color[rgb]{1,0,0}{\flat}$<br>åŒ…å«æ–¯ç‰¹æ—æ•°ç­‰ã€‚</p>
</li>
<li><p><a href="/maths/fourier-transform">å‚…é‡Œå¶å˜æ¢</a> $\color[rgb]{0.5,0.4,0.4}{Ï†}$<br>åŒ…å«å‚…é‡Œå¶å˜æ¢å’Œå¿«é€Ÿå‚…é‡Œå¶å˜æ¢ï¼Œé™„å¸¦ä¸€äº›å¤æ•°å’Œå•ä½æ ¹çš„çŸ¥è¯†ã€‚</p>
</li>
<li><p><a href="/maths/lagrange-interpolation">æ‹‰æ ¼æœ—æ—¥æ’å€¼</a> $\color[rgb]{1,0,0}{\flat}$<br>åŒ…æ‹¬æ‹‰æ ¼æœ—æ—¥æ’å€¼ã€‚</p>
</li>
</ul>
<h2 id="ç®—æ³•"><a href="#ç®—æ³•" class="headerlink" title="ç®—æ³•"></a>ç®—æ³•</h2><p>ç®—æ³•æ˜¯ç¨‹åºçš„åŸºç¡€ã€‚</p>
<ul>
<li><p><a href="/OI/scanning-line">æ‰«æçº¿</a> $\color[rgb]{0,0.5,1}{\sharp}$<br>ä¸€ç§ç”¨æ¥æ±‚çŸ©å½¢é¢ç§¯å¹¶çš„ç®—æ³•ã€‚</p>
</li>
<li><p><a href="/OI/heavy-path-decomposition">æ ‘é“¾å‰–åˆ†</a> $\color[rgb]{0,0.5,1}{\sharp}$<br>æ ‘å‰–ã€‚</p>
</li>
<li><p><a href="/OI/point-divide">ç‚¹åˆ†æ²»</a> $\color[rgb]{0,0.5,1}{\sharp}$<br>ç‚¹åˆ†æ²»ä¸ç‚¹åˆ†æ ‘ã€‚</p>
</li>
</ul>
<h2 id="æ•°æ®ç»“æ„"><a href="#æ•°æ®ç»“æ„" class="headerlink" title="æ•°æ®ç»“æ„"></a>æ•°æ®ç»“æ„</h2><p>å•Šè¿™â€¦â€¦è¿™é‡Œè¯¥æ€ä¹ˆå†™â€¦â€¦</p>
<ul>
<li><p><a href="/OI/tree-array">æ ‘çŠ¶æ•°ç»„</a> $\color[rgb]{0,0.5,1}{\sharp}$<br>å¦‚é¢˜ï¼Œæ ‘çŠ¶æ•°ç»„ã€‚</p>
</li>
<li><p><a href="/OI/segment-tree">çº¿æ®µæ ‘</a> $\color[rgb]{0,0.5,1}{\sharp}$<br>çº¿æ®µæ ‘ç›¸å…³å†…å®¹ï¼ŒåŒ…æ‹¬åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘ã€å¯æŒä¹…åŒ–æƒå€¼çº¿æ®µæ ‘ç­‰ã€‚</p>
</li>
<li><p><a href="/OI/trie-and-AK-avtomat">Trie ä¸ ACè‡ªåŠ¨æœº</a> $\color[rgb]{0,0.5,1}{\sharp}$<br> Trieä¸ACè‡ªåŠ¨æœºï¼ŒåŒæ—¶åŒ…æ‹¬å¯æŒä¹…åŒ–Trieã€‚</p>
</li>
<li><p><a href="/OI/suffix-array">åç¼€æ•°ç»„</a> $\color[rgb]{0,0.5,1}{\sharp}$<br>å¦‚é¢˜ï¼Œåç¼€æ•°ç»„ã€‚</p>
</li>
<li><p><a href="/OI/suffix-avtomat">åç¼€è‡ªåŠ¨æœº</a> $\color[rgb]{0,0.5,1}{\sharp}$<br>å¦‚é¢˜ï¼Œåç¼€è‡ªåŠ¨æœºã€‚</p>
</li>
</ul>
<h2 id="å›¾è®ºç›¸å…³"><a href="#å›¾è®ºç›¸å…³" class="headerlink" title="å›¾è®ºç›¸å…³"></a>å›¾è®ºç›¸å…³</h2><p>æ˜¯æ—¶å€™æŠŠå›¾è®ºçš„ä¸œè¥¿å•ç‹¬æ‹¿å‡ºæ¥äº†ã€‚</p>
<ul>
<li><p><a href="/OI/flow">ç½‘ç»œæµ</a> $\color[rgb]{0.5,0.4,0.4}{Ï†}$<br>å¦‚é¢˜ï¼Œç½‘ç»œæµç›¸å…³å†…å®¹ã€‚</p>
</li>
<li><p><a href="/OI/bipartie-graph">äºŒåˆ†å›¾</a><br>å¦‚é¢˜ï¼ŒäºŒåˆ†å›¾ç›¸å…³å†…å®¹ã€‚</p>
</li>
</ul>
<h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>é¢˜è§£è¿˜ä¼šæœ‰æ²¡å†™å®Œçš„å—ï¼Ÿ</p>
<ul>
<li><a href="/solutions/solution-p1117">Luogu P1117</a> [NOI2016] ä¼˜ç§€çš„æ‹†åˆ†</li>
<li><a href="/solutions/solution-p1251">Luogu P1251</a> é¤å·¾è®¡åˆ’é—®é¢˜</li>
<li><a href="/solutions/solution-p1486">Luogu P1486</a> [NOI2004] éƒé—·çš„å‡ºçº³å‘˜</li>
<li><a href="/solutions/solution-p1505">Luogu P1505</a> [å›½å®¶é›†è®­é˜Ÿ] æ—…æ¸¸</li>
<li><a href="/solutions/solution-p2042">Luogu P2042</a> [NOI2005] ç»´æŠ¤æ•°åˆ—</li>
<li><a href="/solutions/solution-p2146">Luogu P2146</a> è½¯ä»¶åŒ…ç®¡ç†å™¨</li>
<li><a href="/solutions/solution-p2414">Luogu P2414</a> [NOI2011] é˜¿ç‹¸çš„æ‰“å­—æœº</li>
<li><a href="/solutions/solution-p3586">Luogu P3586</a> [POI2015] Logistyka</li>
</ul>
<ul>
<li><a href="/solutions/solution-l2759">LibreOJ #2759</a> èœœè¢‹é¼¯ï¼ˆãƒ•ã‚¯ãƒ­ãƒ¢ãƒ¢ãƒ³ã‚¬ï¼‰</li>
<li><a href="/solutions/solution-l2980">LibreOJ #2980</a> ã€ŒTHUSCH 2017ã€ å¤§é­”æ³•å¸ˆ</li>
</ul>
<ul>
<li><a href="/solutions/solution-sy549">SEZSY OJ #549</a> å†œå¤«å¥¶ç‰›çš„çº¦ç¿°ä»¬</li>
</ul>
<h2 id="æ¯”èµ›è®°å½•"><a href="#æ¯”èµ›è®°å½•" class="headerlink" title="æ¯”èµ›è®°å½•"></a>æ¯”èµ›è®°å½•</h2><p>æ ¡å†…OJçš„æ¨¡æ‹Ÿèµ›è®°å½•ã€‚</p>
<ul>
<li><a href="/contestrecords/2022-wh-8">2022å¯’å‡æ¨¡æ‹Ÿèµ›8</a> $\color[rgb]{0,0.5,1}{\sharp}$</li>
</ul>
<h1 id="å…¶ä»–å­¦ä¹ ç¬”è®°"><a href="#å…¶ä»–å­¦ä¹ ç¬”è®°" class="headerlink" title="å…¶ä»–å­¦ä¹ ç¬”è®°"></a>å…¶ä»–å­¦ä¹ ç¬”è®°</h1><p>å…¶ä»–ä¸œè¥¿çš„å­¦ä¹ ç¬”è®°ã€‚</p>
<ul>
<li><p><a href="/notes/game-strategy">åšå¼ˆè®ºå­¦ä¹ ç¬”è®°</a> <strong>æ­¢ã¾ã‚Œ</strong><br>å¦‚é¢˜ï¼Œåšå¼ˆè®ºå­¦ä¹ ç¬”è®°ã€‚<br>å’•äº†ã€‚</p>
</li>
<li><p><a href="/notes/linar-algebra">çº¿æ€§ä»£æ•°</a> <strong>æ­¢ã¾ã‚Œ</strong><br>åŒ…å«è¡Œåˆ—å¼å’ŒçŸ©é˜µçš„è¿ç®—ã€‚<br>åŒæ ·å’•äº†ã€‚</p>
</li>
</ul>
<h1 id="åŒ–å­¦"><a href="#åŒ–å­¦" class="headerlink" title="åŒ–å­¦"></a>åŒ–å­¦</h1><h2 id="æœ‰æœºåŒ–å­¦ç›¸å…³"><a href="#æœ‰æœºåŒ–å­¦ç›¸å…³" class="headerlink" title="æœ‰æœºåŒ–å­¦ç›¸å…³"></a>æœ‰æœºåŒ–å­¦ç›¸å…³</h2><ul>
<li><p><a href="/chemistry/lewis-structure">Lewisç»“æ„å¼</a> $\color[rgb]{0,0.5,1}{\sharp}$<br>$Lewis$ ç»“æ„å¼ï¼Œ $Lewis$ ç”µå­ç†è®ºä»¥åŠå½¢å¼ç”µè·ã€‚</p>
</li>
<li><p>tbc<br>tbc</p>
</li>
</ul>
<hr>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMTJrNHkxMTczaQ==">å±•å¼€<i class="fa fa-external-link-alt"></i></span><br>å†è§ã€‚</li>
</ul>
]]></content>
  </entry>
  <entry>
    <title>ğ—¼‡ğ—Ÿ²</title>
    <url>/tangut/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="995629453065148db4d540eadf7f0431fcb0d75738c81b397a63e6540c5d0e2e">0c63164426605f29c68b35118afdec0d67df8dc61bc65797a759a4b7b10fb3ae18f634f88bb78396c2601f8eed1a6d537d25e930636c94352100e4cc657766c52e73910ee5e2e60e9a313b03012101de85c26a999ee857e12bac3f1688ae41a156af7e4000d40f66defb721d7a31761e8ca08db5d47d84e555eb11c16a2038cc54f4073218906f93ba142f4729b03a635e70c2829707aa159e0ca0c9fa84086cc1d19f0052d43fa47b74b644fdc42d4977335d17950120d37339c62a63b634f43ee74e143f2209fb85843713136c6aba44444cd40cac053e30d07b0ebb30edca</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">å†™å‡ºğ—¼‡ğ—Ÿ²äºŒå­—çš„æ‹¼éŸ³</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>æ„Ÿè°¢</title>
    <url>/thanks/</url>
    <content><![CDATA[<p>æ„Ÿè°¢ <strong>CloudySky</strong> å’Œ <strong>å®ç¡•</strong> çš„å¤§åŠ›æ”¯æŒã€‚</p>
<p>æ²¡æœ‰ä»–ä»¬å°±æ²¡æœ‰è¿™ä¸ªåšå®¢ã€‚</p>
<p>ååˆ†æ„Ÿè°¢ã€‚</p>
<p><img src="https://img.shields.io/github/repo-size/kaiserwilheim/kaiserwilheim.github.io?style=for-the-badge" alt="GitHub repo size"></p>
]]></content>
  </entry>
  <entry>
    <title>äºŒåˆ†å›¾</title>
    <url>/OI/bipartite-graph/</url>
    <content><![CDATA[<p>äºŒåˆ†å›¾ç›¸å…³å†…å®¹ã€‚</p>
<span id="more"></span>

<h1 id="ä»€ä¹ˆæ˜¯äºŒåˆ†å›¾"><a href="#ä»€ä¹ˆæ˜¯äºŒåˆ†å›¾" class="headerlink" title="ä»€ä¹ˆæ˜¯äºŒåˆ†å›¾"></a>ä»€ä¹ˆæ˜¯äºŒåˆ†å›¾</h1><p>äºŒåˆ†å›¾æ˜¯ä¸€ç§ç‰¹æ®Šçš„å›¾ã€‚</p>
<p>äºŒåˆ†å›¾çš„ä¸€ä¸ªæ€§è´¨æ˜¯ï¼ŒèŠ‚ç‚¹ç”±ä¸¤ä¸ªé›†åˆç»„æˆï¼Œä¸”ä¸¤ä¸ªé›†åˆçš„å†…éƒ¨æ²¡æœ‰ä»»ä½•ä¸€æ¡è¾¹ã€‚</p>
<p>æ¢è€Œè¨€ä¹‹ï¼Œå°±æ˜¯æˆ‘ä»¬å¯ä»¥å°†äºŒåˆ†å›¾çš„ä¸¤ä¸ªé›†åˆä¸­çš„æ‰€æœ‰èŠ‚ç‚¹åˆ†åˆ«æŸ“æˆä¸¤ç§ä¸åŒçš„é¢œè‰²ï¼ˆæ¯”å¦‚çº¢è‰²ä¸è“è‰²ï¼‰ï¼Œå¯ä»¥å‘ç°ä»»æ„ä¸€æ¡è¾¹éƒ½è¿æ¥ç€ä¸¤ä¸ªä¸åŒé¢œè‰²çš„ç‚¹ã€‚</p>
<p>æˆ‘ä»¬ä¸€èˆ¬å°†äºŒåˆ†å›¾çš„ä¸¤ä¸ªé›†åˆåˆ†åˆ«æ”¾åœ¨æˆ‘ä»¬çš„å·¦è¾¹å’Œå³è¾¹ï¼Œè€Œè¾¹éƒ½æ˜¯æ¨ªå‘çš„ã€‚<del>ï¼ˆå…¶å®ä½ åˆ†åˆ«å«è¿™ä¸¤ä¸ªé›†åˆ<font color="#ff0000">åçº¦</font>å’Œ<font color="0000ff">åŒ—çº¦</font>ä¹Ÿæ²¡äººæŠ—è®®ï¼‰</del></p>
<h2 id="æˆ‘ä»¬å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå›¾æ˜¯äºŒåˆ†å›¾ï¼Ÿ"><a href="#æˆ‘ä»¬å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå›¾æ˜¯äºŒåˆ†å›¾ï¼Ÿ" class="headerlink" title="æˆ‘ä»¬å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå›¾æ˜¯äºŒåˆ†å›¾ï¼Ÿ"></a>æˆ‘ä»¬å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå›¾æ˜¯äºŒåˆ†å›¾ï¼Ÿ</h2><p>æ ¹æ®äºŒåˆ†å›¾çš„å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥æ¨æ–­å‡ºæ¥ä¸€ä¸ªé‡è¦çš„å®šç†ï¼š</p>
<p><strong>äºŒåˆ†å›¾æ²¡æœ‰å¥‡æ•°ç¯ã€‚</strong></p>
<p>å› ä¸ºä¸€ä¸ªäºŒåˆ†å›¾çš„æ‰€æœ‰è¾¹éƒ½æ˜¯æ¨ªè·¨ä¸¤ä¸ªé›†åˆçš„ï¼Œæ¯æ¬¡éœ€è¦æ¨ªè·¨å¶æ•°æ¬¡æ‰èƒ½å›åˆ°èµ·ç‚¹æ‰€åœ¨çš„é›†åˆï¼Œæ•…äºŒåˆ†å›¾æ²¡æœ‰å¥‡æ•°ç¯ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ€§è´¨å¯¹ç»™å®šçš„å›¾è¿›è¡Œæœç´¢ï¼Œå¦‚æœæ‰¾åˆ°äº†å¥‡æ•°ç¯ï¼Œé‚£ä¹ˆè¿™ä¸ªå›¾å°±ä¸€å®šä¸æ˜¯äºŒåˆ†å›¾ï¼Œåä¹‹äº¦ç„¶ã€‚</p>
<hr>
<p>å·²çŸ¥æ‰€æœ‰äºŒåˆ†å›¾ç›¸å…³çš„é—®é¢˜åº”è¯¥éƒ½å¯ä»¥é€šè¿‡è½¬åŒ–æˆä¸ºç½‘ç»œæµé—®é¢˜æ¥æ±‚è§£ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œæˆ‘å°±ä¸å¯¹ä¼ ç»Ÿçš„äºŒåˆ†å›¾ç›¸å…³ç®—æ³•è¿›è¡Œè®²è§£ï¼Œå¦‚åŒˆç‰™åˆ©ç®—æ³•ã€‚</p>
<p>äºŒåˆ†å›¾æœ‰å…³çš„é—®é¢˜è§ä¸‹é¢ï¼š</p>
<h1 id="äºŒåˆ†å›¾æœ€å¤§åŒ¹é…"><a href="#äºŒåˆ†å›¾æœ€å¤§åŒ¹é…" class="headerlink" title="äºŒåˆ†å›¾æœ€å¤§åŒ¹é…"></a>äºŒåˆ†å›¾æœ€å¤§åŒ¹é…</h1><h2 id="å•¥shaæ˜¯æœ€å¤§åŒ¹é…ï¼Ÿ"><a href="#å•¥shaæ˜¯æœ€å¤§åŒ¹é…ï¼Ÿ" class="headerlink" title="å•¥shÃ æ˜¯æœ€å¤§åŒ¹é…ï¼Ÿ"></a><ruby>å•¥<rt>shÃ </rt></ruby>æ˜¯æœ€å¤§åŒ¹é…ï¼Ÿ</h2><p>â€œä»»æ„ä¸¤æ¡è¾¹éƒ½æ²¡æœ‰å…¬å…±ç«¯ç‚¹â€çš„è¾¹çš„é›†åˆè¢«ç§°ä¸ºå›¾çš„ä¸€ç»„åŒ¹é…ã€‚<br>åœ¨äºŒåˆ†å›¾ä¸­ï¼ŒåŒ…å«å˜æ•°æœ€å¤šçš„ä¸€ç»„åŒ¹é…è¢«ç§°ä¸ºäºŒåˆ†å›¾çš„<strong>æœ€å¤§åŒ¹é…</strong>ã€‚</p>
<p>å¯¹äºä»»æ„ä¸€ç»„åŒ¹é… $E$ ï¼Œå±äº $E$ çš„è¾¹è¢«ç§°ä¸º<strong>åŒ¹é…è¾¹</strong>ï¼Œä¸å±äº $E$ çš„è¾¹è¢«ç§°ä¸º<strong>éåŒ¹é…è¾¹</strong>ã€‚åŒ¹é…è¾¹çš„ç«¯ç‚¹è¢«ç§°ä¸º<strong>åŒ¹é…ç‚¹</strong>ï¼Œå…¶ä»–åº—è¢«ç§°ä¸º<strong>éåŒ¹é…ç‚¹</strong>ã€‚</p>
<h2 id="å¢å¹¿è·¯"><a href="#å¢å¹¿è·¯" class="headerlink" title="å¢å¹¿è·¯"></a>å¢å¹¿è·¯</h2><p>å¦‚æœåœ¨äºŒåˆ†å›¾ä¸­å­˜åœ¨ä¸€æ¡è¿æ¥ä¸¤ä¸ªéåŒ¹é…ç‚¹çš„è·¯å¾„ $path$ï¼Œä½¿å¾—éåŒ¹é…è¾¹ä¸åŒ¹é…è¾¹åœ¨ $path$ ä¸Šäº¤æ›¿å‡ºç°ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç§° $path$ æ˜¯ åŒ¹é… $E$ çš„ä¸€æ¡<strong>å¢å¹¿è·¯</strong>ï¼Œä¹Ÿç§°äº¤é”™è·¯ã€‚</p>
<p>å¢å¹¿è·¯å…·æœ‰ä»¥ä¸‹æ€§è´¨ï¼š</p>
<ol>
<li>é•¿åº¦ä¸ºå¥‡æ•°ã€‚</li>
<li>è·¯å¾„ä¸Šç¬¬å¥‡æ•°æ¡è¾¹æ˜¯éåŒ¹é…è¾¹ï¼Œç¬¬å¶æ•°æ¡è¾¹æ˜¯åŒ¹é…è¾¹ã€‚</li>
</ol>
<p>åˆ©ç”¨ä»¥ä¸Šæ€§è´¨ï¼Œæˆ‘ä»¬å°è¯•å°†è·¯å¾„ä¸Šæ‰€æœ‰è¾¹çš„çŠ¶æ€å–åï¼Œä¹Ÿå°±æ˜¯åŸæ¥çš„åŒ¹é…è¾¹å˜æˆäº†éåŒ¹é…è¾¹ï¼ŒåŸæ¥çš„éåŒ¹é…è¾¹å˜æˆäº†åŒ¹é…è¾¹ã€‚<br>ç»è¿‡äº†è¿™æ ·çš„ä¸€ä¸ªæ“ä½œï¼Œæˆ‘ä»¬æ–°å¾—åˆ°çš„è¾¹é›† $Eâ€™$ ä»ç„¶æ˜¯ä¸€ç»„åŒ¹é…ï¼Œä¸”åŒ¹é…è¾¹çš„æ•°é‡å¢åŠ äº†1ã€‚</p>
<p>åˆ©ç”¨è¿™æ ·çš„ä¸€ä¸ªæ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªæ¨è®ºï¼š</p>
<p><strong>äºŒåˆ†å›¾çš„ä¸€ç»„åŒ¹é… $E$ æ˜¯æœ€å¤§åŒ¹é…ï¼Œå½“ä¸”ä»…å½“å›¾ä¸­ä¸å­˜åœ¨ $E$ çš„å¢å¹¿è·¯ã€‚</strong></p>
<p><em>æ³¨æ„</em>ï¼šè¿™é‡Œçš„å¢å¹¿è·¯ä¸ç½‘ç»œæµä¸­çš„å¢å¹¿è·¯æ¦‚å¿µä¸åŒã€‚</p>
<h2 id="æ±‚è§£"><a href="#æ±‚è§£" class="headerlink" title="æ±‚è§£"></a>æ±‚è§£</h2><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŒˆç‰™åˆ©ç®—æ³•ï¼Œä¸€ç§åˆ©ç”¨å¢å¹¿è·¯æ¥æ±‚è§£çš„ç®—æ³•ã€‚å…¶æ—¶é—´å¤æ‚åº¦ä¸º $O(nm)$ ã€‚</p>
<p>ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Dinicæ¥æ±‚è§£ã€‚Dinicæ¯”åŒˆç‰™åˆ©ç®—æ³•è¦å¿«ï¼ˆæ—¶é—´å¤æ‚åº¦ä¸º $O(m\sqrt{n})$ï¼‰ï¼Œè€Œä¸”é€‚ç”¨èŒƒå›´è¾ƒåŒˆç‰™åˆ©ç®—æ³•æ›´å¹¿ã€‚</p>
<p>å¯¹äºè¿™æ ·çš„ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬åªéœ€è¦å°†æ‰€æœ‰å·¦è¾¹çš„ç‚¹<del><font color="$ff0000">åçº¦æˆå‘˜å›½</font></del>ä¸æºç‚¹<del><font color="#ff0000">è‹è”</font></del>è¿ä¸€æ¡å®¹é‡ä¸º1çš„è¾¹ï¼Œå†å°†æ‰€æœ‰å³è¾¹çš„ç‚¹<del><font color="#0000ff">åŒ—çº¦æˆå‘˜å›½</font></del>ä¸æ±‡ç‚¹<del><font color="#0000ff">ç¾å›½</font></del>è¿ä¸€æ¡å®¹é‡ä¸º1çš„è¾¹ã€‚æœ€åï¼ŒæŠŠæ‰€æœ‰çš„åŸå›¾ä¸­çš„è¾¹å˜ä¸ºä¸€æ¡å®¹é‡ä¸º1çš„è¾¹ã€‚</p>
<p>è¿™å¼ å›¾çš„æœ€å¤§æµå°±æ˜¯åŸå›¾çš„æœ€å¤§åŒ¹é…æ•°ã€‚</p>
<p>ä»¥<span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL3Byb2JsZW0vUDMzODY=">Luogu P3386 ã€æ¨¡æ¿ã€‘äºŒåˆ†å›¾æœ€å¤§åŒ¹é…<i class="fa fa-external-link-alt"></i></span>ä¸ºä¾‹ã€‚<br>ä¸‹é¢æ˜¯ç¤ºä¾‹ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">10010</span>, M = <span class="number">200010</span>, INF = <span class="number">1e8</span>;</span><br><span class="line"><span class="type">int</span> n, m, S, T;</span><br><span class="line"><span class="type">int</span> h[N], e[M], f[M], ne[M], idx;</span><br><span class="line"><span class="type">int</span> q[N], d[N], cur[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[idx] = b, f[idx] = c, ne[idx] = h[a], h[a] = idx++;</span><br><span class="line">    e[idx] = a, f[idx] = <span class="number">0</span>, ne[idx] = h[b], h[b] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">bfs</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> hh = <span class="number">0</span>, tt = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(d, <span class="number">-1</span>, <span class="built_in">sizeof</span>(d));</span><br><span class="line">    q[<span class="number">0</span>] = S, d[S] = <span class="number">0</span>, cur[S] = h[S];</span><br><span class="line">    <span class="keyword">while</span>(hh &lt;= tt)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> t = q[hh++];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = h[t]; ~i; i = ne[i])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> ver = e[i];</span><br><span class="line">            <span class="keyword">if</span>(d[ver] == <span class="number">-1</span> &amp;&amp; f[i])</span><br><span class="line">            &#123;</span><br><span class="line">                d[ver] = d[t] + <span class="number">1</span>;</span><br><span class="line">                cur[ver] = h[ver];</span><br><span class="line">                <span class="keyword">if</span>(ver == T)  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                q[++tt] = ver;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> limit)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(u == T) <span class="keyword">return</span> limit;</span><br><span class="line">    <span class="type">int</span> flow = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = cur[u]; ~i &amp;&amp; flow &lt; limit; i = ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        cur[u] = i;</span><br><span class="line">        <span class="type">int</span> ver = e[i];</span><br><span class="line">        <span class="keyword">if</span>(d[ver] == d[u] + <span class="number">1</span> &amp;&amp; f[i])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> t = <span class="built_in">find</span>(ver, <span class="built_in">min</span>(f[i], limit - flow));</span><br><span class="line">            <span class="keyword">if</span>(!t) d[ver] = <span class="number">-1</span>;</span><br><span class="line">            f[i] -= t, f[i ^ <span class="number">1</span>] += t, flow += t;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> flow;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dinic</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> r = <span class="number">0</span>, flow;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">bfs</span>()) <span class="keyword">while</span>(flow = <span class="built_in">find</span>(S, INF)) r += flow;</span><br><span class="line">    <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="built_in">memset</span>(h, <span class="number">-1</span>, <span class="built_in">sizeof</span>(h));</span><br><span class="line">    S = <span class="number">0</span>, T = n + m + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)<span class="built_in">add</span>(S, i, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)<span class="built_in">add</span>(i + n, T, <span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> nums;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;nums);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= nums; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> a, b;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);</span><br><span class="line">        <span class="built_in">add</span>(a, b + n, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">dinic</span>());</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ä¸äºŒåˆ†å›¾æœ€å¤§åŒ¹é…ç›¸å…³çš„æ¦‚å¿µ"><a href="#ä¸äºŒåˆ†å›¾æœ€å¤§åŒ¹é…ç›¸å…³çš„æ¦‚å¿µ" class="headerlink" title="ä¸äºŒåˆ†å›¾æœ€å¤§åŒ¹é…ç›¸å…³çš„æ¦‚å¿µ"></a>ä¸äºŒåˆ†å›¾æœ€å¤§åŒ¹é…ç›¸å…³çš„æ¦‚å¿µ</h2><h3 id="äºŒåˆ†å›¾æœ€å¤§ç‹¬ç«‹é›†"><a href="#äºŒåˆ†å›¾æœ€å¤§ç‹¬ç«‹é›†" class="headerlink" title="äºŒåˆ†å›¾æœ€å¤§ç‹¬ç«‹é›†"></a>äºŒåˆ†å›¾æœ€å¤§ç‹¬ç«‹é›†</h3><p>ä»å›¾ä¸­é€‰æ‹©æœ€å¤šçš„ç‚¹ï¼Œæ»¡è¶³ä¸¤ä¸¤ä¹‹é—´æ²¡æœ‰è¾¹ç›¸è¿ã€‚</p>
<p>åœ¨äºŒåˆ†å›¾ä¸­ï¼Œè¿™ä¸ªå°±æ˜¯å»æ‰æœ€å¤§åŒ¹é…åçš„å‰©ä½™éƒ¨åˆ†ã€‚</p>
<h3 id="äºŒåˆ†å›¾æœ€å°ç‚¹è¦†ç›–"><a href="#äºŒåˆ†å›¾æœ€å°ç‚¹è¦†ç›–" class="headerlink" title="äºŒåˆ†å›¾æœ€å°ç‚¹è¦†ç›–"></a>äºŒåˆ†å›¾æœ€å°ç‚¹è¦†ç›–</h3><p>ä»å›¾ä¸­é€‰æ‹©æœ€å°‘çš„ç‚¹ï¼Œæ»¡è¶³æ¯æ¡è¾¹è‡³å°‘æœ‰ä¸€ä¸ªç«¯ç‚¹è¢«é€‰ä¸Šã€‚</p>
<p>æˆ‘ä»¬ä¸éš¾å‘ç°ï¼Œç‚¹è¦†ç›–çš„è¡¥é›†å…¶å®æ˜¯ç‹¬ç«‹é›†ã€‚</p>
<p>åœ¨äºŒåˆ†å›¾ä¸­ï¼Œæœ€å°ç‚¹è¦†ç›–å°±æ˜¯å»æ‰æœ€å¤§ç‹¬ç«‹é›†åçš„å‰©ä½™éƒ¨åˆ†ï¼Œä¸æœ€å¤§åŒ¹é…é‡åˆã€‚</p>
<h1 id="äºŒåˆ†å›¾æœ€å¤§æƒåŒ¹é…"><a href="#äºŒåˆ†å›¾æœ€å¤§æƒåŒ¹é…" class="headerlink" title="äºŒåˆ†å›¾æœ€å¤§æƒåŒ¹é…"></a>äºŒåˆ†å›¾æœ€å¤§æƒåŒ¹é…</h1><p>å¦‚æœæˆ‘ä»¬ç»™äºŒåˆ†å›¾ä¸Šçš„è¾¹åŠ ä¸Šè¾¹æƒçš„è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ±‚è¾¹æƒå’Œæœ€å¤§çš„åŒ¹é…äº†ã€‚</p>
<h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><p>æˆ‘ä»¬å¯ä»¥å°†å…¶è½¬æ¢ä¸ºè´¹ç”¨æµæ¨¡å‹ï¼Œå°†å…¶æŒ‰ç…§æœ€å¤§åŒ¹é…çš„å»ºå›¾æ–¹å¼å»ºå›¾ï¼Œå¹¶ç»™å…¶ä¸­è·¨é›†åˆçš„è¾¹åŠ ä¸Šä¸€ä¸ªè´¹ç”¨ï¼Œæ±‚è¿™ä¸ªå›¾çš„æœ€å¤§è´¹ç”¨æœ€å¤§æµã€‚</p>
]]></content>
      <categories>
        <category>å›¾è®º</category>
      </categories>
      <tags>
        <tag>å›¾è®º</tag>
      </tags>
  </entry>
  <entry>
    <title>å·®åˆ†çº¦æŸ</title>
    <url>/OI/difference-constraint/</url>
    <content><![CDATA[<p>å·®åˆ†çº¦æŸç³»ç»Ÿã€‚</p>
<span id="more"></span>

<p>æˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°ä¸€äº›é—®é¢˜ï¼Œå°±æ˜¯ç»™å‡ºä¸€å †æœªçŸ¥é‡ï¼Œå†ç»™å‡ºä¸€å †ç±»ä¼¼â€œæŸä¸€ä¸ªæœªçŸ¥é‡æ¯”å¦ä¸€ä¸ªæœªçŸ¥é‡æœ€å¤šï¼ˆæœ€å°‘ï¼‰å¤§ï¼ˆå°ï¼‰å¤šå°‘â€çš„é—®é¢˜ï¼Œè®©æˆ‘ä»¬ä»è¿™ä¸€å›¢ç¹æ‚çš„æ¯›é’±ä¸­æ‹å‡ºä¸€æ ¹çº¿å¤´æ¥ï¼Œä»¥æ±‚å¾—è¿™ä¸ªæ¯›çº¿å›¢çš„ä¸€ç»„å¯è¡Œè§£ã€‚</p>
<p>æ¯”å¦‚è¯´ä¸‹é¢è¿™ä¸ªä¸œè¥¿ï¼š</p>
<p>$$<br>\begin{cases}<br>x_1 \geq x_2 - 10 \\<br>x_1 \leq x_3 - 20 \\<br>x_3 \leq x_2 + 10 \\<br>x_4 \leq x_3 - 10 \\<br>x_2 \leq x_4 - 10<br>\end{cases}<br>$$</p>
<p>æˆ‘ä»¬å°±åŸºæœ¬ä¸Šæ— ä»ä¸‹æ‰‹ã€‚</p>
<p>è¿™æ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦å¼•å…¥ä¸€ä¸ªæ–°çš„ç®—æ³•â€”â€”<strong>å·®åˆ†çº¦æŸ</strong>ã€‚</p>
<p>å·®åˆ†çº¦æŸé€šè¿‡å°†ä¸ç­‰å¼çš„é—®é¢˜è½¬åŒ–ä¸ºæœ€çŸ­è·¯ï¼ˆæˆ–æœ€é•¿è·¯ï¼‰é—®é¢˜æ¥æ±‚è§£ã€‚</p>
<h1 id="æœ€çŸ­è·¯ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ"><a href="#æœ€çŸ­è·¯ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ" class="headerlink" title="æœ€çŸ­è·¯ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ"></a>æœ€çŸ­è·¯ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</h1><p>å›å¿†æˆ‘ä»¬å­¦ä¹ æœ€çŸ­è·¯çš„æ—¶å€™å­¦åˆ°çš„çŸ¥è¯†ã€‚</p>
<p>å‡è®¾å¯¹äºä¸¤ä¸ªç‚¹ $a$ å’Œ $b$ï¼Œå¦‚æœå…¶é—´æœ‰ä¸€æ¡è¾¹é•¿ä¸º $w$ çš„æœ‰å‘è¾¹ $a \to b$ï¼Œé‚£ä¹ˆå®ƒä»¬çš„ $dis$ ä¸€å®šæ»¡è¶³ $dis[b] \leq dis[b] + w$ã€‚</p>
<p>æˆ‘ä»¬å¦‚æœå°†æ¯ä¸€ä¸ªæœªçŸ¥é‡ $x_k$ ä¸æ¯ä¸€ä¸ªç‚¹çš„ $dis[i]$ è”ç³»èµ·æ¥çš„è¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°å½¢å¦‚ $x_b \leq x_a + w$ çš„ä¸€å †ä¸ç­‰å¼ã€‚</p>
<p>è€Œæˆ‘ä»¬åˆšå¥½éœ€è¦è¿™äº›ä¸ç­‰å¼ã€‚</p>
<p>äºæ˜¯æˆ‘ä»¬å°±å¯ä»¥å°†æˆ‘ä»¬æ‰‹ä¸­çš„ä¸ç­‰å¼ç»„è½¬åŒ–ä¸ºä¸€å †è¾¹ï¼Œå¹¶å°†å…¶æ”¾åˆ°å›¾é‡Œé¢ï¼Œå»ºæˆä¸€ä¸ªæœ‰å‘å›¾ã€‚</p>
<p>æœ€åå¾—å‡ºçš„æ¯ä¸€ç»„åˆæ³•çš„æœ€çŸ­è·ç¦»ï¼Œéƒ½å¯¹åº”äº†ä¸€ç»„ä¸ç­‰å¼ç»„çš„è§£ã€‚</p>
<p>æˆ‘ä»¬é¦–å…ˆæŠŠæ‰€æœ‰çš„å¼å­è½¬åŒ–ä¸º $x_u \leq x_v + w$ çš„å½¢å¼ï¼Œå†ä»æ¯ä¸€ä¸ª $v$ å‘ $u$ å»ºä¸€æ¡è¾¹æƒä¸º $w$ çš„æœ‰å‘è¾¹ã€‚</p>
<p>è¿™ä¸ªæœ‰å‘å›¾å¯ä»¥æœ‰ç¯ï¼Œæ¯•ç«Ÿç¯æ˜¯ä¸å½±å“æˆ‘ä»¬çš„æ±‚å€¼ç¯èŠ‚çš„ã€‚<br>ä½†æ˜¯å®ƒä¸èƒ½æœ‰è´Ÿç¯ã€‚</p>
<p>æ¯”å¦‚è¯´ä¸‹é¢è¿™ä¸€ç»„è¾¹ï¼š</p>
<p>$$<br>\begin{cases}<br>x_2 \leq x_1 + 10 \\<br>x_3 \leq x_2 + 10 \\<br>x_1 \leq x_3 - 30<br>\end{cases}<br>$$</p>
<p>å»ºåˆ°å›¾ä¸Šå°±æ˜¯è¿™ä¸ªæ ·å­ï¼š</p>
<p><img src="https://s2.loli.net/2022/03/30/d9ltROoBAY178Uy.png" alt="diffcon1.png"></p>
<p>æ ¹æ®åŸå§‹çš„ä¸ç­‰å¼ç»„ï¼Œæœ€ç»ˆæˆ‘ä»¬ä¼šå¾—åˆ° $x_1 \leq x_1 - 10$ è¿™æ ·ä¸€ä¸ªå¥‡æ€ªçš„å¼å­ï¼Œä»è€Œå¯¼è‡´ä¸ç­‰å¼ç»„æ— è§£ã€‚</p>
<p>ä»å›¾ä¸Šçœ‹ï¼Œè¿™ä¸‰æ¡è¾¹æ„æˆäº†ä¸€ä¸ªè´Ÿç¯ã€‚</p>
<p>æ‰€ä»¥è¯´ï¼Œä¸€ä¸ªè´Ÿç¯æœ€ç»ˆä¼šå¯¼è‡´å‡ºç°ä¸€äº›å¥‡æ€ªçš„ä¸ç­‰å¼ï¼Œæœ€ç»ˆå¯¼è‡´ä¸ç­‰å¼ç»„æ— è§£ã€‚<br>ï¼ˆå½“ç„¶ï¼Œå¦‚æœä½¿ç”¨çš„æ˜¯æœ€é•¿è·¯çš„è¯å°±æ˜¯æ­£ç¯ï¼‰</p>
<p>é‚£æˆ‘ä»¬æ€ä¹ˆåˆ¤è´Ÿç¯ï¼Ÿï¼ˆæˆ–è€…è¯´æ­£ç¯ï¼‰</p>
<p>SPFAï¼<br>ï¼ˆSPFAä¿¡å¾’ç‹‚å–œï¼‰</p>
<h1 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h1><p>ä½†æ˜¯æˆ‘ä»¬å…‰é è¿™äº›è¾¹å®é™…ä¸Šæ˜¯ä¸èƒ½å¾—å‡ºæœ€ç»ˆè§£çš„ã€‚<br>å¾ˆå¤šæƒ…å†µä¸‹ï¼Œè¿™å¼ å›¾æ ¹æœ¬ä¸è”é€šã€‚<br>ä½†æ˜¯è¿™æ ·çš„å›¾è¿˜æ˜¯å¯ä»¥æ‰¾åˆ°è‡³å°‘ä¸€ç»„å¯è¡Œè§£çš„ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦å»ºä¸€ä¸ªè¶…çº§æºç‚¹ï¼Œå‘æ¯ä¸€ä¸ªç‚¹è¿ä¸€æ¡é•¿åº¦ä¸º0çš„è¾¹ã€‚</p>
<h1 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h1><p>å…·ä½“æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸ä»…æœ‰ç±»ä¼¼ $x_a \leq x_b + w$ è¿™æ ·çš„å¼å­ï¼Œè¿˜æœ‰å…¶ä»–çš„ä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„çº¦æŸæ¡ä»¶ã€‚</p>
<p>ä¸‹é¢åˆ—å‡ºäº†ä¸€äº›å¸¸è§çš„çº¦æŸæ¡ä»¶å’Œè§£å†³åŠæ³•ï¼š</p>
<table>
<thead>
<tr>
<th>çº¦æŸæ¡ä»¶</th>
<th>è§£å†³åŠæ³•</th>
</tr>
</thead>
<tbody><tr>
<td>$x_a \leq w$</td>
<td>å°†æºç‚¹åˆ° $a$ çš„è¾¹æƒä»0æ”¹åˆ° $w$ã€‚</td>
</tr>
<tr>
<td>$x_a \geq w$</td>
<td>ä» $a$ å‘æºç‚¹è¿ä¸€æ¡é•¿ä¸º $-w$ çš„è¾¹ã€‚</td>
</tr>
<tr>
<td>$x_a &#x3D; x_b + w$</td>
<td>å°†å…¶æ‹†åˆ†ä¸º $x_a \leq x_b + w$ å’Œ $x_b \leq x_a + (-w)$ã€‚</td>
</tr>
<tr>
<td>$x_a + x_b \leq w$</td>
<td>å·®åˆ†çº¦æŸä¼šå¯„ã€‚è¯·æ³¨æ„ä¸€ä¸‹é¢˜ç›®ä¸­æœ‰æ²¡æœ‰å¯ä»¥åˆ©ç”¨çš„å…¶ä»–ç‰¹æ®Šæ€§è´¨ã€‚</td>
</tr>
</tbody></table>
<p>å¦‚æœåœ¨ä¸€ä¸ªä¸ç­‰å¼ç»„çš„çº¦æŸä¸‹ï¼ˆä¸ç­‰å¼ç»„æœ‰è§£ï¼‰ï¼Œæƒ³æ±‚å‡º $x_i âˆ’ x_j$ çš„æœ€å¤§å€¼å‘¢ï¼Ÿ<br>é¦–å…ˆä¸€å®šæœ‰ $x_i âˆ’ x_j \leq j$ åˆ° $i$ çš„â€æœ€çŸ­â€ è·¯ $\operatorname{dis}(j,i)$ ã€‚å› ä¸ºæˆ‘å¯ä»¥å…ˆèµ°åˆ° $j$ ï¼Œç„¶åèµ°â€œ$j$ åˆ° $i$ çš„â€æœ€çŸ­è·¯â€â€åˆ° $i$ ã€‚<br>ç„¶åæˆ‘ä»¬è¯æ˜ $x_i âˆ’ x_j$ å¯ä»¥å–åˆ°è¿™ä¸ªå€¼ã€‚<br>è¿™ç›¸å½“äºå¾€ä¸ç­‰å¼ç»„ä¸­æ·»åŠ ä¸€ä¸ª $x_i âˆ’ x_j \geq \operatorname{dis}(j,i)$ ï¼Œå¦‚æœä¸ç­‰å¼ç»„ä»æœ‰è§£ï¼Œ$x_i âˆ’ x_j$ å°±èƒ½å–åˆ° $\operatorname{dis}(j,i)$ ã€‚<br>è¿™ä¹Ÿç›¸å½“äºåœ¨å›¾ä¸­æ·»åŠ ä¸€æ¡è¾¹ï¼Œä» $i$ åˆ° $j$ ï¼Œè¾¹æƒæ˜¯ $âˆ’\operatorname{dis}(j,i)$ ã€‚è¿™æ ·åŠ è¾¹ä¸€å®šä¸ä¼šå‡ºç°è´Ÿç¯ï¼Œå› ä¸º $\operatorname{dis}(j,i)$ æ˜¯ $j$ åˆ° $i$ çš„æœ€çŸ­è·¯ï¼Œè¦æœ‰è´Ÿç¯çš„è¯å°±æœ‰åˆ«çš„è·¯å¾„é•¿åº¦ $&lt; \operatorname{dis}(j,i)$ äº†ã€‚<br>å¦‚æœè¦æ±‚ $x_i âˆ’ x_j$ çš„æœ€å°å€¼ï¼Œå°±æ˜¯æ±‚ $x_j âˆ’ x_i$ çš„æœ€å¤§å€¼çš„ç›¸åæ•°ï¼Œå³ $âˆ’\operatorname{dis}(i,j)$ã€‚<br>â€œ$x_i âˆ’ x_j$ çš„æœ€å°å€¼â€$\leq$â€œ$x_i âˆ’ x_j$ çš„æœ€å¤§å€¼â€ï¼Œå¯¹åº”äº† $âˆ’\operatorname{dis}(i,j) \leq \operatorname{dis}(j,i)$ ï¼Œä¹Ÿå°±æ˜¯ $\operatorname{dis}(i,j) + \operatorname{dis}(j,i) \geq 0$ ï¼Œä¹Ÿå°±å¯¹åº”äº†å›¾ä¸­æ²¡æœ‰åŒ…å« $i,j$ çš„è´Ÿç¯ã€‚</p>
<h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h1><p>æ´›è°·<span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL3Byb2JsZW0vUDU5NjA=">æ¿å­é¢˜<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">5010</span>, M = <span class="number">10010</span>;</span><br><span class="line"><span class="type">int</span> e[M], ne[M], w[M], h[N], idx;</span><br><span class="line"><span class="type">int</span> tot[N], dis[N], vis[N];</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[++idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">spfa</span><span class="params">(<span class="type">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    <span class="built_in">memset</span>(dis, <span class="number">63</span>, <span class="built_in">sizeof</span>(dis));</span><br><span class="line">    dis[s] = <span class="number">0</span>, vis[s] = <span class="number">1</span>;</span><br><span class="line">    q.<span class="built_in">push</span>(s);</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> u = q.<span class="built_in">front</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        vis[u] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = h[u]; i; i = ne[i])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> v = e[i];</span><br><span class="line">            <span class="keyword">if</span>(dis[v] &gt; dis[u] + w[i])</span><br><span class="line">            &#123;</span><br><span class="line">                dis[v] = dis[u] + w[i];</span><br><span class="line">                <span class="keyword">if</span>(!vis[v])</span><br><span class="line">                &#123;</span><br><span class="line">                    vis[v] = <span class="number">1</span>, tot[v]++;</span><br><span class="line">                    <span class="keyword">if</span>(tot[v] == n + <span class="number">1</span>)<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                    q.<span class="built_in">push</span>(v);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="built_in">add</span>(<span class="number">0</span>, i, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> v, u, w;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;v, &amp;u, &amp;w);</span><br><span class="line">        <span class="built_in">add</span>(u, v, w);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">spfa</span>(<span class="number">0</span>))<span class="built_in">puts</span>(<span class="string">&quot;NO&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, dis[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>$\color[rgb]{1,1,0.0625}{Ï†}$ </p>
<h1 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h1><h2 id="Luogu-P1993-å°-K-çš„å†œåœº"><a href="#Luogu-P1993-å°-K-çš„å†œåœº" class="headerlink" title="Luogu P1993 å° K çš„å†œåœº"></a>Luogu P1993 å° K çš„å†œåœº</h2><p>é¢˜ç›®é“¾æ¥ï¼š<span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL3Byb2JsZW0vUDE5OTM=">https://www.luogu.com.cn/problem/P1993<i class="fa fa-external-link-alt"></i></span></p>
<p>æ¥è¿‘æ¿å­é¢˜ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æˆ‘ä»¬åˆšåˆšå­¦åˆ°çš„æŠ€å·§æ¥å®Œæˆè¿™é“é¢˜ç›®ã€‚</p>
<details class="note default"><summary><p>å‚è€ƒä»£ç </p>
</summary>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">5010</span>, M = <span class="number">20010</span>;</span><br><span class="line"><span class="type">int</span> e[M], ne[M], w[M], h[N], idx;</span><br><span class="line"><span class="type">int</span> tot[N], dis[N], vis[N];</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[++idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">spfa</span><span class="params">(<span class="type">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    <span class="built_in">memset</span>(dis, <span class="number">63</span>, <span class="built_in">sizeof</span>(dis));</span><br><span class="line">    dis[s] = <span class="number">0</span>, vis[s] = <span class="number">1</span>;</span><br><span class="line">    q.<span class="built_in">push</span>(s);</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> u = q.<span class="built_in">front</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        vis[u] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = h[u]; i; i = ne[i])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> v = e[i];</span><br><span class="line">            <span class="keyword">if</span>(dis[v] &gt; dis[u] + w[i])</span><br><span class="line">            &#123;</span><br><span class="line">                dis[v] = dis[u] + w[i];</span><br><span class="line">                <span class="keyword">if</span>(!vis[v])</span><br><span class="line">                &#123;</span><br><span class="line">                    vis[v] = <span class="number">1</span>, tot[v]++;</span><br><span class="line">                    <span class="keyword">if</span>(tot[v] == n + <span class="number">1</span>)<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                    q.<span class="built_in">push</span>(v);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="built_in">add</span>(<span class="number">0</span>, i, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> op, v, u, w;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;op, &amp;v, &amp;u);</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;w);</span><br><span class="line">            <span class="built_in">add</span>(v, u, -w);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;w);</span><br><span class="line">            <span class="built_in">add</span>(u, v, w);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">3</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">add</span>(u, v, <span class="number">0</span>);</span><br><span class="line">            <span class="built_in">add</span>(v, u, <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;Youwike AK IOI!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">spfa</span>(<span class="number">0</span>))<span class="built_in">puts</span>(<span class="string">&quot;No&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">&quot;Yes&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</details>

<h2 id="Luogu-P6145-USACO20FEB-Timeline-G"><a href="#Luogu-P6145-USACO20FEB-Timeline-G" class="headerlink" title="Luogu P6145 [USACO20FEB] Timeline G"></a>Luogu P6145 [USACO20FEB] Timeline G</h2><p>é¢˜ç›®é“¾æ¥ï¼š<span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL3Byb2JsZW0vUDYxNDU=">https://www.luogu.com.cn/problem/P6145<i class="fa fa-external-link-alt"></i></span></p>
<p>ç”±äºä¿è¯æœ‰è§£ï¼Œè€Œä¸”æˆ‘ä»¬å¾—åˆ°çš„çº¦æŸæ¡ä»¶åˆéƒ½å½¢å¦‚â€œç¬¬ $b$ æ¬¡æŒ¤å¥¶åœ¨ç¬¬ $a$ æ¬¡æŒ¤å¥¶ç»“æŸè‡³å°‘ $x$ å¤©åè¿›è¡Œâ€ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—åˆ°çš„éƒ½æ˜¯è´Ÿæƒè¾¹ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥è¿›è¡Œ dpï¼Œä¹Ÿå¯ä»¥è·‘æœ€çŸ­è·¯ã€‚</p>
<details class="note default"><summary><p>å‚è€ƒä»£ç </p>
</summary>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">100010</span>, M = <span class="number">400010</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">int</span> e[M], ne[M], w[M], h[N], idx;</span><br><span class="line"><span class="type">int</span> tot[N], dis[N], vis[N];</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[++idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">spfa</span><span class="params">(<span class="type">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)dis[i] = -INF;</span><br><span class="line">    dis[s] = <span class="number">0</span>, vis[s] = <span class="number">1</span>;</span><br><span class="line">    q.<span class="built_in">push</span>(s);</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> u = q.<span class="built_in">front</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        vis[u] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = h[u]; ~i; i = ne[i])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> v = e[i];</span><br><span class="line">            <span class="keyword">if</span>(dis[v] &lt; dis[u] + w[i])</span><br><span class="line">            &#123;</span><br><span class="line">                dis[v] = dis[u] + w[i];</span><br><span class="line">                <span class="keyword">if</span>(!vis[v])</span><br><span class="line">                &#123;</span><br><span class="line">                    vis[v] = <span class="number">1</span>, tot[v]++;</span><br><span class="line">                    <span class="keyword">if</span>(tot[v] == n + <span class="number">1</span>)<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                    q.<span class="built_in">push</span>(v);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(h, <span class="number">-1</span>, <span class="built_in">sizeof</span>(h));</span><br><span class="line">    <span class="type">int</span> c;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;c);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> s;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;s);</span><br><span class="line">        <span class="built_in">add</span>(<span class="number">0</span>, i, s);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= c; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> u, v, w;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;u, &amp;v, &amp;w);</span><br><span class="line">        <span class="built_in">add</span>(u, v, w);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">spfa</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, dis[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</details>

<h2 id="Luogu-P3275-SCOI2011-ç³–æœ"><a href="#Luogu-P3275-SCOI2011-ç³–æœ" class="headerlink" title="Luogu P3275 [SCOI2011] ç³–æœ"></a>Luogu P3275 [SCOI2011] ç³–æœ</h2><p>é¢˜ç›®é“¾æ¥ï¼š<span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL3Byb2JsZW0vUDMyNzU=">https://www.luogu.com.cn/problem/P3275<i class="fa fa-external-link-alt"></i></span></p>
<p>æˆ‘ä»¬é‡åˆ°äº†æ–°çš„çº¦æŸæ¡ä»¶ï¼šä¸å¸¦å–ç­‰çš„ä¸ç­‰å¼ã€‚</p>
<p>æˆ‘ä»¬çœ‹ä¸€ä¸‹é¢˜ç›®çš„æ¡ä»¶ï¼š<strong>åˆ†ç³–æœ</strong>ã€‚</p>
<p>ç”±äºç³–æœæ˜¯ä¸€å—ä¸€å—çš„ï¼Œæˆ‘ä»¬ä¸èƒ½åˆ†ç»™å°æœ‹å‹ä»¬åŠå—ç³–æœæˆ– $\lim_{m \to 0}$ å—ç³–æœï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°è¯•ç€æ›´æ”¹ä¸€ä¸‹çº¦æŸæ¡ä»¶ã€‚<br>æˆ‘ä»¬å¯ä»¥å°† $x_a &gt; x_b$ æ”¹ä¸º $x_a \geq x_b + 1$ã€‚</p>
<p>è¿™æ ·å°±å¯ä»¥å»ºå›¾äº†ã€‚</p>
<details class="note default"><summary><p>å‚è€ƒä»£ç </p>
</summary>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">3000050</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">int</span> n, k;</span><br><span class="line"><span class="type">int</span> h[N], e[N], ne[N], w[N], idx;</span><br><span class="line"><span class="type">int</span> dis[N], tot[N];</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[++idx] = b;</span><br><span class="line">    ne[idx] = h[a];</span><br><span class="line">    h[a] = idx;</span><br><span class="line">    w[idx] = c;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">spfa</span><span class="params">(<span class="type">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)dis[i] = -INF;</span><br><span class="line">    dis[s] = <span class="number">0</span>, vis[s] = <span class="number">1</span>;</span><br><span class="line">    q.<span class="built_in">push</span>(s);</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> u = q.<span class="built_in">front</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        vis[u] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = h[u]; ~i; i = ne[i])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> v = e[i];</span><br><span class="line">            <span class="keyword">if</span>(dis[v] &lt; dis[u] + w[i])</span><br><span class="line">            &#123;</span><br><span class="line">                dis[v] = dis[u] + w[i];</span><br><span class="line">                <span class="keyword">if</span>(!vis[v])</span><br><span class="line">                &#123;</span><br><span class="line">                    vis[v] = <span class="number">1</span>, tot[v]++;</span><br><span class="line">                    <span class="keyword">if</span>(tot[v] == n + <span class="number">1</span>)<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                    q.<span class="built_in">push</span>(v);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(h, <span class="number">-1</span>, <span class="built_in">sizeof</span>(h));</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= k; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> op, u, v;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;op, &amp;u, &amp;v);</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">add</span>(u, v, <span class="number">0</span>);</span><br><span class="line">            <span class="built_in">add</span>(v, u, <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(u == v)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">add</span>(u, v, <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">3</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">add</span>(v, u, <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">4</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(v == u)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;<span class="built_in">add</span>(v, u, <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">5</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">add</span>(u, v, <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; i--)</span><br><span class="line">        <span class="built_in">add</span>(<span class="number">0</span>, i, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">spfa</span>(<span class="number">0</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            ans += dis[i];</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</details>







]]></content>
      <categories>
        <category>ç®—æ³•</category>
      </categories>
      <tags>
        <tag>ç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title>æ ‘é“¾å‰–åˆ†</title>
    <url>/OI/heavy-path-decomposition/</url>
    <content><![CDATA[<p>æ ‘é“¾å‰–åˆ†ã€‚<br>Luogu P3384</p>
<span id="more"></span>

<h1 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h1><p>æ ‘é“¾å‰–åˆ†ï¼ˆç®€ç§°â€œæ ‘å‰–â€ï¼Œåˆç§°â€œé‡é“¾å‰–åˆ†â€ï¼‰æ˜¯ä¸€ç§å°†ä¸€æ£µæ ‘è½¬åŒ–ä¸ºä¸€æ®µè¿ç»­çš„åŒºé—´çš„æ–¹æ³•ã€‚<br>è¿™ç§æ–¹æ³•å¯ä»¥å°†ä¸€æ£µæ ‘æ ¹æ®å­æ ‘å¤§å°ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„â€œé‡å„¿å­â€å’Œâ€œè½»å„¿å­â€ï¼Œæ¥å°†ä¸€æ£µæ ‘åˆ’åˆ†æˆè‹¥å¹²æ¡â€é‡é“¾â€œï¼Œå¹¶å¯ä»¥ä¿è¯ï¼Œåœ¨ä»»æ„ä¸€æ¡è·¯å¾„ä¸Šçš„è¿ç»­çš„é“¾éƒ½ä¸è¶…è¿‡ $\log_2n$ ä¸ªã€‚</p>
<p>æ ‘å‰–å¯ä»¥å€ŸåŠ©ä¸€äº›æ•°æ®ç»“æ„ï¼ˆå¦‚çº¿æ®µæ ‘ï¼‰æ¥ä»¥ $O(\log n)$ çš„å¤æ‚åº¦ç»´æŠ¤æ•°ä¸Šè·¯å¾„çš„ä¿¡æ¯ï¼Œå¦‚â€œä¿®æ”¹<strong>æ ‘ä¸Šä¸¤ç‚¹ä¹‹é—´çš„è·¯å¾„ä¸Š</strong>æ‰€æœ‰ç‚¹çš„å€¼â€å’Œâ€œæŸ¥è¯¢<strong>æ ‘ä¸Šä¸¤ç‚¹ä¹‹é—´çš„è·¯å¾„ä¸Š</strong>èŠ‚ç‚¹æƒå€¼çš„<strong>å’Œ&#x2F;æå€¼&#x2F;å…¶ä»–</strong>(åœ¨åºåˆ—ä¸Šå¯ä»¥ç”¨æ•°æ®ç»“æ„ç»´æŠ¤çš„ã€ä¾¿äºåˆå¹¶çš„ä¿¡æ¯)â€ç­‰ç­‰ã€‚</p>
<p>å½“ç„¶ï¼Œé™¤äº†ä¸Šé¢é‚£æ ·åšï¼Œæ ‘å‰–è¿˜å¯ä»¥å¿«é€Ÿåœ°æ±‚LCAã€‚</p>
<p>æ ‘å‰–åœ¨æ´›è°·ä¸Šæœ‰ä¸€é“æ¨¡æ¿é¢˜ï¼š<span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL3Byb2JsZW0vUDMzODQ=">Luogu P3384<i class="fa fa-external-link-alt"></i></span><br>ä¸€é“æ¯”è¾ƒç»å…¸çš„ä¾‹é¢˜ï¼š<span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL3Byb2JsZW0vUDIxNDY=">Luogu P2146 [NOI2015] è½¯ä»¶åŒ…ç®¡ç†å™¨<i class="fa fa-external-link-alt"></i></span></p>
<h1 id="æ€æƒ³"><a href="#æ€æƒ³" class="headerlink" title="æ€æƒ³"></a>æ€æƒ³</h1><p>æ ‘å‰–çš„æ€æƒ³æ˜¯ï¼Œå°†ä¸€æ£µæ ‘æŒ‰ç…§â€œé‡è¾¹â€æ¥åˆ’åˆ†ç§°ä¸ºè‹¥å¹²æ¡â€œé‡é“¾â€ã€‚<br>å½“ç„¶ï¼Œè¿™é‡Œçš„â€œé‡é“¾â€åªæ˜¯æŒ‡çš„ä¸€ç§å¸¸ç”¨çš„æƒ…å†µï¼Œå…¶ä»–çš„åˆ’åˆ†æ–¹æ³•æ¯”å¦‚â€œé•¿é“¾å‰–åˆ†â€ç­‰ç­‰å°±ä¸åœ¨æ­¤èµ˜è¿°äº†ã€‚</p>
<h2 id="é‡é“¾"><a href="#é‡é“¾" class="headerlink" title="é‡é“¾"></a>é‡é“¾</h2><p>â€œé‡é“¾â€çš„å®šä¹‰æ˜¯è‹¥å¹²æ¡é¦–å°¾è¡”æ¥çš„â€œé‡è¾¹â€ã€‚<br>é‚£ä¹ˆï¼Œå¦‚æœæƒ³è¦äº†è§£â€œé‡é“¾â€ï¼Œå°±éœ€è¦å…ˆäº†è§£<strong>é‡è¾¹</strong>ã€‚</p>
<h3 id="é‡è¾¹"><a href="#é‡è¾¹" class="headerlink" title="é‡è¾¹"></a>é‡è¾¹</h3><p>â€œé‡è¾¹â€çš„åˆ’åˆ†æ ‡å‡†æ˜¯å®ƒè¿æ¥å‘ä¸€ä¸ªé‡å„¿å­ã€‚<br>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå®ƒåªéœ€è¦ç»“æŸäºä¸€ä¸ªé‡å„¿å­ï¼Œè€Œæ— å…¶ä»–é™åˆ¶ã€‚<br>é‚£ä¹ˆâ€œé‡å„¿å­â€å‘¢ï¼Ÿ</p>
<h3 id="é‡å„¿å­"><a href="#é‡å„¿å­" class="headerlink" title="é‡å„¿å­"></a>é‡å„¿å­</h3><p>â€œé‡å„¿å­â€æ˜¯â€œé‡å­èŠ‚ç‚¹â€çš„åˆ«ç§°ã€‚<br>æˆ‘ä»¬åˆ¤æ–­ä¸€ä¸ªå­èŠ‚ç‚¹æ˜¯å¦ä¸ºé‡å­èŠ‚ç‚¹çš„æ ‡å‡†æ˜¯å®ƒçš„å­æ ‘å¤§å°ã€‚</p>
<p>å¯¹äºä¸€ä¸ªèŠ‚ç‚¹çš„æ‰€æœ‰å„¿å­ï¼Œå…¶ä¸­å­æ ‘æœ€å¤§çš„é‚£ä¸ªå„¿å­ç§°ä¸ºâ€œé‡å„¿å­â€ï¼Œå…¶ä½™çš„ï¼Œåˆ™ç›¸å¯¹åœ°ç§°ä¹‹ä¸ºâ€œè½»å„¿å­â€ã€‚<br>è¿æ¥æŸä¸ªèŠ‚ç‚¹å’Œå…¶é‡å„¿å­çš„è¾¹å«åšâ€œé‡è¾¹â€ï¼Œè€Œè¿æ¥å…¶ä¸å…¶è½»å„¿å­çš„è¾¹åˆ™ç›¸åº”åœ°å«åšâ€œè½»è¾¹â€ã€‚</p>
<h2 id="åˆ’åˆ†"><a href="#åˆ’åˆ†" class="headerlink" title="åˆ’åˆ†"></a>åˆ’åˆ†</h2><p>æˆ‘ä»¬é¦–å…ˆçœ‹ä¸€ä¸‹ä¾‹å­ï¼š</p>
<p><img src="https://s2.loli.net/2021/12/29/iVkNYOTprWKF2Lz.png" alt="æ ‘å‰–1.png"></p>
<p>è¿™æ˜¯ä¸€æ£µæ ‘ã€‚<br>å¯¹äºä¸Šé¢çš„è¿™ä¸€æ£µæ ‘ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œå¦‚ä¸‹çš„ä¸€äº›æ ‡è®°ï¼š<br>æˆ‘ä»¬é¦–å…ˆæŒ‰ç…§æ·±åº¦è¿›è¡Œåˆ†å±‚ï¼š</p>
<p><img src="https://s2.loli.net/2021/12/29/Jgwz7DUojWMBms1.png" alt="æ ‘å‰–2.png"></p>
<p>ç„¶åæ ‡å‡ºå­æ ‘çš„å¤§å°ï¼š</p>
<p><img src="https://s2.loli.net/2021/12/29/4Xcb2qKiFyD6IdM.png" alt="æ ‘å‰–3.png"></p>
<p>ç„¶åæ ‡å‡ºè½»å„¿å­ã€é‡å„¿å­ã€è½»è¾¹å’Œé‡è¾¹ï¼š</p>
<p><img src="https://s2.loli.net/2021/12/29/ACztKMokjJgmYx7.png" alt="æ ‘å‰–4.png"></p>
<p>ç„¶åæ ‡å‡ºé‡é“¾ï¼š</p>
<p><img src="https://s2.loli.net/2021/12/29/4nWDzp72RSkBE1l.png" alt="æ ‘å‰–5.png"></p>
<p>æœ€åæ ‡å‡ºDFSåºï¼š</p>
<p><img src="https://s2.loli.net/2021/12/29/bS7Y1wiOglACmkt.png" alt="æ ‘å‰–6.png"></p>
<p>è¿™æ ·å°±å¤§åŠŸå‘Šæˆäº†ã€‚</p>
<h1 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h1><p>æ ‘å‰–çš„å®ç°æ˜¯é€šè¿‡ä¸¤ä¸ªDFSè¿›è¡Œçš„ã€‚</p>
<p>æˆ‘ä»¬è¿™æ¬¡ä½¿ç”¨é‚»æ¥è¡¨æ¥å­˜å‚¨æ ‘çš„è¾¹ä¿¡æ¯ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> w[N], h[N], e[M], ne[M], idx;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[idx] = b, ne[idx] = h[a], h[a] = idx++;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>$\color[rgb]{1,1,0.0625}{Ï†}$</p>
<p>ç¬¬ä¸€ä¸ªDFSè®°å½•äº†æ¯ä¸ªèŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹(vater)ã€æ·±åº¦(depth)ã€å­æ ‘å¤§å°(sz)å’Œé‡å„¿å­(son)ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> vater, <span class="type">int</span> depth)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    dep[p] = depth, fa[p] = vater, sz[p] = <span class="number">1</span>;<span class="comment">//åˆå§‹åŒ–èŠ‚ç‚¹çŠ¶æ€ï¼Œè®°å½•å…¶æ·±åº¦å’Œçˆ¶èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h[p]; ~i; i = ne[i])<span class="comment">//éå†å…¶æ‰€æœ‰å„¿å­</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> j = e[i];</span><br><span class="line">        <span class="keyword">if</span>(j == vater) <span class="keyword">continue</span>;<span class="comment">//é˜²æ­¢éå†å…¶çˆ¶äº²</span></span><br><span class="line">        <span class="built_in">dfs1</span>(j, p, depth + <span class="number">1</span>);<span class="comment">//æœç´¢å½“å‰å„¿å­</span></span><br><span class="line">        sz[p] += sz[j];<span class="comment">//æ›´æ–°å­æ ‘å¤§å°</span></span><br><span class="line">        <span class="keyword">if</span>(sz[son[p]] &lt; sz[j]) son[p] = j;<span class="comment">//åˆ¤æ–­æ˜¯å¦ä¸ºé‡å„¿å­</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>$\color[rgb]{1,1,0.0625}{Ï†}$</p>
<p>ç¬¬äºŒä¸ªDFSè®°å½•äº†æ¯ä¸ªèŠ‚ç‚¹æ‰€åœ¨é‡é“¾çš„é“¾é¡¶èŠ‚ç‚¹(top)ã€dfsåº(id)å’Œé‡æ–°å®šå‘çš„èŠ‚ç‚¹æƒå€¼(nw)ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    id[p] = ++cnt, nw[cnt] = w[p], top[p] = t;<span class="comment">//åˆå§‹åŒ–èŠ‚ç‚¹ä¿¡æ¯ï¼Œè®°å½•å…¶DFSåº</span></span><br><span class="line">    <span class="keyword">if</span>(!son[p]) <span class="keyword">return</span>;<span class="comment">//æ˜¯å¦ä¸ºå¶èŠ‚ç‚¹</span></span><br><span class="line">    <span class="built_in">dfs2</span>(son[p], t);<span class="comment">//ä¼˜å…ˆæœç´¢åœ¨åŒä¸€æ¡é‡é“¾ä¸Šçš„é‡å„¿å­</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h[p]; ~i; i = ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> j = e[i];</span><br><span class="line">        <span class="keyword">if</span>(j == fa[p] || j == son[p]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs2</span>(j, j);<span class="comment">//æœç´¢è½»å„¿å­ï¼Œå¼€ä¸€æ¡æ–°çš„é‡é“¾ï¼Œé“¾é¡¶ä¸ºå½“å‰è½»å„¿å­</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>$\color[rgb]{1,1,0.0625}{Ï†}$</p>
<h1 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h1><p>æ ‘å‰–å¯ä»¥åœ¨ $O(n) \sim O(\log n)$ çš„æ—¶é—´å¤æ‚åº¦å†…æ±‚å‡ºä¸¤ä¸ªç‚¹çš„LCAã€‚</p>
<h1 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h1><p>æ´›è°·ä¸Šé¢æä¾›äº†æ¿å­é¢˜ã€‚<br>é¢˜é¢è§<span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL3Byb2JsZW0vUDMzODQ=">è¿™é‡Œ<i class="fa fa-external-link-alt"></i></span>ã€‚<br>ä»£ç æ­£ç¡®æ€§è§<span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL3JlY29yZC82NTkwNzI2Mg==">æäº¤è®°å½•<i class="fa fa-external-link-alt"></i></span>ã€‚</p>
<p>æˆ‘ä»¬é¦–å…ˆç…§å¸¸æ‰“å‡ºçº¿æ®µæ ‘éƒ¨åˆ†ï¼ˆ<del>ä¸ä¼šçš„å¯ä»¥çœ‹<a href="">è¿™ç¯‡åšå®¢</a></del>å„ä½è¯»è€…ä»¬ä¸€å®šå·²ç»ä¼šçº¿æ®µæ ‘äº†ç½¢ï¼‰</p>
<p>ä¸¤ä¸ªDFSä¹Ÿæ˜¯å·²ç»æœ‰äº†çš„ä»£ç ï¼ˆè§ä¸Šé¢ï¼‰</p>
<p>ç„¶åå°±æœ‰äº†è¿™ç¯‡ä»£ç çš„æ ¸å¿ƒéƒ¨åˆ†ï¼š</p>
<details class="note default"><summary><p>æ ¸å¿ƒä»£ç </p>
</summary>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> str;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">100010</span>, M = N &lt;&lt; <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> n, m, rt, mod;</span><br><span class="line"><span class="type">int</span> w[N], h[N], e[M], ne[M], idx;</span><br><span class="line"><span class="type">int</span> id[N], nw[N], cnt;</span><br><span class="line"><span class="type">int</span> dep[N], sz[N], top[N], fa[N], son[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">segtree</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    ll add, sum;</span><br><span class="line">&#125;tr[N &lt;&lt; <span class="number">3</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[idx] = b, ne[idx] = h[a], h[a] = idx++;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> father, <span class="type">int</span> depth)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    dep[p] = depth, fa[p] = father, sz[p] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h[p]; ~i; i = ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> j = e[i];</span><br><span class="line">        <span class="keyword">if</span>(j == father) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs1</span>(j, p, depth + <span class="number">1</span>);</span><br><span class="line">        sz[p] += sz[j];</span><br><span class="line">        <span class="keyword">if</span>(sz[son[p]] &lt; sz[j]) son[p] = j;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    id[p] = ++cnt, nw[cnt] = w[p], top[p] = t;</span><br><span class="line">    <span class="keyword">if</span>(!son[p]) <span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">dfs2</span>(son[p], t);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h[p]; ~i; i = ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> j = e[i];</span><br><span class="line">        <span class="keyword">if</span>(j == fa[p] || j == son[p]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs2</span>(j, j);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tr[p].sum = (tr[p &lt;&lt; <span class="number">1</span>].sum + tr[p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].sum) % mod;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> &amp;root = tr[p], &amp;left = tr[p &lt;&lt; <span class="number">1</span>], &amp;rght = tr[p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span>(root.add)</span><br><span class="line">    &#123;</span><br><span class="line">        left.add = (left.add + root.add) % mod;</span><br><span class="line">        left.sum = (left.sum + root.add * (left.r - left.l + <span class="number">1</span>)) % mod;</span><br><span class="line">        rght.add = (rght.add + root.add) % mod;</span><br><span class="line">        rght.sum = (rght.sum + root.add * (rght.r - rght.l + <span class="number">1</span>)) % mod;</span><br><span class="line">        root.add = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tr[p] = &#123; l, r, <span class="number">0</span>, nw[r] &#125;;</span><br><span class="line">    <span class="keyword">if</span>(l == r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">build</span>(p &lt;&lt; <span class="number">1</span>, l, mid);</span><br><span class="line">    <span class="built_in">build</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="built_in">pushup</span>(p);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">segadd</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>((l &lt;= tr[p].l) &amp;&amp; (r &gt;= tr[p].r))</span><br><span class="line">    &#123;</span><br><span class="line">        tr[p].add = (tr[p].add + k) % mod;</span><br><span class="line">        tr[p].sum = (tr[p].sum + k * (tr[p].r - tr[p].l + <span class="number">1</span>)) % mod;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">pushdown</span>(p);</span><br><span class="line">    <span class="type">int</span> mid = (tr[p].l + tr[p].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid) <span class="built_in">segadd</span>(p &lt;&lt; <span class="number">1</span>, l, r, k);</span><br><span class="line">    <span class="keyword">if</span>(r &gt; mid) <span class="built_in">segadd</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r, k);</span><br><span class="line">    <span class="built_in">pushup</span>(p);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">segsum</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>((l &lt;= tr[p].l) &amp;&amp; (r &gt;= tr[p].r)) <span class="keyword">return</span> tr[p].sum;</span><br><span class="line">    <span class="built_in">pushdown</span>(p);</span><br><span class="line">    <span class="type">int</span> mid = (tr[p].l + tr[p].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    ll res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid) res += <span class="built_in">segsum</span>(p &lt;&lt; <span class="number">1</span>, l, r);</span><br><span class="line">    <span class="keyword">if</span>(r &gt; mid) res += <span class="built_in">segsum</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r);</span><br><span class="line">    <span class="keyword">return</span> res % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;rt, &amp;mod);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;w[i]);</span><br><span class="line">    <span class="built_in">memset</span>(h, <span class="number">-1</span>, <span class="keyword">sizeof</span> h);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> a, b;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);</span><br><span class="line">        <span class="built_in">add</span>(a, b);</span><br><span class="line">        <span class="built_in">add</span>(b, a);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dfs1</span>(rt, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">dfs2</span>(rt, rt);</span><br><span class="line">    <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</details>
<p>$\color[rgb]{1,1,0.0625}{Ï†}$</p>
<p>ç„¶åå°±æ˜¯å¯¹é¢˜ç›®è¦æ±‚åŠŸèƒ½çš„å®ç°ã€‚</p>
<p>é¢˜ç›®è¦æ±‚æˆ‘ä»¬è¿™æ ·åšï¼š</p>
<blockquote>
<ol>
<li>å°†æ ‘ä» x åˆ° y ç»“ç‚¹æœ€çŸ­è·¯å¾„ä¸Šæ‰€æœ‰èŠ‚ç‚¹çš„å€¼éƒ½åŠ ä¸Š zã€‚</li>
<li>æ±‚æ ‘ä» x åˆ° y ç»“ç‚¹æœ€çŸ­è·¯å¾„ä¸Šæ‰€æœ‰èŠ‚ç‚¹çš„å€¼ä¹‹å’Œã€‚</li>
<li>å°†ä»¥ x ä¸ºæ ¹èŠ‚ç‚¹çš„å­æ ‘å†…æ‰€æœ‰èŠ‚ç‚¹å€¼éƒ½åŠ ä¸Š zã€‚</li>
<li>æ±‚ä»¥ x ä¸ºæ ¹èŠ‚ç‚¹çš„å­æ ‘å†…æ‰€æœ‰èŠ‚ç‚¹å€¼ä¹‹å’Œã€‚</li>
</ol>
</blockquote>
<p>æˆ‘ä»¬åˆ†ç±»å‹è¿›è¡Œå®ç°ã€‚</p>
<p>å¯¹äºé‚£äº›å¯¹æŸä¸€æ£µå­æ ‘è¿›è¡Œçš„æ“ä½œï¼Œæˆ‘ä»¬ç›´æ¥è°ƒç”¨çº¿æ®µæ ‘æ¥è¿›è¡Œæ“ä½œï¼Œå› ä¸ºå¯¹äºä»»æ„ä¸€æ£µå­æ ‘ï¼Œå®ƒé‡Œé¢çš„æ‰€æœ‰èŠ‚ç‚¹çš„DFSåºå°±æ˜¯è¿ç»­çš„ï¼Œä¹Ÿå°±æ„å‘³ç€å¯ä»¥è¢«å½“æˆä¸€æ®µåŒºé—´æ¥è¿›è¡Œæ“ä½œã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">addtree</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">segadd</span>(<span class="number">1</span>, id[p], id[p] + sz[p] - <span class="number">1</span>, k);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">sumtree</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">segsum</span>(<span class="number">1</span>, id[p], id[p] + sz[p] - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>$\color[rgb]{1,1,0.0625}{Ï†}$</p>
<p>è€Œå¯¹äºè·¯å¾„çš„æ“ä½œï¼Œæˆ‘ä»¬ä½¿ç”¨è¿™æ ·ä¸€ç§ç­–ç•¥ï¼šè¾¹èµ°è¾¹è®¡ç®—ã€‚<br>é¦–å…ˆï¼Œæˆ‘ä»¬æ±‚å‡ºè¿™ä¸€æ¡æœ€çŸ­è·¯ï¼Œä¹Ÿå°±æ˜¯æ±‚å‡ºå®ƒä»¬çš„æœ€è¿‘å…¬å…±ç¥–å…ˆã€‚<br>æˆ‘ä»¬ä½¿ç”¨è¿™æ ·çš„æ€è·¯æ¥å¯»æ‰¾ä»–ä»¬çš„LCAï¼š</p>
<p>æˆ‘ä»¬ä»è¾ƒæ·±çš„é‚£ä¸€ä¸ªèŠ‚ç‚¹å¼€å§‹ä¸æ–­å‘ä¸Šè·³é‡é“¾ï¼Œç›´åˆ°è·³åˆ°ä¸è¾ƒæµ…çš„èŠ‚ç‚¹åŒä¸€æ¡é‡é“¾ä¸Šä¸ºæ­¢ã€‚æ­¤æ—¶ï¼Œæ·±åº¦è¾ƒæµ…çš„é‚£ä¸€ä¸ªå°±æ˜¯ä»–ä»¬çš„LCAã€‚</p>
<p>äºæ˜¯æˆ‘ä»¬å°±å¯ä»¥å†™å‡ºè·¯å¾„åŠ ã€è·¯å¾„æ±‚å’Œçš„ä»£ç äº†ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">addpath</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> q, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(top[p] != top[q])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(dep[top[p]] &lt; dep[top[q]]) <span class="built_in">swap</span>(p, q);</span><br><span class="line">        <span class="built_in">segadd</span>(<span class="number">1</span>, id[top[p]], id[p], k);</span><br><span class="line">        p = fa[top[p]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(dep[p] &lt; dep[q]) <span class="built_in">swap</span>(p, q);</span><br><span class="line">    <span class="built_in">segadd</span>(<span class="number">1</span>, id[q], id[p], k);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">sumpath</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> q)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(top[p] != top[q])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(dep[top[p]] &lt; dep[top[q]]) <span class="built_in">swap</span>(p, q);</span><br><span class="line">        res += <span class="built_in">segsum</span>(<span class="number">1</span>, id[top[p]], id[p]);</span><br><span class="line">        p = fa[top[p]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(dep[p] &lt; dep[q]) <span class="built_in">swap</span>(p, q);</span><br><span class="line">    res += <span class="built_in">segsum</span>(<span class="number">1</span>, id[q], id[p]);</span><br><span class="line">    <span class="keyword">return</span> res % mod;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>$\color[rgb]{1,1,0.0625}{Ï†}$</p>
<p>æœ€åæ”¾ä¸€éå®Œæ•´ä»£ç ï¼š</p>
<details class="note success"><summary><p>å®Œæ•´ä»£ç </p>
</summary>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">100010</span>, M = N &lt;&lt; <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> n, m, rt, mod;</span><br><span class="line"><span class="type">int</span> w[N], h[N], e[M], ne[M], idx;</span><br><span class="line"><span class="type">int</span> id[N], nw[N], cnt;</span><br><span class="line"><span class="type">int</span> dep[N], sz[N], top[N], fa[N], son[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">segtree</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    ll add, sum;</span><br><span class="line">&#125;tr[N &lt;&lt; <span class="number">3</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[idx] = b, ne[idx] = h[a], h[a] = idx++;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> father, <span class="type">int</span> depth)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    dep[p] = depth, fa[p] = father, sz[p] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h[p]; ~i; i = ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> j = e[i];</span><br><span class="line">        <span class="keyword">if</span>(j == father) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs1</span>(j, p, depth + <span class="number">1</span>);</span><br><span class="line">        sz[p] += sz[j];</span><br><span class="line">        <span class="keyword">if</span>(sz[son[p]] &lt; sz[j]) son[p] = j;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    id[p] = ++cnt, nw[cnt] = w[p], top[p] = t;</span><br><span class="line">    <span class="keyword">if</span>(!son[p]) <span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">dfs2</span>(son[p], t);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h[p]; ~i; i = ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> j = e[i];</span><br><span class="line">        <span class="keyword">if</span>(j == fa[p] || j == son[p]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs2</span>(j, j);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tr[p].sum = (tr[p &lt;&lt; <span class="number">1</span>].sum + tr[p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].sum) % mod;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> &amp;root = tr[p], &amp;left = tr[p &lt;&lt; <span class="number">1</span>], &amp;rght = tr[p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span>(root.add)</span><br><span class="line">    &#123;</span><br><span class="line">        left.add = (left.add + root.add) % mod;</span><br><span class="line">        left.sum = (left.sum + root.add * (left.r - left.l + <span class="number">1</span>)) % mod;</span><br><span class="line">        rght.add = (rght.add + root.add) % mod;</span><br><span class="line">        rght.sum = (rght.sum + root.add * (rght.r - rght.l + <span class="number">1</span>)) % mod;</span><br><span class="line">        root.add = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tr[p] = &#123; l, r, <span class="number">0</span>, nw[r] &#125;;</span><br><span class="line">    <span class="keyword">if</span>(l == r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">build</span>(p &lt;&lt; <span class="number">1</span>, l, mid);</span><br><span class="line">    <span class="built_in">build</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="built_in">pushup</span>(p);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">segadd</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>((l &lt;= tr[p].l) &amp;&amp; (r &gt;= tr[p].r))</span><br><span class="line">    &#123;</span><br><span class="line">        tr[p].add = (tr[p].add + k) % mod;</span><br><span class="line">        tr[p].sum = (tr[p].sum + k * (tr[p].r - tr[p].l + <span class="number">1</span>)) % mod;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">pushdown</span>(p);</span><br><span class="line">    <span class="type">int</span> mid = (tr[p].l + tr[p].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid) <span class="built_in">segadd</span>(p &lt;&lt; <span class="number">1</span>, l, r, k);</span><br><span class="line">    <span class="keyword">if</span>(r &gt; mid) <span class="built_in">segadd</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r, k);</span><br><span class="line">    <span class="built_in">pushup</span>(p);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">segsum</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>((l &lt;= tr[p].l) &amp;&amp; (r &gt;= tr[p].r)) <span class="keyword">return</span> tr[p].sum;</span><br><span class="line">    <span class="built_in">pushdown</span>(p);</span><br><span class="line">    <span class="type">int</span> mid = (tr[p].l + tr[p].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    ll res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid) res += <span class="built_in">segsum</span>(p &lt;&lt; <span class="number">1</span>, l, r);</span><br><span class="line">    <span class="keyword">if</span>(r &gt; mid) res += <span class="built_in">segsum</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r);</span><br><span class="line">    <span class="keyword">return</span> res % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">addpath</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> q, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(top[p] != top[q])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(dep[top[p]] &lt; dep[top[q]]) <span class="built_in">swap</span>(p, q);</span><br><span class="line">        <span class="built_in">segadd</span>(<span class="number">1</span>, id[top[p]], id[p], k);</span><br><span class="line">        p = fa[top[p]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(dep[p] &lt; dep[q]) <span class="built_in">swap</span>(p, q);</span><br><span class="line">    <span class="built_in">segadd</span>(<span class="number">1</span>, id[q], id[p], k);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">sumpath</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> q)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(top[p] != top[q])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(dep[top[p]] &lt; dep[top[q]]) <span class="built_in">swap</span>(p, q);</span><br><span class="line">        res += <span class="built_in">segsum</span>(<span class="number">1</span>, id[top[p]], id[p]);</span><br><span class="line">        p = fa[top[p]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(dep[p] &lt; dep[q]) <span class="built_in">swap</span>(p, q);</span><br><span class="line">    res += <span class="built_in">segsum</span>(<span class="number">1</span>, id[q], id[p]);</span><br><span class="line">    <span class="keyword">return</span> res % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">addtree</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">segadd</span>(<span class="number">1</span>, id[p], id[p] + sz[p] - <span class="number">1</span>, k);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">sumtree</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">segsum</span>(<span class="number">1</span>, id[p], id[p] + sz[p] - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;rt, &amp;mod);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;w[i]);</span><br><span class="line">    <span class="built_in">memset</span>(h, <span class="number">-1</span>, <span class="keyword">sizeof</span> h);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> a, b;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);</span><br><span class="line">        <span class="built_in">add</span>(a, b);</span><br><span class="line">        <span class="built_in">add</span>(b, a);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dfs1</span>(rt, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">dfs2</span>(rt, rt);</span><br><span class="line">    <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">    <span class="keyword">while</span>(m--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> op, x, y, z;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;op, &amp;x);</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;y, &amp;z);</span><br><span class="line">            <span class="built_in">addpath</span>(x, y, z);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;y);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">sumpath</span>(x, y));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">3</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;z);</span><br><span class="line">            <span class="built_in">addtree</span>(x, z);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">4</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">sumtree</span>(x));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</details>
<p>$\color[rgb]{1,1,0.0625}{Ï†}$</p>
]]></content>
      <categories>
        <category>ç®—æ³•</category>
      </categories>
      <tags>
        <tag>ç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title>KMP ç®—æ³•ä¸å‰ç¼€å‡½æ•°</title>
    <url>/OI/kmp/</url>
    <content><![CDATA[<p>KMPç®—æ³•ä¸å‰ç¼€å‡½æ•°ã€‚</p>
<span id="more"></span>

<h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><p>KMPç®—æ³•ï¼Œå…¨ç§°ä¸º Knuth-Morris-Pratt ç®—æ³•ï¼Œæ˜¯ç”± Knuth, Morris å’Œ Pratt è¿™ä¸‰ä¸ªäººåˆ›é€ çš„ç®—æ³•ï¼Œå¯ä»¥åœ¨ $O(n+m)$ çš„æ—¶é—´å†…ä½¿ç”¨ $O(n)$ çš„ç©ºé—´å®Œæˆå¦‚ä¸‹çš„ä»»åŠ¡ï¼š</p>
<blockquote>
<p>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² $S$ å’Œä¸€ä¸ªæ¨¡å¼ä¸² $T$ï¼Œæ±‚å‡º $S$ åœ¨ $T$ ä¸­æ‰€æœ‰å‡ºç°çš„ä½ç½®ã€‚</p>
</blockquote>
<p>å…¶ä¸­ $|S| &#x3D; n$ï¼Œ$|T| &#x3D; m$ã€‚</p>
<p>KMPç®—æ³•ä¸»è¦ä¾èµ–çš„æ˜¯ â€œNextå‡½æ•°â€ è¿™ä¸ªä¸œè¥¿ã€‚</p>
<h1 id="Nextå‡½æ•°"><a href="#Nextå‡½æ•°" class="headerlink" title="Nextå‡½æ•°"></a>Nextå‡½æ•°</h1><p>Nextå‡½æ•°ï¼Œæœ‰æ—¶å€™ä¹Ÿè¢«ç§°ä½œ â€œå‰ç¼€å‡½æ•°â€ï¼Œæ˜¯KMPç®—æ³•çš„æ ¸å¿ƒéƒ¨åˆ†ã€‚<br>æˆ‘ä»¬ä»¥ä¸€ä¸ªæ•°ç»„ $\pi$ æ¥è¡¨ç¤ºå®ƒã€‚</p>
<p>å…¶æ—¨åœ¨æ±‚å¾—ä»»æ„ä¸€ä¸ªå‰ç¼€çš„borderé•¿åº¦ã€‚</p>
<h2 id="ä»€ä¹ˆæ˜¯borderï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯borderï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯borderï¼Ÿ"></a>ä»€ä¹ˆæ˜¯borderï¼Ÿ</h2><p>borderæŒ‡çš„æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å†…ï¼ŒçœŸå‰ç¼€å’ŒçœŸåç¼€ç›¸ç­‰çš„é‚£ä¸€éƒ¨åˆ†ã€‚<br>è¿™æ ·çš„çœŸå‰ç¼€å’ŒçœŸåç¼€å¯èƒ½æœ‰å¾ˆå¤šç§ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾çš„æ˜¯æœ€é•¿çš„é‚£ä¸€ç»„ã€‚</p>
<p>çœŸå‰ç¼€å’ŒçœŸåç¼€è¯´çš„æ˜¯å‰ç¼€å’Œåç¼€ä¸­é™¤å»å­—ç¬¦ä¸²æœ¬èº«ä¹‹åå‰©ä¸‹çš„éƒ¨åˆ†ã€‚</p>
<h2 id="å¦‚ä½•æ±‚å¾—borderï¼Ÿ"><a href="#å¦‚ä½•æ±‚å¾—borderï¼Ÿ" class="headerlink" title="å¦‚ä½•æ±‚å¾—borderï¼Ÿ"></a>å¦‚ä½•æ±‚å¾—borderï¼Ÿ</h2><h3 id="æœ´ç´ ç®—æ³•"><a href="#æœ´ç´ ç®—æ³•" class="headerlink" title="æœ´ç´ ç®—æ³•"></a>æœ´ç´ ç®—æ³•</h3><p>æˆ‘ä»¬æ˜¾ç„¶å¯ä»¥æš´åŠ›æ‰«ï¼Œæœ€ç»ˆçš„å¤æ‚åº¦æ˜¯ $O(n^3)$ çš„ã€‚</p>
<p>æ‡’å¾—å†™äº†ï¼Œç›´æ¥æ¬äº†OI-Wikiçš„ä»£ç ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// C++ Version</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">prefix_function</span><span class="params">(string s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> n = ( <span class="type">int</span> )s.<span class="built_in">length</span>();</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">pi</span><span class="params">(n)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = i; j &gt;= <span class="number">0</span>; j--)</span><br><span class="line">            <span class="keyword">if</span>(s.<span class="built_in">substr</span>(<span class="number">0</span>, j) == s.<span class="built_in">substr</span>(i - j + <span class="number">1</span>, j))</span><br><span class="line">            &#123;</span><br><span class="line">                pi[i] = j;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">    <span class="keyword">return</span> pi;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Python Version</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">prefix_function</span>(<span class="params">s</span>):</span><br><span class="line">    n = <span class="built_in">len</span>(s)</span><br><span class="line">    pi = [<span class="number">0</span>] * n</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> s[<span class="number">0</span> : j] == s[i - j + <span class="number">1</span> : i + <span class="number">1</span>]:</span><br><span class="line">                pi[i] = j</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> pi</span><br></pre></td></tr></table></figure>

<h3 id="ä¼˜åŒ–"><a href="#ä¼˜åŒ–" class="headerlink" title="ä¼˜åŒ–"></a>ä¼˜åŒ–</h3><p>æˆ‘ä»¬ä¼šå‘ç°ï¼Œç›¸é‚»çš„ä¸¤ä¸ªå‡½æ•°å€¼æœ€å¤šä¼šå¢åŠ 1ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æˆ‘ä»¬ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªä½ç½®æ—¶ï¼ŒNextå‡½æ•°çš„å€¼è¦ä¹ˆå¢åŠ ä¸€ï¼Œè¦ä¹ˆç»´æŒä¸å˜ï¼Œè¦ä¹ˆå‡å°‘ã€‚</p>
<p>æ­¤æ—¶æ”¹è¿›çš„ç®—æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// C++ Version</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">prefix_function</span><span class="params">(string s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> n = ( <span class="type">int</span> )s.<span class="built_in">length</span>();</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">pi</span><span class="params">(n)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = pi[i - <span class="number">1</span>] + <span class="number">1</span>; j &gt;= <span class="number">0</span>; j--)  <span class="comment">// improved: j=i =&gt; j=pi[i-1]+1</span></span><br><span class="line">            <span class="keyword">if</span>(s.<span class="built_in">substr</span>(<span class="number">0</span>, j) == s.<span class="built_in">substr</span>(i - j + <span class="number">1</span>, j))</span><br><span class="line">            &#123;</span><br><span class="line">                pi[i] = j;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">    <span class="keyword">return</span> pi;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Python Version</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">prefix_function</span>(<span class="params">s</span>):</span><br><span class="line">    n = <span class="built_in">len</span>(s)</span><br><span class="line">    pi = [<span class="number">0</span>] * n</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(pi[i - <span class="number">1</span>] + <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> s[<span class="number">0</span> : j] == s[i - j + <span class="number">1</span> : i + <span class="number">1</span>]:</span><br><span class="line">                pi[i] = j</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> pi</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶ï¼Œæˆ‘ä»¬æ¯ä¸€ä¸ªå‰ç¼€æœ€å¤šéœ€è¦æ¯”å¯¹ $O(n)$ çº§åˆ«çš„å­—ç¬¦ä¸²ï¼Œæ€»å¤æ‚åº¦é™åˆ°äº† $O(n^2)$ã€‚</p>
<h3 id="ç»§ç»­ä¼˜åŒ–"><a href="#ç»§ç»­ä¼˜åŒ–" class="headerlink" title="ç»§ç»­ä¼˜åŒ–"></a>ç»§ç»­ä¼˜åŒ–</h3><p>åˆšæ‰æˆ‘ä»¬åªè€ƒè™‘åˆ°äº† $s[i+1] &#x3D; s[\pi[i]]$ çš„æƒ…å†µï¼Œå³å‡½æ•°å€¼å¢åŠ 1ã€‚<br>é‚£ä¹ˆå¯¹äºå…¶ä»–çš„æƒ…å†µå‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬è€ƒè™‘ $s[i+1] \neq s[\pi[i]]$ã€‚<br>åœ¨æˆ‘ä»¬ä¹‹å‰çš„æƒ³æ³•é‡Œé¢ï¼Œæˆ‘ä»¬å°±éœ€è¦æšä¸¾å‡ºæ¥å¯èƒ½çš„borderé•¿åº¦ï¼Œå¹¶ä¸å®é™…æƒ…å†µè¿›è¡Œæ¯”è¾ƒã€‚</p>
<p>æˆ‘ä»¬å°è¯•é¿å…è¿™äº›æ— è°“çš„æ¯”è¾ƒã€‚</p>
<p>æˆ‘ä»¬å°è¯•æ‰¾åˆ°ä¸€ä¸ªå‰ç¼€ï¼Œåœ¨ä¿è¯å…¶ä¸åç¼€ç›¸ç­‰çš„å‰æä¸‹ï¼Œä½¿å¾—æˆ‘ä»¬å½“å‰åŒ¹é…çš„è¿›åº¦æœ€å¤§åœ°ä¿ç•™ä¸‹æ¥ã€‚</p>
<p>è§‚å¯Ÿä¸€ä¸‹æˆ‘ä»¬æƒ³è¦æ‰¾åˆ°çš„ä¸œè¥¿ï¼š</p>
<p><img src="/pics/kmp1.svg" alt="kmp1.svg"></p>
<p>æˆ‘ä»¬æƒ³è¦æ‰¾åˆ°ä¸¤ä¸ªå­—ç¬¦ä¸² $s[0 \to j-1]$ å’Œ $s[i-j+1 \to i]$ï¼Œä»–ä»¬å®Œå…¨ç›¸ç­‰ï¼ŒåŒæ—¶ä¹Ÿåˆ†åˆ«æ˜¯ $s[0 \to i]$ çš„ä¸€ä¸ªå‰ç¼€å’Œä¸€ä¸ªåç¼€ã€‚</p>
<p>æˆ‘ä»¬å‘ç°ï¼Œè¿™ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å®Œå…¨åŒ…å«åœ¨ $s[0 \to \pi[i]-1]$ å’Œ $s[i-\pi[i]+1 \to i]$ è¿™ä¸¤ä¸ªå®Œå…¨ç›¸ç­‰çš„å­—ç¬¦ä¸²å†…çš„ã€‚</p>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†å…¶è½¬åŒ–æˆä¸ºå¯»æ‰¾å­—ç¬¦ä¸² $s[0 \to \pi[i]-1]$ çš„borderã€‚</p>
<p>æ‰€ä»¥è¯´ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾çš„å°±æ˜¯ $s[0 \to \pi[\pi[i]]-1]$ å’Œ $s[i-\pi[\pi[i]]+1 \to i]$ã€‚</p>
<p>ç„¶åæˆ‘ä»¬å°è¯•å°† $s_{i+1}$ çº³å…¥æˆ‘ä»¬å½“å‰æ‰¾åˆ°çš„borderé‡Œé¢ã€‚</p>
<p>å¦‚æœåŒ¹é…ï¼Œé‚£å°±å‘å‰ç§»åŠ¨ï¼›<br>å¦‚æœå¤±é…ï¼Œé‚£å°±ç»§ç»­å¯»æ‰¾å½“å‰é•¿åº¦çš„borderï¼Œç›´åˆ°æœ€ååˆ°è¾¾0ã€‚</p>
<p>æ­¤æ—¶æ”¹è¿›çš„ç®—æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// C++ Version</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">prefix_function</span><span class="params">(string s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> n = ( <span class="type">int</span> )s.<span class="built_in">length</span>();</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">pi</span><span class="params">(n)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> j = pi[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">while</span>(j &gt; <span class="number">0</span> &amp;&amp; s[i] != s[j]) j = pi[j - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span>(s[i] == s[j]) j++;</span><br><span class="line">        pi[i] = j;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pi;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Python Version</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">prefix_function</span>(<span class="params">s</span>):</span><br><span class="line">    n = <span class="built_in">len</span>(s)</span><br><span class="line">    pi = [<span class="number">0</span>] * n</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n):</span><br><span class="line">        j = pi[i - <span class="number">1</span>]</span><br><span class="line">        <span class="keyword">while</span> j &gt; <span class="number">0</span> <span class="keyword">and</span> s[i] != s[j]:</span><br><span class="line">            j = pi[j - <span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> s[i] == s[j]:</span><br><span class="line">            j += <span class="number">1</span></span><br><span class="line">        pi[i] = j</span><br><span class="line">    <span class="keyword">return</span> pi</span><br></pre></td></tr></table></figure>

<p>åŒæ—¶æˆ‘ä»¬è¿˜å¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬è¿›è¡Œä¼˜åŒ–è¿‡çš„ç®—æ³•æ˜¯ä¸€ä¸ªåœ¨çº¿ç®—æ³•ã€‚</p>
<h1 id="KMP"><a href="#KMP" class="headerlink" title="KMP"></a>KMP</h1><p>ç°åœ¨ç»ˆäºæ¥åˆ°äº†KMPç®—æ³•çš„æœ¬ä½“éƒ¨åˆ†ã€‚</p>
<p>æˆ‘ä»¬è€ƒè™‘æ ¹æ®é¢˜ç›®ç»™å®šçš„ $S$ å’Œ $T$ ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œæ‹¼æ¥æˆä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸² $S+ \sharp +T$ ï¼Œå…¶ä¸­ $\sharp$ ä»£è¡¨åœ¨ $S$ å’Œ $T$ ä¸­éƒ½æ²¡æœ‰å‡ºç°è¿‡çš„åˆ†éš”ç¬¦ã€‚</p>
<p>æˆ‘ä»¬è€ƒè™‘è®¡ç®—æ–°å­—ç¬¦ä¸² $T$ éƒ¨åˆ†çš„Nextå‡½æ•°ã€‚</p>
<p>å› ä¸ºå¯¹äº $T$ éƒ¨åˆ†çš„æ¯ä¸€ä¸ªä½ç½®ï¼Œå…¶ä½ç½®æ‰€å¯¹åº”çš„å‰ç¼€ç»å¯¹åŒ…å« $S$ å’Œåˆ†éš”ç¬¦çš„ã€‚<br>æ‰€ä»¥ï¼Œå…¶Nextå‡½æ•°é•¿åº¦ç»å¯¹ä¸ä¼šè¶…è¿‡ $n$ã€‚ï¼ˆå³ $|S|$ï¼‰</p>
<p>åŒæ—¶ï¼Œæˆ‘ä»¬ä¿è¯äº†åªä¼šæ¯”å¯¹ $T$ éƒ¨åˆ†çš„å­—ä¸²ï¼Œå› ä¸ºåˆ†éš”ç¬¦çš„å‡ºç°ä½¿å¾—åŒ…å«å…¶çš„åç¼€æ— æ³•ä¸åŒæ ·é•¿åº¦çš„å‰ç¼€åŒ¹é…ï¼Œå› ä¸ºè¿™ä¸ªå­—ç¬¦ä¸åœ¨ $S$ æˆ– $T$ ä¸­å‡ºç°è¿‡ï¼Œè€Œå‡å¦‚å‰ç¼€ä¸­ä¹ŸåŒ…å«äº†å®ƒï¼Œä¹Ÿä¼šå› ä¸ºä½ç½®ä¸ä¸€æ ·è€Œæ— æ³•åŒ¹é…ã€‚</p>
<p>æ‰€ä»¥è¯´ï¼Œå¦‚æœåœ¨æŸä¸€ä¸ªä½ç½® $i$ æœ‰ $\pi[i] &#x3D; n$ æˆç«‹ï¼Œé‚£ä¹ˆ $S$ å°±ä¼šåœ¨ $T$ çš„ $i-2n$ å¤„å‡ºç°ã€‚</p>
<p>æ´›è°·ä¾‹é¢˜ï¼š<span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL3Byb2JsZW0vUDMzNzU=">https://www.luogu.com.cn/problem/P3375<i class="fa fa-external-link-alt"></i></span></p>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">kmp</span><span class="params">(string s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> n = ( <span class="type">int</span> )s.<span class="built_in">length</span>();</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">pi</span><span class="params">(n)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> j = pi[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">while</span>(j &gt; <span class="number">0</span> &amp;&amp; s[i] != s[j]) j = pi[j - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span>(s[i] == s[j]) j++;</span><br><span class="line">        pi[i] = j;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pi;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    string s1, s2;</span><br><span class="line">    cin &gt;&gt; s2 &gt;&gt; s1;</span><br><span class="line">    string s3 = s1 + <span class="string">&quot;#&quot;</span> + s2;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; pi1 = <span class="built_in">kmp</span>(s3);</span><br><span class="line">    <span class="type">int</span> n = s1.<span class="built_in">length</span>();</span><br><span class="line">    <span class="type">int</span> m = s2.<span class="built_in">length</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = n; i &lt; s3.<span class="built_in">length</span>(); i++)</span><br><span class="line">        <span class="keyword">if</span>(pi1[i] == n)<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, i - n - n + <span class="number">1</span>);</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; pi2 = <span class="built_in">kmp</span>(s1);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, pi2[i]);</span><br><span class="line">    <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<details class="note default"><summary><p>Python</p>
</summary>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">kmp</span>(<span class="params">s</span>):</span><br><span class="line">    n = <span class="built_in">len</span>(s)</span><br><span class="line">    pi = [<span class="number">0</span>] * n</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n):</span><br><span class="line">        j = pi[i - <span class="number">1</span>]</span><br><span class="line">        <span class="keyword">while</span> j &gt; <span class="number">0</span> <span class="keyword">and</span> s[i] != s[j]:</span><br><span class="line">            j = pi[j - <span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> s[i] == s[j]:</span><br><span class="line">            j += <span class="number">1</span></span><br><span class="line">        pi[i] = j</span><br><span class="line">    <span class="keyword">return</span> pi</span><br><span class="line"></span><br><span class="line">s2 = <span class="built_in">input</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line">s1 = <span class="built_in">input</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line">n = <span class="built_in">len</span>(s1)</span><br><span class="line">s3 = s1 + <span class="string">&quot;#&quot;</span> + s2</span><br><span class="line">pi1 = kmp(s3)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span> (n, <span class="built_in">len</span>(s3)):</span><br><span class="line">    <span class="keyword">if</span> pi1[i] == n:</span><br><span class="line">        <span class="built_in">print</span>(i - <span class="number">2</span> * n + <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">pi2 = kmp(s1)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">0</span>, n):</span><br><span class="line">    <span class="built_in">print</span>(pi2[i], end=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>

</details>

<h1 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h1><h2 id="æ±‚ä¸€ä¸ªå­—ç¬¦ä¸²çš„å‘¨æœŸ"><a href="#æ±‚ä¸€ä¸ªå­—ç¬¦ä¸²çš„å‘¨æœŸ" class="headerlink" title="æ±‚ä¸€ä¸ªå­—ç¬¦ä¸²çš„å‘¨æœŸ"></a>æ±‚ä¸€ä¸ªå­—ç¬¦ä¸²çš„å‘¨æœŸ</h2><p>æˆ‘ä»¬è€ƒè™‘åˆ©ç”¨borderçš„æ€§è´¨ã€‚</p>
<p>å¦‚æœä¸€ä¸ªå­—ç¬¦ä¸² $s$ æœ‰é•¿åº¦ä¸º $r$ çš„borderï¼Œé‚£ä¹ˆ $|s| - r$ ä¸€å®šæ˜¯ $s$ çš„å‘¨æœŸï¼Œå…¶é•¿åº¦æˆ‘ä»¬è¿™é‡Œè®°ä½œ $p$ã€‚</p>
<p>å°±åƒè¿™æ ·ï¼š</p>
<p><img src="/pics/kmp2.svg" alt="kmp2.svg"></p>
<p>ä»è¿™é‡Œæˆ‘ä»¬å¯ä»¥å¾—å‡º $s[0 \to 1]&#x3D;s[2 \to 3]&#x3D;s[4 \to 5]&#x3D;s[6 \to 7]$ï¼Œä»è€Œå¾—å‡º $r-|s|&#x3D;2$ ä¸º $s$ çš„å‘¨æœŸã€‚</p>
<p>åŒæ—¶ï¼Œå¦‚æœè¿™ä¸ªå‘¨æœŸçš„é•¿åº¦ $p$ å¯ä»¥è¢« $|s|$ æ•´é™¤çš„è¯ï¼Œé‚£ä¹ˆé•¿åº¦ä¸º $p$ çš„å‰ç¼€å°±æ˜¯ $s$ çš„æœ€å°å¾ªç¯å…ƒã€‚</p>
<p>AcWingä¾‹é¢˜ï¼š<span class="exturl" data-url="aHR0cHM6Ly93d3cuYWN3aW5nLmNvbS9wcm9ibGVtL2NvbnRlbnQvMTQzLw==">https://www.acwing.com/problem/content/143/<i class="fa fa-external-link-alt"></i></span></p>
<details class="note success"><summary><p>å‚è€ƒä»£ç </p>
</summary>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">kmp</span><span class="params">(string s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> n = ( <span class="type">int</span> )s.<span class="built_in">length</span>();</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">pi</span><span class="params">(n)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> j = pi[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">while</span>(j &gt; <span class="number">0</span> &amp;&amp; s[i] != s[j]) j = pi[j - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span>(s[i] == s[j]) j++;</span><br><span class="line">        pi[i] = j;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pi;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    string s;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="type">int</span> tot = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(n)</span><br><span class="line">    &#123;</span><br><span class="line">        cin &gt;&gt; s;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt;pi = <span class="built_in">kmp</span>(s);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Test case #%d\n&quot;</span>, ++tot);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">            <span class="keyword">if</span>(((i + <span class="number">1</span>) % (i - pi[i] + <span class="number">1</span>) == <span class="number">0</span>) &amp;&amp; ((i + <span class="number">1</span>) != (i - pi[i] + <span class="number">1</span>)))</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, i + <span class="number">1</span>, (i + <span class="number">1</span>) / (i - pi[i] + <span class="number">1</span>));</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">        cin &gt;&gt; n;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</details>
]]></content>
      <categories>
        <category>ç®—æ³•</category>
      </categories>
      <tags>
        <tag>ç®—æ³•</tag>
        <tag>å­—ç¬¦ä¸²</tag>
      </tags>
  </entry>
  <entry>
    <title>ç‚¹åˆ†æ²»</title>
    <url>/OI/point-divide/</url>
    <content><![CDATA[<p>ç‚¹åˆ†æ²»ä»¥åŠç‚¹åˆ†æ ‘ã€‚</p>
<span id="more"></span>

<h1 id="ç‚¹åˆ†æ²»"><a href="#ç‚¹åˆ†æ²»" class="headerlink" title="ç‚¹åˆ†æ²»"></a>ç‚¹åˆ†æ²»</h1><p>ç‚¹åˆ†æ²»ï¼Œé¡¾åæ€ä¹‰ï¼Œæ˜¯ä¸€ç§åˆ†æ²»ç±»ç®—æ³•ã€‚</p>
<p>ç‚¹åˆ†æ²»çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼Œå°†ä¸€æ£µæ ‘ä¸æ–­åœ°é€šè¿‡åˆ ç‚¹æ¥åˆ†ä¸ºæ›´å°çš„å­æ ‘ï¼Œä¸æ–­é€’å½’ä¸‹å»ç›´è‡³æ— æ³•ç»§ç»­åˆ†æ²»ã€‚</p>
<h2 id="æ—¶é—´å¤æ‚åº¦"><a href="#æ—¶é—´å¤æ‚åº¦" class="headerlink" title="æ—¶é—´å¤æ‚åº¦"></a>æ—¶é—´å¤æ‚åº¦</h2><p>åŒæ—¶å…·æœ‰ç±»ä¼¼æ€æƒ³çš„è¿˜æœ‰è¾¹åˆ†æ²»ï¼Œå³é€šè¿‡æˆªæ–­è¾¹çš„æ–¹å¼æ¥å°†æ ‘åˆ†ä¸ºä¸¤æ£µæ›´å°çš„æ ‘ï¼Œä½†æ˜¯ä¸€ä¸ªèŠèŠ±å›¾å°±å¯ä»¥å°†å…¶å¡åˆ°Tå¾—é£èµ·ã€‚<br>æ‰€ä»¥è¯´è¾¹åˆ†æ²»æ— æ³•æœ‰æ•ˆåœ°ä¿è¯å…¶æ—¶é—´å¤æ‚åº¦ã€‚</p>
<p>ä½†æ˜¯ç‚¹åˆ†æ²»æ˜¯å¦‚ä½•ä¿è¯æ—¶é—´å¤æ‚åº¦çš„å‘¢ï¼Ÿ</p>
<h3 id="æ ‘çš„é‡å¿ƒ"><a href="#æ ‘çš„é‡å¿ƒ" class="headerlink" title="æ ‘çš„é‡å¿ƒ"></a>æ ‘çš„é‡å¿ƒ</h3><p>ç‚¹åˆ†æ²»é€šè¿‡å¯»æ‰¾æ ‘çš„é‡å¿ƒå¹¶åˆ é™¤ä¹‹æ¥ä¿è¯å…¶æ—¶é—´å¤æ‚åº¦ä¸º $O(n \log n)$ã€‚</p>
<p>ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p>æœ‰è¿™æ ·ä¸€æ¡å¼•ç†è¯´å¾—å¥½ï¼šæ ‘çš„é‡å¿ƒçš„å­æ ‘å¤§å°æœ€å¤šä¸è¶…è¿‡ $\frac{n}{2}$ ï¼ŒåŒæ—¶ $n$ æŒ‡å½“å‰æ ‘çš„å¤§å°ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥ä¿è¯ï¼Œæ¯ä¸€æ¬¡æœ€å°‘å¯ä»¥å°†æœ€å¤§çš„å­æ ‘å¤§å°å‰Šå‡ä¸ºä¹‹å‰çš„ä¸€åŠï¼Œä¹Ÿå°±ä¿è¯äº†æœ€å¤šåˆ†æ²» $\log n$ æ¬¡ã€‚</p>
<h2 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h2><p>ç‚¹åˆ†æ²»ä¸å…¶ä»–åˆ†æ²»çš„æ€è·¯ç›¸è¿‘ï¼Œå¤§è‡´å¦‚ä¸‹ï¼š</p>
<ol>
<li>å°†æ‰€è¦åˆ†æ²»çš„åŒºé—´åˆ†ä¸ºå¤šæ®µï¼Œé€’å½’å¤„ç†å­æ ‘å†…é—®é¢˜ã€‚</li>
<li>å°è¯•å¤„ç†æ¨ªè·¨å­æ ‘çš„é—®é¢˜ã€‚</li>
</ol>
<p>ä¸¾ä¸ªæ —å­ï¼š</p>
<p>ä»¥<span class="exturl" data-url="aHR0cHM6Ly93d3cuYWN3aW5nLmNvbS9wcm9ibGVtL2NvbnRlbnQvMjU0Lw==">AcWing #252 æ ‘<i class="fa fa-external-link-alt"></i></span>,<span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL3Byb2JsZW0vUDQxNzg=">Luogu P4178 Tree<i class="fa fa-external-link-alt"></i></span>ä¸ºä¾‹ã€‚</p>
<p>è¿™é“é¢˜è®©æˆ‘ä»¬æ±‚å‡ºæ ‘ä¸Šé•¿åº¦ä¸è¶…è¿‡ $k$ çš„è·¯å¾„æœ‰å¤šå°‘æ¡ã€‚</p>
<p>æˆ‘ä»¬çš„æ€è·¯æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š</p>
<p>æˆ‘ä»¬æŠŠæ‰€æœ‰è·¯å¾„åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ç±»æ˜¯ä¸¤ç«¯ç‚¹å‡åœ¨åŒä¸€å­æ ‘å†…çš„ï¼Œä¸€ç±»æ˜¯ä¸¤ç«¯ç‚¹æ¨ªè·¨ä¸¤ä¸ªå­æ ‘çš„ã€‚<br>å¯¹äºç¬¬ä¸€ç§ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é€’å½’å¤„ç†æ¥è§£å†³ã€‚<br>è€Œå¯¹äºç¬¬äºŒç§ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œè¿™æ ·çš„è·¯å¾„ä¸€å®šç»è¿‡æˆ‘ä»¬è¿›è¡Œåˆ†æ²»çš„ç‚¹ï¼Œä¹Ÿå°±æ˜¯å½“å‰æ ‘çš„é‡å¿ƒã€‚å¯¹æ­¤ï¼Œæˆ‘ä»¬è€ƒè™‘æšä¸¾å½“å‰åˆ†æ²»é‡å¿ƒçš„å­æ ‘å†…ï¼Œä¸å…¶è·ç¦»ä¸º $i$ çš„ç‚¹çš„ä¸ªæ•°ï¼Œæœ€åå†ä¾æ® $\sum_{i&#x3D;1}^{\lfloor \frac{k}{2} \rfloor} num[i] \times num[k-i]$ ç»Ÿè®¡å‡ºæ‰€æœ‰é•¿åº¦ä¸º $k$ çš„è·¯å¾„çš„ä¸ªæ•°ã€‚</p>
<p>å‚è€ƒä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">40010</span>, M = N * <span class="number">2</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> h[N], e[M], w[M], ne[M], idx;</span><br><span class="line"><span class="type">bool</span> st[N];</span><br><span class="line"><span class="type">int</span> p[N], q[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get_size</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa)</span><span class="comment">//æ±‚å­æ ‘å¤§å°</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(st[u]) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h[u]; ~i; i = ne[i])</span><br><span class="line">        <span class="keyword">if</span>(e[i] != fa)</span><br><span class="line">            res += <span class="built_in">get_size</span>(e[i], u);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get_wc</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa, <span class="type">int</span> tot, <span class="type">int</span> &amp;wc)</span><span class="comment">//æ±‚é‡å¿ƒ</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(st[u]) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> sum = <span class="number">1</span>, ms = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h[u]; ~i; i = ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> j = e[i];</span><br><span class="line">        <span class="keyword">if</span>(j == fa) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="type">int</span> t = <span class="built_in">get_wc</span>(j, u, tot, wc);</span><br><span class="line">        ms = <span class="built_in">max</span>(ms, t);</span><br><span class="line">        sum += t;</span><br><span class="line">    &#125;</span><br><span class="line">    ms = <span class="built_in">max</span>(ms, tot - sum);</span><br><span class="line">    <span class="keyword">if</span>(ms &lt;= tot / <span class="number">2</span>) wc = u;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_dist</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa, <span class="type">int</span> dist, <span class="type">int</span> &amp;qt)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(st[u]) <span class="keyword">return</span>;</span><br><span class="line">    q[qt++] = dist;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h[u]; ~i; i = ne[i])</span><br><span class="line">        <span class="keyword">if</span>(e[i] != fa)</span><br><span class="line">            <span class="built_in">get_dist</span>(e[i], u, dist + w[i], qt);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">int</span> a[], <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">sort</span>(a, a + k);</span><br><span class="line">    <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = k - <span class="number">1</span>, j = <span class="number">-1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(j + <span class="number">1</span> &lt; i &amp;&amp; a[j + <span class="number">1</span>] + a[i] &lt;= m) j++;</span><br><span class="line">        j = <span class="built_in">min</span>(j, i - <span class="number">1</span>);</span><br><span class="line">        res += j + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">calc</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(st[u]) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">get_wc</span>(u, <span class="number">-1</span>, <span class="built_in">get_size</span>(u, <span class="number">-1</span>), u);</span><br><span class="line">    st[u] = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> pt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h[u]; ~i; i = ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> j = e[i], qt = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">get_dist</span>(j, <span class="number">-1</span>, w[i], qt);</span><br><span class="line">        res -= <span class="built_in">get</span>(q, qt);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>; k &lt; qt; k++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(q[k] &lt;= m) res++;</span><br><span class="line">            p[pt++] = q[k];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    res += <span class="built_in">get</span>(p, pt);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h[u]; ~i; i = ne[i]) res += <span class="built_in">calc</span>(e[i]);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="built_in">memset</span>(st, <span class="number">0</span>, <span class="keyword">sizeof</span> st);</span><br><span class="line">    <span class="built_in">memset</span>(h, <span class="number">-1</span>, <span class="keyword">sizeof</span> h);</span><br><span class="line">    idx = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n - <span class="number">1</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> a, b, c;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;c);</span><br><span class="line">        <span class="built_in">add</span>(a - <span class="number">1</span>, b - <span class="number">1</span>, c), <span class="built_in">add</span>(b - <span class="number">1</span>, a - <span class="number">1</span>, c);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;m);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">calc</span>(<span class="number">0</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="è¾¹åˆ†æ²»ä¼˜åŒ–"><a href="#è¾¹åˆ†æ²»ä¼˜åŒ–" class="headerlink" title="è¾¹åˆ†æ²»ä¼˜åŒ–"></a>è¾¹åˆ†æ²»ä¼˜åŒ–</h1><p>ä¹‹å‰æˆ‘ä»¬æåˆ°è¿‡è¾¹åˆ†æ²»æ— æ³•åº”å¯¹èŠèŠ±å›¾ã€‚</p>
<p>ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘å°†æ ‘çš„ç»“æ„è¿›è¡Œä¼˜åŒ–ã€‚<br>æˆ‘ä»¬å‘å›¾ä¸­æ·»åŠ å¤šä¸ªè™šç‚¹ï¼Œè¿™äº›ç‚¹æ²¡æœ‰å®é™…æ„ä¹‰ï¼Œæ ¹æ®é¢˜ç›®çš„è¦æ±‚èµ‹ä¸Šå¯¹ç»“æœæ— å½±å“çš„å€¼ã€‚<br>è¿™äº›ç‚¹å¯ä»¥å°†ä¸€ä¸ªç‚¹ä¸å…¶è¿‡å¤šçš„å„¿å­åˆ†å¼€ï¼Œè¾¾åˆ°äºŒå‰æ ‘çš„çº§åˆ«ï¼Œç¡®ä¿äº†è¾¹åˆ†æ²»èƒ½å¤Ÿä¿æŒ $O(n \log n)$ çš„å¤æ‚åº¦ã€‚</p>
<hr>
<p>ï¼ˆéœ€è¦å¤ä¹ ï¼‰</p>
<h1 id="ç‚¹åˆ†æ ‘"><a href="#ç‚¹åˆ†æ ‘" class="headerlink" title="ç‚¹åˆ†æ ‘"></a>ç‚¹åˆ†æ ‘</h1><p>ç‚¹åˆ†æ²»èƒ½è§£å†³å¾ˆå¤šé—®é¢˜ï¼Œä½†æ˜¯å¯¹äºå¸¦ä¿®è¿˜å¤šæ¬¡è¯¢é—®çš„è¿™ç§é—®é¢˜å´ä¸æ˜¯ç‰¹åˆ«æ“…é•¿ã€‚<br>å¦‚æœæˆ‘ä»¬ä¿è¯æ•°æ®æ­£ç¡®æ€§ï¼Œæ¯ä¸€æ¬¡è¯¢é—®éƒ½é‡æ–°è®¡ç®—ä¸€éï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„æ—¶é—´å¤æ‚åº¦å°†ä¼šå˜ä¸º $O(n^2 \log n)$ çº§åˆ«çš„ã€‚</p>
<p>ä½†æ˜¯æœ‰ä¸€ç§æ–¹æ³•å¯ä»¥è§£å†³è¿™æ ·çš„é—®é¢˜ï¼Œé‚£å°±æ˜¯ç‚¹åˆ†æ ‘ã€‚</p>
<p>ç‚¹åˆ†æ ‘å°±æ˜¯å°†ç‚¹åˆ†æ²»çš„è¿‡ç¨‹æ¥å»ºæˆä¸€æ£µæ ‘ï¼Œé€‚ç”¨äºå¸¦ä¿®è¿˜å¤šæ¬¡è¯¢é—®ï¼Œå¹¶ä¸”å¯¹æ ‘çš„ç»“æ„æ²¡æœ‰è¦æ±‚çš„é—®é¢˜ã€‚</p>
<p>æˆ‘ä»¬è€ƒè™‘å°†æ¯ä¸€æ¬¡åˆ†æ²»çš„é—®é¢˜åˆ†ä¸ºä¸¤ç§ï¼Œä¸€ç§æ˜¯ä¸é€‰å®šèŠ‚ç‚¹åœ¨åŒä¸€å­æ ‘å†…çš„ï¼Œä¸€ç§æ˜¯ä¸åœ¨åŒä¸€å­æ ‘å†…çš„ã€‚<br>ä¸åœ¨åŒä¸€å­æ ‘å†…çš„èŠ‚ç‚¹ï¼Œæˆ‘ä»¬è€ƒè™‘ä½¿ç”¨ä¸€ç§ $\log$ çº§åˆ«çš„ç®—æ³•æ¥æ±‚å‡ºæ¥ï¼›<br>åœ¨åŒä¸€ä¸ªå­æ ‘å†…çš„èŠ‚ç‚¹ï¼Œæˆ‘ä»¬è€ƒè™‘ç»§ç»­é€’å½’ã€‚</p>
<p>æœ€åç›´åˆ°é€‰å®šèŠ‚ç‚¹ä¸ºæ­¤æ—¶æ ‘çš„é‡å¿ƒã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿæœ‰ä¸€ä¸ª $\log$ çº§åˆ«çš„ç®—æ³•æ¥æ±‚è§£å‰©ä¸‹çš„é—®é¢˜ã€‚</p>
<p>å› æ­¤ï¼ŒåŠ¨æ€ç‚¹åˆ†æ²»çš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(n \log^2 n)$ çº§åˆ«çš„ã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬ä»¥<span class="exturl" data-url="aHR0cHM6Ly93d3cuYWN3aW5nLmNvbS9wcm9ibGVtL2NvbnRlbnQvMjIyOC8=">AcWing #2261 å¼€åº—<i class="fa fa-external-link-alt"></i></span>,<span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL3Byb2JsZW0vUDMyNDE=">Luogu P3241 HNOI å¼€åº—<i class="fa fa-external-link-alt"></i></span>ä¸ºä¾‹ã€‚</p>
<p>å‚è€ƒä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">150010</span>, M = N &lt;&lt; <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> n, m, A;</span><br><span class="line"><span class="type">int</span> h[N], e[M], w[M], ne[M], idx;</span><br><span class="line"><span class="type">int</span> age[N];</span><br><span class="line"><span class="type">bool</span> st[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Father</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> u, num;</span><br><span class="line">    ll dis;</span><br><span class="line">&#125;;</span><br><span class="line">vector&lt;Father&gt;f[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Son</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> age;</span><br><span class="line">    ll dis;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> Son &amp;a) <span class="type">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> age &lt; a.age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">vector&lt;Son&gt;son[N][<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get_sz</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa)</span><span class="comment">//æ±‚å­æ ‘å¤§å°</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(st[u])<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h[u]; ~i; i = ne[i])</span><br><span class="line">        <span class="keyword">if</span>(e[i] != fa)</span><br><span class="line">            res += <span class="built_in">get_sz</span>(e[i], u);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get_zx</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa, <span class="type">int</span> tot, <span class="type">int</span> &amp;zx)</span><span class="comment">//æ±‚é‡å¿ƒ</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(st[u])<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> sum = <span class="number">1</span>, ms = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h[u]; ~i; i = ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(e[i] == fa)<span class="keyword">continue</span>;</span><br><span class="line">        <span class="type">int</span> t = <span class="built_in">get_zx</span>(e[i], u, tot, zx);</span><br><span class="line">        ms = <span class="built_in">max</span>(ms, t);</span><br><span class="line">        sum += t;</span><br><span class="line">    &#125;</span><br><span class="line">    ms = <span class="built_in">max</span>(ms, tot - sum);</span><br><span class="line">    <span class="keyword">if</span>(ms &lt;= tot / <span class="number">2</span>)zx = u;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_dis</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa, ll dis, <span class="type">int</span> zx, <span class="type">int</span> k, vector&lt;Son&gt; &amp;p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(st[u])<span class="keyword">return</span>;</span><br><span class="line">    f[u].<span class="built_in">push_back</span>(&#123; zx,k,dis &#125;);</span><br><span class="line">    p.<span class="built_in">push_back</span>(&#123; age[u],dis &#125;);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h[u]; ~i; i = ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(e[i] == fa)<span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">get_dis</span>(e[i], u, dis + w[i], zx, k, p);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">calc</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(st[u])<span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">get_zx</span>(u, <span class="number">-1</span>, <span class="built_in">get_sz</span>(u, <span class="number">-1</span>), u);</span><br><span class="line">    st[u] = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h[u], k = <span class="number">0</span>; ~i; i = ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(st[e[i]])<span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">auto</span> &amp;p = son[u][k];</span><br><span class="line">        p.<span class="built_in">push_back</span>(&#123; <span class="number">-1</span>,<span class="number">0</span> &#125;);</span><br><span class="line">        p.<span class="built_in">push_back</span>(&#123; A + <span class="number">1</span>,<span class="number">0</span> &#125;);</span><br><span class="line">        <span class="built_in">get_dis</span>(e[i], <span class="number">-1</span>, w[i], u, k, p);</span><br><span class="line">        k++;</span><br><span class="line">        <span class="built_in">sort</span>(p.<span class="built_in">begin</span>(), p.<span class="built_in">end</span>());</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; p.<span class="built_in">size</span>(); i++)</span><br><span class="line">            p[i].dis += p[i - <span class="number">1</span>].dis;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h[u]; ~i; i = ne[i])<span class="built_in">calc</span>(e[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">query</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;t : f[u])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> g = age[t.u];</span><br><span class="line">        <span class="keyword">if</span>((g &gt;= l) &amp;&amp; (g &lt;= r))res += t.dis;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(i == t.num)<span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">auto</span> &amp;p = son[t.u][i];</span><br><span class="line">            <span class="keyword">if</span>(p.<span class="built_in">empty</span>())<span class="keyword">continue</span>;</span><br><span class="line">            <span class="type">int</span> a = <span class="built_in">lower_bound</span>(p.<span class="built_in">begin</span>(), p.<span class="built_in">end</span>(), <span class="built_in">Son</span>(&#123; l,<span class="number">-1</span> &#125;)) - p.<span class="built_in">begin</span>();</span><br><span class="line">            <span class="type">int</span> b = <span class="built_in">lower_bound</span>(p.<span class="built_in">begin</span>(), p.<span class="built_in">end</span>(), <span class="built_in">Son</span>(&#123; r + <span class="number">1</span>,<span class="number">-1</span> &#125;)) - p.<span class="built_in">begin</span>();</span><br><span class="line">            res += t.dis * (b - a) + p[b - <span class="number">1</span>].dis - p[a - <span class="number">1</span>].dis;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> &amp;p = son[u][i];</span><br><span class="line">        <span class="keyword">if</span>(p.<span class="built_in">empty</span>())<span class="keyword">continue</span>;</span><br><span class="line">        <span class="type">int</span> a = <span class="built_in">lower_bound</span>(p.<span class="built_in">begin</span>(), p.<span class="built_in">end</span>(), <span class="built_in">Son</span>(&#123; l,<span class="number">-1</span> &#125;)) - p.<span class="built_in">begin</span>();</span><br><span class="line">        <span class="type">int</span> b = <span class="built_in">lower_bound</span>(p.<span class="built_in">begin</span>(), p.<span class="built_in">end</span>(), <span class="built_in">Son</span>(&#123; r + <span class="number">1</span>,<span class="number">-1</span> &#125;)) - p.<span class="built_in">begin</span>();</span><br><span class="line">        res += p[b - <span class="number">1</span>].dis - p[a - <span class="number">1</span>].dis;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;A);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;age[i]);</span><br><span class="line">    <span class="built_in">memset</span>(h, <span class="number">-1</span>, <span class="built_in">sizeof</span>(h));</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> a, b, c;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;c);</span><br><span class="line">        <span class="built_in">add</span>(a, b, c);</span><br><span class="line">        <span class="built_in">add</span>(b, a, c);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">calc</span>(<span class="number">1</span>);</span><br><span class="line">    ll res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(m--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> u, a, b;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;u, &amp;a, &amp;b);</span><br><span class="line">        <span class="type">int</span> l = (a + res) % A, r = (b + res) % A;</span><br><span class="line">        <span class="keyword">if</span>(l &gt; r)<span class="built_in">swap</span>(l, r);</span><br><span class="line">        res = <span class="built_in">query</span>(u, l, r);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, res);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


















































































]]></content>
      <categories>
        <category>ç®—æ³•</category>
      </categories>
      <tags>
        <tag>ç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title>è´¨æ•°ç­›æ³•</title>
    <url>/OI/prime-sieves/</url>
    <content><![CDATA[<p>ç®€ä»‹ï¼šè´¨æ•°ç­›</p>
<span id="more"></span>

<p><strong>è´¨æ•°</strong> ã€‚<br>ä¸€ç±»å¾ˆå¥‡å¼‚çš„æ•°å­—ã€‚</p>
<p>è´¨æ•°çš„å®šä¹‰æ˜¯ï¼š<br><strong>â€œåœ¨å¤§äº1çš„è‡ªç„¶æ•°ä¸­ï¼Œé™¤äº†1å’Œå®ƒæœ¬èº«ä»¥å¤–ä¸å†æœ‰å…¶ä»–å› æ•°çš„è‡ªç„¶æ•°ã€‚â€</strong></p>
<p>äºæ˜¯æˆ‘ä»¬å°±å¯ä»¥æƒ³åˆ°ä¸€ä¸ªç®€å•çš„ç®—æ³•æ¥æ±‚ $n$ æ˜¯ä¸æ˜¯è´¨æ•°ï¼š</p>
<h2 id="ç®€å•çš„ç®—æ³•"><a href="#ç®€å•çš„ç®—æ³•" class="headerlink" title="ç®€å•çš„ç®—æ³•"></a>ç®€å•çš„ç®—æ³•</h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt;= <span class="built_in">sqrt</span>(n); i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(n % i == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;ã„ã„ãˆ&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;ã¯ã„&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(\sqrt[]{n})$ ã€‚</p>
<p>ä»£ç å¥½å†™å½’å¥½å†™ï¼Œä½†æ˜¯æ—¶é—´å¤æ‚åº¦çœŸçš„æ˜¯å¤ªé«˜äº†ï¼Œæœ‰æ—¶å€™å¹¶ä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€è¦ï¼›<br>æ›´ä½•å†µæˆ‘ä»¬ç»å¸¸éœ€è¦çš„æ“ä½œæ˜¯æ‰¾å‡º $n$ä»¥å†…çš„æ‰€æœ‰è´¨æ•°ï¼Œè€Œä¸æ˜¯ç®€å•åœ°åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯å¦æ˜¯è´¨æ•°ã€‚</p>
<p>ä»$[1,n]$ èŒƒå›´å†…çš„æ‰€æœ‰æ•´æ•°é‡ŒæŒ‘è´¨æ•°å…¶å®å¾ˆç®€å•ã€‚</p>
<p>å¾ˆå¤šäººå¤§æ¦‚æ¥è§¦è¿‡è¿™æ ·ä¸€ç§æ–¹æ³•ï¼š</p>
<ul>
<li>é¦–å…ˆåˆ—å‡ºæ‰€æœ‰æ•°å­—å¹¶æŒ‰ç…§ä»å¤§åˆ°å°çš„é¡ºåºæ’å¥½ï¼š</li>
</ul>
<p><img src="https://i.loli.net/2021/09/16/9FUrb7uVhWJ3da2.png"></p>
<ul>
<li>ç„¶åæ‹¿å‡ºäº”é¢œå…­è‰²çš„å½©ç¬”ï¼Œå¼€å§‹å¯¹æ•°æ®è¿›è¡Œå¤„ç†ã€‚</li>
<li>$1$ æ—¢ä¸æ˜¯è´¨æ•°ä¹Ÿä¸æ˜¯åˆæ•°ï¼Œæå‰æŠŠå®ƒå‰”é™¤</li>
</ul>
<p><img src="https://i.loli.net/2021/09/16/ZrR3XAqTa46xGHI.png"></p>
<ul>
<li>ç„¶åçœ‹æ•°åˆ—çš„ç¬¬ä¸€ä¸ªæ•°ï¼š $2$ ã€‚æ‹¿ç¬”åœˆå‡º2ï¼Œå¹¶ä¸”åˆ’æ‰2çš„æ‰€æœ‰å€æ•°ï¼ˆä¹Ÿå°±æ˜¯æ‰€æœ‰å‰©ä¸‹çš„å¶æ•°ï¼‰ã€‚</li>
</ul>
<p><img src="https://i.loli.net/2021/09/16/8R3H9v1YntmDB6N.png"></p>
<ul>
<li>æ•°åˆ—çš„ä¸‹ä¸€ä¸ªæ•°æ˜¯ $3$ ã€‚æ¢ä¸ªé¢œè‰²çš„ç¬”åœˆå‡º3ï¼Œå¹¶åˆ’æ‰æ‰€æœ‰å‰©ä¸‹çš„3çš„å€æ•°ã€‚</li>
</ul>
<p><img src="https://i.loli.net/2021/09/16/hDGu9gJq4dcfPsw.png"></p>
<ul>
<li>è¶Šè¿‡è¢«åˆ’æ‰çš„4ï¼Œä¸‹ä¸€ä¸ªæ•°æ˜¯ $5$ ã€‚æ“ä½œæˆ‘å°±ä¸ç”¨è¯´äº†å§ã€‚</li>
</ul>
<p><img src="https://i.loli.net/2021/09/16/p8vdWwcxgi32ZuV.png"></p>
<ul>
<li>ä¸‹ä¸€ä¸ªæ˜¯ $7$ ã€‚</li>
</ul>
<p><img src="https://i.loli.net/2021/09/16/nHqIJQ2uEKRs9if.png"></p>
<ul>
<li>è¶Šè¿‡8,9å’Œ10ï¼Œæˆ‘ä»¬æ¥åˆ°äº† $11$ ã€‚ç”±äº11å¤§äº $\sqrt[]{100}$ ï¼Œä¹Ÿå°±æ˜¯10ï¼Œæˆ‘ä»¬å°±åœæ­¢æ“ä½œï¼Œæ¢ä¸€ä¸ªé¢œè‰²çš„ç¬”ï¼Œåœˆå‡ºå‰©ä¸‹çš„æ‰€æœ‰æ•°ã€‚</li>
</ul>
<p><img src="https://i.loli.net/2021/09/16/XGn68kx5Cp9iVoe.png"></p>
<ul>
<li>æ“¦æ‰æ‰€æœ‰åˆ’å»çš„æ•°ï¼Œæˆ‘ä»¬å¾—åˆ°äº†100ä»¥å†…çš„æ‰€æœ‰è´¨æ•°ã€‚</li>
</ul>
<p><img src="https://i.loli.net/2021/09/16/cJADHQ4t73sPj61.png"></p>
<p>å¦‚æœæˆ‘ä»¬å°†è¿™ä¸ªæ“ä½œç”¨ä»£ç æ¥å®ç°ï¼Œé‚£å°±æ˜¯ï¼š</p>
<h2 id="åŸƒæ°ç­›"><a href="#åŸƒæ°ç­›" class="headerlink" title="åŸƒæ°ç­›"></a>åŸƒæ°ç­›</h2><p><strong>åŸƒæ°ç­›</strong> ï¼Œæˆ–è€…å«åš <strong>åŸƒæ‹‰æ‰˜æ–¯ç‰¹å°¼ç­›æ³•</strong> ï¼Œåˆ©ç”¨çš„å°±æ˜¯è¿™ç§æ€æƒ³ã€‚</p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> n;</span><br><span class="line">cin &gt;&gt; n;</span><br><span class="line"><span class="type">bool</span> visit[n];</span><br><span class="line"><span class="built_in">memset</span>(visit, <span class="literal">false</span>, n);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!visit[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(n &lt; i * i)<span class="keyword">break</span>;<span class="comment">//åŸƒæ°ç­›åªéœ€è¦å‰”é™¤æ ¹å·nä»¥å†…çš„ç´ æ•°çš„å€æ•° </span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = i * i; j &lt;= n; j += i)visit[j] = <span class="literal">true</span>;<span class="comment">//æ ‡è®°è´¨æ•°</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!visit[i])cout &lt;&lt; i &lt;&lt; endl;<span class="comment">//è¾“å‡º </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åŸƒæ°ç­›æ³•çš„æ—¶é—´å¤æ‚åº¦åªæœ‰ $O(n \log \log n)$ ã€‚æ¯”èµ·ç®€å•æ–¹æ³•çš„ $O(\sqrt{n})$ï¼ŒåŸƒæ°ç­›æ³•æ˜æ˜¾å¿«äº†å¾ˆå¤šã€‚</p>
<p>ä½†æ˜¯ï¼ŒåŸƒæ°ç­›æ³•è¿˜å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–ã€‚</p>
<p>ä¸¾ä¸ªæ —å­ï¼š</p>
<p>æ•°å­— $223092870$ å¯ä»¥è¢«åˆ†è§£æˆ $2 \times 3 \times 5 \times 7 \times 11 \times 13 \times 17 \times 19 \times 23$ ï¼Œåœ¨åŸƒæ°ç­›æ³•ä¸­ä¼šè¢«æœç´¢9æ¬¡ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªæ•°è¢«æœç´¢åˆ°çš„ç¬¬ä¸€æ¬¡å°±æ ‡è®°å¥½ï¼Œå¹¶ä¸”ä½¿å¾—è¿™ä¸ªæ•°åœ¨ä¹‹åçš„è¿‡ç¨‹ä¸­ä¸ä¼šè¢«å†æ¬¡æœç´¢åˆ°ï¼Œæˆ‘ä»¬ç®—æ³•çš„é€Ÿåº¦å°±ä¼šå¿«å¾ˆå¤šã€‚</p>
<p>é‚£ä¹ˆå¦‚ä½•å®ç°è¿™ä¸€æƒ³æ³•å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬ç»§ç»­æ‹¿ $223092870$ æ¥ä¸¾ä¾‹ã€‚å¦‚æœæˆ‘ä»¬åœ¨å¼€å§‹åˆ¤æ–­ä¹‹å‰å°±ç”¨ <strong>&amp;1</strong> çš„æ–¹æ³•æ¥å»æ‰æ‰€æœ‰å¶æ•°å‘¢ï¼Ÿ</p>
<p>æ˜¾ç„¶ä¼šå¿«å¾ˆå¤šã€‚ä½†æ˜¯ï¼Œç±»ä¼¼ $4849845$  ( $3 \times 5 \times 7 \times 11 \times 13 \times 17 \times 19$ )</p>
<p>è¿™æ ·çš„æ•°ä»ç„¶ä¼šè¢«ä¸å¯é¿å…åœ°æœç´¢åˆ°å¤šæ¬¡ã€‚</p>
<p>ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬ä¿è¯ $4849845$ è¿™ä¸ªæ•°åªåœ¨è¢«åˆ†è§£æˆ $3 \times 1616615$ çš„æ—¶å€™è¢«æœç´¢åˆ°å¹¶æ ‡è®°ä¸ºåˆæ•°ï¼Œå°±å¯ä»¥å®ç°è¿™ä¸ªæƒ³æ³•ã€‚</p>
<p>äºæ˜¯ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†ä¸€ç§ç®—æ³•ï¼š</p>
<h2 id="æ¬§æ‹‰ç­›"><a href="#æ¬§æ‹‰ç­›" class="headerlink" title="æ¬§æ‹‰ç­›"></a>æ¬§æ‹‰ç­›</h2><p><strong>æ¬§æ‹‰ç­›</strong> ï¼Œåˆå« <strong>çº¿æ€§ç­›</strong> ï¼Œåœ¨åŸƒæ°ç­›çš„åŸºç¡€ä¸Šè¿›è¡Œäº†ä¼˜åŒ–ï¼Œä½¿å¾—æ¯ä¸ªæ•°è¢«ä¸”åªè¢«æœç´¢åˆ°ä¸€æ¬¡ã€‚ </p>
<p>æ¬§æ‹‰ç­›åˆ©ç”¨åˆæ•°çš„ <strong>æœ€å°è´¨å› å­</strong> è¿›è¡Œç­›é€‰ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥æ‰“è¡¨çœ‹ä¸€ä¸‹100ä»¥å†…çš„åˆæ•°æ˜¯æ€ä¹ˆè¢«æ¨å‡ºæ¥çš„ã€‚</p>
<p><img src="https://i.loli.net/2021/09/16/Vw8liybKC4zX6NO.png" alt="2~22"></p>
<p><img src="https://i.loli.net/2021/09/16/fiZtvQesKYVyunW.png" alt="23~50">ã€</p>
<p>å½“ $i&gt;50$ ä¹‹åï¼Œå› ä¸º $i\times 2$ å·²ç»è¶…å‡º100è¿™ä¸ªèŒƒå›´ï¼Œæ— æ³•æ¨å‡ºä»»ä½•æ›´å¤šçš„èŒƒå›´å†…çš„åˆæ•°ã€‚</p>
<p>é™„ä¸Šä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">long</span> <span class="type">long</span> n;</span><br><span class="line">cin &gt;&gt; n;</span><br><span class="line"><span class="type">int</span> prime[n];</span><br><span class="line"><span class="type">bool</span> visit[n];</span><br><span class="line"><span class="built_in">memset</span>(prime, <span class="number">0</span>, n);</span><br><span class="line"><span class="built_in">memset</span>(visit, <span class="literal">false</span>, n);</span><br><span class="line">prime[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">long</span> <span class="type">long</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!visit[i])</span><br><span class="line">    &#123;</span><br><span class="line">        prime[prime[<span class="number">0</span>] + <span class="number">1</span>] = i;</span><br><span class="line">        prime[<span class="number">0</span>]++;<span class="comment">//è®°å½•è´¨æ•° </span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">long</span> <span class="type">long</span> j = <span class="number">1</span>; j &lt;= prime[<span class="number">0</span>] &amp;&amp; i * prime[j] &lt;= n; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        visit[i * prime[j]] = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span>(i % prime[j] == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">break</span>;<span class="comment">//åˆ¤æ–­æ˜¯å¦æ˜¯æœ€å°è´¨å› å­ </span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">long</span> <span class="type">long</span> i = <span class="number">1</span>; i &lt;= prime[<span class="number">0</span>]; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(n % prime[i] == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        visit[n] = <span class="literal">true</span>;</span><br><span class="line">    &#125;<span class="comment">//æœ€åä¸€ä¸ªä¸€èˆ¬ç­›ä¸å‡ºæ¥ï¼Œç‰¹åˆ¤ä¸€ä¸‹ </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">long</span> <span class="type">long</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!visit[i])</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; i &lt;&lt; endl;<span class="comment">//è¾“å‡º </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æ¬§æ‹‰ç­›</strong> çš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(n)$ ï¼ˆæ‰€ä»¥è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®ƒä¹Ÿå« <strong>çº¿æ€§ç­›</strong> ï¼‰ï¼Œåœ¨æ•°æ®é‡å¾ˆå¤§çš„æ—¶å€™ï¼Œé€Ÿåº¦ä¼šæ¯”åŸƒæ°ç­›å¿«å¾ˆå¤šã€‚</p>
<p>å¦‚æœéœ€è¦æ›´ç›´è§‚ä¸€ç‚¹çš„è¯ï¼Œå¯ä»¥çœ‹è¿™ä¸ªåŠ¨ç”»ï¼š</p>
<p><img src="https://i.loli.net/2021/10/08/fT1mI9ulFgQUobs.gif" alt="è´¨æ•°.gif"></p>
<p>2å€é€Ÿç‰ˆï¼š</p>
<p><img src="https://i.loli.net/2021/10/08/Vw6ugo5ZEvmORB3.gif" alt="è´¨æ•°2x.gif"></p>
<hr>
<p>å½“ $n$ å¾ˆå¤§çš„æ—¶å€™ï¼Œæ‰¾å‡º$n$ä»¥å†…çš„æ‰€æœ‰è´¨æ•°å·²ç»ä¸å¤ªç°å®äº†ã€‚ä½†æ˜¯ï¼Œåˆ¤æ–­ $n$ æ˜¯å¦ä¸ºè´¨æ•°ä»ç„¶æ˜¯ä¸€ç§ <del>ï¼ˆçœ‹èµ·æ¥ï¼‰</del> å¯è¡Œçš„æ“ä½œã€‚</p>
<p>è¿™å°±ç”¨åˆ°äº†ï¼š</p>
<h2 id="Miller-Rabin-ç®—æ³•"><a href="#Miller-Rabin-ç®—æ³•" class="headerlink" title="$Miller-Rabin$ ç®—æ³•"></a>$Miller-Rabin$ ç®—æ³•</h2><p>$Miller-Rabin$ ç®—æ³•æ¶‰åŠäº†ä¸¤ä¸ªå®šç†ï¼š</p>
<h3 id="è´¹é©¬å°å®šç†"><a href="#è´¹é©¬å°å®šç†" class="headerlink" title="è´¹é©¬å°å®šç†"></a>è´¹é©¬å°å®šç†</h3><p>è´¹é©¬å°å®šç†æ˜¯è¿™æ ·çš„ï¼š</p>
<blockquote>
<p>å¯¹äºè´¨æ•° $p$ å’Œä»»æ„æ•´æ•° $a$ ï¼Œæœ‰ $a^p\equiv a\pmod{p}$ã€‚</p>
</blockquote>
<p>è¿™é‡Œæˆ‘ä»¬éœ€è¦ç”¨çš„æ˜¯å®ƒçš„é€†å®šç†ï¼Œå³</p>
<blockquote>
<p>è‹¥æ»¡è¶³ $a^p\equiv a\pmod{p}$ ï¼Œ $p$ ä¸ºè´¨æ•°ã€‚<br>æ­¤æ—¶æˆ‘ä»¬ä¸¤è¾¹åŒæ—¶çº¦å»ä¸€ä¸ª $a$ ï¼Œå¾— $a^{p-1} \equiv 1\pmod{p}$ã€‚</p>
</blockquote>
<p>å¾ˆé—æ†¾ï¼Œè´¹é©¬å°å®šç†çš„é€†å®šç†ä¸æ˜¯ä¸ªçœŸå‘½é¢˜ï¼Œä½†æ»¡è¶³æ¡ä»¶çš„ $p$ è¿˜æ˜¯æœ‰å¾ˆå¤§æ¦‚ç‡æ˜¯è´¨æ•°çš„ã€‚</p>
<p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬é€‰å–ä¸åŒçš„ $a$ è¿›è¡Œå¤šæ¬¡æµ‹è¯•ï¼Œé‚£ä¹ˆæˆ‘ä»¬å‡ ä¹å°±å¯ä»¥æ–­å®šè¿™ä¸ªæ•°æ˜¯ä¸€ä¸ªè´¨æ•°äº†ã€‚</p>
<h3 id="äºŒæ¬¡æ¢æµ‹å®šç†"><a href="#äºŒæ¬¡æ¢æµ‹å®šç†" class="headerlink" title="äºŒæ¬¡æ¢æµ‹å®šç†"></a>äºŒæ¬¡æ¢æµ‹å®šç†</h3><blockquote>
<p>å¦‚æœ $p$ æ˜¯å¥‡ç´ æ•°ï¼Œåˆ™ $x^2\equiv 1\pmod{p}$ çš„è§£ä¸º $x\equiv 1$ æˆ– $x\equiv p-1\pmod{p}$ ã€‚</p>
</blockquote>
<p>è¿™æ˜¯å¾ˆå®¹æ˜“è¯æ˜çš„ï¼š</p>
<p>$$<br>\begin{array}<br>x^2 \equiv 1 \pmod{p} \\<br>x^2-1 \equiv 0 \pmod{p} \\<br>(x-1)(x+1) \equiv 0 \pmod{p}<br>\end{array}<br>$$</p>
<blockquote>
<p>åˆâˆµ $p$ ä¸ºå¥‡ç´ æ•°ï¼Œå…¶å› å­åªæœ‰ $1$ ä¸ $p$ ä¸¤ä¸ªã€‚<br>âˆ´åªæœ‰ä¸¤è§£ $x\equiv 1$ ä¸ $x\equiv p-1 \pmod{p}$ ã€‚</p>
</blockquote>
<p>å¦‚æœ $a^{nâˆ’1}\equiv 1\pmod{n}$ æˆç«‹ï¼Œ$Millerâˆ’Rabin$ ç®—æ³•ä¸æ˜¯ç«‹å³æ‰¾å¦ä¸€ä¸ª $a$ è¿›è¡Œæµ‹è¯•ï¼Œè€Œæ˜¯çœ‹ $nâˆ’1$ æ˜¯ä¸æ˜¯å¶æ•°ã€‚å¦‚æœ $nâˆ’1$ æ˜¯å¶æ•°ï¼Œå¦ $u&#x3D;\dfrac{n-1}{2}$ ï¼Œå¹¶æ£€æŸ¥æ˜¯å¦æ»¡è¶³äºŒæ¬¡æ¢æµ‹å®šç†å³ $a^u\equiv 1$ æˆ– $a^u\equiv nâˆ’1 \pmod{n}$ ã€‚</p>
<p>å°†è¿™ä¸¤æ¡å®šç†åˆèµ·æ¥ï¼Œä¹Ÿå°±æ˜¯æœ€å¸¸è§çš„ Millerâˆ’Rabin æµ‹è¯• ã€‚</p>
<p>å•æ¬¡æ—¶é—´å¤æ‚åº¦æ˜¯ $O(\log n)$ ï¼Œæ€»å¤æ‚åº¦å°±æ˜¯ $O(times\times \log n)$ äº†ã€‚</p>
<p>å‚è€ƒä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long </span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">char</span> c = <span class="built_in">getchar</span>(); <span class="type">int</span> x = <span class="number">0</span>, f = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(c &lt; <span class="string">&#x27;0&#x27;</span> || c &gt; <span class="string">&#x27;9&#x27;</span>) &#123; <span class="keyword">if</span>(c == <span class="string">&#x27;-&#x27;</span>) f = <span class="number">-1</span>; c = <span class="built_in">getchar</span>(); &#125;</span><br><span class="line">    <span class="keyword">while</span>(c &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span>) x = x * <span class="number">10</span> + c - <span class="string">&#x27;0&#x27;</span>, c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">return</span> x * f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> N, M, Test[<span class="number">10</span>] = &#123; <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">17</span> &#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">pow</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> p, <span class="type">int</span> mod)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> base = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(; p; p &gt;&gt;= <span class="number">1</span>, a = (<span class="number">1ll</span> * a * a) % mod)</span><br><span class="line">        <span class="keyword">if</span>(p &amp; <span class="number">1</span>) base = (<span class="number">1ll</span> * base * a) % mod;</span><br><span class="line">    <span class="keyword">return</span> base % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">Query</span><span class="params">(<span class="type">int</span> P)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(P == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> t = P - <span class="number">1</span>, k = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(!(t &amp; <span class="number">1</span>)) k++, t &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(P == Test[i]) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        ll a = <span class="built_in">pow</span>(Test[i], t, P), nxt = a;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= k; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            nxt = (a * a) % P;</span><br><span class="line">            <span class="keyword">if</span>(nxt == <span class="number">1</span> &amp;&amp; a != <span class="number">1</span> &amp;&amp; a != P - <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            a = nxt;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(a != <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    N = <span class="built_in">read</span>(); M = <span class="built_in">read</span>();</span><br><span class="line">    <span class="keyword">while</span>(M--) <span class="built_in">puts</span>(<span class="built_in">Query</span>(<span class="built_in">read</span>()) ? <span class="string">&quot;Yes&quot;</span> : <span class="string">&quot;No&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vendmeW1xei9wLzgxNTA5NjkuaHRtbA==">$\blacktriangleright$<i class="fa fa-external-link-alt"></i></span></p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ ç¬”è®°</tag>
        <tag>ç®—æ³•</tag>
        <tag>æ•°è®º</tag>
      </tags>
  </entry>
  <entry>
    <title>æ‰«æçº¿</title>
    <url>/OI/scanning-line/</url>
    <content><![CDATA[<p>ä¸€ç§ä¾¿æºçš„ç”¨æ¥æ±‚çŸ©å½¢é¢ç§¯å¹¶çš„ç®—æ³•ã€‚</p>
<span id="more"></span>

<h1 id="æ€æƒ³"><a href="#æ€æƒ³" class="headerlink" title="æ€æƒ³"></a>æ€æƒ³</h1><p>é¡¾åæ€ä¹‰ï¼Œæ‰«æçº¿å°±æ˜¯è¦æ¨¡æ‹Ÿä¸€æ ¹çº¿ï¼Œæ‰«è¿‡æ•´ä¸ªå›¾å½¢ã€‚è‡³äºæ–¹å‘ä»€ä¹ˆçš„è‡ªå·±æ ¹æ®å–œå¥½ï¼Œè¿™é‡Œé€‰ç”¨ä»å·¦å¾€å³çš„æ–¹å¼ã€‚</p>
<h1 id="è¿‡ç¨‹"><a href="#è¿‡ç¨‹" class="headerlink" title="è¿‡ç¨‹"></a>è¿‡ç¨‹</h1><h2 id="æœ´ç´ åšæ³•"><a href="#æœ´ç´ åšæ³•" class="headerlink" title="æœ´ç´ åšæ³•"></a>æœ´ç´ åšæ³•</h2><p>é¦–å…ˆæˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™ä¸ªä¾‹å­ï¼š</p>
<img src="https://i.loli.net/2021/11/12/ykmlLC6RpHTZbUf.png" alt="æ‰«æçº¿1.png" width="60%" />

<p>æˆ‘ä»¬æœ‰ä¸‰ä¸ªçŸ©å½¢ï¼Œåˆ†åˆ«ç”¨çº¢ã€è“ã€ç»¿ä¸‰è‰²æ ‡æ³¨äº†å‡ºæ¥ã€‚<br>ä»–ä»¬ç›¸äº¤çš„é¢ç§¯ç”¨å…¶ä»–çš„é¢œè‰²æ ‡äº†å‡ºæ¥ã€‚</p>
<p>æˆ‘ä»¬æ‰€å¾—åˆ°çš„ä¿¡æ¯åªæœ‰çŸ©å½¢çš„å·¦ä¸‹ç«¯ç‚¹å’Œå³ä¸Šç«¯ç‚¹çš„åæ ‡ã€‚ä¹Ÿå°±æ˜¯æˆ‘ä»¬æ ‡çº¢çš„è¿™å‡ ä¸ªç‚¹ï¼š</p>
<img src="https://i.loli.net/2021/11/12/Naw9ZzMXnA6Jt7d.png" alt="æ‰«æçº¿2.png" width="60%" />

<p>ç„¶åæˆ‘ä»¬å¯ä»¥ç”»å‡ºä¸€æ ¹çº¿æ¥ï¼Œæ‰«è¿‡è¿™ä¸ªå¤šè¾¹å½¢çš„æ‰€æœ‰é¢ç§¯ã€‚<br>è¿™æ ¹çº¿ä»æœ€å·¦è¾¹çš„è¾¹å¼€å§‹ï¼Œæ¯é‡åˆ°ä¸€æ¡è¾¹ï¼Œå°±åœä¸‹æ¥è®¡ç®—ä¹‹å‰æ‰«åˆ°çš„é¢ç§¯ï¼Œå³ä¸ºè·ä¸Šä¸€æ¡è¾¹çš„è·ç¦»ä¸æ‰«æçº¿è½åœ¨å›¾å½¢ä¸Šçš„é•¿åº¦ä¹‹ç§¯ï¼Œå†åŠ åˆ°ä¹‹å‰çš„å’Œä¸Šé¢ã€‚<br>ç”¨åŠ¨ç”»æ¥åšå°±æ˜¯è¿™æ ·çš„ï¼š</p>
<img src="https://s2.loli.net/2021/12/29/zsg32tJnWbykfBo.gif" alt="æ‰«æçº¿3.gif" width="60%" />

<p>ä½†æ˜¯è¿™æ ·åšæœ‰ä¸€å¤„éœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼š <strong>æˆ‘ä»¬æ€ä¹ˆæ‰èƒ½çŸ¥é“æ¯ä¸€æ¬¡é‡åˆ°ä¸€æ¡è¾¹ä¹‹åæ‰«æçº¿è½åœ¨å›¾åƒä¸Šçš„é•¿åº¦æ˜¯å¤šå°‘</strong> ï¼Ÿ<br>å¦‚æœæˆ‘ä»¬æ¯ä¸€æ¬¡éƒ½å»æšä¸¾ã€å»æ‰¾ï¼Œæˆ‘ä»¬ç¨‹åºçš„æ—¶é—´å¤æ‚åº¦å°±è¾¾ä¸åˆ°æˆ‘ä»¬çš„è¦æ±‚äº†ã€‚<br>è¿™å°±æ˜¯æ‰«æçº¿ç®—æ³•çš„ç²¾é«“ä¹‹å¤„ã€‚</p>
<h2 id="çº¿æ®µæ ‘"><a href="#çº¿æ®µæ ‘" class="headerlink" title="çº¿æ®µæ ‘"></a>çº¿æ®µæ ‘</h2><h3 id="åˆ†æ®µ"><a href="#åˆ†æ®µ" class="headerlink" title="åˆ†æ®µ"></a>åˆ†æ®µ</h3><p>æˆ‘ä»¬æŠŠ $y$ è½´ä¸Šçš„ä¸€æ®µåŒºé—´æŒ‰ç…§æ¯ä¸€ä¸ªå­˜åœ¨çš„çŸ©å½¢çš„è¾¹çš„é«˜åº¦å€¼åˆ†ä¸€ä¸‹å—ï¼š</p>
<img src="https://i.loli.net/2021/11/12/pkELge24OblfDxI.png" alt="æ‰«æçº¿4.png" width="60%" />

<p>æˆ‘ä»¬åªéœ€è¦è®¡ç®—æ¯ä¸€æ®µæ‰€å¯¹åº”çš„åœ¨ $x$ è½´ä¸Šçš„é•¿åº¦å°±è¡Œäº†ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨çº¿æ®µæ ‘è¿™ä¸€å¼ºå¤§çš„æ•°æ®ç»“æ„æ¥å¸®åŠ©æˆ‘ä»¬æ›´å¿«åœ°è¿›è¡ŒåŒºé—´ä¿®æ”¹ã€‚</p>
<img src="https://i.loli.net/2021/11/12/W3OLxhVenapUIfH.png" alt="æ‰«æçº¿5.png" width="60%" />

<h3 id="æ ‡è®°"><a href="#æ ‡è®°" class="headerlink" title="æ ‡è®°"></a>æ ‡è®°</h3><p>æˆ‘ä»¬åœ¨é‡åˆ°æŸä¸ªçŸ©å½¢çš„ä¸€æ¡è¾¹çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦çœ‹ä¸€ä¸‹è¿™ä¸¤ä¸ªä¸œè¥¿ï¼š</p>
<ol>
<li>å®ƒçš„é•¿åº¦ï¼›</li>
<li>ä»–æ˜¯èµ·å§‹è¾¹è¿˜æ˜¯ç»ˆæ­¢è¾¹ã€‚</li>
</ol>
<p>å¦‚æœæ˜¯èµ·å§‹è¾¹çš„è¯ï¼Œæˆ‘ä»¬æŠŠä»–è¿™æ¡è¾¹æ‰€åŒ…å«çš„æ‰€æœ‰åŒºå—éƒ½æ‰“ä¸Šä¸€ä¸ªæ ‡è®°ï¼›å¦‚æœæ˜¯ç»ˆæ­¢è¾¹çš„è¯ï¼Œæˆ‘ä»¬å°±æŠŠä¹‹å‰èµ·å§‹è¾¹æ‰“ä¸Šçš„æ ‡è®°å»æ‰ã€‚è¿™æ ·ï¼Œåªè¦æœ‰æ ‡è®°å°±æ˜¯å­˜åœ¨ï¼Œä¸ç®¡æœ‰å¤šå°‘ä¸ªï¼›æ²¡æœ‰æ ‡è®°å°±æ˜¯æ²¡æœ‰è¢«è¦†ç›–ï¼Œå¿½ç•¥ä¸è®¡ã€‚<br>æ‰€ä»¥ï¼Œæˆ‘ä»¬çš„çº¿æ®µæ ‘èŠ‚ç‚¹éœ€è¦å­˜å‚¨è¿™ä¸ªåŒºæ®µè¢«æ ‡è®°çš„æ¬¡æ•°ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å­˜å‚¨åŸºæœ¬çš„çº¿æ®µæ ‘ä¿¡æ¯ï¼Œè¿˜æœ‰å®ƒçš„é•¿åº¦ã€‚<br>åŒæ—¶ï¼Œæˆ‘ä»¬ç”¨æ¥å­˜å‚¨çŸ©å½¢è¾¹çš„ä½ç½®æˆ‘ä»¬ä¹Ÿéœ€è¦æ”¹ä¸€ä¸‹ï¼Œä½¿ä¹‹èƒ½å¤Ÿå­˜å‚¨è¿™æ¡è¾¹çš„ä¸Šç«¯ç‚¹å’Œä¸‹ç«¯ç‚¹ï¼Œè¿˜è¦æ ‡è®°è¿™æ¡è¾¹æ˜¯èµ·å§‹è¾¹è¿˜æ˜¯ç»ˆæ­¢è¾¹ã€‚<br>æœ€ç»ˆæˆ‘ä»¬ä½¿ç”¨åŠ¨ç”»æ¨¡æ‹Ÿä¸€ä¸‹å°±æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š</p>
<img src="https://s2.loli.net/2021/12/29/UEmq4XVFOWL56eo.gif" alt="æ‰«æçº¿6.gif" width="60%" />

<h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h1><p>ä¸Šä»£ç ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1000010</span>;</span><br><span class="line"><span class="type">int</span> n, cnt = <span class="number">0</span>;</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> lf, rt, tp, bt, a[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ScanLine</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> l, r, h;</span><br><span class="line">    <span class="type">int</span> mark;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> ScanLine &amp;a) <span class="type">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> h &lt; a.h;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; line[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SegTree</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> l, r, sum;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> len;</span><br><span class="line">&#125; tree[N &lt;&lt; <span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tree[p].l = l;</span><br><span class="line">    tree[p].r = r;</span><br><span class="line">    tree[p].len = <span class="number">0</span>;</span><br><span class="line">    tree[p].sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(l == r)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">build</span>(p &lt;&lt; <span class="number">1</span>, l, mid);</span><br><span class="line">    <span class="built_in">build</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> l = tree[p].l, r = tree[p].r;</span><br><span class="line">    <span class="keyword">if</span>(tree[p].sum)</span><br><span class="line">    &#123;</span><br><span class="line">        tree[p].len = a[r + <span class="number">1</span>] - a[l];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        tree[p].len = tree[p &lt;&lt; <span class="number">1</span>].len + tree[p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].len;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">mark</span><span class="params">(<span class="type">int</span> p, <span class="type">long</span> <span class="type">long</span> L, <span class="type">long</span> <span class="type">long</span> R, <span class="type">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> l = tree[p].l, r = tree[p].r;</span><br><span class="line">    <span class="keyword">if</span>(a[r + <span class="number">1</span>] &lt;= L || R &lt;= a[l])</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= a[l] &amp;&amp; a[r + <span class="number">1</span>] &lt;= R)</span><br><span class="line">    &#123;</span><br><span class="line">        tree[p].sum += c;</span><br><span class="line">        <span class="built_in">pushup</span>(p);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">mark</span>(p &lt;&lt; <span class="number">1</span>, L, R, c);</span><br><span class="line">    <span class="built_in">mark</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, L, R, c);</span><br><span class="line">    <span class="built_in">pushup</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld%lld%lld&quot;</span>, &amp;lf, &amp;bt, &amp;rt, &amp;tp);</span><br><span class="line">        a[<span class="number">2</span> * i - <span class="number">1</span>] = lf;</span><br><span class="line">        a[<span class="number">2</span> * i] = rt;</span><br><span class="line">        line[<span class="number">2</span> * i - <span class="number">1</span>] = &#123; lf, rt, bt, <span class="number">1</span> &#125;;</span><br><span class="line">        line[<span class="number">2</span> * i] = &#123; lf, rt, tp, <span class="number">-1</span> &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    n &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">sort</span>(line + <span class="number">1</span>, line + n + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">sort</span>(a + <span class="number">1</span>, a + n + <span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> tot = <span class="built_in">unique</span>(a + <span class="number">1</span>, a + n + <span class="number">1</span>) - a - <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, tot - <span class="number">1</span>);</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">mark</span>(<span class="number">1</span>, line[i].l, line[i].r, line[i].mark);</span><br><span class="line">        ans += tree[<span class="number">1</span>].len * (line[i + <span class="number">1</span>].h - line[i].h);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>ç®—æ³•</category>
      </categories>
      <tags>
        <tag>ç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title>åç¼€æ•°ç»„</title>
    <url>/OI/suffix-array/</url>
    <content><![CDATA[<p>åç¼€æ•°ç»„(SA)ã€‚</p>
<span id="more"></span>

<p>åç¼€æ•°ç»„ä¸»è¦ç»´æŠ¤çš„æ˜¯ä¸¤ä¸ªæ•°ç»„ï¼š<code>sa[]</code>å’Œ<code>rk[]</code>ã€‚<br>å…¶ä¸­ï¼Œ<code>sa[i]</code>è¡¨ç¤ºå°†æ‰€æœ‰åç¼€è¿›è¡Œæ’åºä¹‹åç¬¬ $i$ å°çš„åç¼€çš„ç¼–å·ï¼Œ<code>rk[i]</code>è¡¨ç¤ºç¬¬ $i$ ä¸ªåç¼€çš„æ’åæ˜¯å¤šå°‘ã€‚</p>
<p>æˆ‘ä»¬å®¹æ˜“çœ‹å‡ºï¼Œsaå’Œrkä¸¤ä¸ªæ•°ç»„äº’ç›¸æŒ‡å‘å¯¹æ–¹ï¼Œå³<code>sa[rk[i]]=rk[sa[i]]=i</code>ã€‚</p>
<h1 id="æ’åº"><a href="#æ’åº" class="headerlink" title="æ’åº"></a>æ’åº</h1><p>æˆ‘ä»¬çŸ¥é“äº†åç¼€æ•°ç»„ç»´æŠ¤çš„ä¸»è¦ä¿¡æ¯äº†ï¼Œå°±å¯ä»¥å¼€å§‹æ’åºäº†ã€‚<br>æˆ‘ä»¬å®šä¹‰ç©ºå­—ç¬¦æ¯”ä»»ä½•å­—ç¬¦éƒ½è¦å°ï¼Œè¿™æ ·ä¿è¯äº†é•¿åº¦ä¸åŒçš„åç¼€å¯ä»¥è¿›è¡Œæ’åºã€‚</p>
<h2 id="O-n-2-log-n-åšæ³•"><a href="#O-n-2-log-n-åšæ³•" class="headerlink" title="$O(n^2 \log n)$ åšæ³•"></a>$O(n^2 \log n)$ åšæ³•</h2><p>æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨<code>string</code>æ¥å­˜å‚¨æ•°æ®ï¼Œä¹‹åä½¿ç”¨<code>sort</code>å‡½æ•°æ¥è¿›è¡Œæ’åºã€‚<br>ç”±äºæ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²çš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(n)$ çš„ï¼Œæ‰€ä»¥æ€»çš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(n^2 \log n)$ çš„ã€‚</p>
<h2 id="O-n-log-2-n-åšæ³•"><a href="#O-n-log-2-n-åšæ³•" class="headerlink" title="$O(n \log^2 n)$ åšæ³•"></a>$O(n \log^2 n)$ åšæ³•</h2><p>æˆ‘ä»¬è€ƒè™‘å€å¢ä¼˜åŒ–æ’åºã€‚</p>
<p>æˆ‘ä»¬é¦–å…ˆå¯¹é•¿åº¦è¾ƒå°çš„åç¼€è¿›è¡Œæ’åºï¼Œä¹‹åå°†å·²ç»æ’å¥½åºçš„å­ä¸²å½“åšç¬¬äºŒå…³é”®å­—è¿›è¡Œæ’åºã€‚æ¯ä¸€æ¬¡çš„ç¬¬äºŒå…³é”®å­—çš„é•¿åº¦æ˜¯å€å¢çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¼˜åŒ–å‡ºæ¥ä¸€ä¸ªlogã€‚</p>
<details class="note default"><summary><p>å‚è€ƒä»£ç  from OI Wiki</p>
</summary>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1000010</span>;</span><br><span class="line"><span class="type">char</span> s[N];</span><br><span class="line"><span class="type">int</span> n, w, sa[N], rk[N &lt;&lt; <span class="number">1</span>], oldrk[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="comment">// ä¸ºäº†é˜²æ­¢è®¿é—® rk[i+w] å¯¼è‡´æ•°ç»„è¶Šç•Œï¼Œå¼€ä¸¤å€æ•°ç»„ã€‚</span></span><br><span class="line"><span class="comment">// å½“ç„¶ä¹Ÿå¯ä»¥åœ¨è®¿é—®å‰åˆ¤æ–­æ˜¯å¦è¶Šç•Œï¼Œä½†ç›´æ¥å¼€ä¸¤å€æ•°ç»„æ–¹ä¾¿ä¸€äº›ã€‚</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> i, p;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s + <span class="number">1</span>);</span><br><span class="line">  n = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= n; ++i) sa[i] = i, rk[i] = s[i];</span><br><span class="line">  <span class="keyword">for</span> (w = <span class="number">1</span>; w &lt; n; w &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="built_in">sort</span>(sa + <span class="number">1</span>, sa + n + <span class="number">1</span>, [](<span class="type">int</span> x, <span class="type">int</span> y) &#123;</span><br><span class="line">      <span class="keyword">return</span> rk[x] == rk[y] ? rk[x + w] &lt; rk[y + w] : rk[x] &lt; rk[y];&#125;);  <span class="comment">// è¿™é‡Œç”¨åˆ°äº† lambda</span></span><br><span class="line">    <span class="built_in">memcpy</span>(oldrk, rk, <span class="built_in">sizeof</span>(rk));</span><br><span class="line">    <span class="comment">// ç”±äºè®¡ç®— rk çš„æ—¶å€™åŸæ¥çš„ rk ä¼šè¢«è¦†ç›–ï¼Œè¦å…ˆå¤åˆ¶ä¸€ä»½</span></span><br><span class="line">    <span class="keyword">for</span> (p = <span class="number">0</span>, i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">      <span class="keyword">if</span> (oldrk[sa[i]] == oldrk[sa[i - <span class="number">1</span>]] &amp;&amp; oldrk[sa[i] + w] == oldrk[sa[i - <span class="number">1</span>] + w]) &#123;</span><br><span class="line">        rk[sa[i]] = p;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        rk[sa[i]] = ++p;</span><br><span class="line">      &#125;  <span class="comment">// è‹¥ä¸¤ä¸ªå­ä¸²ç›¸åŒï¼Œå®ƒä»¬å¯¹åº”çš„ rk ä¹Ÿéœ€è¦ç›¸åŒï¼Œæ‰€ä»¥è¦å»é‡</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, sa[i]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</details>

<h2 id="O-n-log-n-åšæ³•"><a href="#O-n-log-n-åšæ³•" class="headerlink" title="$O(n \log n)$ åšæ³•"></a>$O(n \log n)$ åšæ³•</h2><p>æˆ‘ä»¬å°è¯•ä¼˜åŒ–æ’åºçš„é€Ÿåº¦ã€‚<br>åœ¨åˆšåˆšçš„ä»£ç ä¸­ï¼Œæ’åºçš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(n \log n)$ çš„ã€‚å¦‚æœæˆ‘ä»¬å°†æ’åºä¼˜åŒ–åˆ° $O(n)$ é‚£ä¹ˆå°±å¯ä»¥å‡å°æ€»æ—¶é—´å¤æ‚åº¦åˆ° $O(n \log n)$ ã€‚</p>
<p>æˆ‘ä»¬å°è¯•ä½¿ç”¨è®¡æ•°æ’åºæ¥ä¼˜åŒ–æˆ‘ä»¬çš„æ—¶é—´å¤æ‚åº¦ã€‚<br>ç”±äºåç¼€æ•°ç»„æ’åºæ—¶çš„å…³é”®å­—çš„æ’åï¼Œå€¼åŸŸä¸º $O(n)$ ï¼Œè€Œä¸”æ˜¯ä¸€ä¸ªåŒå…³é”®å­—çš„æ’åºï¼Œå¯ä»¥ä½¿ç”¨è®¡æ•°æ’åºæ¥ä¼˜åŒ–è‡³ $O(n)$ ã€‚</p>
<p>åŒæ—¶æˆ‘ä»¬è€ƒè™‘ä¸€äº›ä¼˜åŒ–ã€‚</p>
<h3 id="ç¬¬äºŒå…³é”®å­—æ— éœ€è®¡æ•°æ’åº"><a href="#ç¬¬äºŒå…³é”®å­—æ— éœ€è®¡æ•°æ’åº" class="headerlink" title="ç¬¬äºŒå…³é”®å­—æ— éœ€è®¡æ•°æ’åº"></a>ç¬¬äºŒå…³é”®å­—æ— éœ€è®¡æ•°æ’åº</h3><p>å…¶å®æˆ‘ä»¬ä¸€å¼€å§‹å·²ç»æ’è¿‡åºäº†ã€‚è¿™äº›ç¬¬äºŒå…³é”®å­—ç›¸å½“äºæ˜¯ä¸€äº›åŸä¸²çš„åç¼€ã€‚ä»–ä»¬é•¿åº¦è¾ƒå°ï¼Œä¹Ÿå°±ä¼˜å…ˆè¢«æ’è¿‡åºã€‚  </p>
<p>OI Wikiä¸Šè¿˜ä»‹ç»äº†ä¸€äº›å…¶ä»–çš„ä¼˜åŒ–ã€‚</p>
<details class="note primary"><summary><p>å…¶ä»–ä¼˜åŒ–</p>
</summary>
<ul>
<li>ä¼˜åŒ–è®¡æ•°æ’åºçš„å€¼åŸŸ</li>
</ul>
<p>æ¯æ¬¡å¯¹ $rk$ è¿›è¡Œå»é‡ä¹‹åï¼Œæˆ‘ä»¬éƒ½è®¡ç®—äº†ä¸€ä¸ª $p$ ï¼Œè¿™ä¸ª $p$ å³æ˜¯ $rk$ çš„å€¼åŸŸï¼Œå°†å€¼åŸŸæ”¹æˆå®ƒå³å¯ã€‚</p>
<ul>
<li>å°† <code>rk[id[i]]</code> å­˜ä¸‹æ¥ï¼Œå‡å°‘ä¸è¿ç»­å†…å­˜è®¿é—®</li>
</ul>
<p>è¿™ä¸ªä¼˜åŒ–åœ¨æ•°æ®èŒƒå›´è¾ƒå¤§æ—¶æ•ˆæœéå¸¸æ˜æ˜¾ã€‚</p>
<ul>
<li>ç”¨å‡½æ•° cmp æ¥è®¡ç®—æ˜¯å¦é‡å¤</li>
</ul>
<p>åŒæ ·æ˜¯å‡å°‘ä¸è¿ç»­å†…å­˜è®¿é—®ï¼Œåœ¨æ•°æ®èŒƒå›´è¾ƒå¤§æ—¶æ•ˆæœæ¯”è¾ƒæ˜æ˜¾ã€‚</p>
<p>æŠŠ <code>oldrk[sa[i]] == oldrk[sa[i - 1]] &amp;&amp; oldrk[sa[i] + w] == oldrk[sa[i - 1] + w]</code> æ›¿æ¢æˆ <code>cmp(sa[i], sa[i - 1], w)ï¼Œbool cmp(int x, int y, int w) { return oldrk[x] == oldrk[y] &amp;&amp; oldrk[x + w] == oldrk[y + w]; }</code>ã€‚</p>
<p>è‹¥æ’åéƒ½ä¸ç›¸åŒå¯ç›´æ¥ç”Ÿæˆåç¼€æ•°ç»„<br>è€ƒè™‘æ–°çš„<code>rk</code>æ•°ç»„ï¼Œè‹¥å…¶å€¼åŸŸä¸º $[1,n]$ é‚£ä¹ˆæ¯ä¸ªæ’åéƒ½ä¸åŒï¼Œæ­¤æ—¶æ— éœ€å†æ’åºã€‚</p>

</details>

<details class="note default"><summary><p>å‚è€ƒä»£ç  from OI Wiki</p>
</summary>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1000010</span>;</span><br><span class="line"><span class="type">char</span> s[N];</span><br><span class="line"><span class="type">int</span> n, sa[N], rk[N], oldrk[N &lt;&lt; <span class="number">1</span>], id[N], px[N], cnt[N];</span><br><span class="line"><span class="comment">// px[i] = rk[id[i]]ï¼ˆç”¨äºæ’åºçš„æ•°ç»„æ‰€ä»¥å« pxï¼‰</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> w)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> oldrk[x] == oldrk[y] &amp;&amp; oldrk[x + w] == oldrk[y + w];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> i, m = <span class="number">300</span>, p, w;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s + <span class="number">1</span>);</span><br><span class="line">  n = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= n; ++i) ++cnt[rk[i] = s[i]];</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= m; ++i) cnt[i] += cnt[i - <span class="number">1</span>];</span><br><span class="line">  <span class="keyword">for</span> (i = n; i &gt;= <span class="number">1</span>; --i) sa[cnt[rk[i]]--] = i;</span><br><span class="line">  <span class="keyword">for</span> (w = <span class="number">1</span>;; w &lt;&lt;= <span class="number">1</span>, m = p) &#123;  <span class="comment">// m=p å°±æ˜¯ä¼˜åŒ–è®¡æ•°æ’åºå€¼åŸŸ</span></span><br><span class="line">    <span class="keyword">for</span> (p = <span class="number">0</span>, i = n; i &gt; n - w; --i) id[++p] = i;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">      <span class="keyword">if</span> (sa[i] &gt; w) id[++p] = sa[i] - w;</span><br><span class="line">    <span class="built_in">memset</span>(cnt, <span class="number">0</span>, <span class="built_in">sizeof</span>(cnt));</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= n; ++i) ++cnt[px[i] = rk[id[i]]];</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= m; ++i) cnt[i] += cnt[i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (i = n; i &gt;= <span class="number">1</span>; --i) sa[cnt[px[i]]--] = id[i];</span><br><span class="line">    <span class="built_in">memcpy</span>(oldrk, rk, <span class="built_in">sizeof</span>(rk));</span><br><span class="line">    <span class="keyword">for</span> (p = <span class="number">0</span>, i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">      rk[sa[i]] = <span class="built_in">cmp</span>(sa[i], sa[i - <span class="number">1</span>], w) ? p : ++p;</span><br><span class="line">    <span class="keyword">if</span> (p == n) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) sa[rk[i]] = i;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, sa[i]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</details>

<h1 id="height-æ•°ç»„"><a href="#height-æ•°ç»„" class="headerlink" title="height æ•°ç»„"></a><code>height</code> æ•°ç»„</h1><h2 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h2><p>height æ•°ç»„çš„å®šä¹‰å¦‚ä¸‹ï¼š<br><code>height[i]=lcp(sa[i],sa[i-1])</code>ï¼Œ<br>å³ç¬¬ $i$ åçš„åç¼€ä¸å…¶å‰ä¸€åçš„åç¼€çš„æœ€é•¿å…¬å…±å‰ç¼€çš„é•¿åº¦ã€‚</p>
<p><code>height[1]</code>å¯ä»¥è§†ä½œ $0$ã€‚</p>
<h2 id="O-n-æ±‚-height-æ•°ç»„éœ€è¦çš„ä¸€ä¸ªå¼•ç†"><a href="#O-n-æ±‚-height-æ•°ç»„éœ€è¦çš„ä¸€ä¸ªå¼•ç†" class="headerlink" title="$O(n)$ æ±‚ height æ•°ç»„éœ€è¦çš„ä¸€ä¸ªå¼•ç†"></a>$O(n)$ æ±‚ <code>height</code> æ•°ç»„éœ€è¦çš„ä¸€ä¸ªå¼•ç†</h2><p>$height[rk[i]]\ge height[rk[i-1]]-1$</p>
<p>è¯æ˜ï¼š</p>
<p>å½“ $height[rk[i-1]]\le1$ æ—¶ï¼Œä¸Šå¼æ˜¾ç„¶æˆç«‹ï¼ˆå³è¾¹å°äºç­‰äº $0$ï¼‰ã€‚</p>
<p>å½“ $height[rk[i-1]]&gt;1$ æ—¶ï¼š</p>
<p>è®¾åç¼€ $i-1$ ä¸º $aAD$ï¼ˆ$A$ æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º $height[rk[i-1]]-1$ çš„å­—ç¬¦ä¸²ï¼‰ï¼Œé‚£ä¹ˆåç¼€ $i$ å°±æ˜¯ $AD$ã€‚è®¾åç¼€ $sa[rk[i-1]-1]$ ä¸º $aAB$ï¼Œé‚£ä¹ˆ $lcp(i-1,sa[rk[i-1]-1])&#x3D;aA$ã€‚ç”±äºåç¼€ $sa[rk[i-1]-1]+1$ æ˜¯ $AB$ï¼Œä¸€å®šæ’åœ¨åç¼€ $i$ çš„å‰é¢ï¼Œæ‰€ä»¥åç¼€ $sa[rk[i]-1]$ ä¸€å®šå«æœ‰å‰ç¼€ $A$ï¼Œæ‰€ä»¥ $lcp(i,sa[rk[i]-1])$ è‡³å°‘æ˜¯ $height[rk[i-1]]-1$ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼š<br>$i-1$ï¼š$aAD$<br>$i$ï¼š$AD$<br>$sa[rk[i-1]-1]$ï¼š$aAB$<br>$sa[rk[i-1]-1]+1$ï¼š$AB$<br>$sa[rk[i]-1]$ï¼š$A[B&#x2F;C]$<br>$lcp(i,sa[rk[i]-1])$ï¼š$AX$ï¼ˆ$X$ å¯èƒ½ä¸ºç©ºï¼‰</p>
<h2 id="O-n-æ±‚-height-æ•°ç»„çš„ä»£ç å®ç°"><a href="#O-n-æ±‚-height-æ•°ç»„çš„ä»£ç å®ç°" class="headerlink" title="$O(n)$ æ±‚ height æ•°ç»„çš„ä»£ç å®ç°"></a>$O(n)$ æ±‚ <code>height</code> æ•°ç»„çš„ä»£ç å®ç°</h2><p>åˆ©ç”¨ä¸Šé¢è¿™ä¸ªå¼•ç†æš´åŠ›æ±‚å³å¯ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span>, k = <span class="number">0</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">  <span class="keyword">if</span> (rk[i] == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">  <span class="keyword">if</span> (k) --k;</span><br><span class="line">  <span class="keyword">while</span> (s[i + k] == s[sa[rk[i] - <span class="number">1</span>] + k]) ++k;</span><br><span class="line">  height[rk[i]] = k;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>$k$ ä¸ä¼šè¶…è¿‡ $n$ï¼Œæœ€å¤šå‡ $n$ æ¬¡ï¼Œæ‰€ä»¥æœ€å¤šåŠ  $2n$ æ¬¡ï¼Œæ€»å¤æ‚åº¦å°±æ˜¯ $O(n)$ã€‚</p>
<h2 id="height-æ•°ç»„çš„åº”ç”¨"><a href="#height-æ•°ç»„çš„åº”ç”¨" class="headerlink" title="height æ•°ç»„çš„åº”ç”¨"></a><code>height</code> æ•°ç»„çš„åº”ç”¨</h2><p>æ‘˜è‡ª OI Wikiã€‚</p>
<h3 id="ä¸¤å­ä¸²æœ€é•¿å…¬å…±å‰ç¼€"><a href="#ä¸¤å­ä¸²æœ€é•¿å…¬å…±å‰ç¼€" class="headerlink" title="ä¸¤å­ä¸²æœ€é•¿å…¬å…±å‰ç¼€"></a>ä¸¤å­ä¸²æœ€é•¿å…¬å…±å‰ç¼€</h3><p>$lcp(sa[i],sa[j])&#x3D;\min{height[i+1..j]}$</p>
<p>æ„Ÿæ€§ç†è§£ï¼šå¦‚æœ $height$ ä¸€ç›´å¤§äºæŸä¸ªæ•°ï¼Œå‰è¿™ä¹ˆå¤šä½å°±ä¸€ç›´æ²¡å˜è¿‡ï¼›åä¹‹ï¼Œç”±äºåç¼€å·²ç»æ’å¥½åºäº†ï¼Œä¸å¯èƒ½å˜äº†ä¹‹åå˜å›æ¥ã€‚</p>
<p>ä¸¥æ ¼è¯æ˜å¯ä»¥å‚è€ƒ[[2004]åç¼€æ•°ç»„ by. å¾æ™ºç£Š][1]ã€‚</p>
<p>æœ‰äº†è¿™ä¸ªå®šç†ï¼Œæ±‚ä¸¤å­ä¸²æœ€é•¿å…¬å…±å‰ç¼€å°±è½¬åŒ–ä¸ºäº† <a href="../topic/rmq.md">RMQ é—®é¢˜</a>ã€‚</p>
<h3 id="æ¯”è¾ƒä¸€ä¸ªå­—ç¬¦ä¸²çš„ä¸¤ä¸ªå­ä¸²çš„å¤§å°å…³ç³»"><a href="#æ¯”è¾ƒä¸€ä¸ªå­—ç¬¦ä¸²çš„ä¸¤ä¸ªå­ä¸²çš„å¤§å°å…³ç³»" class="headerlink" title="æ¯”è¾ƒä¸€ä¸ªå­—ç¬¦ä¸²çš„ä¸¤ä¸ªå­ä¸²çš„å¤§å°å…³ç³»"></a>æ¯”è¾ƒä¸€ä¸ªå­—ç¬¦ä¸²çš„ä¸¤ä¸ªå­ä¸²çš„å¤§å°å…³ç³»</h3><p>å‡è®¾éœ€è¦æ¯”è¾ƒçš„æ˜¯ $A&#x3D;S[a..b]$ å’Œ $B&#x3D;S[c..d]$ çš„å¤§å°å…³ç³»ã€‚</p>
<p>è‹¥ $lcp(a, c)\ge\min(|A|, |B|)$ï¼Œ$A &lt; B\iff |A|&lt;|B|$ã€‚</p>
<p>å¦åˆ™ï¼Œ$A &lt; B\iff rk[a]&lt; rk[c]$ã€‚</p>
<h3 id="ä¸åŒå­ä¸²çš„æ•°ç›®"><a href="#ä¸åŒå­ä¸²çš„æ•°ç›®" class="headerlink" title="ä¸åŒå­ä¸²çš„æ•°ç›®"></a>ä¸åŒå­ä¸²çš„æ•°ç›®</h3><p>å­ä¸²å°±æ˜¯åç¼€çš„å‰ç¼€ï¼Œæ‰€ä»¥å¯ä»¥æšä¸¾æ¯ä¸ªåç¼€ï¼Œè®¡ç®—å‰ç¼€æ€»æ•°ï¼Œå†å‡æ‰é‡å¤ã€‚</p>
<p>â€œå‰ç¼€æ€»æ•°â€å…¶å®å°±æ˜¯å­ä¸²ä¸ªæ•°ï¼Œä¸º $n(n+1)&#x2F;2$ã€‚</p>
<p>å¦‚æœæŒ‰åç¼€æ’åºçš„é¡ºåºæšä¸¾åç¼€ï¼Œæ¯æ¬¡æ–°å¢çš„å­ä¸²å°±æ˜¯é™¤äº†ä¸ä¸Šä¸€ä¸ªåç¼€çš„ LCP å‰©ä¸‹çš„å‰ç¼€ã€‚è¿™äº›å‰ç¼€ä¸€å®šæ˜¯æ–°å¢çš„ï¼Œå¦åˆ™ä¼šç ´å $lcp(sa[i],sa[j])&#x3D;\min { height[i+1..j]}$ çš„æ€§è´¨ã€‚åªæœ‰è¿™äº›å‰ç¼€æ˜¯æ–°å¢çš„ï¼Œå› ä¸º LCP éƒ¨åˆ†åœ¨æšä¸¾ä¸Šä¸€ä¸ªå‰ç¼€æ—¶è®¡ç®—è¿‡äº†ã€‚</p>
<p>æ‰€ä»¥ç­”æ¡ˆä¸ºï¼š</p>
<p>$\frac{n(n+1)}{2}-\sum\limits_{i&#x3D;2}^nheight[i]$</p>
<h3 id="å‡ºç°è‡³å°‘-k-æ¬¡çš„å­ä¸²çš„æœ€å¤§é•¿åº¦"><a href="#å‡ºç°è‡³å°‘-k-æ¬¡çš„å­ä¸²çš„æœ€å¤§é•¿åº¦" class="headerlink" title="å‡ºç°è‡³å°‘ k æ¬¡çš„å­ä¸²çš„æœ€å¤§é•¿åº¦"></a>å‡ºç°è‡³å°‘ k æ¬¡çš„å­ä¸²çš„æœ€å¤§é•¿åº¦</h3><p>ä¾‹é¢˜ï¼š<span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL3Byb2JsZW0vUDI4NTI=">ã€ŒUSACO06DECã€Milk Patterns<i class="fa fa-external-link-alt"></i></span>ã€‚</p>
<details class="note info"><summary><p>é¢˜è§£</p>
</summary>
<p>å‡ºç°è‡³å°‘ $k$ æ¬¡æ„å‘³ç€åç¼€æ’åºåæœ‰è‡³å°‘è¿ç»­ $k$ ä¸ªåç¼€çš„ LCP æ˜¯è¿™ä¸ªå­ä¸²ã€‚</p>
<p>æ‰€ä»¥ï¼Œæ±‚å‡ºæ¯ç›¸é‚» $k-1$ ä¸ª $height$ çš„æœ€å°å€¼ï¼Œå†æ±‚è¿™äº›æœ€å°å€¼çš„æœ€å¤§å€¼å°±æ˜¯ç­”æ¡ˆã€‚</p>
<p>å¯ä»¥ä½¿ç”¨å•è°ƒé˜Ÿåˆ— $O(n)$ è§£å†³ï¼Œä½†ä½¿ç”¨å…¶å®ƒæ–¹å¼ä¹Ÿè¶³ä»¥ ACã€‚</p>

</details>

<details class="note info"><summary><p>å‚è€ƒä»£ç </p>
</summary>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">40010</span>;</span><br><span class="line"><span class="type">int</span> n, k, a[N], sa[N], rk[N], oldrk[N], id[N], px[N], cnt[<span class="number">1000010</span>], ht[N], ans;</span><br><span class="line">multiset&lt;<span class="type">int</span>&gt; t;  <span class="comment">// multiset æ˜¯æœ€å¥½å†™çš„å®ç°æ–¹å¼</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> w)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> oldrk[x] == oldrk[y] &amp;&amp; oldrk[x + w] == oldrk[y + w];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> i, j, w, p, m = <span class="number">1000000</span>;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;k);</span><br><span class="line">  --k;</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a + i);  <span class="comment">//æ±‚åç¼€æ•°ç»„</span></span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= n; ++i) ++cnt[rk[i] = a[i]];</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= m; ++i) cnt[i] += cnt[i - <span class="number">1</span>];</span><br><span class="line">  <span class="keyword">for</span> (i = n; i &gt;= <span class="number">1</span>; --i) sa[cnt[rk[i]]--] = i;</span><br><span class="line">  <span class="keyword">for</span> (w = <span class="number">1</span>; w &lt; n; w &lt;&lt;= <span class="number">1</span>, m = p) &#123;</span><br><span class="line">    <span class="keyword">for</span> (p = <span class="number">0</span>, i = n; i &gt; n - w; --i) id[++p] = i;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">      <span class="keyword">if</span> (sa[i] &gt; w) id[++p] = sa[i] - w;</span><br><span class="line">    <span class="built_in">memset</span>(cnt, <span class="number">0</span>, <span class="built_in">sizeof</span>(cnt));</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= n; ++i) ++cnt[px[i] = rk[id[i]]];</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= m; ++i) cnt[i] += cnt[i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (i = n; i &gt;= <span class="number">1</span>; --i) sa[cnt[px[i]]--] = id[i];</span><br><span class="line">    <span class="built_in">memcpy</span>(oldrk, rk, <span class="built_in">sizeof</span>(rk));</span><br><span class="line">    <span class="keyword">for</span> (p = <span class="number">0</span>, i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">      rk[sa[i]] = <span class="built_in">cmp</span>(sa[i], sa[i - <span class="number">1</span>], w) ? p : ++p;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">1</span>, j = <span class="number">0</span>; i &lt;= n; ++i) &#123;  <span class="comment">//æ±‚ height</span></span><br><span class="line">    <span class="keyword">if</span> (j) --j;</span><br><span class="line">    <span class="keyword">while</span> (a[i + j] == a[sa[rk[i] - <span class="number">1</span>] + j]) ++j;</span><br><span class="line">    ht[rk[i]] = j;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= n; ++i) &#123;  <span class="comment">//æ±‚æ‰€æœ‰æœ€å°å€¼çš„æœ€å¤§å€¼</span></span><br><span class="line">    t.<span class="built_in">insert</span>(ht[i]);</span><br><span class="line">    <span class="keyword">if</span> (i &gt; k) t.<span class="built_in">erase</span>(t.<span class="built_in">find</span>(ht[i - k]));</span><br><span class="line">    ans = <span class="built_in">max</span>(ans, *t.<span class="built_in">begin</span>());</span><br><span class="line">  &#125;</span><br><span class="line">  cout &lt;&lt; ans;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</details>

<h3 id="æ˜¯å¦æœ‰æŸå­—ç¬¦ä¸²åœ¨æ–‡æœ¬ä¸²ä¸­è‡³å°‘ä¸é‡å åœ°å‡ºç°äº†ä¸¤æ¬¡"><a href="#æ˜¯å¦æœ‰æŸå­—ç¬¦ä¸²åœ¨æ–‡æœ¬ä¸²ä¸­è‡³å°‘ä¸é‡å åœ°å‡ºç°äº†ä¸¤æ¬¡" class="headerlink" title="æ˜¯å¦æœ‰æŸå­—ç¬¦ä¸²åœ¨æ–‡æœ¬ä¸²ä¸­è‡³å°‘ä¸é‡å åœ°å‡ºç°äº†ä¸¤æ¬¡"></a>æ˜¯å¦æœ‰æŸå­—ç¬¦ä¸²åœ¨æ–‡æœ¬ä¸²ä¸­è‡³å°‘ä¸é‡å åœ°å‡ºç°äº†ä¸¤æ¬¡</h3><p>å¯ä»¥äºŒåˆ†ç›®æ ‡ä¸²çš„é•¿åº¦ $|s|$ï¼Œå°† $h$ æ•°ç»„åˆ’åˆ†æˆè‹¥å¹²ä¸ªè¿ç»­ LCP å¤§äºç­‰äº $|s|$ çš„æ®µï¼Œåˆ©ç”¨ RMQ å¯¹æ¯ä¸ªæ®µæ±‚å…¶ä¸­å‡ºç°çš„æ•°ä¸­æœ€å¤§å’Œæœ€å°çš„ä¸‹æ ‡ï¼Œè‹¥è¿™ä¸¤ä¸ªä¸‹æ ‡çš„è·ç¦»æ»¡è¶³æ¡ä»¶ï¼Œåˆ™ä¸€å®šæœ‰é•¿åº¦ä¸º $|s|$ çš„å­—ç¬¦ä¸²ä¸é‡å åœ°å‡ºç°äº†ä¸¤æ¬¡ã€‚</p>
<h3 id="è¿ç»­çš„è‹¥å¹²ä¸ªç›¸åŒå­ä¸²"><a href="#è¿ç»­çš„è‹¥å¹²ä¸ªç›¸åŒå­ä¸²" class="headerlink" title="è¿ç»­çš„è‹¥å¹²ä¸ªç›¸åŒå­ä¸²"></a>è¿ç»­çš„è‹¥å¹²ä¸ªç›¸åŒå­ä¸²</h3><p>æˆ‘ä»¬å¯ä»¥æšä¸¾è¿ç»­ä¸²çš„é•¿åº¦ $|s|$ï¼ŒæŒ‰ç…§ $|s|$ å¯¹æ•´ä¸ªä¸²è¿›è¡Œåˆ†å—ï¼Œå¯¹ç›¸é‚»ä¸¤å—çš„å—é¦–è¿›è¡Œ LCP ä¸ LCS æŸ¥è¯¢ï¼Œå…·ä½“å¯è§[[2009]åç¼€æ•°ç»„â€”â€”å¤„ç†å­—ç¬¦ä¸²çš„æœ‰åŠ›å·¥å…·][2]ã€‚</p>
<p>ä¾‹é¢˜ï¼š<span class="exturl" data-url="aHR0cHM6Ly9sb2ouYWMvcC8yMDgz">ã€ŒNOI2016ã€ä¼˜ç§€çš„æ‹†åˆ†<i class="fa fa-external-link-alt"></i></span>ã€‚</p>
<h3 id="ç»“åˆå¹¶æŸ¥é›†"><a href="#ç»“åˆå¹¶æŸ¥é›†" class="headerlink" title="ç»“åˆå¹¶æŸ¥é›†"></a>ç»“åˆå¹¶æŸ¥é›†</h3><p>æŸäº›é¢˜ç›®æ±‚è§£æ—¶è¦æ±‚ä½ å°†åç¼€æ•°ç»„åˆ’åˆ†æˆè‹¥å¹²ä¸ªè¿ç»­ LCP é•¿åº¦å¤§äºç­‰äºæŸä¸€å€¼çš„æ®µï¼Œäº¦å³å°† $h$ æ•°ç»„åˆ’åˆ†æˆè‹¥å¹²ä¸ªè¿ç»­æœ€å°å€¼å¤§äºç­‰äºæŸä¸€å€¼çš„æ®µå¹¶ç»Ÿè®¡æ¯ä¸€æ®µçš„ç­”æ¡ˆã€‚å¦‚æœæœ‰å¤šæ¬¡è¯¢é—®ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¯¢é—®ç¦»çº¿ã€‚è§‚å¯Ÿåˆ°å½“ç»™å®šå€¼å•è°ƒé€’å‡çš„æ—¶å€™ï¼Œæ»¡è¶³æ¡ä»¶çš„åŒºé—´ä¸ªæ•°æ€»æ˜¯è¶Šæ¥è¶Šå°‘ï¼Œè€Œæ–°åŒºé—´éƒ½æ˜¯ä¸¤ä¸ªæˆ–å¤šä¸ªåŸåŒºé—´ç›¸è¿æ‰€å¾—ï¼Œä¸”æ–°åŒºé—´ä¸­ä¸åŒ…å«åœ¨åŸåŒºé—´å†…çš„éƒ¨åˆ†çš„ $h$ å€¼éƒ½ä¸ºå‡å°‘åˆ°çš„è¿™ä¸ªå€¼ã€‚æˆ‘ä»¬åªéœ€è¦ç»´æŠ¤ä¸€ä¸ªå¹¶æŸ¥é›†ï¼Œæ¯æ¬¡åˆå¹¶ç›¸é‚»çš„ä¸¤ä¸ªåŒºé—´ï¼Œå¹¶ç»´æŠ¤ç»Ÿè®¡ä¿¡æ¯å³å¯ã€‚</p>
<p>ç»å…¸é¢˜ç›®ï¼š<span class="exturl" data-url="aHR0cHM6Ly91b2ouYWMvcHJvYmxlbS8xMzE=">ã€ŒNOI2015ã€å“é…’å¤§ä¼š<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="ç»“åˆçº¿æ®µæ ‘"><a href="#ç»“åˆçº¿æ®µæ ‘" class="headerlink" title="ç»“åˆçº¿æ®µæ ‘"></a>ç»“åˆçº¿æ®µæ ‘</h3><p>æŸäº›é¢˜ç›®è®©ä½ æ±‚æ»¡è¶³æ¡ä»¶çš„å‰è‹¥å¹²ä¸ªæ•°ï¼Œè€Œè¿™äº›æ•°åˆåœ¨åç¼€æ’åºä¸­çš„ä¸€ä¸ªåŒºé—´å†…ã€‚è¿™æ—¶æˆ‘ä»¬å¯ä»¥ç”¨å½’å¹¶æ’åºçš„æ€§è´¨æ¥åˆå¹¶ä¸¤ä¸ªç»“ç‚¹çš„ä¿¡æ¯ï¼Œåˆ©ç”¨çº¿æ®µæ ‘ç»´æŠ¤å’ŒæŸ¥è¯¢åŒºé—´ç­”æ¡ˆã€‚</p>
<h3 id="ç»“åˆå•è°ƒæ ˆ"><a href="#ç»“åˆå•è°ƒæ ˆ" class="headerlink" title="ç»“åˆå•è°ƒæ ˆ"></a>ç»“åˆå•è°ƒæ ˆ</h3><p>ä¾‹é¢˜ï¼š<span class="exturl" data-url="aHR0cHM6Ly9sb2ouYWMvcHJvYmxlbS8yMzc3">ã€ŒAHOI2013ã€å·®å¼‚<i class="fa fa-external-link-alt"></i></span></p>
<details class="note info"><summary><p>é¢˜è§£</p>
</summary>
<p>è¢«åŠ æ•°çš„å‰ä¸¤é¡¹å¾ˆå¥½å¤„ç†ï¼Œä¸º $n(n-1)(n+1)&#x2F;2$ï¼ˆæ¯ä¸ªåç¼€éƒ½å‡ºç°äº† $n-1$ æ¬¡ï¼Œåç¼€æ€»é•¿æ˜¯ $n(n+1)&#x2F;2$ï¼‰ï¼Œå…³é”®æ˜¯æœ€åä¸€é¡¹ï¼Œå³åç¼€çš„ä¸¤ä¸¤ LCPã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“ $lcp(i,j)&#x3D;k$ ç­‰ä»·äº $\min{height[i+1..j]}&#x3D;k$ã€‚æ‰€ä»¥ï¼Œå¯ä»¥æŠŠ $lcp(i,j)$ è®°ä½œ $\min{x|i+1\le x\le j, height[x]&#x3D;lcp(i,j)}$ å¯¹ç­”æ¡ˆçš„è´¡çŒ®ã€‚</p>
<p>è€ƒè™‘æ¯ä¸ªä½ç½®å¯¹ç­”æ¡ˆçš„è´¡çŒ®æ˜¯å“ªäº›åç¼€çš„ LCPï¼Œå…¶å®å°±æ˜¯ä»å®ƒå¼€å§‹å‘å·¦è‹¥å¹²ä¸ªè¿ç»­çš„ $height$ å¤§äºå®ƒçš„åç¼€ä¸­é€‰ä¸€ä¸ªï¼Œå†ä»å‘å³è‹¥å¹²ä¸ªè¿ç»­çš„ $height$ ä¸å°äºå®ƒçš„åç¼€ä¸­é€‰ä¸€ä¸ªã€‚è¿™ä¸ªä¸œè¥¿å¯ä»¥ç”¨å•è°ƒæ ˆè®¡ç®—ã€‚</p>
<p>å•è°ƒæ ˆéƒ¨åˆ†ç±»ä¼¼äº <span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL3Byb2JsZW0vUDI2NTk=">Luogu P2659 ç¾ä¸½çš„åºåˆ—<i class="fa fa-external-link-alt"></i></span> ä»¥åŠæ‚¬çº¿æ³•ã€‚</p>

</details>

<details class="note default"><summary><p>å‚è€ƒä»£ç </p>
</summary>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">500010</span>;</span><br><span class="line"><span class="type">char</span> s[N];</span><br><span class="line"><span class="type">int</span> n, sa[N], rk[N &lt;&lt; <span class="number">1</span>], oldrk[N &lt;&lt; <span class="number">1</span>], id[N], px[N], cnt[N], ht[N], sta[N],</span><br><span class="line">    top, l[N];</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> ans;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> w)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> oldrk[x] == oldrk[y] &amp;&amp; oldrk[x + w] == oldrk[y + w];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> i, k, w, p, m = <span class="number">300</span>;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s + <span class="number">1</span>);</span><br><span class="line">  n = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line">  ans = <span class="number">1ll</span> * n * (n - <span class="number">1</span>) * (n + <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">  <span class="comment">//æ±‚åç¼€æ•°ç»„</span></span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= n; ++i) ++cnt[rk[i] = s[i]];</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= m; ++i) cnt[i] += cnt[i - <span class="number">1</span>];</span><br><span class="line">  <span class="keyword">for</span> (i = n; i &gt;= <span class="number">1</span>; --i) sa[cnt[rk[i]]--] = i;</span><br><span class="line">  <span class="keyword">for</span> (w = <span class="number">1</span>; w &lt; n; w &lt;&lt;= <span class="number">1</span>, m = p) &#123;</span><br><span class="line">    <span class="keyword">for</span> (p = <span class="number">0</span>, i = n; i &gt; n - w; --i) id[++p] = i;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">      <span class="keyword">if</span> (sa[i] &gt; w) id[++p] = sa[i] - w;</span><br><span class="line">    <span class="built_in">memset</span>(cnt, <span class="number">0</span>, <span class="built_in">sizeof</span>(cnt));</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= n; ++i) ++cnt[px[i] = rk[id[i]]];</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= m; ++i) cnt[i] += cnt[i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (i = n; i &gt;= <span class="number">1</span>; --i) sa[cnt[px[i]]--] = id[i];</span><br><span class="line">    <span class="built_in">memcpy</span>(oldrk, rk, <span class="built_in">sizeof</span>(rk));</span><br><span class="line">    <span class="keyword">for</span> (p = <span class="number">0</span>, i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">      rk[sa[i]] = <span class="built_in">cmp</span>(sa[i], sa[i - <span class="number">1</span>], w) ? p : ++p;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//æ±‚ height</span></span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">1</span>, k = <span class="number">0</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">    <span class="keyword">if</span> (k) --k;</span><br><span class="line">    <span class="keyword">while</span> (s[i + k] == s[sa[rk[i] - <span class="number">1</span>] + k]) ++k;</span><br><span class="line">    ht[rk[i]] = k;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//ç»´æŠ¤å•è°ƒæ ˆ</span></span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">    <span class="keyword">while</span> (ht[sta[top]] &gt; ht[i]) --top;  <span class="comment">// topç±»ä¼¼äºä¸€ä¸ªæŒ‡é’ˆ</span></span><br><span class="line">    l[i] = i - sta[top];</span><br><span class="line">    sta[++top] = i;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//æœ€ååˆ©ç”¨å•è°ƒæ ˆç®— ans</span></span><br><span class="line">  sta[++top] = n + <span class="number">1</span>;</span><br><span class="line">  ht[n + <span class="number">1</span>] = <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">for</span> (i = n; i &gt;= <span class="number">1</span>; --i) &#123;</span><br><span class="line">    <span class="keyword">while</span> (ht[sta[top]] &gt;= ht[i]) --top;</span><br><span class="line">    ans -= <span class="number">2ll</span> * ht[i] * l[i] * (sta[top] - i);</span><br><span class="line">    sta[++top] = i;</span><br><span class="line">  &#125;</span><br><span class="line">  cout &lt;&lt; ans;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</details>
<p>ç±»ä¼¼çš„é¢˜ç›®ï¼š<span class="exturl" data-url="aHR0cHM6Ly9sb2ouYWMvcHJvYmxlbS8yMDY0">ã€ŒHAOI2016ã€æ‰¾ç›¸åŒå­—ç¬¦<i class="fa fa-external-link-alt"></i></span>ã€‚</p>
]]></content>
      <categories>
        <category>æ•°æ®ç»“æ„</category>
      </categories>
      <tags>
        <tag>æ•°æ®ç»“æ„</tag>
        <tag>å­—ç¬¦ä¸²</tag>
      </tags>
  </entry>
  <entry>
    <title>æ ‘çŠ¶æ•°ç»„</title>
    <url>/OI/tree-array/</url>
    <content><![CDATA[<p>ç®€ä»‹ï¼š æ ‘çŠ¶æ•°ç»„</p>
<span id="more"></span>

<h1 id="æ ‘çŠ¶æ•°ç»„"><a href="#æ ‘çŠ¶æ•°ç»„" class="headerlink" title="æ ‘çŠ¶æ•°ç»„"></a>æ ‘çŠ¶æ•°ç»„</h1><p>ä¸€ç§ç¥å¥‡çš„æ•°æ®ç»“æ„ã€‚</p>
<h2 id="å¼•å­"><a href="#å¼•å­" class="headerlink" title="å¼•å­"></a>å¼•å­</h2><p>å½“æˆ‘ä»¬æƒ³è¦å¯¹ä¸€ä¸ªæ•°ç»„è¿›è¡Œå•ç‚¹åŠ æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ä½¿ç”¨æ™®é€šæ•°ç»„ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯ $O(1)$ï¼›<br>å½“æˆ‘ä»¬æƒ³è¦å¯¹ä¸€ä¸ªæ•°ç»„è¿›è¡ŒåŒºé—´æ±‚å’Œæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ä½¿ç”¨å‰ç¼€å’Œæ•°ç»„ï¼Œæ—¶é—´å¤æ‚åº¦ä¹Ÿæ˜¯ $O(1)$ï¼›</p>
<p>ä½†æ˜¯ï¼Œå‰ç¼€å’Œæ•°ç»„åœ¨è¿›è¡Œå•ç‚¹åŠ æ—¶ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯ $O(n)$ ï¼›<br>è€Œæ™®é€šæ•°ç»„åœ¨è¿›è¡ŒåŒºé—´æ±‚å’Œæ—¶ï¼Œæ—¶é—´å¤æ‚åº¦ä¹Ÿæ˜¯ $O(n)$ ï¼›</p>
<p>æˆ‘ä»¬èƒ½ä¸èƒ½è®¾è®¡å‡ºä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œè®©æˆ‘ä»¬åœ¨è¿›è¡Œè¿™ä¸¤ä¸ªæ“ä½œæ—¶ç‰ºç‰²æŸä¸€ä¸ªæ“ä½œçš„æ—¶é—´å¤æ‚åº¦ï¼Œè€Œå‡å°‘äº†å¦ä¸€ä¸ªæ“ä½œçš„æ—¶é—´å¤æ‚åº¦å‘¢ï¼Ÿ</p>
<p>äºæ˜¯ï¼Œæ ‘çŠ¶æ•°ç»„å°±åº”è¿è€Œç”Ÿã€‚</p>
<h2 id="ç®€è¦ä»‹ç»"><a href="#ç®€è¦ä»‹ç»" class="headerlink" title="ç®€è¦ä»‹ç»"></a>ç®€è¦ä»‹ç»</h2><p>æ ‘çŠ¶æ•°ç»„çš„å­˜å‚¨åŸç†æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š</p>
<p>æˆ‘ä»¬ç§°åŸæ•°ç»„ä¸º $a[i]$ ï¼Œæˆ‘ä»¬æ­£å¸¸æ‰€è¾“å…¥çš„æ•°æ®å°±å­˜å‚¨åœ¨è¿™é‡Œã€‚</p>
<p>åœ¨åŸæ•°ç»„ $a[i]$ çš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„ $c[i]$ ã€‚<br>æ•°ç»„ $c[i]$ æ˜¯ä»¥è¿™ä¸ªè§„åˆ™å­˜å‚¨ä¿¡æ¯çš„ï¼š</p>
<p>æˆ‘ä»¬å…ˆåˆ—å‡ºæ‰€æœ‰çš„æ•°ç»„ä¸‹æ ‡ï¼š</p>
<p><img src="https://i.loli.net/2021/10/14/w8Q9VlYpkiRZOuK.png" alt="æ ‘çŠ¶æ•°ç»„1.png"></p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å¼€å§‹è€ƒè™‘æ•°å­—çš„ $lowbit$ ã€‚</p>
<p>æ‰€æœ‰å¥‡æ•°çš„ $lowbit$ éƒ½æ˜¯1ã€‚<br>æˆ‘ä»¬åœ¨ç¬¬ä¸€å±‚æ ‡è®°ä¸Š $lowbit$ ä¸º1çš„æ‰€æœ‰æ•°å­—ï¼š</p>
<p><img src="https://i.loli.net/2021/10/14/etBbyiMgNhHA2zQ.png" alt="æ ‘çŠ¶æ•°ç»„2.png"></p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¾æ¬¡æ ‡ä¸Šæ•°å­—çš„ $lowbit$ ï¼š</p>
<p><img src="https://i.loli.net/2021/10/14/7J41bdLejGiP9wF.png" alt="æ ‘çŠ¶æ•°ç»„3.png"></p>
<p><img src="https://i.loli.net/2021/10/14/vCznWK9uGPhIwO8.png" alt="æ ‘çŠ¶æ•°ç»„4.png"></p>
<p><img src="https://i.loli.net/2021/10/14/j1TmJIP9xBknas5.png" alt="æ ‘çŠ¶æ•°ç»„5.png"></p>
<p>æœ€åï¼Œæˆ‘ä»¬å†è¿›è¡Œä¸€ä¸‹å»¶é•¿ï¼Œæ¯ä¸€ä¸ªå—å‘å·¦å»¶é•¿è‡³é•¿åº¦ä¸º $2^{lowbit(i)}$ ã€‚</p>
<p><img src="https://i.loli.net/2021/10/14/PAUqE1a8D6CGh3d.png" alt="æ ‘çŠ¶æ•°ç»„6.png"></p>
<p>æˆ‘ä»¬å¯¹å—è¿›è¡Œä¸€ä¸‹æ ‡å·ï¼š</p>
<p><img src="https://i.loli.net/2021/10/14/r8mtGfDANz2XWHv.png" alt="æ ‘çŠ¶æ•°ç»„7.png"></p>
<p>è¿™äº›ç»¿è‰²çš„å—é‡Œé¢å­˜å‚¨çš„æ˜¯å…¶ä¸‹æ–¹æ‰€æœ‰æ•°å­—çš„å’Œã€‚</p>
<p>å½“ç„¶ï¼Œæˆ‘ä»¬è¿›è¡Œå€¼çš„æ›´æ–°çš„æ—¶å€™ï¼Œä¸å¯èƒ½ä¸€ä¸ªä¸€ä¸ªåŠ èµ·æ¥å†æ›´æ–°ï¼Œè¿™æ ·å¤æ‚åº¦åˆå›åˆ°äº†åŸå…ˆçš„æ ·å­ã€‚</p>
<p>æˆ‘ä»¬æ›´æ–°æ—¶éµå¾ªçš„æ˜¯è¿™æ ·ä¸€ä¸ªè·¯çº¿ï¼š</p>
<p><img src="https://i.loli.net/2021/10/14/JWnIe5SftkZjpL7.png" alt="æ ‘çŠ¶æ•°ç»„8.png"></p>
<p>å› ä¸ºæ¯ä¸€ä¸ªæ•°æœ‰ $\log (n)$ ä½ï¼Œæ‰€ä»¥æœ€ç»ˆä¸¤ä¸ªæ“ä½œçš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ $O(\log n)$ ã€‚</p>
<h2 id="æ¿å­"><a href="#æ¿å­" class="headerlink" title="æ¿å­"></a>æ¿å­</h2><div class="tabs" id="model"><ul class="nav-tabs"><li class="tab active"><a href="#model-1">Luoguæ¿å­é¢˜1</a></li><li class="tab"><a href="#model-2">Luoguæ¿å­é¢˜2</a></li></ul><div class="tab-content"><div class="tab-pane active" id="model-1"><p>Luogu P3374 ã€æ¨¡æ¿ã€‘ æ ‘çŠ¶æ•°ç»„1ï¼š<span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL3Byb2JsZW0vUDMzNzQ=">https://www.luogu.com.cn/problem/P3374<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">500010</span>;</span><br><span class="line"><span class="type">int</span> a[N], tr[N];</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lowbit</span><span class="params">(<span class="type">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a &amp; -a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = x; i &lt;= n; i += <span class="built_in">lowbit</span>(i))</span><br><span class="line">        tr[i] += c;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sum</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = x; i; i -= <span class="built_in">lowbit</span>(i))</span><br><span class="line">        res += tr[i];</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cin &gt;&gt; a[i];</span><br><span class="line">        <span class="built_in">add</span>(i, a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> op, x, y;</span><br><span class="line">        cin &gt;&gt; op &gt;&gt; x &gt;&gt; y;</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            a[x] += y;</span><br><span class="line">            <span class="built_in">add</span>(x, y);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> res = <span class="built_in">sum</span>(y) - <span class="built_in">sum</span>(x - <span class="number">1</span>);</span><br><span class="line">            cout &lt;&lt; res &lt;&lt; endl;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="model-2"><p>Luogu P3368 ã€æ¨¡æ¿ã€‘ æ ‘çŠ¶æ•°ç»„2ï¼š<span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL3Byb2JsZW0vUDMzNjg=">https://www.luogu.com.cn/problem/P3368<i class="fa fa-external-link-alt"></i></span></p>
<details class="note info"><summary><p>æ€è·¯</p>
</summary>
<p>ç»´æŠ¤å·®åˆ†åºåˆ—ï¼Œè€Œä¸æ˜¯åŸåºåˆ—ã€‚</p>

</details>

<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">500010</span>;</span><br><span class="line"><span class="type">int</span> num[N], a[N], tr[N];</span><br><span class="line"><span class="type">int</span> idx, hd, n;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lowbit</span><span class="params">(<span class="type">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a &amp; -a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = x; i &lt;= n; i += <span class="built_in">lowbit</span>(i))</span><br><span class="line">        tr[i] += c;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sum</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = x; i; i -= <span class="built_in">lowbit</span>(i))</span><br><span class="line">        res += tr[i];</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> m;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cin &gt;&gt; num[i];</span><br><span class="line">        a[i] = num[i] - num[i - <span class="number">1</span>];</span><br><span class="line">        <span class="built_in">add</span>(i, a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> op;</span><br><span class="line">        cin &gt;&gt; op;</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> x, y, k;</span><br><span class="line">            cin &gt;&gt; x &gt;&gt; y &gt;&gt; k;</span><br><span class="line">            <span class="built_in">add</span>(x, k);</span><br><span class="line">            <span class="built_in">add</span>(y + <span class="number">1</span>, -k);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> x;</span><br><span class="line">            cin &gt;&gt; x;</span><br><span class="line">            cout &lt;&lt; <span class="built_in">sum</span>(x) &lt;&lt; endl;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div></div>
]]></content>
      <categories>
        <category>æ•°æ®ç»“æ„</category>
      </categories>
      <tags>
        <tag>æ•°æ®ç»“æ„</tag>
      </tags>
  </entry>
  <entry>
    <title>Lewisç”µå­ç†è®º</title>
    <url>/chemistry/lewis-structure/</url>
    <content><![CDATA[<p>$Lewis$ ç”µå­ç†è®ºï¼Œ $Lewis$ ç»“æ„å¼ï¼Œå’Œå½¢å¼ç”µè·ã€‚</p>
<span id="more"></span>

<p><strong>å¼•è¨€</strong></p>
<p>Lewisç»“æ„å¼ä¸€ç›´æ˜¯åŒ–å­¦ä¸Šé¢ä¸€ä¸ªé‡è¦çš„å·¥å…·ï¼Œä¸ç®¡æœ‰æœºè¿˜æ˜¯æ— æœºã€‚</p>
<p>è€Œåœ¨æœ‰æœºè¿™ä¸€éƒ¨åˆ†é‡Œé¢ï¼ŒLewisç»“æ„å¼å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´åŠ æ¸…æ¥šåœ°ç†è§£å¾ˆå¤šååº”çš„æœºç†ã€‚</p>
<p>æ‰€ä»¥ï¼Œå­¦ä¹ Lewisç»“æ„å¼ç½¢ã€‚</p>
<h1 id="å¦‚ä½•ç¡®å®šä¸€ä¸ªç‰©è´¨çš„Lewisç»“æ„å¼ï¼Ÿ"><a href="#å¦‚ä½•ç¡®å®šä¸€ä¸ªç‰©è´¨çš„Lewisç»“æ„å¼ï¼Ÿ" class="headerlink" title="å¦‚ä½•ç¡®å®šä¸€ä¸ªç‰©è´¨çš„Lewisç»“æ„å¼ï¼Ÿ"></a>å¦‚ä½•ç¡®å®šä¸€ä¸ªç‰©è´¨çš„Lewisç»“æ„å¼ï¼Ÿ</h1><p>æˆ‘ä»¬é¦–å…ˆéœ€è¦ç¡®å®šä¸€ä¸‹è¿™ä¸ªç‰©è´¨åˆ°åº•æ˜¯ä»€ä¹ˆã€‚æ˜¯åˆ†å­ï¼Ÿæ˜¯è‡ªç”±åŸºï¼Ÿäº¦æˆ–æ˜¯ç¦»å­ï¼Ÿ</p>
<p>å¯¹äºä¸åŒç§ç±»çš„ç‰©è´¨ï¼Œæˆ‘ä»¬ç¡®å®šå…¶çš„Lewisç»“æ„å¼çš„éš¾åº¦æ˜¯é€’å¢çš„ã€‚</p>
<h2 id="åˆ†å­"><a href="#åˆ†å­" class="headerlink" title="åˆ†å­"></a>åˆ†å­</h2><p>åœ¨Lewisç»“æ„å¼é‡Œé¢ï¼ŒåŸå­æ˜¯ç”¨ç±»ä¼¼è¿™æ ·çš„æ–¹å¼è¡¨ç¤ºçš„ï¼Œè¿™é‡Œä»¥<strong>æ°§</strong>ä¸ºä¾‹åšä¸€ä¸‹è®²è§£ã€‚</p>
<p>é¦–å…ˆæ˜¯ä¸€ä¸ªåŸå­å®ï¼š</p>
<p><img src="https://i.loli.net/2021/11/21/l6PyiVO7kHeLwFK.png" alt="1.png"></p>
<p>åŸå­å®åŒ…å«äº†åŸå­æ ¸å’Œéä»·å±‚ç”µå­ã€‚</p>
<p>ç„¶åæˆ‘ä»¬ä½¿ç”¨å°ç‚¹æ¥è¡¨ç¤ºä»·å±‚ç”µå­ï¼š</p>
<p><img src="https://i.loli.net/2021/11/21/69ToQI3LJsgfvXV.png" alt="2-1.png"></p>
<p>å½“ç„¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è¿™æ ·è¡¨ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2021/11/21/RGzOWaB6ytroJPC.png" alt="2-2.png"></p>
<p>ä¸¤ç§ä¸åŒçš„ç»“æ„å¼é€‚ç”¨äºä¸åŒçš„æƒ…å†µã€‚</p>
<p>å½“ä¸¤ä¸ªåŸå­æˆå…±ä»·é”®çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç”¨ä¸€æ¡çŸ­çº¿æ¥ä»£è¡¨ä¸€å¯¹å…±ç”¨ç”µå­å¯¹ï¼Œå°±åƒè¿™æ ·ï¼š</p>
<p><img src="https://i.loli.net/2021/11/21/VFxkT6n2JoC5LUX.png" alt="3-1.png"></p>
<p>åŒé”®ã€åé”®ä¹Ÿæ˜¯ä¸€æ ·ã€‚</p>
<p><img src="https://i.loli.net/2021/11/21/veM26EPIlUg98hq.png" alt="3-2.png"></p>
<p>æˆ‘ä»¬å…ˆä»ç®€å•åˆ†å­å¼€å§‹çœ‹èµ·ã€‚</p>
<h3 id="ç®€å•åˆ†å­"><a href="#ç®€å•åˆ†å­" class="headerlink" title="ç®€å•åˆ†å­"></a>ç®€å•åˆ†å­</h3><h4 id="ç”²çƒ·"><a href="#ç”²çƒ·" class="headerlink" title="ç”²çƒ·"></a>ç”²çƒ·</h4><p><strong>ç”²çƒ·</strong>ï¼Œä¸€ä¸ªå¾ˆå¥½çš„åˆ†å­ã€‚è¿™ä»£è¡¨äº†å†™Lewisç»“æ„å¼æ—¶çš„æœ€ç®€å•çš„æƒ…å†µã€‚å®ƒçš„ç»“æ„æ˜¯è¿™æ ·çš„ï¼š</p>
<p><img src="https://i.loli.net/2021/11/21/nBuLoXwip45CAm7.png" alt="4-1.png"></p>
<p>å…¶ä¸­çš„å››ä¸ªçŸ­çº¿ä»£è¡¨æ°¢ä¸ç¢³æˆäº†å››ä¸ªå•é”®ã€‚</p>
<p><img src="https://i.loli.net/2021/11/21/xHbQJKqnaZslw28.png" alt="4-2.png"></p>
<p>å°±åƒè¿™æ ·ã€‚</p>
<h4 id="æ°¨"><a href="#æ°¨" class="headerlink" title="æ°¨"></a>æ°¨</h4><p><strong>æ°¨</strong>ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„åˆ†å­ã€‚è¿™ä»£è¡¨äº†å¦ä¸€ç§æƒ…å†µã€‚å®ƒçš„ç»“æ„æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š</p>
<p><img src="https://i.loli.net/2021/11/21/3jq4B8A1pyIhiUR.png" alt="4-3.png"></p>
<p>å…¶ä¸­Nå‘¨å›´é™¤äº† $\ce{N-H}$ å•é”®ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€å¯¹å­¤å¯¹ç”µå­ã€‚</p>
<h4 id="æ°´"><a href="#æ°´" class="headerlink" title="æ°´"></a>æ°´</h4><p><strong>æ°´</strong>æ˜¯æ°¨çš„è¿›é˜¶â€”â€”å®ƒæœ‰ä¸¤å¯¹å­¤å¯¹ç”µå­ã€‚</p>
<p><img src="https://i.loli.net/2021/11/21/vQZoB1y4nEi3MVX.png" alt="4-4.png"></p>
<p>ä»–ä»¬éƒ½æ»¡è¶³ä¸€ä¸ªç®€å•çš„è§„åˆ™â€”â€”å…«éš…å¾‹ã€‚</p>
<p><strong>å…«éš…å¾‹</strong>çš„æ„æ€æ˜¯ï¼Œä»»æ„ä¸€ä¸ªåŸå­å‘¨å›´éƒ½æœ‰8ä¸ªç”µå­ã€‚</p>
<p>è¿™ä¸»è¦é’ˆå¯¹çš„æ˜¯ç¬¬äºŒå‘¨æœŸçš„å…ƒç´ ï¼Œå¦‚Cï¼ŒNå’ŒOã€‚åƒHè¿™æ ·çš„ç¬¬ä¸€å‘¨æœŸå…ƒç´ ï¼Œæœ€å¤–å±‚åªèƒ½æ‰¿å—ä¸¤ä¸ªç”µå­ï¼Œæ‰€ä»¥å¯ä»¥è¯´ä¸æ»¡è¶³å…«éš…å¾‹ã€‚</p>
<p>å…«éš…å¾‹é€‚ç”¨çš„åœ°æ–¹å¾ˆå¤šï¼Œä¸é€‚ç”¨çš„åœ°æ–¹ä¹Ÿå¾ˆå¤šã€‚ä½†æ˜¯å…«éš…å¾‹å¾ˆå®ç”¨ï¼Œæ‰€ä»¥å­¦æœ¯ç•Œå°±æ¥å—äº†å…«éš…å¾‹ã€‚</p>
<h3 id="å¤æ‚åˆ†å­"><a href="#å¤æ‚åˆ†å­" class="headerlink" title="å¤æ‚åˆ†å­"></a>å¤æ‚åˆ†å­</h3><p>æ‰€è°“çš„â€œå¤æ‚åˆ†å­â€å…¶å®ä¸æ˜¯é‚£ç§åˆ†å­é‡åŠ¨è¾„ä¸Šåƒä¸‡çš„é‚£ç§å¤æ‚ï¼Œè€Œæ˜¯æŒ‡åˆ†å­å†…éƒ¨æƒ…å†µååˆ†å¤æ‚ã€‚</p>
<h4 id="ä¸€æ°§åŒ–ç¢³"><a href="#ä¸€æ°§åŒ–ç¢³" class="headerlink" title="ä¸€æ°§åŒ–ç¢³"></a>ä¸€æ°§åŒ–ç¢³</h4><p><strong>ä¸€æ°§åŒ–ç¢³</strong>æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚</p>
<p>æˆ‘ä»¬å…ˆå†™å‡ºCå’ŒOï¼š</p>
<p><img src="https://i.loli.net/2021/11/21/1wJ9YShy5jVWOCe.png" alt="5-1.png"></p>
<p>å› ä¸ºOæœ‰2ä¸ªå¯ä»¥ç”¨æ¥æˆé”®çš„ç”µå­ï¼Œæ‰€ä»¥æˆ‘ä»¬è®©å®ƒä¿©æˆå…ˆä¸€ä¸ªåŒé”®ï¼š</p>
<p><img src="https://i.loli.net/2021/11/21/mbkQwvHIBgYsACn.png" alt="5-2.png"></p>
<p>ç„¶åæˆ‘ä»¬çœ‹ä¸€ä¸‹ï¼š</p>
<p>Oå‘¨å›´æœ‰8ä¸ªç”µå­ï¼Œæ»¡è¶³å…«éš…å¾‹ï¼›è€ŒCå‘¨å›´æœ‰6ä¸ªç”µå­ï¼Œä¸æ»¡è¶³å…«éš…å¾‹ã€‚</p>
<p>æ­¤æ—¶æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œæœ‰ä¸€ç§é”®å«é…ä½é”®ã€‚<br>äºæ˜¯æˆ‘ä»¬è®©Oçš„å­¤å¯¹ç”µå­è¿›å…¥Cçš„ç©ºè½¨é“ï¼Œæˆé…ä½é”®ã€‚</p>
<p>ä¸€åˆ‡çœ‹èµ·æ¥éƒ½å¾ˆå¥½ã€‚</p>
<p>ä½†æ˜¯ï¼Œå…¶å® $\ce{C-O}$ ä¹‹é—´çš„ä¸€å¯¹ç”µå­å®é™…æ˜¯å±äºOçš„ï¼Œå¹¶ä¸æ˜¯ä¸¤è€…å…±äº«ã€‚è€Œä¸”ï¼ŒCä¹Ÿæ‹¿ä¸å‡ºé‚£ä¹ˆå¤šç”µå­æ¥æˆé”®ã€‚</p>
<p>è¿™æ—¶ï¼Œæˆ‘ä»¬å°±è®©Cå¸¦ä¸Šä¸€ä¸ªè´Ÿç”µè·ï¼Œçœ‹åšæ˜¯å¾—åˆ°äº†ä¸€ä¸ªç”µå­ï¼ŒåŒæ—¶è®©æ°§å¸¦ä¸Šä¸€ä¸ªæ­£ç”µè·ï¼Œçœ‹åšæ˜¯å¤±å»äº†ä¸€ä¸ªç”µå­ã€‚</p>
<p><img src="https://i.loli.net/2021/11/22/RPGpybJcUlSIEu5.png" alt="5-3.png"></p>
<p>å®é™…ä¸Šï¼Œæ— è®ºæ˜¯Cè¿˜æ˜¯Oï¼Œéƒ½æ²¡æœ‰å‘ç”Ÿç”µå­çš„å¾—å¤±ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬ç§°è¿™ç§ç”µè·ä¸º<strong>â€å½¢å¼ç”µè·â€œ</strong>ã€‚</p>
<h4 id="ä¸€æ°§åŒ–æ°®"><a href="#ä¸€æ°§åŒ–æ°®" class="headerlink" title="ä¸€æ°§åŒ–æ°®"></a>ä¸€æ°§åŒ–æ°®</h4><p>è€Œ<strong>ä¸€æ°§åŒ–æ°®</strong>å°±ç¨æœ‰ä¸åŒã€‚</p>
<p>æˆ‘ä»¬é¦–å…ˆå†™å‡ºæ°®å’Œæ°§ï¼š</p>
<p><img src="https://i.loli.net/2021/11/22/iOnG7alt8p1jbkY.png" alt="6-1.png"></p>
<p>åŒä¸Šï¼Œæˆ‘ä»¬é¦–å…ˆè®©ä»–ä¿©æˆä¸€ä¸ªåŒé”®ï¼š</p>
<p><img src="https://i.loli.net/2021/11/22/1o3ktQdCZINgMfP.png" alt="6-2.png"></p>
<p>ç„¶åæˆ‘ä»¬çœ‹ä¸€ä¸‹ï¼š</p>
<p>Oçš„å‘¨å›´æ»¡è¶³å…«éš…å¾‹ï¼Œä½†æ˜¯Nçš„å‘¨å›´ä¸æ»¡è¶³ã€‚</p>
<p>æˆ‘ä»¬å°è¯•åƒä¹‹å‰ä¸€æ ·æå‡ºæ¥ä¸€ä¸ªé…ä½é”®ï¼Œä½†æ˜¯è¿™æ ·ä¹Ÿæ— æµäºäº‹ã€‚</p>
<p>å…¶å®ï¼Œä¸€æ°§åŒ–æ°®æ˜¯ä¸€ä¸ªè‡ªç”±åŸºï¼Œä¸€ä¸ªâ€é•¿å‘½â€œçš„è‡ªç”±åŸºã€‚<br>ä¸€æ—¦è¿™æ ·è§£é‡Šå°±è§£é‡Šçš„é€šäº†ã€‚</p>
<h2 id="è‡ªç”±åŸº"><a href="#è‡ªç”±åŸº" class="headerlink" title="è‡ªç”±åŸº"></a>è‡ªç”±åŸº</h2><p>è‡ªç”±åŸºçš„ä¹¦å†™æœ‰ä¸¤ç§æ–¹æ³•ï¼šé…å¯¹æ³•å’Œå‡è£‚æ³•ã€‚</p>
<h3 id="é…å¯¹æ³•"><a href="#é…å¯¹æ³•" class="headerlink" title="é…å¯¹æ³•"></a>é…å¯¹æ³•</h3><p>é…å¯¹æ³•é€‚ç”¨äºçŸ¥é“å¤§ä½“ç»“æ„ï¼Œä½†æ˜¯ä¸çŸ¥é“å…·ä½“çš„é‚£ä¸ªç”µå­åœ¨å“ªé‡Œçš„æƒ…å†µã€‚<br>é…å¯¹æ—¶ï¼Œè¦å°½é‡æ»¡è¶³å…«éš…å¾‹ã€‚</p>
<p>ä»¥<strong>ç”²åŸºè‡ªç”±åŸº</strong>ä¸ºä¾‹ï¼š</p>
<p>ç”²åŸºè‡ªç”±åŸºå†™å‡ºæ¥æ˜¯ $\ce{ * CH3 }$ çš„æ ·å­ã€‚</p>
<p>æˆ‘ä»¬é¦–å…ˆå†™å‡ºä¸€ä¸ªCå’Œä¸‰ä¸ªHï¼š</p>
<p><img src="https://i.loli.net/2021/11/22/bU2ueq36F5fyiBt.png" alt="7-1.png"></p>
<p>æˆ‘ä»¬çŸ¥é“åœ¨ç”²åŸºè‡ªç”±åŸºç†é¢ï¼Œä¸‰ä¸ªHéƒ½ä¸Cæˆé”®ï¼š</p>
<p><img src="https://i.loli.net/2021/11/22/wlMR9XL1DhGmCTI.png" alt="7-2.png"></p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œç°åœ¨ä¸æ»¡è¶³å…«éš…å¾‹çš„åªæœ‰ä¸€ä¸ªCåŸå­ã€‚æ‰€ä»¥ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬æœ€ç»ˆå¾—åˆ°çš„è‡ªç”±åŸºçš„ç»“æ„ã€‚</p>
<h3 id="å‡è£‚æ³•"><a href="#å‡è£‚æ³•" class="headerlink" title="å‡è£‚æ³•"></a>å‡è£‚æ³•</h3><p>å‡è£‚æ³•é€‚ç”¨äºä¸çŸ¥é“å¤§ä½“ç»“æ„çš„æ€æƒ³ã€‚</p>
<p><strong>å‡è£‚</strong>æ˜¯æŒ‡å…±ä»·é”®æ–­è£‚æ—¶ï¼Œå…±ç”¨ç”µå­å¯¹å‡åŒ€åˆ†é…ç»™ä¸¤ä¸ªåˆ†å­æ®‹ç‰‡ï¼Œäº§ç”Ÿä¸¤ä¸ªè‡ªç”±åŸºçš„æƒ…å†µã€‚</p>
<p>è¿˜æ˜¯ä»¥<strong>ç”²åŸºè‡ªç”±åŸº</strong>ä¸ºä¾‹ã€‚</p>
<p>æˆ‘ä»¬ä¸çŸ¥é“ç”²åŸºè‡ªç”±åŸºæ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚ä½†æ˜¯æˆ‘ä»¬çŸ¥é“ç”²çƒ·æ˜¯ä»€ä¹ˆç»“æ„å•Šï¼</p>
<p>æˆ‘ä»¬å‡è®¾ç”²çƒ·ä¹‹ä¸­çš„ä¸€ä¸ª $\ce{C-H}$ é”®å‘ç”Ÿäº†å‡è£‚ã€‚<br>æ ¹æ®å‡è£‚çš„å®šä¹‰ï¼Œç”²çƒ·æœ€ç»ˆä¼šå‡è£‚æˆä¸ºä¸€ä¸ªç”²åŸºè‡ªç”±åŸºå’Œä¸€ä¸ªæ°¢åŸå­ï¼ˆæˆ–è€…è¯´æ°¢è‡ªç”±åŸºï¼‰ï¼š</p>
<p><img src="https://i.loli.net/2021/11/22/16BuMmPr3oXsFiH.png" alt="7-3.png"></p>
<p>è€Œæˆ‘ä»¬æ˜¯çŸ¥é“ç”²çƒ·çš„ç»“æ„çš„ï¼š</p>
<p><img src="https://i.loli.net/2021/11/22/IJcbSTDUZr5xnqF.png" alt="7-4.png"></p>
<p>äºæ˜¯æˆ‘ä»¬å°±å¾—åˆ°äº†ç”²åŸºè‡ªç”±åŸºçš„ç»“æ„ã€‚</p>
<h2 id="ç¦»å­"><a href="#ç¦»å­" class="headerlink" title="ç¦»å­"></a>ç¦»å­</h2><p>ç¦»å­çš„ä¹¦å†™ä¹Ÿæœ‰ä¸¤ç§æ–¹æ³•ã€‚</p>
<h3 id="ç”±è‡ªç”±åŸºè½¬åŒ–è€Œæ¥"><a href="#ç”±è‡ªç”±åŸºè½¬åŒ–è€Œæ¥" class="headerlink" title="ç”±è‡ªç”±åŸºè½¬åŒ–è€Œæ¥"></a>ç”±è‡ªç”±åŸºè½¬åŒ–è€Œæ¥</h3><p>ç¦»å­å¯ä»¥çœ‹åšæ˜¯ä¸­æ€§ç‰©è´¨å¾—ï¼ˆæˆ–å¤±ï¼‰$\ce{1e-}$ è½¬åŒ–è€Œæ¥çš„ã€‚<br>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè¿™ä¸ªä¸­æ€§ç‰©è´¨æ˜¯è‡ªç”±åŸºã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬ä¸¾<strong>ç”²åŸºæ­£ç¦»å­</strong>å’Œ<strong>ç”²åŸºè´Ÿç¦»å­</strong>çš„ä¾‹å­ã€‚<br>ä»–ä»¬ä¸¤ä¸ªéƒ½å¯ä»¥çœ‹åšæ˜¯ç”²åŸºè‡ªç”±åŸºè½¬åŒ–è€Œæ¥ã€‚<br>ç”²åŸºæ­£ç¦»å­å¯ä»¥çœ‹åšæ˜¯ç”²åŸºè‡ªç”±åŸºå¤±å» $\ce{1e-}$ ï¼Œ<br>è€Œç”²åŸºè´Ÿç¦»å­å¯ä»¥çœ‹åšæ˜¯ç”²åŸºè‡ªç”±åŸºå¾—åˆ° $\ce{1e-}$ ã€‚</p>
<p><img src="https://i.loli.net/2021/11/22/osXEe6zhHQZ4rPC.png" alt="8-1.png"></p>
<p>è€Œæˆ‘ä»¬å·²ç»çŸ¥é“äº†ç”²åŸºè‡ªç”±åŸºçš„ç»“æ„ï¼Œæ‰€ä»¥æ¨å‡ºç”²åŸºæ­£ç¦»å­å’Œç”²åŸºè´Ÿç¦»å­çš„ç»“æ„åº”è¯¥ä¸ç®—å¤ªéš¾ã€‚</p>
<p><img src="https://i.loli.net/2021/11/22/ZAvkdrUVFC4O5Kq.png" alt="8-2.png"></p>
<h3 id="å¼‚è£‚æ³•"><a href="#å¼‚è£‚æ³•" class="headerlink" title="å¼‚è£‚æ³•"></a>å¼‚è£‚æ³•</h3><p><strong>å¼‚è£‚</strong>æŒ‡çš„æ˜¯åœ¨å…±ä»·é”®æ–­è£‚æ—¶ï¼Œå…±ç”¨ç”µå­å¯¹å®Œå…¨ç»™äºˆæŸä¸€åˆ†å­æ®‹ç‰‡ï¼Œå½¢æˆä¸¤ä¸ªç¦»å­ï¼ˆä¸€æ­£ä¸€è´Ÿï¼‰çš„æƒ…å†µã€‚</p>
<p>æˆ‘ä»¬è¿˜æ˜¯ä¸¾<strong>ç”²åŸºæ­£ç¦»å­</strong>å’Œ<strong>ç”²åŸºè´Ÿç¦»å­</strong>çš„ä¾‹å­ã€‚<br>è¿™æ¬¡æˆ‘ä»¬ä»ä¹™çƒ·å¼€å§‹ã€‚<br>æˆ‘ä»¬æ¸…æ¥šåœ°çŸ¥é“ä¹™çƒ·çš„ç»“æ„ã€‚å½“ä¹™çƒ·çš„ $\ce{C-C}$ é”®æ–­è£‚æ—¶ï¼Œæˆ‘ä»¬å‡è®¾å®ƒå‘ç”Ÿäº†å¼‚è£‚ï¼Œå°±åƒè¿™æ ·ï¼š</p>
<p><img src="https://i.loli.net/2021/11/22/RtkndPMrUIa1ch9.png" alt="8-3.png"></p>
<p>å› ä¸ºæˆ‘ä»¬çŸ¥é“ä¹™çƒ·çš„ç»“æ„ï¼Œæˆ‘ä»¬å°±èƒ½å¾ˆå¿«åœ°æ¨å‡ºç”²åŸºæ­£ç¦»å­å’Œç”²åŸºè´Ÿç¦»å­çš„ç»“æ„ï¼š</p>
<p><img src="https://i.loli.net/2021/11/22/gm2IcwjxnCXfyKB.png" alt="8-4.png"></p>
<h2 id="å½¢å¼ç”µè·"><a href="#å½¢å¼ç”µè·" class="headerlink" title="å½¢å¼ç”µè·"></a>å½¢å¼ç”µè·</h2><p>å½¢å¼ç”µè·æœ‰ä¸€ç§æ ‡æ³•ï¼š<br>$$<br>å½¢å¼ç”µè· &#x3D; ä¸»æ—åºæ•° - ä¸åŒ…æ‹¬å•ç”µå­çš„æœªæˆé”®ç”µå­æ•° - \frac{1}{2} \times æˆé”®ç”µå­æ•°<br>$$<br>å…¶ä¸­çš„æˆé”®ç”µå­æ•°ä¹Ÿå¯ä»¥è¯´æ˜¯åŒ–å­¦é”®æ•°ã€‚</p>
<p>å½“ç„¶ï¼Œæœ‰æ—¶å€™å½¢å¼ç”µè·å¯ä»¥è½¬åŒ–ä¸ºå®é™…çš„ç”µè·ã€‚<br>ä¾‹å¦‚ç”²åŸºè´Ÿç¦»å­ï¼š $\ce{C}:4-2-3&#x3D;-1$ ï¼Œæ­£å¥½å¸¦1ä¸ªè´Ÿç”µè·ã€‚<br>ç”²åŸºè‡ªç”±åŸºï¼š $\ce{C}:4-0-4&#x3D;0$ ï¼Œè¯´æ˜ç”²åŸºè‡ªç”±åŸºæ˜¯ç”µä¸­æ€§çš„ã€‚<br>æ°´åˆæ°¢ç¦»å­ï¼š $\ce{O}:6-2-3&#x3D;+1$ ï¼Œæ­£å¥½å¸¦1ä¸ªæ­£ç”µè·ã€‚</p>
<p>åœ¨ä¸€æ°§åŒ–äºŒæ°®ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“ä¸¤ä¸ªNåŸå­ä¸ä¸€ä¸ªOåŸå­æ˜¯ä»¥ $\ce{N-N-O}$ çš„å½¢å¼è¿æ¥èµ·æ¥çš„ã€‚æˆ‘ä»¬æ„é€ å‡ºäº†ä¸¤ç§è§£é‡Š $\ce{N2O}$ åˆ†å­ç»“æ„çš„æ¨¡å‹ï¼š</p>
<p><img src="https://i.loli.net/2021/11/23/8IKiqWcDSn3mVFr.png" alt="8-5.png"></p>
<p>ä¸Šé¢çš„é‚£ä¸ªæ»¡è¶³äº†å·¦è¾¹åŸå­â€œæ°®ä¸‰ä»·â€çš„åŸåˆ™ï¼Œè€Œä¸‹é¢çš„é‚£ä¸ªæ»¡è¶³äº†ä¸­é—´åŸå­çš„å…«éš…å¾‹ã€‚</p>
<p>æˆ‘ä»¬åˆ†åˆ«ç®—ä¸€ä¸‹å„è‡ªçš„å½¢å¼ç”µè·ï¼š</p>
<p>ä¸‰ä»·æ°®ï¼š $\ce{N}:5-2-3&#x3D;0$ ï¼Œå‘ˆç”µä¸­æ€§ï¼›<br>å››ä»·æ°®ï¼š $\ce{N}:5-0-4&#x3D;+1$ ï¼Œå¸¦1ä¸ªæ­£ç”µè·ï¼›<br>ä¸€ä»·æ°§ï¼š $\ce{O}:6-6-1&#x3D;-1$ ï¼Œå¸¦1ä¸ªè´Ÿç”µè·ã€‚</p>
<p>äºŒä»·æ°®ï¼š $\ce{N}:5-4-2&#x3D;-1$ ï¼Œå¸¦1ä¸ªè´Ÿç”µè·ï¼›<br>å››ä»·æ°®ï¼š $\ce{N}:5-0-4&#x3D;+1$ ï¼Œå¸¦1ä¸ªæ­£ç”µè·ï¼›<br>äºŒä»·æ°§ï¼š $\ce{O}:6-4-2&#x3D;0$ ï¼Œå‘ˆç”µä¸­æ€§ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œä¸¤ç§æƒ…å†µéƒ½æ˜¯åˆç†å’Œç”µä¸­æ€§çš„ã€‚</p>
<p>è¿™ä¸¤ä¸ªç»“æ„å¼å°±å«åšä¸€æ°§åŒ–äºŒæ°®çš„<strong>â€œå…±æŒ¯å¼â€</strong>ã€‚<br>å¸¸è§çš„ç±»ä¼¼æƒ…å†µè¿˜æœ‰é…®-çƒ¯é†‡ç­‰ç­‰ã€‚</p>
<p><img src="https://i.loli.net/2021/11/23/IglOnuxvWo9i7YS.png" alt="8-6.png"></p>
<h1 id="å¦‚ä½•ç¡®å®šå¸¸è§å…ƒç´ çš„å½¢å¼ç”µè·ï¼Ÿ"><a href="#å¦‚ä½•ç¡®å®šå¸¸è§å…ƒç´ çš„å½¢å¼ç”µè·ï¼Ÿ" class="headerlink" title="å¦‚ä½•ç¡®å®šå¸¸è§å…ƒç´ çš„å½¢å¼ç”µè·ï¼Ÿ"></a>å¦‚ä½•ç¡®å®šå¸¸è§å…ƒç´ çš„å½¢å¼ç”µè·ï¼Ÿ</h1><p>ä¸‹é¢å°†ä¼šåˆ—å‡ºæœ‰æœºåŒ–å­¦é‡Œé¢å¸¸è§çš„éƒ¨åˆ†å…ƒç´ çš„Lewisç»“æ„å¼å’Œå½¢å¼ç”µè·ã€‚</p>
<h2 id="æ°¢"><a href="#æ°¢" class="headerlink" title="æ°¢"></a>æ°¢</h2><p>æ°¢æœ‰ä»¥ä¸‹å‡ ç§å½¢å¼ï¼š</p>
<p><img src="https://i.loli.net/2021/11/22/blwaz4qsV8BukmP.png" alt="9-1.png"></p>
<p>ä»å·¦åˆ°å³åˆ†åˆ«æ˜¯ï¼šæ°¢æ­£ç¦»å­ã€æ°¢è‡ªç”±åŸºã€æ°¢è´Ÿç¦»å­å’Œå·²ç»å½¢æˆäº†åŒ–å­¦é”®çš„æ°¢ã€‚</p>
<p><img src="https://i.loli.net/2021/11/22/3uTs6IY5wOXmy2D.png" alt="9-2.png"></p>
<h2 id="ç¡¼"><a href="#ç¡¼" class="headerlink" title="ç¡¼"></a>ç¡¼</h2><p>ç¡¼æœ‰ä»¥ä¸‹å‡ ç§å½¢å¼ï¼š</p>
<p><img src="https://i.loli.net/2021/11/22/EIhKw9nV4xjvL83.png" alt="9-3.png"></p>
<p>ç¡¼å¯ä»¥è¿3æˆ–4æ ¹åŒ–å­¦é”®ã€‚</p>
<p><img src="https://i.loli.net/2021/11/23/jBQ2pdEOHPvFewq.png" alt="9-4.png"></p>
<p>æ­¤æ—¶æˆ‘ä»¬éœ€è¦æ³¨æ„ï¼šè¿™é‡Œçš„ç¡¼æ˜¯ä¸æ»¡è¶³å…«éš…å¾‹çš„ã€‚</p>
<h2 id="ç¢³"><a href="#ç¢³" class="headerlink" title="ç¢³"></a>ç¢³</h2><p>ç¢³æœ‰ä»¥ä¸‹å‡ ç§å½¢å¼ï¼š</p>
<p><img src="https://i.loli.net/2021/11/22/YTfUS3mvdQH2PrF.png" alt="9-5.png"></p>
<p>ä»å·¦åˆ°å³åˆ†åˆ«æ˜¯å››ä»·ç¢³ã€ç¢³æ­£ç¦»å­ã€ç¢³è‡ªç”±åŸºå’Œç¢³è´Ÿç¦»å­ã€‚</p>
<p><img src="https://i.loli.net/2021/11/23/Fu8iClQoN6YD9yM.png" alt="9-6.png"></p>
<p>è¿™é‡Œæ‰€è¯´çš„å››ä»·ç¢³é€‚ç”¨äºåŒ…æ‹¬çƒ·ã€çƒ¯ã€ç‚”ç­‰åœ¨å†…çš„æƒ…å†µï¼Œå³åŒ…æ‹¬å•é”®ã€åŒé”®å’Œåé”®ã€‚</p>
<p><img src="https://i.loli.net/2021/11/23/AsRuGlnZ4HCo1jO.png" alt="9-5-1.png"></p>
<h2 id="æ°®"><a href="#æ°®" class="headerlink" title="æ°®"></a>æ°®</h2><p>æ°®æœ‰ä»¥ä¸‹å‡ ç§å½¢å¼ï¼š</p>
<p><img src="https://i.loli.net/2021/11/23/bkgipc8AQodh2r7.png" alt="9-7.png"></p>
<p>ä»å·¦åˆ°å³åˆ†åˆ«æ˜¯ä¸‰ä»·æ°®ï¼Œæ°®æ­£ç¦»å­ä¸æ°®è´Ÿç¦»å­ã€‚</p>
<p><img src="https://i.loli.net/2021/11/23/t6Eg5FsIyAjLlTx.png" alt="9-8.png"></p>
<p>å…¶ä¸­ï¼Œä¸‰ä»·æ°®é€‚ç”¨äºä¾‹å¦‚èƒºã€äºšèƒºã€æ°°åŸºç­‰åœ¨å†…çš„æƒ…å†µï¼Œå³åŒ…æ‹¬å•é”®ã€åŒé”®å’Œåé”®ï¼›<br>æ°®æ­£ç¦»å­é€‚ç”¨äºä¾‹å¦‚é“µã€äºšé“µã€å¼‚æ°°ç­‰åœ¨å†…çš„æƒ…å†µï¼›<br>æ°®è´Ÿç¦»å­å¸¸è§çš„æƒ…å†µåªæœ‰æ°¨åŸºè´Ÿç¦»å­ï¼ˆä¾‹å¦‚æ°¨åŸºé’ ï¼Œé‡Œé¢é’ å‘ˆè´Ÿä¸€ä»·ï¼‰ã€‚</p>
<p><img src="https://i.loli.net/2021/11/23/GNAztaJEHobTxnU.png" alt="9-7-1.png"></p>
<h2 id="æ°§"><a href="#æ°§" class="headerlink" title="æ°§"></a>æ°§</h2><p>æ°§æœ‰ä»¥ä¸‹å‡ ç§å½¢å¼ï¼š</p>
<p><img src="https://i.loli.net/2021/11/23/ZFQ8dsyEeVTlbKh.png" alt="9-9.png"></p>
<p>ä»å·¦å¾€å³åˆ†åˆ«æ˜¯çƒ·æ°§è´Ÿç¦»å­ï¼ŒäºŒä»·æ°§å’Œçƒ·æ°§æ­£ç¦»å­ã€‚</p>
<p><img src="https://i.loli.net/2021/11/23/eqI3wWSgpB1zr2H.png" alt="9-10.png"></p>
<p>äºŒä»·æ°§åŒ…æ‹¬é†‡ã€é…šã€é†šã€é…¯é‡Œé¢çš„å•é”®ï¼Œä¹ŸåŒ…æ‹¬é†›ã€é…®ã€é…¸ã€é…°é‡Œé¢çš„åŒé”®ã€‚<br>çƒ·æ°§æ­£ç¦»å­çš„å¸¸è§å‡ºç°ä½ç½®ä¸ºæ°´åˆæ°¢ç¦»å­å’Œæ°§î†Œã€‚</p>
<p><img src="https://i.loli.net/2021/11/23/gHnstFZBVKEdh5j.png" alt="9-9-1.png"></p>
<h2 id="å¤ç´ "><a href="#å¤ç´ " class="headerlink" title="å¤ç´ "></a>å¤ç´ </h2><p><del>é²è‚ƒ</del>å¤ç´ æœ‰ä»¥ä¸‹å‡ ç§å½¢å¼ï¼š</p>
<p><img src="https://i.loli.net/2021/11/23/Ecwt9hFCkOKZfuN.png" alt="9-11.png"></p>
<p>ä»å·¦å¾€å³åˆ†åˆ«æ˜¯å¤è´Ÿç¦»å­ï¼Œå¤ç´ åŸºå›¢å’ŒäºŒä»·å¤ã€‚</p>
<p><img src="https://i.loli.net/2021/11/23/ZXWOb7E3yu6qmGA.png" alt="9-12.png"></p>
<p>äºŒä»·çš„å¤ç´ åœ¨èŠ³é¦™åŒ–åˆç‰©çš„äº²ç”µåŠ æˆé‡Œé¢å¯ä»¥çœ‹è§ã€‚</p>
<h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>æœ€åé™„ä¸Šä¸€å¼ æ€»è¡¨ï¼š<a href="/bits/Lewis.xlsx">Lewisæ€»è¡¨</a></p>
]]></content>
      <categories>
        <category>åŒ–å­¦</category>
      </categories>
      <tags>
        <tag>åŒ–å­¦</tag>
      </tags>
  </entry>
  <entry>
    <title>è½¨é“ç†è®º</title>
    <url>/chemistry/orbitals/</url>
    <content><![CDATA[<p>åŸå­è½¨é“ç†è®ºï¼Œæ‚åŒ–è½¨é“ç†è®ºï¼Œä»·å±‚ç”µå­äº’æ–¥æ¨¡å‹ï¼Œåˆ†å­è½¨é“ç†è®ºã€‚</p>
<span id="more"></span>

<h1 id="è½¨é“"><a href="#è½¨é“" class="headerlink" title="è½¨é“"></a>è½¨é“</h1><h2 id="ä½•ä¸ºè½¨é“ï¼Ÿ"><a href="#ä½•ä¸ºè½¨é“ï¼Ÿ" class="headerlink" title="ä½•ä¸ºè½¨é“ï¼Ÿ"></a>ä½•ä¸ºè½¨é“ï¼Ÿ</h2><p>è¿™é‡Œæˆ‘ä»¬æ‰€æŒ‡çš„è½¨é“ï¼Œåœ¨è‹±æ–‡é‡Œçš„ç¿»è¯‘å…¶å®æ˜¯ â€œorbitalâ€ ï¼Œä¸ç°ä»£æ±‰è¯­é‡Œé¢çš„â€è½¨é“å®šä¹‰æœ‰ç»†å¾®çš„å·®åˆ«ã€‚</p>
<h3 id="ç»å°”ç†è®º"><a href="#ç»å°”ç†è®º" class="headerlink" title="ç»å°”ç†è®º"></a>ç»å°”ç†è®º</h3><p>ç»å°”(Bohr)ç†è®ºè®¤ä¸ºï¼Œç”µå­åœ¨å›´ç»•åŸå­æ ¸çš„ç‰¹å®šè½¨é“ä¸Šé¢è¿åŠ¨ï¼Œå°±åƒæ’æ˜Ÿç³»ä¸­çš„è¡Œæ˜Ÿå›´ç»•æ’æ˜Ÿè¿è½¬ä¸€æ ·ã€‚</p>
<p>è¿™å°±æ˜¯â€œè½¨é“â€ä¸€è¯çš„æ¥æºï¼Œå½¢è±¡åœ°è§£é‡Šäº†å¤§éƒ¨åˆ†çš„é—®é¢˜ã€‚</p>
<h3 id="ç°ä»£ç†è®º"><a href="#ç°ä»£ç†è®º" class="headerlink" title="ç°ä»£ç†è®º"></a>ç°ä»£ç†è®º</h3><p>ç°ä»£æ„ä¹‰ä¸Šçš„â€œè½¨é“â€æ˜¯è–›å®šè°”(SchÃ¶dinger)æ–¹ç¨‹çš„ä¸€ä¸ªç»“æœã€‚<br>å®ƒæç»˜äº†ç”µå­åœ¨ç©ºé—´ä¸­çš„åˆ†å¸ƒã€‚</p>
<p>1926å¹´ï¼Œå¥¥åœ°åˆ©ç‰©ç†å­¦å®¶è–›å®šè°”æå‡ºäº†è‘—åçš„<strong>æ³¢åŠ¨æ–¹ç¨‹</strong>ï¼Œåˆç§°<strong>è–›å®šè°”æ–¹ç¨‹</strong>ã€‚å®ƒé•¿è¿™ä¸ªæ ·å­ï¼š</p>
<p>$$<br>\frac{\partial^2Ïˆ}{\partial x^2}+\frac{\partial^2Ïˆ}{\partial y^2}+\frac{\partial^2Ïˆ}{\partial z^2}+\frac{8Ïˆ^2m}{h^2}(E-V)Ïˆ&#x3D;0<br>$$<br>å…¶ä¸­ï¼Œhæ˜¯æ™®æœ—å…‹å¸¸æ•°ï¼Œmæ˜¯å¾®ç²’çš„è´¨é‡ï¼ŒEä¸ºå¾®ç²’çš„æ€»èƒ½é‡ï¼ŒVæ˜¯åŠ¿èƒ½ï¼Œ(x,y,z)æ˜¯ä¸€ç»„ä¸‰ç»´åæ ‡ï¼Œä»£è¡¨ç²’å­çš„ä½ç½®ï¼Œè€ŒÏˆå°±ä»£è¡¨æ³¢å‡½æ•°ã€‚<br>çœ‹èµ·æ¥å°±å¾ˆå¤æ‚ã€‚ç¡®å®ï¼Œå› ä¸ºå®ƒç”¨åˆ°äº†åå¾®åˆ†ï¼Œè€Œè¿™ä¸åœ¨æˆ‘çš„çŸ¥è¯†èŒƒå›´ä¹‹å†…ï¼Œè€Œä¸”å¯èƒ½è¿‘å‡ å¹´éƒ½ä¸ä¼šåœ¨ã€‚<br>æˆ‘ä»¬åªéœ€è¦äº†è§£å‡ ä»¶äº‹æƒ…ï¼š</p>
<ol>
<li>ç”±è–›å®šè°”æ–¹ç¨‹å¯ä»¥è§£å‡ºæ¥ä¸€ç³»åˆ—æ³¢å‡½æ•°Ïˆã€‚</li>
<li>æ³¢å‡½æ•°Ïˆä»£è¡¨äº†ç”µå­åœ¨åŸå­ä¸­çš„å„ç§è¿åŠ¨çŠ¶æ€ã€‚</li>
<li>æ³¢å‡½æ•°Ïˆæ˜¯ä¸‰ç»´ç©ºé—´åæ ‡å‡½æ•°[$Ïˆ(x,y,z)$]ï¼Œæœ‰æ—¶å€™è¿˜ä¼šä½¿ç”¨ä¸€ç§ç±»ä¼¼æåæ ‡çš„å½¢å¼ $Ïˆ(r,Î¸,Ï†)$ æ¥è¡¨ç¤ºï¼Œå…¶ä¸­ræ˜¯å¾®ç²’è·ç¦»åæ ‡åŸç‚¹çš„è·ç¦»ï¼ŒÎ¸æ˜¯å¾®ç²’ä¸åæ ‡åŸç‚¹çš„è¿çº¿åœ¨yzå¹³é¢ä¸Šé¢çš„æŠ•å½±ä¸zè½´çš„å¤¹è§’ï¼ŒÏ†æ˜¯å¾®ç²’ä¸åæ ‡åŸç‚¹çš„è¿çº¿åœ¨xyå¹³é¢ä¸Šé¢çš„æŠ•å½±ä¸xè½´çš„å¤¹è§’ã€‚ä¸¤è€…ä¹‹é—´æœ‰è¿™æ ·ä¸€ç§å…³ç³»ï¼š<br>$$\begin{cases}x&#x3D;r \sin Î¸ \cos Ï† \\ y&#x3D;r \sin Î¸ \sin Ï† \\z&#x3D;r \cos Î¸ \end{cases}$$</li>
<li>ç”µå­åœ¨æ ¸å¤–ç©ºé—´çš„ä½ç½®æŒ‰ç…§æ³¢å‡½æ•°çš„å¹³æ–¹ $Ïˆ^2$å‘ˆæ¦‚ç‡åˆ†å¸ƒã€‚</li>
</ol>
<h2 id="é‡å­æ•°"><a href="#é‡å­æ•°" class="headerlink" title="é‡å­æ•°"></a>é‡å­æ•°</h2><p>ä¸ºäº†ä¿è¯ $|Ïˆ(r,Î¸,Ï†)|^2$ å…·æœ‰æ¦‚ç‡çš„æ„ä¹‰ï¼Œç§‘å­¦å®¶ä»¬åœ¨ç»™æ³¢å‡½æ•°é™„åŠ äº†å•å€¼ã€æœ‰é™ã€è¿ç»­ä¸‰ä¸ªæ¡ä»¶ä¹‹åï¼Œå‡ºç°äº†ä¸‰ä¸ªé‡å­æ•°ã€‚</p>
<h3 id="ä¸»é‡å­æ•°-n"><a href="#ä¸»é‡å­æ•°-n" class="headerlink" title="ä¸»é‡å­æ•°$n$"></a>ä¸»é‡å­æ•°$n$</h3><p>ä¸»é‡å­æ•°$n$è§„å®šäº†ç”µå­å‡ºç°çš„æœ€å¤§æ¦‚ç‡åŒºåŸŸç¦»æ ¸çš„è¿œè¿‘å’Œç”µå­èƒ½é‡çš„é«˜ä½ã€‚<br>ä¸»é‡å­æ•°çš„å–å€¼ä¸å—ä»»ä½•é™åˆ¶ï¼Œä¸º $\mathbb{N}^+$ ï¼ˆå³æ­£æ•´æ•°<del>ï¼Œç»™æ²¡æœ‰å­¦è¿‡çš„äººçœ‹çš„</del>ï¼‰ã€‚<br>å‡¡æ˜¯$n$ç›¸åŒçš„ç”µå­ç§°ä¸ºåŒå±‚ç”µå­ï¼Œå¹¶ç”¨ç¬¦å·$K,L,M,N,O,P,Q,\cdots$ç­‰ä»£è¡¨$n&#x3D;1,2,3,4,5,6,7,\cdots$ç”µå­å±‚ã€‚<br>æ ¹æ®æ°¢åŸå­å’Œç±»æ°¢ç¦»å­çš„èƒ½é‡å…¬å¼ $E_n &#x3D; -\frac{me^4z^2}{8Îµ_0^2h^2n^2} &#x3D; -13.6 \frac{z^2}{n^2} (eV) &#x3D; -1312 \frac{z^2}{n^2} (kJÂ·mol^{-1})$ å¯çŸ¥ï¼Œ$n$è¶Šå¤§ï¼Œç”µå­èƒ½é‡è¶Šé«˜ã€‚</p>
<h3 id="è§’é‡å­æ•°-l"><a href="#è§’é‡å­æ•°-l" class="headerlink" title="è§’é‡å­æ•°$l$"></a>è§’é‡å­æ•°$l$</h3><p>è§’é‡å­æ•°$l$å†³å®šäº†ç”µå­è§’åŠ¨é‡çš„å¤§å°ï¼Œä»–è§„å®šäº†ç”µå­åœ¨ç©ºé—´è§’åº¦çš„åˆ†å¸ƒæƒ…å†µï¼Œä¸ç”µå­äº‘çš„å½¢æ€å¯†åˆ‡ç›¸å…³ã€‚<br>$l$çš„å€¼å—$n$çš„é™åˆ¶ï¼Œåªèƒ½å–$[0,n-1]$èŒƒå›´å†…çš„æ•´æ•°ã€‚<br>å¯¹äºåŒä¸€ä¸ª$n$å€¼ï¼Œ$l$å¯ä»¥å–$0,1,2,3,\cdots$ç­‰å…±$n$ä¸ªå€¼ï¼Œç›¸åº”çš„ç”µå­ç§°ä¸º$s,p,d,f,\cdots$ç”µå­ã€‚</p>
<h3 id="ç£é‡å­æ•°-m"><a href="#ç£é‡å­æ•°-m" class="headerlink" title="ç£é‡å­æ•°$m$"></a>ç£é‡å­æ•°$m$</h3><p>ç£é‡å­æ•°$m$åæ˜ äº†åŸå­çš„ç£æ€§è´¨ï¼Œæ•…ç§°ç£é‡å­æ•°ã€‚<br>$m$çš„å–å€¼å—$l$çš„é™åˆ¶ï¼Œå¯ä»¥å–$[-l,l]$èŒƒå›´å†…çš„æ•´æ•°ï¼Œå…±$2l+1$ä¸ªå€¼ã€‚<br>ç£é‡å­æ•°ä¸ç”µå­è½¨é“è¿åŠ¨çš„è§’åŠ¨é‡åœ¨å¤–åŠ ç£åœºæ–¹å‘çš„åˆ†é‡$l_z$æœ‰å…³ï¼Œæ»¡è¶³è¿™æ ·ä¸€ä¸ªå¼å­ï¼š $l_z &#x3D; m \hbar$ ï¼Œå…¶ä¸­ $\hbar &#x3D; \frac{h}{2Ï€}$ ã€‚<br>è¿™è¯´æ˜å½“æˆ‘ä»¬æŠŠæ°¢åŸå­æ”¾åœ¨ç£åœºå½“ä¸­æ—¶ï¼Œå®ƒçš„è§’åŠ¨é‡çš„ç©ºé—´å–å‘ä¸èƒ½æ˜¯éšæ„çš„ï¼Œåªèƒ½æŒ‰ç…§ä¸Šè¿°è§„åˆ™å–å‘ã€‚</p>
<h3 id="è‡ªæ—‹é‡å­æ•°-m-s"><a href="#è‡ªæ—‹é‡å­æ•°-m-s" class="headerlink" title="è‡ªæ—‹é‡å­æ•°$m_s$"></a>è‡ªæ—‹é‡å­æ•°$m_s$</h3><p>æˆ‘ä»¬éƒ½çŸ¥é“æœ‰ä¸€ç§ç°è±¡å«åšç„°è‰²ååº”ï¼Œå®ƒæ˜¯åŸºæ€åŸå­æ¥å—èƒ½é‡è·ƒè¿åˆ°æ¿€å‘æ€å†è·ƒè¿å›åŸºæ€æ‰€é‡Šæ”¾çš„å…‰å­çš„ä½“ç°ã€‚è¿™äº›å…‰å­çš„é¢‘ç‡ä»ç´«å¤–åˆ°çº¢å¤–éƒ½æœ‰ï¼Œä½†æ˜¯å¤§å¤šæ•°é‡‘å±å…ƒç´ éƒ½æœ‰è½åœ¨å¯è§å…‰èŒƒå›´å†…çš„é¢‘ç‡ã€‚<br>æ¯ä¸€ç§å…ƒç´ å‘å°„å‡ºçš„å…‰å­çš„é¢‘ç‡å„ä¸ç›¸åŒï¼Œåæ˜ åˆ°å®è§‚ä¸Šå°±æ˜¯æ¯ä¸€ç§å…ƒç´ éƒ½æœ‰è‡ªå·±ç‹¬æœ‰çš„ç„°è‰²ã€‚<br>åŸºäºè¿™ä¸ªç°è±¡ï¼Œæˆ‘ä»¬å¼€å‘å‡ºäº†ä¸€ç§ä»ªå™¨â€”â€”å…‰è°±ä»ªï¼Œæ¥æµ‹å®šä¸€ä¸ªç‰©è´¨é‡Œé¢å«æœ‰çš„å…ƒç´ ã€‚</p>
<p>ä½†æ˜¯å½“æˆ‘ä»¬ä½¿ç”¨é«˜åˆ†è¾¨ç‡çš„å…‰è°±ä»ªè¿›è¡Œè§‚å¯Ÿçš„æ—¶å€™ï¼Œæˆ‘ä»¬å‘ç°å…‰è°±çº¿å¯ä»¥è¿›ä¸€æ­¥åˆ†è£‚ã€‚<br>æ¯”å¦‚æ°¢åŸå­å…‰è°±ä¸­ï¼Œ2påˆ°1sçš„è·ƒè¿æ‰€äº§ç”Ÿçš„ä¸€æ¡è°±çº¿ä¸­åŒ…å«ç€ä¸¤æ¡é—´éš”å¾ˆå°çš„è°±çº¿ï¼›é’ åŸå­çš„ä¸€æ¡é»„è‰²çº¿å…¶å®ä¹Ÿæ˜¯åŒçº¿ï¼Œæ³¢é•¿åˆ†åˆ«ä¸º589nmå’Œ589.6nmã€‚<br>è¿™ç§ç°è±¡ç§°ä¸ºå…‰è°±çº¿çš„ç²¾ç»†ç»“æ„ã€‚</p>
<p>è¿™ä¸€ç°è±¡æ— æ³•ç”¨ä¹‹å‰è§£è–›å®šè°”æ–¹ç¨‹å¾—åˆ°çš„ä¸‰ä¸ªé‡å­æ•°$n,l,m$æ¥è§£é‡Šã€‚<br>1925å¹´ï¼Œäººä»¬ä¸ºäº†è§£é‡Šæ­¤ç°è±¡ï¼Œæ²¿ç”¨äº†æ—§é‡å­è®ºä¸­å‰”é™¤ç”µå­æœ‰è‡ªæ—‹è¿åŠ¨çš„å‡è®¾ï¼Œå¼•å…¥äº†ç¬¬å››ä¸ªé‡å­æ•°ï¼Œç§°ä¸ºè‡ªæ—‹é‡å­æ•°ï¼Œå¹¶ç¡®å®šè‡ªæ—‹é‡å­æ•°$m_s$æœ‰$+\frac{1}{2}$å’Œ$-\frac{1}{2}$ä¸¤ä¸ªå€¼ï¼Œå¸¸ç”¨â€œâ†‘â€å’Œâ€œâ†“â€æ¥è¡¨ç¤ºã€‚<br>ç”µå­è‡ªæ—‹çš„å‡è®¾åæ¥æœ‰æ–¯ç‰¹æ©-ç›–æ‹‰èµ«å®éªŒè¯å®ã€‚</p>
<hr>
<p>è¿™æ ·ï¼Œä¸€ä¸ªç”µå­çš„å…¨éƒ¨çŠ¶æ€åº”ç”±$n,l,m,m_s$è¿™å››ä¸ªé‡å­æ•°æ¥ç¡®å®šã€‚</p>
<h2 id="åŸå­è½¨é“"><a href="#åŸå­è½¨é“" class="headerlink" title="åŸå­è½¨é“"></a>åŸå­è½¨é“</h2><h3 id="ç”µå­äº‘"><a href="#ç”µå­äº‘" class="headerlink" title="ç”µå­äº‘"></a>ç”µå­äº‘</h3><p>æˆ‘ä»¬æ—¢ç„¶å·²ç»äº†è§£äº†è–›å®šè°”æ–¹ç¨‹å’Œå››ä¸ªé‡å­æ•°ï¼Œå°±å¯ä»¥å¯¹ç”µå­çš„è¿åŠ¨è½¨è¿¹è¿›è¡Œæ›´ç²¾ç¡®çš„æè¿°äº†ã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œç”µå­æœ‰$1s,2s,2p,3s,3p,3d$ç­‰ç­‰èƒ½çº§ã€‚æ¯ä¸ªèƒ½çº§çš„ç”µå­éƒ½åœ¨ç©ºé—´ä¸­æœ‰ä¸åŒçš„åˆ†å¸ƒè¶‹åŠ¿ã€‚<br>æ ¹æ®æ¯ä¸€ä¸ªèƒ½çº§ä»£è¡¨çš„æ³¢å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥è§£å‡ºä¸€ç³»åˆ—ä¸‰ç»´åæ ‡ã€‚å°†è¿™äº›ä¸‰ç»´åæ ‡æ”¾å…¥åŒä¸€ä¸ªåæ ‡ç³»ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€å¼ ç‚¹å›¾ï¼Œå…¶ä¸­ç‚¹è¶Šå¯†é›†çš„åœ°æ–¹ç”µå­å‡ºç°åœ¨è¿™é‡Œçš„æ¦‚ç‡è¶Šå¤§ã€‚æˆ‘ä»¬å°†$90%$ç­‰å¯†åº¦é¢ç”»ä¸‹æ¥ï¼Œå°±å¯ä»¥å¾—åˆ°æˆ‘ä»¬ç»å…¸çš„ä¸€ç³»åˆ—å›¾åƒï¼šæˆ‘ä»¬ç†Ÿæ‚‰çš„ç”µå­äº‘å›¾åƒã€‚<br>å°±åƒä¸‹é¢è¿™æ ·ï¼š</p>
<p>[pic]</p>
<p>å…¶ä¸­ï¼Œ$s$è½¨é“çš„ç”µå­äº‘æ˜¯çƒçŠ¶çš„ï¼Œ$p$è½¨é“çš„ç”µå­äº‘æ˜¯çººé”¤å½¢çš„ï¼Œ$d$è½¨é“çš„ç”µå­äº‘åƒå››ä¸ªèŠ±ç“£ï¼ˆè¿™è§£é‡Šçš„å¥½ç‰µå¼ºå•Šï¼‰ï¼Œ$f$è½¨é“â€¦â€¦$f$è½¨é“æœ‰æœºé˜¶æ®µæ¥è§¦ä¸åˆ°ï¼Œè‡ªå·±çœ‹å›¾ä½“ä¼šã€‚</p>
<p>å½“ç„¶ï¼Œ$1s,2p,3d,4f$è¿™å››ä¸ªè½¨é“æ˜¯ç®€å•çš„ï¼Œå› ä¸ºä»–ä»¬åªæœ‰ä¸€å±‚ã€‚<br>è€Œ$2s$è½¨é“æ˜¯ä¸€ä¸ªç©ºå¿ƒçƒé‡Œé¢å¥—ä¸€ä¸ªçƒï¼Œ$3s$è½¨é“å°±å†åœ¨å¤–é¢å¥—ä¸Šä¸€å±‚ç©ºå¿ƒçƒâ€¦â€¦<br>$3p$è½¨é“å°±åƒæ˜¯åœ¨$2p$è½¨é“å¤–é¢å¥—ä¸Šä¸€å±‚$p$è½¨é“â€¦â€¦<br>å…·ä½“è¯·ç»“åˆä¸Šå›¾è‡ªè¡Œæƒ³è±¡ã€‚</p>
<h3 id="è½¨é“èƒ½é‡"><a href="#è½¨é“èƒ½é‡" class="headerlink" title="è½¨é“èƒ½é‡"></a>è½¨é“èƒ½é‡</h3><h4 id="èƒ½é‡æœ€ä½åŸç†"><a href="#èƒ½é‡æœ€ä½åŸç†" class="headerlink" title="èƒ½é‡æœ€ä½åŸç†"></a>èƒ½é‡æœ€ä½åŸç†</h4><p>ç”µå­é¦–å…ˆå æ®èƒ½é‡æœ€ä½çš„è½¨é“ï¼Œä½¿å¾—åŸå­çš„èƒ½é‡è¾¾åˆ°æœ€ä½ï¼Œè¿™æ ·ï¼ŒåŸå­æ‰èƒ½å¤„äºç¨³å®šçŠ¶æ€ã€‚</p>
<hr>
<p>ä½†æ˜¯æˆ‘ä»¬é¦–å…ˆéœ€è¦çŸ¥é“ç”µå­è½¨é“çš„èƒ½é‡é«˜ä½ã€‚</p>
<p>é¦–å…ˆï¼Œå¯¹äºæ¯ä¸€ä¸ª$n$å€¼ï¼Œå…¶ç”µå­è½¨é“çš„èƒ½é‡éš$l$å€¼çš„å¢åŠ è€Œå¢åŠ ã€‚ä¾‹å¦‚ $E_{4s} &lt; E_{4p} &lt; E_{4d} &lt; E_{4f}$ ã€‚<br>å…¶æ¬¡ï¼Œå¯¹äºæ¯ä¸€ä¸ª$l$å€¼ï¼Œå…¶ç”µå­è½¨é“çš„èƒ½é‡éš$n$å€¼å¾—å¢åŠ è€Œå¢åŠ ã€‚ä¾‹å¦‚ $E_{1s} &lt; E_{2s} &lt; E_{3s} &lt; E_{4s}$ ã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“ï¼ŒåŸå­å†…éƒ¨æœ‰$1s,2s,2p,3s,3p,3d,4s,4p,4d,4f,\cdots$ç­‰ç­‰è½¨é“ã€‚<br>æ ¹æ®ä¸­å­¦æ—¶ä»£çš„åŒ–å­¦ä¹¦ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ç”µå­å¡«å…¥çš„é¡ºåºï¼š</p>
<p>ç¬¬ä¸€å‘¨æœŸæˆ‘ä»¬åªå¡«æ»¡äº†$1s$èƒ½çº§($\ce{H},\ce{He}$)ï¼›<br>ç¬¬äºŒå‘¨æœŸæˆ‘ä»¬é¦–å…ˆå¡«æ»¡äº†$2s$èƒ½çº§($\ce{Li},\ce{Be}$)ï¼Œä¹‹åå¡«æ»¡äº†$2p$èƒ½çº§($\ce{B} \to \ce{Ne}$)ï¼›<br>ç¬¬ä¸‰å‘¨æœŸæˆ‘ä»¬ä¸ç¬¬äºŒå‘¨æœŸç±»ä¼¼ï¼Œå…ˆå¡«æ»¡$3s$èƒ½çº§($\ce{Na},\ce{Mg}$)å’Œ$3p$èƒ½çº§($\ce{Al} \to \ce{Ar}$)ã€‚ä½†æ˜¯æˆ‘ä»¬ç©ºç€$3d$èƒ½çº§ä¸å¡«ï¼Œè€Œè½¬èº«å»å¡«$4s$èƒ½çº§ï¼›<br>ç¬¬å››å‘¨æœŸæˆ‘ä»¬é¦–å…ˆå¡«æ»¡äº†$4s$èƒ½çº§($\ce{K},\ce{Ca}$)ï¼Œä¹‹ååè¿‡å¤´æ¥åˆå¼€å§‹å¡«$3d$èƒ½çº§($\ce{Sc} \to \ce{Cu}$)ã€‚å¡«å®Œ$3d$èƒ½çº§ä¹‹åï¼Œå†å¼€å§‹å¡«$4p$èƒ½çº§($\ce{Ga} \to \ce{Kr}$)ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬ä¾ç„¶æ”¾ç€$4d$èƒ½çº§ä¸å¡«ï¼Œè½¬èº«å»å¡«$5s$èƒ½çº§ï¼›<br>ç¬¬äº”å‘¨æœŸæˆ‘ä»¬å¡«æ»¡äº†$5s$ ($\ce{Rb},\ce{Sr}$)ï¼Œ$4d$ ($\ce{Y} \to \ce{Cd}$)å’Œ$5p$ ($\ce{In} \to \ce{Xe}$)ä¸‰ä¸ªèƒ½çº§ï¼Œç•™ä¸‹åœ¨ä¸Šä¸€ä¸ªå‘¨æœŸå°±å·²ç»è¢«æŠ›å¼ƒçš„$4f$èƒ½çº§å’ŒæŒ‰æƒ¯ä¾‹ä¸å¡«çš„$5d$èƒ½çº§ä¸å¡«ï¼Œè½¬èº«å»å¡«$6s$èƒ½çº§ï¼›<br>ç¬¬å…­å‘¨æœŸæˆ‘ä»¬é¦–å…ˆå¡«æ»¡äº†$6s$èƒ½çº§($\ce{Cs},\ce{Ba}$)ï¼Œç„¶åå°±å¼€å§‹å¡«ä¹‹å‰è¢«æŠ›å¼ƒçš„$4f$èƒ½çº§($\ce{La} \to \ce{Yb}$)ã€‚å¡«å®Œ$4f$èƒ½çº§ä¹‹åï¼Œæˆ‘ä»¬å†å¼€å§‹å¡«$5d$èƒ½çº§($\ce{Lu} \to \ce{Hg}$)ï¼Œæ¥ä¸‹æ¥æ˜¯$6p$èƒ½çº§($\ce{Tl} \to \ce{Rn}$)ã€‚<br>å…¶ä»–çš„å‘¨æœŸæš‚æ—¶è¿˜æ²¡æœ‰å¡«å®Œï¼Œæˆ‘ä»¬æš‚æ—¶ä¸èƒ½å¤ŸçŸ¥é“å†å¾€åçš„è§„å¾‹äº†ã€‚</p>
<p>ä»ä»¥ä¸Šçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªç›´è§‚çš„è§„å¾‹ï¼š</p>
<p>$$<br>\begin{gathered}<br>E_{1s} &lt; E_{2s} &lt; E_{2p} &lt; E_{3s} &lt; E_{3p} &lt; E_{4s} &lt; E_{3d} &lt; E_{4p} &lt; E_{5s} \\<br> &lt; E_{4d} &lt; E_{5p} &lt; E_{6s} &lt; E_{4f} &lt; E_{5d} &lt; E_{6p} &lt; E_{3s} &lt; \cdots<br>\end{gathered}<br>$$</p>
<p>è¿™ä¸ªæ ·å­æ˜¯ç”±äºç”µå­çš„<strong>å±è”½æ•ˆåº”</strong>å’Œ<strong>é’»ç©¿æ•ˆåº”</strong>å†³å®šçš„ã€‚</p>
<h2 id="æ‚åŒ–è½¨é“"><a href="#æ‚åŒ–è½¨é“" class="headerlink" title="æ‚åŒ–è½¨é“"></a>æ‚åŒ–è½¨é“</h2><p>æˆ‘ä»¬çŸ¥é“ï¼Œ $E_{2s} &lt; E_{2p}$ ï¼Œç†è®ºä¸Šç”²çƒ·åœ¨æˆé”®çš„æ—¶å€™ä¼šæœ‰ä¸€ä¸ªç¢³æ°¢é”®é”®é•¿è¾ƒé•¿ï¼Œé”®èƒ½è¾ƒä½ã€‚<br>ä½†æ˜¯ï¼Œåœ¨å®é™…æƒ…å†µä¸­ï¼Œç”²çƒ·çš„å››ä¸ªç¢³æ°¢é”®çš„é”®é•¿æ˜¯å‡ç­‰çš„ã€‚<br>è¿™æˆ‘ä»¬æ€ä¹ˆæ¥è§£å†³ï¼Ÿ</p>
<p>1931å¹´ï¼Œé²æ—(Pauling)æå‡ºäº†æ‚åŒ–è½¨é“ç†è®ºã€‚<br>æ‚åŒ–è½¨é“ç†è®ºçš„ä¸­å¿ƒæ€æƒ³å°±æ˜¯ï¼Œå¤šä¸ªèƒ½çº§æ‹¿å‡ºè‡ªå·±çš„éƒ¨åˆ†è½¨é“ï¼Œç»„æˆä¸€ä¸ªæ–°çš„èƒ½çº§æ¥æˆé”®ã€‚</p>
<p>æˆ‘ä»¬è¿™é‡Œä»¥ç”²çƒ·åˆ†å­ä¸ºä¾‹ã€‚<br>åœ¨ç”²çƒ·åˆ†å­é‡Œé¢ï¼Œæœ‰å››ä¸ª$\ce{H}$å’Œä¸€ä¸ª$\ce{C}$ã€‚<br>Håªæœ‰ä¸€ä¸ªç”µå­ï¼Œåªèƒ½æ‹¿å‡ºè¿™ä¸€ä¸ªç”µå­æ¥æˆé”®ã€‚<br>è€ŒCæœ‰å››ä¸ªä»·ç”µå­ï¼Œä¸º $2s^2 2p^2$ ã€‚</p>
<p>ä»ç”²çƒ·ä¸­$\ce{C-H}$é”®é”®é•¿æ˜¯ç›¸ç­‰çš„è¿™ä¸ªäº‹å®ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çŒœæµ‹ç”²çƒ·çš„å››ä¸ª$\ce{C-H}$é”®åº”è¯¥æ˜¯ç­‰åŒçš„ã€‚<br>äº‹å®ä¹Ÿï¼ˆåº”è¯¥ï¼‰æ˜¯å¦‚æ­¤ã€‚<br>Cçš„sèƒ½çº§æ‹¿å‡ºè‡ªå·±çš„1ä¸ªè½¨é“ï¼Œä¸pèƒ½çº§çš„ä¸‰ä¸ªè½¨é“è¿›è¡Œç»„åˆï¼Œå½¢æˆå››ä¸ªç­‰åŒçš„è½¨é“ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º $sp^3$ <strong>æ‚åŒ–è½¨é“</strong>ã€‚<br>å¼•ç”¨ç™¾ç§‘ä¸Šé¢çš„ä¸€æ®µè¯æ¥è¯´ï¼Œå°±æ˜¯è¿™æ ·çš„ï¼š</p>
<blockquote>
<p>åœ¨æˆé”®çš„è¿‡ç¨‹ä¸­ï¼Œç”±äºåŸå­é—´çš„ç›¸äº’å½±å“ï¼ŒåŒä¸€åˆ†å­ä¸­å‡ ä¸ªèƒ½é‡ç›¸è¿‘çš„ä¸åŒç±»å‹çš„åŸå­è½¨é“ï¼ˆå³æ³¢å‡½æ•°ï¼‰ï¼Œå¯ä»¥è¿›è¡Œçº¿æ€§ç»„åˆï¼Œé‡æ–°åˆ†é…èƒ½é‡å’Œç¡®å®šç©ºé—´æ–¹å‘ï¼Œç»„æˆæ•°ç›®ç›¸ç­‰çš„æ–°åŸå­è½¨é“ï¼Œè¿™ç§è½¨é“é‡æ–°ç»„åˆçš„æ–¹å¼ç§°ä¸ºæ‚åŒ–(Hybridization)ï¼Œæ‚åŒ–åå½¢æˆçš„æ–°è½¨é“ç§°ä¸ºæ‚åŒ–è½¨é“(Hybrid Orbital)ã€‚</p>
</blockquote>
<p>å°±æ˜¯è¿™æ ·ã€‚</p>
<p>å½“ç„¶ï¼Œé™¤äº† $sp^3$ æ‚åŒ–ä¹‹å¤–ï¼Œè¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„æ‚åŒ–æ–¹å¼ã€‚ä¸‹é¢ä¼šåˆ—ä¸¾å‡ºå·²çŸ¥çš„éƒ¨åˆ†æ‚åŒ–æ–¹å¼ï¼Œå¹¶ç»™ä¸Šä¾‹å­ï¼š<br>$sp^3$ ä¾‹ï¼šç”²çƒ· ($\ce{CH}$)<br>$sp^2$ ä¾‹ï¼šä¹™çƒ¯ ($\ce{CH2&#x3D;CH2}$)<br>$sp$ ä¾‹ï¼šä¹™ç‚” ($\ce{CH#CH}$)<br>$sp^3d$ ä¾‹ï¼šäº”æ°¯åŒ–ç£· ($\ce{PCl5}$)<br>$sp^3d^2$ ä¾‹ï¼šå…­æ°ŸåŒ–ç¡« ($\ce{SF6}$)</p>
<h1 id="ä»·å±‚ç”µå­äº’æ–¥æ¨¡å‹"><a href="#ä»·å±‚ç”µå­äº’æ–¥æ¨¡å‹" class="headerlink" title="ä»·å±‚ç”µå­äº’æ–¥æ¨¡å‹"></a>ä»·å±‚ç”µå­äº’æ–¥æ¨¡å‹</h1><p>æˆ‘ä»¬åœ¨å­¦ä¼šäº†Lewisç»“æ„å¼å’Œè½¨é“ç†è®ºä¹‹åï¼Œå°±å¯ä»¥ç¡®å®šåˆ†å­å†…åŸå­ä¹‹é—´çš„æˆé”®æ–¹å¼äº†ã€‚ï¼ˆLewisç»“æ„å¼è¯·è§æˆ‘<a href="/organic%20chemistry/lewis-structure">å¦ä¸€ç¯‡åšå®¢</a>ï¼‰<br>åœ¨ç¡®å®šäº†åˆ†å­å†…åŸå­ä¹‹é—´çš„æˆé”®æ–¹å¼ä¹‹åï¼Œå°±å¯ä»¥è§£å†³å¾ˆå¤šæ„å‹ä¸Šé¢çš„é—®é¢˜ã€‚<br>ä½†æ˜¯ï¼Œç”±äºåˆ†å­æ˜¯ç«‹ä½“çš„ï¼Œæˆ‘ä»¬ä½¿ç”¨Lewisç»“æ„å¼ä¸èƒ½å¾ˆå¥½åœ°è¡¨ç°åˆ†å­çš„ç«‹ä½“ç»“æ„ã€‚ä¾‹å¦‚ç”²çƒ·åˆ†å­ç±»ä¼¼æ­£å››é¢ä½“ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬ä¹¦å†™Lewisç»“æ„å¼æ—¶çš„é‚£ä¸ªå…±å¹³é¢çš„æ ·å­ã€‚<br>æ›´ç”šè‡³æœ‰äº›å…¶ä»–åˆ†å­ï¼Œè™½ç„¶åˆ†å­å†…çš„æ‰€æœ‰åŸå­æ˜¯å…±å¹³é¢çš„ï¼Œä½†æ˜¯é•¿å¾—ä¸æ˜¯æˆ‘ä»¬ä¹¦å†™Lewisç»“æ„å¼çš„é‚£æ ·ï¼Œæ¯”å¦‚æ°´ã€‚</p>
<p>è¿™å°±å¼•å‡ºäº†ä¸€ä¸ªé‡è¦çš„æ¨¡å‹ï¼šä»·å±‚ç”µå­äº’æ–¥æ¨¡å‹ã€‚<br>ä»·å±‚ç”µå­äº’æ–¥æ¨¡å‹æœ‰ä¸€ä¸ªè‹±æ–‡ç®€ç§°ï¼šVSEPRæ¨¡å‹ã€‚</p>
]]></content>
      <categories>
        <category>åŒ–å­¦</category>
      </categories>
      <tags>
        <tag>åŒ–å­¦</tag>
      </tags>
  </entry>
  <entry>
    <title>æ¬§æ‹‰å’Œè«æ¯”ä¹Œæ–¯</title>
    <url>/maths/eular-and-m%C3%B6bius/</url>
    <content><![CDATA[<p>ç®€ä»‹ï¼šæ¬§æ‹‰å®šç†ï¼Œæ¬§æ‹‰å‡½æ•°å’Œè«æ¯”ä¹Œæ–¯å‡½æ•°</p>
<span id="more"></span>

<p>åˆç¨¿å†™äº2021-10-10ï¼Œ<br>å†ä¿®æ”¹äº2022-02-07</p>
<p><strong>Achtung: æœ¬æ–‡ç« ä½¿ç”¨pæ¥ä»£æŒ‡â€œä»»æ„è´¨æ•°â€ï¼Œè¯·å‹¿æ··æ·†ã€‚</strong></p>
<p>é¦–å…ˆè®©æˆ‘ä»¬è†œæ‹œä¸€ä¸‹è±æ˜‚å“ˆå¾·Â·æ¬§æ‹‰(Leonhard Euler):</p>
<p><img src="/pics/eular.jpg" alt="eular"></p>
<h1 id="æ¬§æ‹‰å‡½æ•°"><a href="#æ¬§æ‹‰å‡½æ•°" class="headerlink" title="æ¬§æ‹‰å‡½æ•°"></a>æ¬§æ‹‰å‡½æ•°</h1><p>æ¬§æ‹‰å‡½æ•° $Ï†(n)$ çš„æ¦‚å¿µæ˜¯åœ¨ $[0,n-1]$ èŒƒå›´å†…æœ‰å¤šå°‘ä¸ªæ•´æ•°ä¸ $n$ äº’è´¨ã€‚</p>
<p>å…¶ä¸­ï¼Œæˆ‘ä»¬è§„å®š $Ï†(1)&#x3D;1$ï¼Œ</p>
<p>ä¸”ä¸éš¾å‘ç°ï¼Œ$Ï†(p)&#x3D;p-1$ã€‚</p>
<h2 id="æ¬§æ‹‰å‡½æ•°çš„ä¸€äº›æ€§è´¨"><a href="#æ¬§æ‹‰å‡½æ•°çš„ä¸€äº›æ€§è´¨" class="headerlink" title="æ¬§æ‹‰å‡½æ•°çš„ä¸€äº›æ€§è´¨"></a>æ¬§æ‹‰å‡½æ•°çš„ä¸€äº›æ€§è´¨</h2><h3 id="æ¬§æ‹‰å‡½æ•°æ˜¯ç§¯æ€§å‡½æ•°"><a href="#æ¬§æ‹‰å‡½æ•°æ˜¯ç§¯æ€§å‡½æ•°" class="headerlink" title="æ¬§æ‹‰å‡½æ•°æ˜¯ç§¯æ€§å‡½æ•°"></a>æ¬§æ‹‰å‡½æ•°æ˜¯ç§¯æ€§å‡½æ•°</h3><p>å³ $Ï†(mn) &#x3D; Ï†(m) Ï†(n)$</p>
<p>å¹¶ä¸”å½“ $n \bmod{2} \equiv 1$ æ—¶ï¼Œ$Ï†(2n) &#x3D; Ï†(n)$ï¼Œ</p>
<p>è€Œå½“ $n \bmod{2} \equiv 0$ï¼ˆå³ $2|n$)æ—¶ï¼Œ$Ï†(2n) &#x3D; 2 Ï†(n)$</p>
<h3 id="displaystyle-sum-m-n-n-m-x3D-n-frac-Ï†-n-2"><a href="#displaystyle-sum-m-n-n-m-x3D-n-frac-Ï†-n-2" class="headerlink" title="$\displaystyle \sum_{m|n}^{n} m &#x3D; n \frac{Ï†(n)}{2}$"></a>$\displaystyle \sum_{m|n}^{n} m &#x3D; n \frac{Ï†(n)}{2}$</h3><p>$$<br>\sum_{m|n}^{n} m &#x3D; n \frac{Ï†(n)}{2}<br>$$</p>
<p>æ˜“è¯ã€‚</p>
<h3 id="displaystyle-sum-d-n-Ï†-d-x3D-n"><a href="#displaystyle-sum-d-n-Ï†-d-x3D-n" class="headerlink" title="$\displaystyle \sum_{d|n} Ï†(d) &#x3D; n$"></a>$\displaystyle \sum_{d|n} Ï†(d) &#x3D; n$</h3><p>$$<br>\sum_{d|n} Ï†(d) &#x3D; n<br>$$</p>
<p>æˆ‘ä»¬åˆ©ç”¨è«æ¯”ä¹Œæ–¯åæ¼”çš„ç›¸å…³çŸ¥è¯†å¯ä»¥å¾—å‡ºã€‚</p>
<p>æˆ–è€…æˆ‘ä»¬è¿™æ ·è€ƒè™‘ï¼š<br>å¦‚æœ $\gcd(k,n) &#x3D; d$ ï¼Œé‚£ä¹ˆ $\gcd(\frac{k}{d} , \frac{n}{d}) &#x3D; 1 (k &lt; n)$ ã€‚<br>æˆ‘ä»¬å¦‚æœè®¾ $f(x)$ ä¸ºæ»¡è¶³ $\gcd(k,n) &#x3D; x$ çš„æ•°çš„ä¸ªæ•°ï¼Œé‚£ä¹ˆ $n &#x3D; \sum_{i-1}^n f(i)$ ã€‚<br>æ ¹æ®ä¸Šé¢çš„è¯æ˜ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œ $f(x) &#x3D; Ï†(\frac{n}{x})$ ï¼Œä»è€Œå¾—åˆ° $n &#x3D; \sum_{d|n} Ï†(\frac{n}{d})$ ã€‚æ³¨æ„æ­¤æ—¶æˆ‘ä»¬çš„çº¦æ•° $d$ å’Œ $\frac{n}{d}$ å…·æœ‰å¯¹ç§°æ€§ï¼Œæ‰€ä»¥ä¸Šé¢çš„å¼å­å¯ä»¥åŒ–ä¸º $n &#x3D; \sum_{d|n} Ï†(d)$ ã€‚</p>
<h3 id="displaystyle-Ï†-p-k-x3D-p-k-p-k-1"><a href="#displaystyle-Ï†-p-k-x3D-p-k-p-k-1" class="headerlink" title="$\displaystyle Ï†(p^k) &#x3D; p^k - p^{k-1}$"></a>$\displaystyle Ï†(p^k) &#x3D; p^k - p^{k-1}$</h3><p>è‹¥ $n &#x3D; p^k$ ï¼Œé‚£ä¹ˆ $Ï†(n) &#x3D; p^k - p^{k-1}$ ã€‚</p>
<p>ç”±å®šä¹‰å¯çŸ¥ã€‚<br>å› ä¸ºæœ‰ $n \perp p^k \iff p \not \mid n$ ã€‚åœ¨ ${ 0,1,p,\cdots ,p^k-1 }$ ä¸­ï¼Œ $p$ çš„å€æ•°æ˜¯ ${ 0,p,2p,\cdots ,p^k-p }$ ï¼Œå…±æœ‰ $p^{k-1}$ ä¸ªã€‚</p>
<h3 id="displaystyle-Ï†-prod-i-x3D-1-s-p-i-k-i-x3D-prod-i-x3D-1-s-p-i-k-i-1-Â·-p-i-1"><a href="#displaystyle-Ï†-prod-i-x3D-1-s-p-i-k-i-x3D-prod-i-x3D-1-s-p-i-k-i-1-Â·-p-i-1" class="headerlink" title="$\displaystyle Ï†(\prod_{i&#x3D;1}^s p_i^{k_i}) &#x3D; \prod_{i&#x3D;1}^s p_i^{k_i - 1} Â· (p_i - 1)$"></a>$\displaystyle Ï†(\prod_{i&#x3D;1}^s p_i^{k_i}) &#x3D; \prod_{i&#x3D;1}^s p_i^{k_i - 1} Â· (p_i - 1)$</h3><p>ç”±å”¯ä¸€åˆ†è§£å®šç†ï¼Œè®¾ $n &#x3D; \prod_{i&#x3D;1}^s p_i^{k_i}$ ï¼Œåˆ™æœ‰ $Ï†(n) &#x3D; \prod_{i&#x3D;1}^s \frac{p_i - 1}{p_i}$ã€‚</p>
<p>è¯æ˜ï¼š</p>
<p>$$<br>\begin{align}<br>Ï†(n) &amp;&#x3D; \prod_{i&#x3D;1}^s Ï†(p_i^{k_i}) \\<br>&amp;&#x3D; \prod_{i&#x3D;1}^s p_i^{k_i} - p_i^{k_i - 1} \\<br>&amp;&#x3D; \prod_{i&#x3D;1}^s (p_i - 1) \times p_i^{k_i - 1} \\<br>&amp;&#x3D; \prod_{i&#x3D;1}^s (1 - \frac{1}{p_i}) p_i^{k_i} \\<br>&amp;&#x3D; n \prod_{i&#x3D;1}^s (1 - \frac{1}{p_i})<br>\end{align}<br>$$</p>
<h2 id="è®¡ç®—æ¬§æ‹‰å‡½æ•°çš„å€¼"><a href="#è®¡ç®—æ¬§æ‹‰å‡½æ•°çš„å€¼" class="headerlink" title="è®¡ç®—æ¬§æ‹‰å‡½æ•°çš„å€¼"></a>è®¡ç®—æ¬§æ‹‰å‡½æ•°çš„å€¼</h2><h3 id="å•ç‚¹æ±‚å€¼"><a href="#å•ç‚¹æ±‚å€¼" class="headerlink" title="å•ç‚¹æ±‚å€¼"></a>å•ç‚¹æ±‚å€¼</h3><p>æˆ‘ä»¬ä¸éš¾å‘ç°ï¼Œå½“ $m$ æ˜¯ä¸€ä¸ªè´¨æ•°çš„æ•´æ•°å¹‚ $p^k$ æ—¶ï¼Œæˆ‘ä»¬æœ‰<br>$$<br>Ï†(p^k)&#x3D;p^k-p^{k-1}<br>$$<br>;<br>å¦‚æœ $m&gt;1$ ä¸æ˜¯ä¸€ä¸ªè´¨æ•°çš„æ•´æ•°å¹‚ï¼Œé‚£æˆ‘ä»¬å¯ä»¥æŠŠ $m$ æ‹†åˆ†æˆ $m&#x3D;m_1 m_2$ ï¼Œå…¶ä¸­ $m_1 \perp m_2$ã€‚è¿™æ ·è¿™ä¸ªæ•°å°±å¯ä»¥åœ¨å‰©ä½™ç³»é‡Œè¡¨ç¤ºä¸º $(n \bmod m_1 , n \bmod m_2)$ ã€‚å¦‚æœä½ ä¸çŸ¥é“ä»€ä¹ˆæ˜¯å‰©ä½™ç³»ï¼Œå¯ä»¥çœ‹æˆ‘çš„åšå®¢ï¼šï¼ˆå’•äº†ï¼‰ã€‚</p>
<p>æ ¹æ®<br>$$<br>k \perp m ä¸” k \perp n \iff k \perp mn<br>$$<br>å’Œ<br>$$<br>\gcd(m,n) &#x3D; \gcd(n \bmod m,m)<br>$$<br>å¯å¾—<br>$$<br>n \perp m \iff n \bmod m_1 \perp m_1 ä¸” n \bmod m_2 \perp m_2<br>$$<br>ï¼Œç”±æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æ¨å¾—<br>$$<br>Ï†(m)&#x3D;Ï†(m_1)Ï†(m_2),m_1 \perp m_2<br>$$<br>æ‰€ä»¥ï¼Œæ¬§æ‹‰å‡½æ•°æ˜¯ä¸€ä¸ªç§¯æ€§å‡½æ•°ã€‚</p>
<p>æ¬§æ‹‰å‡½æ•°çš„é€šé¡¹å…¬å¼æ˜¯<br>$$<br>Ï†(m)&#x3D;\prod_{p|m} (p^{m_p}-p^{m_p-1})&#x3D;m \prod_{p|m}(1-\frac{1}{p})<br>$$</p>
<p>ä¸Šä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">euler_phi</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> m = <span class="built_in">int</span>(<span class="built_in">sqrt</span>(n + <span class="number">0.5</span>));</span><br><span class="line">    <span class="type">int</span> ans = n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt;= m; i++)</span><br><span class="line">        <span class="keyword">if</span>(n % i == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            ans = ans / i * (i - <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">while</span>(n % i == <span class="number">0</span>) n /= i;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">if</span>(n &gt; <span class="number">1</span>) ans = ans / n * (n - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœå°†ä»£ç æ”¹ä¸ºä¸‹é¢çš„å½¢å¼å¯ä»¥ä¼˜åŒ–ä¸€äº›ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">euler_phi</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> ans = n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i * i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">if</span>(n % i == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            ans = ans / i * (i - <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">while</span>(n % i == <span class="number">0</span>) n /= i;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">if</span>(n &gt; <span class="number">1</span>) ans = ans / n * (n - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="åŒºé—´ç­›"><a href="#åŒºé—´ç­›" class="headerlink" title="åŒºé—´ç­›"></a>åŒºé—´ç­›</h3><p>è€Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç­›æ³•æ¥æ±‚è¿ç»­åŒºé—´çš„æ¬§æ‹‰å‡½æ•°å€¼ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e7</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> phi[N], prime[N / <span class="number">100</span>];</span><br><span class="line"><span class="type">bool</span> visit[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">getphi</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    phi[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!visit[i])</span><br><span class="line">        &#123;</span><br><span class="line">            prime[prime[<span class="number">0</span>] + <span class="number">1</span>] = i;</span><br><span class="line">            prime[<span class="number">0</span>]++;</span><br><span class="line">            phi[i] = i - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= prime[<span class="number">0</span>] &amp;&amp; i * prime[j] &lt;= n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            visit[i * prime[j]] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span>(!(i % prime[j]))</span><br><span class="line">            &#123;</span><br><span class="line">                phi[i * prime[j]] = phi[i] * prime[j];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                phi[i * prime[j]] = phi[i] * (prime[j] - <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿˜æœ‰OI Wikiä¸Šæä¾›çš„ä»£ç ï¼š</p>
<details class="note default"><summary><p>from OI Wiki</p>
</summary>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">pre</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(is_prime, <span class="number">1</span>, <span class="built_in">sizeof</span>(is_prime));</span><br><span class="line">    <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    is_prime[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    phi[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt;= <span class="number">5000000</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(is_prime[i])</span><br><span class="line">        &#123;</span><br><span class="line">            prime[++cnt] = i;</span><br><span class="line">            phi[i] = i - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= cnt &amp;&amp; i * prime[j] &lt;= <span class="number">5000000</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            is_prime[i * prime[j]] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span>(i % prime[j])</span><br><span class="line">                phi[i * prime[j]] = phi[i] * phi[prime[j]];</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                phi[i * prime[j]] = phi[i] * prime[j];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</details>

<p>å¤æ‚åº¦å‡ä¸ºçº¿æ€§ã€‚</p>
<h1 id="æ¬§æ‹‰å®šç†"><a href="#æ¬§æ‹‰å®šç†" class="headerlink" title="æ¬§æ‹‰å®šç†"></a>æ¬§æ‹‰å®šç†</h1><p>æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹è´¹é©¬å°å®šç†ã€‚</p>
<h2 id="è´¹é©¬å°å®šç†"><a href="#è´¹é©¬å°å®šç†" class="headerlink" title="è´¹é©¬å°å®šç†"></a>è´¹é©¬å°å®šç†</h2><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œè´¹é©¬å°å®šç†æ˜¯ï¼š<br>$$<br>a^{p-1} \equiv 1 \pmod{p},a \perp p<br>$$<br>è¿˜æœ‰å¦ä¸€ç§å½¢å¼ï¼Œæ˜¯è¿™æ ·çš„ï¼š<br>$$<br>\forall a \in \mathbb{N} ,a^p \equiv a \pmod{p}<br>$$<br>ã€‚</p>
<h3 id="è¯æ˜"><a href="#è¯æ˜" class="headerlink" title="è¯æ˜"></a>è¯æ˜</h3><p>æˆ‘ä»¬é¦–å…ˆå–ä¸€ä¸ªä¸ä¸º $p$ å€æ•°çš„æ•° $a$ ã€‚<br>æ„é€ ä¸€ä¸ªåºåˆ—ï¼š $A &#x3D; \lbrace 1,2,3, \cdots , p - 1 \rbrace$ ï¼Œè¿™ä¸ªåºåˆ—æ‹¥æœ‰è¿™æ ·çš„ä¸€ä¸ªæ€§è´¨ï¼š<br>$$<br>\prod_{i&#x3D;1}^n A_i \equiv \prod_{i&#x3D;1}^n (A_i \times a) \pmod{p}<br>$$</p>
<p>è¯æ˜ï¼š<br>$$<br>\because (A_i,p) &#x3D; 1 , (A_i \times a,p) &#x3D; 1<br>$$<br>åˆå› ä¸ºæ¯ä¸€ä¸ª $A_i \times a \pmod{p}$ éƒ½æ˜¯ç‹¬ä¸€æ— äºŒçš„ï¼Œä¸” $A_i \times a \pmod{p} &lt; p$ ï¼Œå¾—è¯ï¼ˆæ¯ä¸€ä¸ª $A_i \times a$ éƒ½å¯¹åº”äº†ä¸€ä¸ª $A_i$ï¼‰ã€‚<br>è®¾ $f &#x3D; (p-1)!$ï¼Œåˆ™<br>$$<br>\begin{align}<br>f &amp;\equiv (a \times A_1)(a \times A_2)(a \times A_3) \cdots (a \times A_{p-1}) \pmod{p} \\<br>a^{p-1} Â· f &amp;\equiv f \pmod{p} \\<br>a^{p-1} &amp;\equiv 1 \pmod{p}<br>\end{align}<br>$$<br>è¯æ¯•ã€‚</p>
<p>æˆ–è€…ä¹Ÿå¯ä»¥ä½¿ç”¨å½’çº³æ³•è¯æ˜ï¼š</p>
<p>æ˜¾ç„¶ $1^p \equiv 1 \pmod{p}$ã€‚é‚£ä¹ˆå‡è®¾ $a^p \equiv a \pmod{p}$ æˆç«‹ï¼Œé‚£ä¹ˆé€šè¿‡äºŒé¡¹å¼å®šç†æœ‰<br>$$<br>(a+1)^p &#x3D; a^p + C_p^1 a^{p-1} + C_p^2 a^{p-2} + \cdots + C_p^{p-1} a + 1<br>$$<br>å› ä¸º $C_p^k &#x3D; \frac{p!}{(n-k)!k!}$ å¯¹äº $k \in [ 1,p-1 ]$ æˆç«‹ï¼Œåœ¨æ¨¡ $p$ æ„ä¹‰ä¸‹ $C_p^1 \equiv C_p^2 \equiv \cdots \equiv C_p^{p-1} \equiv 0 \pmod{p}$ï¼Œé‚£ä¹ˆ $(a+1)^p \equiv a^p + 1 \pmod{p}$ï¼Œå°† $a^p \equiv a \pmod{p}$ ä»£å…¥å¾— $(a+1)^p \equiv a+1 \pmod{p}$ã€‚<br>è¯æ¯•ã€‚</p>
<h2 id="æ¬§æ‹‰å®šç†-1"><a href="#æ¬§æ‹‰å®šç†-1" class="headerlink" title="æ¬§æ‹‰å®šç†"></a>æ¬§æ‹‰å®šç†</h2><p>æ¬§æ‹‰å®šç†çš„å†…å®¹å¦‚ä¸‹ï¼š</p>
<p>è‹¥ $\gcd(a,m) &#x3D; 1$ï¼Œåˆ™ $a^{Ï†(m)} \equiv 1 \pmod{m}$ã€‚</p>
<h3 id="è¯æ˜-1"><a href="#è¯æ˜-1" class="headerlink" title="è¯æ˜"></a>è¯æ˜</h3><p>æ¬§æ‹‰å®šç†çš„è¯æ˜è¿‡ç¨‹ä¸è´¹é©¬å°å®šç†çš„è¯æ˜è¿‡ç¨‹ååˆ†ç›¸ä¼¼ã€‚<br>æˆ‘ä»¬åŒæ ·é¦–å…ˆæ„é€ ä¸€ä¸ªä¸ $m$ äº’è´¨çš„åºåˆ—ï¼Œå†è¿›è¡Œæ“ä½œã€‚</p>
<p>è®¾ $r_1,r_2, \cdots ,r_{Ï†(m)}$ ä¸ºæ¨¡ $m$ æ„ä¹‰ä¸‹çš„ä¸€ä¸ªç®€åŒ–å‰©ä½™ç³»ï¼Œåˆ™ $ar_1,ar_2, \cdots ,ar_{Ï†(m)}$ åŒæ ·ä¹Ÿä¸ºæ¨¡ $m$ æ„ä¹‰ä¸‹çš„ä¸€ä¸ªç®€åŒ–å‰©ä½™ç³»ã€‚æ‰€ä»¥ï¼Œ$\prod_{i&#x3D;1}^{Ï†(m)} r_i \equiv \prod_{i&#x3D;1}^{Ï†(m)} ar_i \equiv a^{Ï†(m)} \prod_{i&#x3D;1}^{Ï†(m)} r_i \pmod{m}$ï¼Œçº¦å» $\prod_{i&#x3D;1}^{Ï†(m)} r_i$ åå¯å¾— $a^{Ï†(m)} \equiv 1 \pmod{m}$ã€‚<br>è¯æ¯•ã€‚</p>
<p>å½“ $m&#x3D;p$ æ—¶ï¼Œç”±äº $Ï†(m) &#x3D; m-1$ï¼Œå°†ä¹‹ä»£å…¥å¯å¾—è´¹é©¬å°å®šç†ã€‚</p>
<h2 id="æ‰©å±•æ¬§æ‹‰å®šç†"><a href="#æ‰©å±•æ¬§æ‹‰å®šç†" class="headerlink" title="æ‰©å±•æ¬§æ‹‰å®šç†"></a>æ‰©å±•æ¬§æ‹‰å®šç†</h2><p>æ‰©å±•æ¬§æ‹‰å®šç†æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š</p>
<p>$$<br>a^b \equiv \begin{cases}a^{b \ \bmod \ Ï†(m)}, &amp; \gcd(a,m) &#x3D; 1,\\a^b, &amp; \gcd(a,m) \neq 1, b &lt; Ï†(m),\\a^{(b \ \bmod \ Ï†(m))+Ï†(m)}, &amp; \gcd(a,m) \neq 1,b \geq Ï†(m). \end{cases} \pmod{m}<br>$$</p>
<p>è¯æ˜è§<span class="exturl" data-url="aHR0cHM6Ly9vaS13aWtpLm9yZy9tYXRoL251bWJlci10aGVvcnkvZmVybWF0LyNfNg==">OI Wiki<i class="fa fa-external-link-alt"></i></span></p>
<h1 id="è«æ¯”ä¹Œæ–¯å‡½æ•°"><a href="#è«æ¯”ä¹Œæ–¯å‡½æ•°" class="headerlink" title="è«æ¯”ä¹Œæ–¯å‡½æ•°"></a>è«æ¯”ä¹Œæ–¯å‡½æ•°</h1><h2 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h2><p>æˆ‘ä»¬æŠŠä¸€ä¸ªæ•°å­—åˆ†è§£è´¨å› æ•°ä¸º $n&#x3D;p_1^{c_1}p_2^{c_2} \cdots p_k^{c_k}$ï¼Œåˆ™<br>$$<br>Î¼(n)&#x3D;<br>\begin{cases}<br>1 &amp; n&#x3D;1 \\<br>0 &amp; \forall i \in [1,k] , c_i &gt; 1 \\<br>(-1)^k &amp; \forall i \in [1,k] , c_i &#x3D; 1<br>\end{cases}<br>$$</p>
<p>è§£é‡Šä¸€ä¸‹ï¼š</p>
<ol>
<li>å½“ $n&#x3D;1$ æ—¶ï¼Œ $Î¼(n)&#x3D;1$ï¼›</li>
<li>å½“ $n \neq 1$ æ—¶ï¼š<ol>
<li>å½“å­˜åœ¨ $i\in [1,k]$ï¼Œä½¿å¾— $c_i &gt; 1$ æ—¶ï¼Œ$Î¼(n)&#x3D;0$ï¼Œä¹Ÿå°±æ˜¯è¯´åªè¦æŸä¸ªè´¨å› å­å‡ºç°çš„æ¬¡æ•°è¶…è¿‡ä¸€æ¬¡ï¼Œ$Î¼(n)$ å°±ç­‰äº $0$ï¼›</li>
<li>å½“ä»»æ„ $i\in[1,k]$ï¼Œéƒ½æœ‰ $c_i&#x3D;1$ æ—¶ï¼Œ$Î¼(n)&#x3D;(-1)^k$ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯ä¸ªè´¨å› å­éƒ½ä»…ä»…åªå‡ºç°è¿‡ä¸€æ¬¡æ—¶ï¼Œ$Î¼(n)$ ç­‰äº $-1$ çš„ $k$ æ¬¡å¹‚ï¼Œæ­¤å¤„ $k$ æŒ‡çš„ä¾¿æ˜¯ä»…ä»…åªå‡ºç°è¿‡ä¸€æ¬¡çš„è´¨å› å­çš„æ€»ä¸ªæ•°ã€‚</li>
</ol>
</li>
</ol>
<h2 id="æ€§è´¨"><a href="#æ€§è´¨" class="headerlink" title="æ€§è´¨"></a>æ€§è´¨</h2><p>è«æ¯”ä¹Œæ–¯å‡½æ•°ä¸ä»…æ˜¯ç§¯æ€§å‡½æ•°ï¼Œè¿˜æœ‰å¦‚ä¸‹æ€§è´¨ï¼š<br>$$<br>\sum_{d|m} Î¼(d) &#x3D; [m&#x3D;&#x3D;1]<br>$$<br>å…¶ä¸­ $[m&#x3D;&#x3D;1]$ ä»£è¡¨ <code>m==1?1:0</code> ã€‚</p>
<h2 id="è¯æ˜-2"><a href="#è¯æ˜-2" class="headerlink" title="è¯æ˜"></a>è¯æ˜</h2><p>è®¾<br>$$<br>n&#x3D;\prod_{i&#x3D;1}^k{p_i}^{c_i},nâ€™&#x3D;\prod_{i&#x3D;1}^k p_i<br>$$<br>é‚£ä¹ˆ<br>$$<br>\sum_{d\mid n}Î¼(d)&#x3D;\sum_{d\mid nâ€™}Î¼(d)&#x3D;\sum_{i&#x3D;0}^k C_k^iÂ·(-1)^i&#x3D;(1+(-1))^k<br>$$</p>
<h2 id="è«æ¯”ä¹Œæ–¯åæ¼”"><a href="#è«æ¯”ä¹Œæ–¯åæ¼”" class="headerlink" title="è«æ¯”ä¹Œæ–¯åæ¼”"></a>è«æ¯”ä¹Œæ–¯åæ¼”</h2><p>å¦‚æœä¸¤ä¸ªçš„å‡½æ•° $f(n)$ ä¸ $g(n)$ æ»¡è¶³<br>$$<br>f(n) &#x3D; \sum_{d|n} g(d)<br>$$<br>åˆ™<br>$$<br>g(n) &#x3D; \sum_{d|n} Î¼(d) f(\frac{n}{d})<br>$$</p>
<h3 id="è¯æ˜-3"><a href="#è¯æ˜-3" class="headerlink" title="è¯æ˜"></a>è¯æ˜</h3><details class="note info"><summary><p>æ‘˜è‡ªã€Šæ··å‡åœŸæ•°å­¦ã€‹</p>
</summary>
<h4 id="å……åˆ†æ€§"><a href="#å……åˆ†æ€§" class="headerlink" title="å……åˆ†æ€§"></a>å……åˆ†æ€§</h4><p>$$<br>\begin{align}<br>f(n) &amp;&#x3D; \sum_{d|n} g (d)\\<br>&amp;&#x3D; \sum_{d|n} g (\frac{n}{d})<br>\end{align}<br>$$</p>
<p>$$<br>\sum_{d|n} Î¼(d) f(\frac{n}{d}) &#x3D; \sum_{d|n} Î¼(d) \sum_{d_1|\frac{n}{d}} g(d_1)<br>$$</p>
<p>$$<br>\begin{align}<br>\sum_{d|n} \sum_{d_1|\frac{n}{d}} Î¼(d) g (d_1) &amp;&#x3D; \sum_{d_1|n} g(d_1) \sum_{d|\frac{n}{d_1}} Î¼(d) \\<br>&amp;&#x3D; g(n)<br>\end{align}<br>$$</p>
<p>è€ƒè™‘åˆ°<br>$$<br>\sum_{d|\frac{n}{d_1}} Î¼(d) &#x3D;<br>\begin{cases}<br>1 &amp; d_1 &#x3D; n \\<br>0 &amp; d_1 &lt; n<br>\end{cases}<br>$$<br>å› æ­¤<br>$$<br>\begin{align}<br>g(n) &amp;&#x3D; \sum_{d|n} Î¼(d) f(\frac{n}{d}) \\<br>&amp;&#x3D; \sum_{d|n} Î¼(\frac{n}{d}) f(d)<br>\end{align}<br>$$</p>
<h4 id="å¿…è¦æ€§"><a href="#å¿…è¦æ€§" class="headerlink" title="å¿…è¦æ€§"></a>å¿…è¦æ€§</h4><p>$$<br>\begin{align}<br>g(n) &amp;&#x3D; \sum_{d|n} Î¼(d) f(\frac{n}{d}) \\<br>&amp;&#x3D; \sum_{d|n} Î¼(\frac{n}{d}) f(d)<br>\end{align}<br>$$</p>
<p>$$<br>\begin{align}<br>\sum_{d|n} g(d) &amp;&#x3D; \sum_{d|n}g(\frac{n}{d}) \\<br>&amp;&#x3D; \sum_{d|n} \sum_{d_1|\frac{n}{d}} Î¼(\frac{n}{d d_1})f(d_1) \\<br>&amp;&#x3D; \sum_{d d_1|n} Î¼(\frac{n}{d d_1}) f(d_1) \\<br>&amp;&#x3D; \sum_{d_1|n} f(d_1) \sum_{d|\frac{n}{d}} Î¼(\frac{n}{d d_1}) \\<br>&amp;&#x3D; f(n)<br>\end{align}<br>$$</p>
<p>è€ƒè™‘åˆ°</p>
<p>$$<br>\begin{align}<br>\sum_{d|\frac{n}{d_1}} Î¼(\frac{n}{d d_1}) &amp;&#x3D; \sum_{d|\frac{n}{d_1}} Î¼(d) \\<br>&amp;&#x3D; \begin{cases} 1 &amp; d_1 &#x3D; n \\ 0 &amp; d_1 &lt; n \end{cases}<br>\end{align}<br>$$</p>
<p>å› æ­¤</p>
<p>$$<br>\begin{align}<br>f(n) &amp;&#x3D; \sum_{d|n} g(d) \\<br>&amp;&#x3D; \sum_{d|n} g(\frac{n}{d})<br>\end{align}<br>$$</p>

</details>

<h2 id="æ±‚è«æ¯”ä¹Œæ–¯å‡½æ•°çš„å€¼"><a href="#æ±‚è«æ¯”ä¹Œæ–¯å‡½æ•°çš„å€¼" class="headerlink" title="æ±‚è«æ¯”ä¹Œæ–¯å‡½æ•°çš„å€¼"></a>æ±‚è«æ¯”ä¹Œæ–¯å‡½æ•°çš„å€¼</h2><h3 id="å•ç‚¹æ±‚å€¼-1"><a href="#å•ç‚¹æ±‚å€¼-1" class="headerlink" title="å•ç‚¹æ±‚å€¼"></a>å•ç‚¹æ±‚å€¼</h3><p>è‡ªå·±ç®—ã€‚</p>
<h3 id="åŒºé—´ç­›æ³•"><a href="#åŒºé—´ç­›æ³•" class="headerlink" title="åŒºé—´ç­›æ³•"></a>åŒºé—´ç­›æ³•</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">getMu</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!flg[i]) p[++tot] = i, mu[i] = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= tot &amp;&amp; i * p[j] &lt;= n; ++j)</span><br><span class="line">        &#123;</span><br><span class="line">            flg[i * p[j]] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i % p[j] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                mu[i * p[j]] = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            mu[i * p[j]] = -mu[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="è«æ¯”ä¹Œæ–¯å˜æ¢"><a href="#è«æ¯”ä¹Œæ–¯å˜æ¢" class="headerlink" title="è«æ¯”ä¹Œæ–¯å˜æ¢"></a>è«æ¯”ä¹Œæ–¯å˜æ¢</h2><p>è®¾ $f(n)$ï¼Œ$g(n)$ ä¸ºä¸¤ä¸ªæ•°è®ºå‡½æ•°ã€‚<br>å¦‚æœæœ‰ $f(n) &#x3D; \sum_{d|n} g(d)$ é‚£ä¹ˆæœ‰ï¼š</p>
<p>å½¢å¼1ï¼š $g(n) &#x3D; \sum_{d|n} Î¼(d) f(\frac{n}{d})$ã€‚</p>
<p>è¿™ç§å½¢å¼ä¸‹ï¼Œå‡½æ•° $f(n)$ è¢«ç§°ä¸ºå‡½æ•° $g(n)$ çš„è«æ¯”ä¹Œæ–¯å˜æ¢ï¼Œåä¹‹åˆ™ç§°ä¹‹ä¸ºå…¶çš„è«æ¯”ä¹Œæ–¯é€†å˜æ¢ï¼ˆåæ¼”ï¼‰ã€‚</p>
<p>å½¢å¼2ï¼š $g(n) &#x3D; \sum_{d|n} Î¼(\frac{d}{n}) f(d)$ã€‚</p>
<p>æ®è¯´è¿™ç§å½¢å¼æ›´å¸¸è€ƒä¸€ç‚¹ã€‚</p>
<h3 id="è¯æ˜-4"><a href="#è¯æ˜-4" class="headerlink" title="è¯æ˜"></a>è¯æ˜</h3><ul>
<li>æ–¹æ³•ä¸€ï¼šå¯¹åŸå¼åšæ•°è®ºå˜æ¢ã€‚</li>
</ul>
<p>$$<br>\begin{align}<br>&amp; \sum_{d\mid n}Î¼(d)f(\frac{n}{d}) \\<br>&#x3D;&amp; \sum_{d\mid n}Î¼(d)\sum_{k\mid \frac{n}{d}}g(k) \\<br>&#x3D;&amp; \sum_{k\mid n}g(k)\sum_{d\mid \frac{n}{k}}Î¼(d) \\<br>&#x3D;&amp; g(n)<br>\end{align}<br>$$</p>
<p>ç”¨ $\displaystyle\sum_{d\mid n}g(d)$ æ¥æ›¿æ¢ $f(\dfrac{n}{d})$ï¼Œå†å˜æ¢æ±‚å’Œé¡ºåºã€‚æœ€åä¸€æ­¥å˜æ¢çš„ä¾æ®ï¼š$\displaystyle\sum_{d\mid n}Î¼(d)&#x3D;[n&#x3D;1]$ï¼Œå› æ­¤åœ¨ $\dfrac{n}{k}&#x3D;1$ æ—¶ç¬¬äºŒä¸ªå’Œå¼çš„å€¼æ‰ä¸º $1$ã€‚æ­¤æ—¶ $n&#x3D;k$ï¼Œæ•…åŸå¼ç­‰ä»·äº $\displaystyle\sum_{k\mid n}[n&#x3D;k]\cdot g(k)&#x3D;g(n)$</p>
<ul>
<li>æ–¹æ³•äºŒï¼šè¿ç”¨å·ç§¯ã€‚</li>
</ul>
<p>åŸé—®é¢˜ä¸ºï¼šå·²çŸ¥ $f&#x3D;g * 1$ï¼Œè¯æ˜ $g&#x3D;f * Î¼$</p>
<p>æ˜“çŸ¥å¦‚ä¸‹è½¬åŒ–ï¼š$f * Î¼&#x3D;g * 1 * Î¼\implies f * Î¼&#x3D;g$ï¼ˆå…¶ä¸­ $1 * Î¼&#x3D;Îµ$ï¼‰ã€‚</p>
<p>å¯¹äºç¬¬äºŒç§å½¢å¼ï¼š</p>
<p>ç±»ä¼¼ä¸Šé¢çš„æ–¹æ³•ä¸€ï¼Œæˆ‘ä»¬è€ƒè™‘é€†æ¨è¿™ä¸ªå¼å­ã€‚</p>
<p>$$<br>\begin{align}<br>&amp; \sum_{n|d}{Î¼(\frac{d}{n})f(d)} \\<br>&#x3D;&amp; \sum_{k&#x3D;1}^{+\infty}{Î¼(k)f(kn)} \\<br>&#x3D;&amp; \sum_{k&#x3D;1}^{+\infty}{Î¼(k)\sum_{kn|d}{g(d)}} \\<br>&#x3D;&amp; \sum_{n|d}{g(d)\sum_{k|\frac{d}{n}}{Î¼(k)}} \\<br>&#x3D;&amp; \sum_{n|d}{g(d)Îµ(\frac{d}{n})} \\<br>&#x3D;&amp; g(n)<br>\end{align}<br>$$</p>
<p>æˆ‘ä»¬æŠŠ $d$ è¡¨ç¤ºä¸º $kn$ çš„å½¢å¼ï¼Œç„¶åæŠŠ $f$ çš„åŸå®šä¹‰ä»£å…¥å¼å­ã€‚</p>
<p>å‘ç°æšä¸¾ $k$ å†æšä¸¾ $kn$ çš„å€æ•°å¯ä»¥è½¬æ¢ä¸ºç›´æ¥æšä¸¾ $n$ çš„å€æ•°å†æ±‚å‡º $k$ï¼Œå‘ç°åé¢é‚£ä¸€å—å…¶å®å°±æ˜¯ $Îµ$, æ•´ä¸ªå¼å­åªæœ‰åœ¨ $d&#x3D;n$ çš„æ—¶å€™æ‰èƒ½å–åˆ°å€¼ã€‚</p>
<h1 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h1><p>ã€Šæ··å‡åœŸæ•°å­¦ã€‹<br>OI Wiki</p>
]]></content>
      <categories>
        <category>æ•°å­¦</category>
      </categories>
      <tags>
        <tag>æ•°å­¦</tag>
      </tags>
  </entry>
  <entry>
    <title>æ•°å­¦æ‚é¡¹æ•´ç†</title>
    <url>/maths/mathematics/</url>
    <content><![CDATA[<p>è¿™é‡Œæ˜¯ä¸€ä¸ªæ•°å­¦æ‚é¡¹ï¼ˆä¹Ÿå°±æ˜¯å¤ªçŸ­æš‚æ—¶å†™ä¸æˆåšå®¢ï¼‰çš„æ•´ç†ã€‚</p>
<span id="more"></span>

<h1 id="è´¨æ•°"><a href="#è´¨æ•°" class="headerlink" title="è´¨æ•°"></a>è´¨æ•°</h1><p>å‚è§ <strong>é™ˆå“è£•è´¨æ•°ä¸‰å¤§å…¬ç†</strong> (<span class="exturl" data-url="aHR0cHM6Ly9rYW1vbWUubW9lL2luZGV4LnBocC8yMDIxLzA5LzI2L3RoZXlfY2hhbmdlZF9tYXRoLw==">Link is here<i class="fa fa-external-link-alt"></i></span>) ã€‚</p>
<p>åœ¨ $[1,n]$èŒƒå›´å†…ï¼Œè´¨æ•°ä¸ªæ•°çš„æ•°é‡çº§æ˜¯ $\dfrac{n}{\log n}$ çš„ï¼Œ</p>
<p>å³ï¼Œ $\pi(n) \sim O(\dfrac{n}{\log n})$</p>
<p>ï¼ˆæ­¤å¤„çš„$\log$æŒ‡çš„æ˜¯$\ln$ï¼‰</p>
<h1 id="ç»„åˆè®¡æ•°"><a href="#ç»„åˆè®¡æ•°" class="headerlink" title="ç»„åˆè®¡æ•°"></a>ç»„åˆè®¡æ•°</h1><h2 id="æ’åˆ—æ•°"><a href="#æ’åˆ—æ•°" class="headerlink" title="æ’åˆ—æ•°"></a>æ’åˆ—æ•°</h2><p>æ’åˆ—æ•°ï¼Œé€šå¸¸ç”¨ $A$ (Arrangement)æ¥è¡¨ç¤ºã€‚<br>å…¬å¼ä¸ºï¼š</p>
<p>$$<br>\begin{equation}<br>A^n_m &#x3D; \frac{n!}{(n-m)!}<br>\end{equation}<br>$$</p>
<p>è¿˜æœ‰ä»¥ä¸‹é€’æ¨å¼ï¼š</p>
<p>$$<br>A_n^m &#x3D; m \times A_{n-1}^{m-1} + A_{n-1}^m<br>$$</p>
<h2 id="ç»„åˆæ•°"><a href="#ç»„åˆæ•°" class="headerlink" title="ç»„åˆæ•°"></a>ç»„åˆæ•°</h2><p>ç»„åˆæ•°ï¼Œé€šå¸¸ç”¨ $C$ (Conbination)æ¥è¡¨ç¤ºã€‚</p>
<p>å¸¸è§çš„è¡¨ç¤ºæ–¹æ³•æœ‰$\binom{m}{n}$ å’Œ $C^n_m$ ä¸¤ç§ã€‚</p>
<p>å…¬å¼ä¸ºï¼š</p>
<p>$$<br>\begin{equation}<br>C^n_m &#x3D; \frac{A^n_m}{A^n_n} &#x3D; \frac{n!}{(n-m)!m!}<br>\end{equation}<br>$$</p>
<p>è¿˜æœ‰ä»¥ä¸‹é€’æ¨å¼ï¼š</p>
<p>$$<br>C_n^m &#x3D; C_{n-1}^{m-1} + C_{n-1}^m<br>$$</p>
<h3 id="å¿«é€Ÿè®¡ç®—ç»„åˆæ•°"><a href="#å¿«é€Ÿè®¡ç®—ç»„åˆæ•°" class="headerlink" title="å¿«é€Ÿè®¡ç®—ç»„åˆæ•°"></a>å¿«é€Ÿè®¡ç®—ç»„åˆæ•°</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">C</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> m)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(m &gt; n || m &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> fac[n] * ifac[m] % mod * ifac[n - m] % mod;</span><br><span class="line">&#125;<span class="comment">//ç»„åˆæ•°</span></span><br></pre></td></tr></table></figure>

<h3 id="å¸¸è§ç»„åˆæ’ç­‰å¼"><a href="#å¸¸è§ç»„åˆæ’ç­‰å¼" class="headerlink" title="å¸¸è§ç»„åˆæ’ç­‰å¼"></a>å¸¸è§ç»„åˆæ’ç­‰å¼</h3><ul>
<li>$\displaystyle C_n^m &#x3D; C_n^{n-m}$</li>
</ul>
<p>å› ä¸º</p>
<p>$$<br>C_n^m &#x3D; \frac{n!}{(n-m)!m!} &#x3D; \frac{n!}{(n-(n-m))!(n-m)!} &#x3D; C_n^{n-m}<br>$$</p>
<ul>
<li>$\displaystyle m \times C_n^m &#x3D; n \times C_{n-1}^{m-1}$</li>
</ul>
<p>å› ä¸º</p>
<p>$$<br>m \times C_n^m &#x3D; \frac{n!}{(n-m)!(m-1)!} &#x3D; n \times \frac{(n-1)!}{(n-m)!(m-1)!} &#x3D; n \times C_{n-1}^{m-1}<br>$$</p>
<ul>
<li>$\displaystyle \sum_{i&#x3D;0}^n C_n^i &#x3D; 2^n$</li>
</ul>
<p>å°±ç±»ä¼¼äºè€ƒè™‘æ¯ä¸€ä¸ªç‰©å“åˆ°åº•æ˜¯é€‰è¿˜æ˜¯ä¸é€‰ã€‚</p>
<ul>
<li>$\displaystyle C_n^0 + C_n^2 + \cdots &#x3D; C_n^1 + C_n^3 + \cdots &#x3D; 2^{n-1} (n \geq 1)$</li>
</ul>
<p>è·Ÿä¸Šé¢çš„é‚£ä¸ªå·®ä¸å¤šã€‚</p>
<ul>
<li>$\displaystyle \sum_{i&#x3D;0}^n (-1)^i C_n^i &#x3D; C_n^0 - C_n^1 + C_n^2 - C_n^3 + \cdots &#x3D; [ n&#x3D;&#x3D;0 ]$</li>
</ul>
<p>ä¸Šé¢é‚£ä¸ªçš„è¡ç”Ÿã€‚</p>
<ul>
<li>$\displaystyle \sum_{i&#x3D;0}^k C_n^i \times C_m^{k-i} &#x3D; C_{n+m}^k$</li>
</ul>
<p>è€ƒè™‘å°† $n+m$ çš„ä¸€å †ç‰©å“åˆ†ä¸ºä¸€å † $n$ çš„å’Œä¸€å † $m$ çš„ï¼Œåˆ†åˆ«ä»ä¸¤å †é‡Œé¢å–ã€‚<br>ç„¶ååˆ†åˆ«è€ƒè™‘ä»ä¸¤å †é‡Œé¢å„æŒ‘å‡ºæ¥å‡ ä¸ªç‰©å“ã€‚</p>
<ul>
<li>$\displaystyle \sum_{i&#x3D;0}^n (C_n^i)^2 &#x3D; C_{2n}^n$</li>
</ul>
<p>ä¸Šé¢çš„é‚£ä¸ªçš„ç‰¹æ®ŠåŒ–ã€‚<br>å› ä¸º $C_n^i &#x3D; C_n^{n-i}$ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†å…¶æ›¿æ¢ä¸ºè¿™æ ·çš„å½¢å¼ã€‚</p>
<h1 id="ä¸Šå‡å¹‚ä¸ä¸‹é™å¹‚"><a href="#ä¸Šå‡å¹‚ä¸ä¸‹é™å¹‚" class="headerlink" title="ä¸Šå‡å¹‚ä¸ä¸‹é™å¹‚"></a>ä¸Šå‡å¹‚ä¸ä¸‹é™å¹‚</h1><h2 id="ä¸Šå‡å¹‚"><a href="#ä¸Šå‡å¹‚" class="headerlink" title="ä¸Šå‡å¹‚"></a>ä¸Šå‡å¹‚</h2><p>$$<br>x^{\bar{k}} &#x3D; \prod_{i&#x3D;i}^k (x+i-1)<br>$$</p>
<h2 id="ä¸‹é™å¹‚"><a href="#ä¸‹é™å¹‚" class="headerlink" title="ä¸‹é™å¹‚"></a>ä¸‹é™å¹‚</h2><p>$$<br>x^{\underline{k}} &#x3D; \prod_{i&#x3D;1}^k (x-i+1)<br>$$</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ ç¬”è®°</tag>
        <tag>æ•°å­¦</tag>
      </tags>
  </entry>
  <entry>
    <title>æ‹‰æ ¼æœ—æ—¥æ’å€¼</title>
    <url>/maths/lagrange-interpolation/</url>
    <content><![CDATA[<p>æ‹‰æ ¼æœ—æ—¥æ’å€¼ã€‚</p>
<span id="more"></span>

<p>åœ¨å­¦å®Œå‡½æ•°ä»¥åï¼ŒAJæƒ³è®©æˆ‘ä»¬æ±‚å‡ºä¸€ä¸ªå‡½æ•°ï¼Œä½¿å¾—å…¶å¸¦å…¥è‡ªç„¶æ•°æ—¶ç”Ÿæˆçš„åºåˆ—æ—¶ç»™å®šçš„ï¼Œå¹¶è®©æ­¦å˜‰ç»™å‡ºäº†ä¸€ä¸ªæ•°åˆ—ã€‚</p>
<p>å´‡å°š<ruby>é‡ç£<rt>ã‚„ã˜ã‚…ã†</rt></ruby><ruby>å…ˆè¼©<rt>ã›ã‚“ã±ã„</rt></ruby>çš„æ­¦å˜‰ç»™å‡ºäº†è¿™æ ·çš„ä¸€ä¸ªåºåˆ—ï¼š</p>
<p>$$<br>1,3,5,7,9,114514<br>$$</p>
<p>å…‰çœ‹å‰äº”é¡¹è²Œä¼¼å¯ä»¥æ„å»ºå‡º $f(x)&#x3D;2x-1$ æ¥ç³Šè¿‡å»ï¼Œä½†æ˜¯ç¬¬6é¡¹å°±ä¸å¥½åŠäº†ã€‚</p>
<p>ç‹å“¥è¯´ï¼šâ€œè¿™éƒ½ä¸ä¼šï¼Œå¿«ç”¨<strong>æ‹‰æ ¼æœ—æ—¥æ’å€¼</strong>ï¼â€<br>(P.S.: å…¶å®æˆ‘ä»¬ç­é‡Œåˆä¸‰çš„æ—¶å€™çœŸçš„æœ‰è®²æ‹‰æ’)</p>
<hr>
<p>å¼•å…¥å®Œæ¯•ã€‚</p>
<p>æ‹‰æ ¼æœ—æ—¥æ’å€¼æ³•å¯ä»¥å¾ˆå¿«åœ°å°†ä¸€ç³»åˆ—çš„ç‚¹å€¼è½¬åŒ–ä¸ºä¸€ä¸ªç»è¿‡æ‰€æœ‰ç»™å®šç‚¹å€¼çš„å‡½æ•°ï¼ˆæˆ–è€…ç§°å¤šé¡¹å¼ï¼‰ã€‚</p>
<p>æ‹‰æ ¼æœ—æ—¥ç»™å‡ºçš„æ–¹æ³•æ˜¯è¿™æ ·çš„ï¼š</p>
<p>é¦–å…ˆæˆ‘ä»¬ç»™å‡ºä¸¤ä¸ªäºŒæ¬¡å¤šé¡¹å¼ï¼Œåˆ†åˆ«ç§°ä¹‹ä¸º $f(x)$ ä¸ $g(x)$ã€‚<br>ä¸¤è€…çš„ç³»æ•°åˆ†åˆ«ä¸º $a_f,b_f,c_f$ ä¸ $a_g,b_g,c_g$ã€‚</p>
<p>å‡è®¾æœ‰ä¸€ä¸ªå‡½æ•° $h(x)$ ï¼Œå®ƒç­‰äº $f(x)+g(x)$ï¼Œé‚£ä¹ˆ</p>
<p>$$<br>\begin{align}<br>h(x) &amp;&#x3D; f(x)+g(x) \\<br>&amp;&#x3D; a_fx^2+b_fx+c_f + a_gx^2+b_gx+c_g \\<br>&amp;&#x3D; (a_f+a_g)x^2 + (b_f+b_g)x + (c_f+c_g)<br>\end{align}<br>$$</p>
<p>$h(x)$ çš„æ¯ä¸€é¡¹ç³»æ•°ç«Ÿç„¶æ˜¯ $f(x)$ ä¸ $g(x)$ è¯¥é¡¹ç³»æ•°ä¹‹å’Œã€‚</p>
<p>æˆ‘ä»¬å†æ¥çœ‹ä»£å…¥æ•°å€¼ä¹‹åçš„ç»“æœã€‚</p>
<p>æˆ‘ä»¬ä¸éš¾çœ‹å‡ºï¼Œå¯¹äºæ¯ä¸€ä¸ª $x$ ï¼Œå…¶å¯¹åº”çš„å‡½æ•°å€¼ $f(x)$ï¼Œ$g(x)$ ä¸ $h(x)$ æ»¡è¶³ $h(x)&#x3D;f(x)+g(x)$ã€‚</p>
<p>ç„¶åæ‹‰æ ¼æœ—æ—¥å°±æƒ³ï¼Œå¯¹äºæ¯ä¸€ä¸ªç‚¹å€¼ï¼Œæˆ‘ä»¬åˆ†åˆ«æ„é€ ä¸€ä¸ªå‡½æ•°ï¼Œä½¿å¾—å…¶åˆšå¥½ç»è¿‡å½“å‰ç‚¹å€¼ä»£è¡¨çš„ç‚¹ï¼Œè€Œå…¶ä»–ç‚¹å€¼å¤„å‡ä¸º $0$ã€‚<br>æˆ‘ä»¬æœ€åå°†æ‰€æœ‰çš„å‡½æ•°åŠ èµ·æ¥ï¼Œå°±å¾—åˆ°äº†å®Œç¾ç»è¿‡æ¯ä¸ªç‚¹å€¼çš„å‡½æ•°äº†ã€‚</p>
<p>è€Œæ¯ä¸€ä¸ªå‡½æ•°åˆæ€ä¹ˆæ±‚å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬å…ˆæƒ³ä¸ªç®€å•ä¸€ç‚¹çš„ï¼Œè®©è¿™ä¸ªå‡½æ•°åœ¨å½“å‰ $x$ å¤„ä¸º $1$ï¼Œå…¶ä»– $x$ å¤„éƒ½ä¸º $0$ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬ä¸ºäº†è¡¨ç¤ºè¿™äº›ç‚¹å€¼ä¸”ä¸è‡ªç”±å…ƒ $x$ åŒºåˆ†ï¼Œè®¾å…¶åˆ†åˆ«ä¸º $(X_i,Y_i)$ï¼Œæ€»å…±æœ‰ $n$ ä¸ªï¼Œå½“å‰å‡½æ•°ä¸º $F_k(x)$ï¼Œä»£è¡¨ç€ç¬¬ $k$ ä¸ªç‚¹å€¼ã€‚</p>
<p>é‚£ä¹ˆï¼Œæˆ‘ä»¬è®©å‡½æ•°ä¸º $\displaystyle \prod_{i&#x3D;1,i \neq k}^n (x - X_i)$ï¼Œè¿™æ ·å¯ä»¥ä½¿é™¤å½“å‰ç‚¹ä¹‹å¤–çš„æ•°éƒ½æ˜¯ $0$ã€‚</p>
<p>ç„¶åï¼Œæˆ‘ä»¬å°†æ•´ä¸ªå‡½æ•°é™¤ä»¥ä»£å…¥ $X_k$ æ—¶çš„å€¼ï¼Œä½¿ $F_k(X_k)&#x3D;1$ã€‚<br>é‚£ä¹ˆæ•´ä¸ªå‡½æ•°å°±å˜ä¸ºäº† $\displaystyle \prod_{i&#x3D;1,i \neq k}^n \frac{x - X_i}{X_k - X_i}$ã€‚</p>
<p>æœ€åå†ä¹˜ä¸Š $Y_k$ï¼Œå°±å¯ä»¥å¾—å‡ºæˆ‘ä»¬å½“å‰çš„å‡½æ•°ï¼š$\displaystyle F_k(x) &#x3D; Y_k \prod_{i&#x3D;1,i \neq k}^n \frac{x - X_i}{X_k - X_i}$</p>
<p>å†æŠŠæ‰€æœ‰çš„ä¸œè¥¿åŠ èµ·æ¥ï¼Œå¾—åˆ°</p>
<p>$$<br>G(x) &#x3D; \sum_{k&#x3D;1}^n \bigg( Y_k \prod_{i&#x3D;1,i \neq k}^n \frac{x - X_i}{X_k -X_i} \bigg)<br>$$</p>
<hr>
<p>æˆ–è€…è¯´ï¼Œæˆ‘ä»¬å¯¹äºæ¯ä¸€ä¸ªç‚¹å€¼åˆ—ä¸€ä¸ªæ–¹ç¨‹ï¼Œå°†æ‰€æœ‰çš„ç³»æ•°ä½œä¸ºæœªçŸ¥é‡æ¥æ±‚è§£ã€‚</p>
<p>å¯¹äºä¸€ä¸ª $n$ æ¬¡å¤šé¡¹å¼ï¼Œæˆ‘ä»¬ä¸€å…±æœ‰ $n+1$ ä¸ªç³»æ•°ã€‚æˆ‘ä»¬è®¾è¿™äº›ç³»æ•°åˆ†åˆ«ä¸º $a_0,a_1,a_2,a_3,\cdots ,a_n$ã€‚</p>
<p>æˆ‘ä»¬å¦‚æœæœ‰ä¸€ä¸ªç‚¹å€¼ $(x,y)$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®å…¶åˆ—å‡ºä¸€ä¸ªæ–¹ç¨‹ï¼š</p>
<p>$$<br>a_0 + a_1 x + a_2 x^2 + a_3 x^3 + \cdots + a_n x^n &#x3D; y<br>$$</p>
<p>é¦–å…ˆï¼Œä¼—æ‰€å‘¨çŸ¥ï¼Œæˆ‘ä»¬éœ€è¦ä¸å°‘äº $n$ ä¸ªæ–¹ç¨‹æ‰èƒ½æ±‚å‡º $n$ ä¸ªæœªçŸ¥æ•°ã€‚<br>å…¶æ¬¡ï¼Œæˆ‘ä»¬åˆ©ç”¨å…‹æ‹‰é»˜æ³•åˆ™æ¥æ¥æ–¹ç¨‹å¼çš„æ—¶å€™ï¼Œä¹Ÿéœ€è¦å½¢æˆè¡Œåˆ—å¼æ‰èƒ½è§£å‡ºæ¥å€¼ã€‚</p>
<p>æ‰€ä»¥è¯´ï¼Œæˆ‘ä»¬ç»™å®š $n+1$ ä¸ªç‚¹å€¼ï¼Œèƒ½å”¯ä¸€åœ°ç¡®å®šä¸€ä¸ª $n$ æ¬¡å¤šé¡¹å¼ã€‚</p>
<hr>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å¦‚æœç”¨æ‹‰æ ¼æœ—æ—¥æ’å€¼æ³•æ¥è®¡ç®—AJçš„è¯¾åä½œä¸šçš„è¯ï¼Œå¾—åˆ°çš„å¼å­å°±æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š</p>
<p>$$<br>\begin{align}<br>G(x) &amp;&#x3D; 1Â·\frac{(x-2)(x-3)(x-4)(x-5)(x-6)}{(1-2)(1-3)(1-4)(1-5)(1-6)}<br>\\ &amp;+ 3Â·\frac{(x-1)(x-3)(x-4)(x-5)(x-6)}{(2-1)(2-3)(2-4)(2-5)(2-6)}<br>\\ &amp;+ 5Â·\frac{(x-1)(x-2)(x-4)(x-5)(x-6)}{(3-1)(3-2)(3-4)(3-5)(3-6)}<br>\\ &amp;+ 7Â·\frac{(x-1)(x-2)(x-3)(x-5)(x-6)}{(4-1)(4-2)(4-3)(4-5)(4-6)}<br>\\ &amp;+ 9Â·\frac{(x-1)(x-2)(x-3)(x-4)(x-6)}{(5-1)(5-2)(5-3)(5-4)(5-6)}<br>\\ &amp;+ 114514Â·\frac{(x-1)(x-2)(x-3)(x-4)(x-5)}{(6-1)(6-2)(6-3)(6-4)(6-5)} \\<br>&amp;&#x3D; \frac{114503}{120} x^5 - \frac{114503}{8} x^4 + \frac{1946551}{24} x^3 - \frac{1717545}{8} x^2 + \frac{15687031}{60} x - 114504<br>\end{align}<br>$$</p>
<p>è¿™é‡Œæœ‰ä¸€ä¸ª $O(n^2)$ æ±‚å‡ºæœ€åå¾—å‡ºçš„å¤šé¡¹å¼çš„ç³»æ•°çš„ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long </span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">5050</span>;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function">ll <span class="title">qpow</span><span class="params">(ll a, ll t = mod - <span class="number">2</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(t)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(t &amp; <span class="number">1</span>)ans = ans * a % mod;</span><br><span class="line">        a = a * a % mod;</span><br><span class="line">        t &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line">ll x[N], y[N], c[N], fs[N], g[N], f[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld&quot;</span>, &amp;x[i], &amp;y[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        c[i] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; j++)</span><br><span class="line">            <span class="keyword">if</span>(i != j)</span><br><span class="line">                c[i] = c[i] * (x[i] - x[j]) % mod;</span><br><span class="line">        c[i] = <span class="built_in">qpow</span>(c[i]) * y[i] % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    fs[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = n; j; j--)</span><br><span class="line">            fs[j] = (fs[j - <span class="number">1</span>] + fs[j] * (mod - x[i])) % mod;</span><br><span class="line">        fs[<span class="number">0</span>] = fs[<span class="number">0</span>] * (mod - x[i]) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ll buf = <span class="built_in">qpow</span>(mod - x[i]);</span><br><span class="line">        g[<span class="number">0</span>] = fs[<span class="number">0</span>] * buf % mod;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt; n; j++)</span><br><span class="line">            g[j] = (fs[j] - g[j - <span class="number">1</span>]) * buf % mod;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; j++)</span><br><span class="line">            f[j] = (f[j] + c[i] * g[j]) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>, (f[i] + mod) % mod);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3Uub3JnL2Jsb2cvY29tbWFuZC1ibG9jay96b25nLWxhLWNoYS1kYW8ta3VhaS1zdS1jaGEtemhpLXFpdS16aGk=">$\blacktriangleright$<i class="fa fa-external-link-alt"></i></span></p>
]]></content>
      <categories>
        <category>æ•°å­¦</category>
      </categories>
      <tags>
        <tag>æ•°å­¦</tag>
      </tags>
  </entry>
  <entry>
    <title>ç‰¹æ®Šçš„æ•°</title>
    <url>/maths/special-numbers/</url>
    <content><![CDATA[<p>ç®€ä»‹ï¼š å¡ç‰¹å…°æ•°ï¼Œæ–¯ç‰¹æ—æ•°ï¼Œæ¬§æ‹‰æ•°ï¼Œè°ƒå’Œçº§æ•°</p>
<span id="more"></span>

<h1 id="å¡ç‰¹å…°æ•°-Catalan-Numbers"><a href="#å¡ç‰¹å…°æ•°-Catalan-Numbers" class="headerlink" title="å¡ç‰¹å…°æ•°(Catalan Numbers)"></a>å¡ç‰¹å…°æ•°(Catalan Numbers)</h1><p>å¡ç‰¹å…°æ•° (<del>CatalÃ </del>Catalan Numbers) ååˆ†å¸¸ç”¨ï¼Œåºåˆ—çš„å¼€å¤´æ˜¯ $1,1,2,5,14,42,\cdots$</p>
<h2 id="å¼•å…¥"><a href="#å¼•å…¥" class="headerlink" title="å¼•å…¥"></a>å¼•å…¥</h2><p>æœ‰å…³å¡ç‰¹å…°æ•°çš„ä¾‹é¢˜æœ‰å¾ˆå¤šï¼Œå…¶ä¸­æœ€ç»å…¸çš„æ˜¯<span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL3Byb2JsZW0vUDEwNDQ=">ä¸‹é¢è¿™ä¸ª<i class="fa fa-external-link-alt"></i></span>ï¼š</p>
<p>æˆ‘ä»¬æœ‰ $n$ ä¸ªå…ƒç´ å’Œä¸€ä¸ªæ ˆã€‚è¿™ $n$ å„å…ƒç´ æ˜¯ $[1,n]$ çš„æ‰€æœ‰æ•´æ•°ï¼Œå¹¶ä¸”ä»¥å‡åºæ’åˆ—ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬å°†æ‰€æœ‰çš„å…ƒç´ æ”¾å…¥æ ˆä¸­ï¼Œå¹¶æœ€ç»ˆè®©æ‰€æœ‰å…ƒç´ éƒ½å‡ºæ ˆã€‚æ ˆçš„<code>pop()</code>å’Œ<code>push()</code>çš„é¡ºåºç”±ä½ è‡ªå·±æ¥å†³å®šï¼Œé—®æœ‰å¤šå°‘ç§å¯èƒ½çš„å‡ºæ ˆé¡ºåºã€‚</p>
<h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>æˆ‘ä»¬æ˜¾ç„¶å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬ä¸èƒ½å¯¹ç€ä¸€ä¸ªç©ºçš„æ ˆç–¯ç‹‚<code>pop()</code>ï¼Œä¹Ÿä¸èƒ½å¯¹ç€ä¸€ä¸ªç©ºçš„è¿›æ ˆåºåˆ—ç–¯ç‹‚<code>push()</code>ã€‚<br>æ‰€ä»¥ï¼Œæ¯ä¸€ä¸ª<code>pop()</code>æ“ä½œå¿…å®šå¯¹åº”ç€ä¹‹å‰çš„ä¸€ä¸ª<code>pop()</code>æ“ä½œï¼Œä¸”æ‰€æœ‰<code>pop()</code>æ“ä½œçš„æ¬¡æ•°ä¸<code>push()</code>æ“ä½œçš„æ¬¡æ•°ç›¸ç­‰ã€‚</p>
<p>æˆ‘ä»¬å°è¯•å°†<code>push()</code>å’Œ<code>pop()</code>æŠ½è±¡ä¸ºå‰ç¼€å’Œçš„å½¢å¼ã€‚<br>æˆ‘ä»¬å¯ä»¥å°†<code>push()</code>è½¬åŒ–ä¸º<code>+1</code>ï¼Œ<code>pop()</code>è½¬åŒ–ä¸º<code>-1</code>ã€‚<br>é‚£ä¹ˆï¼Œæˆ‘ä»¬çš„è¦æ±‚å°±æ˜¯ï¼š</p>
<p>è¯¥åºåˆ—çš„æ¯ä¸€ä¸ªå‰ç¼€å’Œå¿…å®šå¤§äºç­‰äº0ï¼Œä¸”æ•´ä¸ªåºåˆ—çš„å’Œå¿…å®šä¸º0ã€‚</p>
<p>è¿™å°±éœ€è¦æˆ‘ä»¬ä½¿ç”¨å¡ç‰¹å…°æ•°ã€‚</p>
<h2 id="æ±‚å€¼"><a href="#æ±‚å€¼" class="headerlink" title="æ±‚å€¼"></a>æ±‚å€¼</h2><p>æˆ‘ä»¬è¿™é‡Œä½¿ç”¨ $c_n$ æ¥ä»£è¡¨ç¬¬ $n$ é¡¹å¡ç‰¹å…°æ•°ã€‚</p>
<p>æˆ‘ä»¬é€šå¸¸ä½¿ç”¨çš„éƒ½æ˜¯å•ä¸ªçš„å¡ç‰¹å…°æ•°ï¼ˆé™¤éæœ‰å¤šç»„æµ‹è¯•æ•°æ®ï¼‰ï¼Œæ‰€ä»¥è¿™é‡Œé¦–å…ˆç»™å‡ºäº†é€šé¡¹å…¬å¼ã€‚</p>
<p>å¡ç‰¹å…°æ•°çš„é€šé¡¹å…¬å¼æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š</p>
<p>$$<br>c_n&#x3D;\frac{C_{2n}^n}{n+1}<br>$$</p>
<p>å¦‚æœéœ€è¦ç”Ÿæˆå¡ç‰¹å…°æ•°æ•°åˆ—ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¿›è¡Œé€’æ¨ï¼š</p>
<p>é¦–å…ˆï¼Œ$c_0&#x3D;c_1&#x3D;1$ï¼Œè¿™ä¸¤ä¸ªæˆ‘ä»¬å…ˆè‡ªå·±æ‰‹åŠ¨è¾“å…¥è¿›å»ã€‚<br>ä¹‹åæˆ‘ä»¬å¯ä»¥æ ¹æ®è¿™ä¸ªé€’æ¨å…¬å¼æ¥è®¡ç®—ï¼š</p>
<p>$$<br>c_n &#x3D; c_{n-1} \frac{4n-2}{n+1}<br>$$</p>
<p>æˆ‘ä»¬éœ€è¦æ³¨æ„ï¼Œåœ¨ $n \in [ 0,16 ] $ çš„æ—¶å€™å¯ä»¥åªå¼€<code>int</code>ï¼›åœ¨ $n \in [ 17,35 ] $ çš„æ—¶å€™å°±éœ€è¦å¼€<code>long long</code>äº†ï¼›è€Œå½“ $n \geq 36$ çš„æ—¶å€™å°±åªèƒ½ä½¿ç”¨é«˜ç²¾åº¦æˆ–è€…ç”¨ Python æ¥æ±‚äº†ã€‚</p>
<p>é€’æ¨ä»£ç ç¤ºä¾‹ï¼š</p>
<p>Pythonï¼š</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">ans = <span class="number">1</span></span><br><span class="line">n = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;é¡¹æ•°ï¼š&quot;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;1:&quot;</span> + <span class="built_in">str</span>(ans))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, n + <span class="number">1</span>):</span><br><span class="line">    ans = ans * (<span class="number">4</span> * i - <span class="number">2</span>) // (i + <span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">str</span>(i) + <span class="string">&quot;:&quot;</span> + <span class="built_in">str</span>(ans))</span><br></pre></td></tr></table></figure>

<p>ä¾‹é¢˜ <span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL3Byb2JsZW0vUDEwNDQ=">Luogu P1044<i class="fa fa-external-link-alt"></i></span> ä»£ç ç¤ºä¾‹ï¼š</p>
<p>Pythonï¼š</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">ans = <span class="number">1</span></span><br><span class="line">n = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;&quot;</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, n + <span class="number">1</span>):</span><br><span class="line">    ans = ans * (<span class="number">4</span> * i - <span class="number">2</span>) // (i + <span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>(ans))</span><br></pre></td></tr></table></figure>

<p>C++ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        ans = ans * (<span class="number">4</span> * i - <span class="number">2</span>) / (i + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="æ–¯ç‰¹æ—æ•°-Stirling-Numbers"><a href="#æ–¯ç‰¹æ—æ•°-Stirling-Numbers" class="headerlink" title="æ–¯ç‰¹æ—æ•°(Stirling Numbers)"></a>æ–¯ç‰¹æ—æ•°(Stirling Numbers)</h1><p>æ–¯ç‰¹æ—æ•° (Stirling Numbers) åˆ†ä¸ºç¬¬ä¸€ç±»æ–¯ç‰¹æ—æ•°å’Œç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°ã€‚</p>
<p>æˆ‘ä»¬ä½¿ç”¨ $s_1(n,k)$ æ¥è¡¨ç¤ºç¬¬ä¸€ç±»æ–¯ç‰¹æ—æ•°ï¼Œä½¿ç”¨ $s_2(n,k)$ æ¥è¡¨ç¤ºç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°ã€‚<br>é€šå¸¸çš„è¡¨è¾¾æ–¹å¼æ˜¯è¿™æ ·çš„ï¼š<br>ä½¿ç”¨ $\begin{bmatrix} n \\ k \end{bmatrix}$ æ¥è¡¨ç¤ºç¬¬ä¸€ç±»æ–¯ç‰¹æ—æ•°ï¼Œä½¿ç”¨ $\begin{Bmatrix} n \\ k \end{Bmatrix}$ æ¥è¡¨ç¤ºç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°ã€‚<br>ä½†æ˜¯å› ä¸ºè¿™ä¸ªæ ·å­åœ¨ $ \LaTeX $ é‡Œé¢å¹¶ä¸å¥½æ‰“ï¼Œæ‰€ä»¥æˆ‘å°±ç´¢æ€§æ¢äº†ä¸ªè¡¨è¾¾æ–¹å¼ï¼Œä»¥ä¾¿æˆ‘èƒ½å¤Ÿæ‰“å‡ºæ¥ã€‚</p>
<h2 id="ç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°"><a href="#ç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°" class="headerlink" title="ç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°"></a>ç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°</h2><p>ç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°æ¯”ç¬¬ä¸€ç±»æ›´åŠ å¸¸ç”¨ï¼ˆå…¶å®æ˜¯æ‰€æœ‰è¿™äº›æ•°é‡Œé™¤äº†ç»„åˆæ•°å¤–æœ€å¸¸ç”¨çš„ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆä»‹ç»ç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°ã€‚</p>
<h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>ç¬¬äºŒç±»æ–¯ç‰¹æ—æ•° $s_2(n,k)$ $(n \geq k)$ è¡¨ç¤ºè®²ä¸€ä¸ªæœ‰ $n$ ä»¶äº’ä¸ç›¸åŒçš„ç‰©å“çš„é›†åˆåˆ’åˆ†ä¸º $k$ ä¸ªéç©ºå­é›†çš„æ–¹æ³•æ•°ã€‚</p>
<p>ä¾‹ï¼š</p>
<p>$s_2(4,2)$ æœ‰ä¸‹åˆ—å‡ ç§æƒ…å†µï¼š</p>
<p>$$<br>\begin{align}<br>\{ 1 , 2 , 3 \} &amp; \cup \{ 4 \} \\<br>\{ 1 , 2 , 4 \} &amp; \cup \{ 3 \} \\<br>\{ 1 , 3 , 4 \} &amp; \cup \{ 2 \} \\<br>\{ 2 , 3 , 4 \} &amp; \cup \{ 1 \} \\<br>\{ 1 , 2 \} &amp; \cup \{ 3 , 4 \} \\<br>\{ 1 , 3 \} &amp; \cup \{ 2 , 4 \} \\<br>\{ 1 , 4 \} &amp; \cup \{ 2 , 3 \}<br>\end{align}<br>$$</p>
<p>æ‰€ä»¥ $s_2(4,2)&#x3D;7$ ã€‚</p>
<h3 id="æ€§è´¨"><a href="#æ€§è´¨" class="headerlink" title="æ€§è´¨"></a>æ€§è´¨</h3><ol>
<li><p>æ˜¾è€Œæ˜“è§çš„ï¼Œ$s_2(n,1)&#x3D;1$ ï¼Œ$s_2(n,n)&#x3D;1$ ã€‚</p>
</li>
<li><p>ç‰¹åˆ«çš„ï¼Œæˆ‘ä»¬è§„å®š $s_2(0,0)&#x3D;1$ ï¼Œ$s_2(n,0)&#x3D;0$ ã€‚</p>
</li>
</ol>
<h3 id="æ±‚å€¼-1"><a href="#æ±‚å€¼-1" class="headerlink" title="æ±‚å€¼"></a>æ±‚å€¼</h3><p>æˆ‘ä»¬ä»è¾ƒå°çš„ $k$ æ¥å…¥æ‰‹ã€‚</p>
<p>å½“ $k \leq 1$ æ—¶ æ¯”è¾ƒå¥½åŠï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸Šé¢ä¸¤ä¸ªæ˜¾è€Œæ˜“è§çš„æ€§è´¨æ¨å‡ºæ¥ã€‚</p>
<p>è€Œå½“ $k&#x3D;2$ æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·æƒ³ï¼š<br>ä¸€ä¸ªç‰©å“ä¸æ˜¯æ”¾åœ¨ä¸€ä¸ªç¯®å­é‡Œé¢å°±æ˜¯æ”¾åœ¨å¦ä¸€ä¸ªç¯®å­é‡Œé¢ï¼Œæ‰€ä»¥ $n$ ä¸ªç‰©å“ä¸€å…±æœ‰ $n^2$ ä¸­ä¸åŒçš„åˆ’åˆ†æ–¹å¼ã€‚<br>è€Œå› ä¸ºä¸¤ä¸ªç¯®å­ä¸åŒºåˆ†ï¼Œä¸”æœ‰ç€éç©ºçš„è¦æ±‚ï¼Œæ‰€ä»¥æœ€ç»ˆçš„åˆ’åˆ†æ–¹å¼å°±åªæœ‰ $2^{n-1}-1$ ç§äº†ã€‚<br>æ‰€ä»¥ï¼Œ</p>
<p>$$<br>s_2(n,k) &#x3D; 2^{n-1}-1 \quad (n&gt;0)<br>$$</p>
<p>æˆ–è€…ä½¿ç”¨æ›´éš¾æ‰“å‡ºæ¥ä½†æ›´çœ¼ç†Ÿçš„æ–¹å¼ï¼š</p>
<p>$$<br>\begin{Bmatrix}<br>n \\ 2<br>\end{Bmatrix}<br>&#x3D; 2^{n-1}-1<br>$$</p>
<p>å†æ¥çœ‹ $k&gt;2$ çš„æƒ…å†µã€‚</p>
<p>æˆ‘ä»¬ä»ç„¶å¯¹æ¯ä¸€ä¸ªç‰©å“è¿›è¡Œåˆ†æï¼Œåªä¸è¿‡æˆ‘ä»¬è¿™æ¬¡æ˜¯å€’åºåˆ†æçš„ã€‚</p>
<p>å¯¹äºæœ€åçš„ä¸€ä¸ªç‰©å“ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶å•ç‹¬åˆ†æˆä¸€å †ï¼Œä¹Ÿå¯ä»¥å°†å…¶æ”¾å…¥ä¹‹å‰çš„ $n-1$ ä¸ªç‰©å“ç»„æˆçš„ $k$ å †ä¸­çš„ä¸€å †ä¸­ã€‚</p>
<p>å¯¹äºå‰ä¸€ä¸ªé€‰æ‹©ï¼Œæˆ‘ä»¬æœ‰ $s_2(n-1,k-1)$ ä¸­æ’åˆ—çš„æ–¹æ³•ï¼›è€Œå¯¹äºåä¸€ç§ï¼Œæˆ‘ä»¬æœ‰ $s_2(n-1,k)$ ä¸­æ–¹æ³•ï¼Œæœ€åè¿˜éœ€ä¹˜ä»¥æˆ‘ä»¬å¯ä»¥åšå‡ºçš„é€‰æ‹©æ•° $k$ã€‚</p>
<h4 id="é€’æ¨å¼"><a href="#é€’æ¨å¼" class="headerlink" title="é€’æ¨å¼"></a>é€’æ¨å¼</h4><p>æ‰€ä»¥æ€»ç»“ä¸€ä¸€ä¸‹ï¼Œæˆ‘ä»¬æœ‰ä»¥ä¸‹é€’æ¨å¼ï¼š</p>
<p>$$<br>s_2(n,k) &#x3D; k Â· s_2(n-1,k) + s_2(n-1,k-1)<br>$$</p>
<p>æˆ–è€…ä½¿ç”¨æ›´éš¾æ‰“å‡ºæ¥ä½†æ›´çœ¼ç†Ÿçš„è¡¨è¾¾æ–¹å¼ï¼š</p>
<p>$$<br>\begin{Bmatrix}<br>n \\ k<br>\end{Bmatrix}<br>&#x3D;<br>k<br>\begin{Bmatrix}<br>n-1 \\ k<br>\end{Bmatrix}<br>+<br>\begin{Bmatrix}<br>n-1 \\ k-1<br>\end{Bmatrix}<br>$$</p>
<h4 id="é€šé¡¹å¼"><a href="#é€šé¡¹å¼" class="headerlink" title="é€šé¡¹å¼"></a>é€šé¡¹å¼</h4><p>è¿˜æœ‰ä¸€ç§ç›´æ¥æ±‚çš„é€šé¡¹å…¬å¼ï¼Œæ˜¯è¿™ä¸ªæ ·å­çš„ï¼š</p>
<p>$$<br>s_2(n,m)&#x3D;\sum_{i&#x3D;0}^m \frac{(-1)^{m-i} i^n}{i! (m-i)!}<br>$$</p>
<h2 id="ç¬¬ä¸€ç±»æ–¯ç‰¹æ—æ•°"><a href="#ç¬¬ä¸€ç±»æ–¯ç‰¹æ—æ•°" class="headerlink" title="ç¬¬ä¸€ç±»æ–¯ç‰¹æ—æ•°"></a>ç¬¬ä¸€ç±»æ–¯ç‰¹æ—æ•°</h2><h3 id="å®šä¹‰-1"><a href="#å®šä¹‰-1" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>ç¬¬ä¸€ç±»æ–¯ç‰¹æ—æ•° $s_1(n,k) (n \geq k)$ ä¹Ÿæ˜¯ä¸€ç§æè¿°å°† $n$ ä¸ªäº’ä¸ç›¸åŒçš„ç‰©å“åˆ’åˆ†ä¸º $k$ ä¸ªä¸åŒçš„è½®æ¢çš„æ–¹æ¡ˆã€‚</p>
<p>æ‰€è°“è½®æ¢ï¼Œå°±æ˜¯æŒ‡åƒé¡¹é“¾ä¸€æ ·çš„ç¯å½¢æ’åˆ—ï¼Œå¯ä»¥ç±»æ¯”æˆæŠŠæ‰€æœ‰çš„å…ƒç´ åƒç å­ä¸€æ ·ç©¿åˆ°é¡¹é“¾ä¸Šã€‚</p>
<p>æ¯”å¦‚è¯´ä¸€ä¸ªè½®æ¢ $[A,B,C,D]$ï¼Œå®ƒæœ‰4ç§å¼‚æ„ä½“ï¼š</p>
<p>$$<br>[A,B,C,D]&#x3D;[B,C,D,A]&#x3D;[C,D,A,B]&#x3D;[D,A,B,C]<br>$$</p>
<p>æ‰€ä»¥è¯´å¯¹äº $s_1(4,2)$ï¼Œæœ‰ä¸‹åˆ—å‡ ç§æƒ…å†µï¼š</p>
<p>$$<br>\begin{align}<br>[ 1,2,3 ] [ 4 ] \quad [ 1,3,2 ] [ 4 ] \\<br>[ 1,2,4 ] [ 3 ] \quad [ 1,4,2 ] [ 3 ] \\<br>[ 1,3,4 ] [ 2 ] \quad [ 1,4,3 ] [ 2 ] \\<br>[ 2,3,4 ] [ 1 ] \quad [ 2,4,3 ] [ 1 ]<br>\end{align}<br>$$<br>$$<br>[ 1,2 ] [ 3,4 ] \quad<br>[ 1,3 ] [ 2,4 ] \quad<br>[ 1,4 ] [ 2,3 ]<br>$$</p>
<p>ä¸€å…±11ç§ã€‚</p>
<p>æ‰€ä»¥ï¼Œ $s_1(4,2)&#x3D;11$ã€‚</p>
<p>æˆ‘ä»¬ä¸éš¾çœ‹å‡ºï¼Œ$s_1(n,k) \geq s_2(n,k)$ã€‚</p>
<h3 id="æ±‚å€¼-2"><a href="#æ±‚å€¼-2" class="headerlink" title="æ±‚å€¼"></a>æ±‚å€¼</h3><p>æˆ‘ä»¬ä»ç„¶ä»è¾ƒå°çš„ $k$ å¼€å§‹ã€‚</p>
<p>å½“ $k&#x3D;1$ æ—¶ï¼Œæˆ‘ä»¬å¯¹äºæ¯ä¸€ä¸ªç©ºä½è€ƒè™‘ã€‚ç¬¬ $i$ ä¸ªç©ºä½å¯ä»¥éšæ„é€‰æ‹© $n-i+1$ ä¸ªç‰©å“ï¼Œæ€»ä½“å°±æ˜¯ $\displaystyle \prod_{i&#x3D;1}^n (n-i+1)$ï¼Œæ˜¾è€Œæ˜“è§æ˜¯ $(n-1)!$ã€‚<br>æ‰€ä»¥ï¼š</p>
<p>$$<br>s_1(n,1)&#x3D;(n-1)!<br>$$</p>
<p>å½“æ‰€æœ‰çš„è½®æ¢éƒ½è‡³å¤šå«ä¸¤ä¸ªç‰©å“çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±ä¼šå‘ç°ï¼Œæ­¤æ—¶çš„è½®æ¢ä¸å­é›†æ˜¯ç­‰ä»·çš„ã€‚<br>è¿™ç§æƒ…å†µåªèƒ½åœ¨ $k&#x3D;n-1$ çš„æ—¶å€™æˆç«‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ<br>$$<br>\begin{align}<br>s_1(n,n) &amp;&#x3D; s_2(n,n) &#x3D; 1 \\<br>s_1(n,n-1) &amp;&#x3D; s_2(n,n-1) &#x3D; C^2_n<br>\end{align}<br>$$</p>
<h4 id="é€’æ¨å¼-1"><a href="#é€’æ¨å¼-1" class="headerlink" title="é€’æ¨å¼"></a>é€’æ¨å¼</h4><p>æˆ‘ä»¬è€ƒè™‘ä¸€èˆ¬çš„æƒ…å†µã€‚</p>
<p>è¿˜æ˜¯ç±»ä¼¼ä¹‹å‰è€ƒè™‘ $s_2$ æ—¶çš„æ–¹æ³•ï¼Œæˆ‘ä»¬è¿˜æ˜¯è€ƒè™‘æœ€åä¸€ä¸ªå…ƒç´ ã€‚</p>
<p>å¯¹äºè¿™ä¸ªå…ƒç´ ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶å•ç‹¬æˆå †ï¼Œä¹Ÿå¯ä»¥å°†å…¶æ”¾åœ¨ä¹‹å‰çš„ä»»æ„ä¸€ä¸ªè½®æ¢é‡Œé¢ã€‚</p>
<p>æ˜¾ç„¶ï¼Œå¯¹äºå‰è€…ï¼Œæˆ‘ä»¬æœ‰ $s_1(n-1,k-1)$ ç§æ–¹æ¡ˆï¼›å¯¹äºåè€…ï¼Œæˆ‘ä»¬æœ‰ $s_1(n-1,k)$ ç§æ–¹æ¡ˆï¼Œè€Œè¿™ä¸ªç‰©å“æœ‰ $n-1$ ç§æ”¾ç½®çš„ä½ç½®ï¼ˆæŒ‡æ’åœ¨ä»»æ„ä¸€ä¸ªå…ƒç´ çš„åé¢ï¼‰ï¼Œæ‰€ä»¥æ€»å…±æ˜¯è¿™æ ·çš„å¼å­ï¼š</p>
<p>$$<br>s_1(n,k) &#x3D; (n-1) Â· s_1(n-1,k) + s_1(n-1,k-1)<br>$$</p>
<p>æˆ–è€…ä½¿ç”¨æ›´éš¾æ‰“å‡ºæ¥ä½†æ›´çœ¼ç†Ÿçš„è¡¨è¾¾æ–¹å¼ï¼š</p>
<p>$$<br>\begin{bmatrix}<br>n \\ k<br>\end{bmatrix}<br>&#x3D;<br>(n-1)<br>\begin{bmatrix}<br>n-1 \\ k<br>\end{bmatrix}<br>+<br>\begin{bmatrix}<br>n-1 \\ k-1<br>\end{bmatrix}<br>$$</p>
<p>ç¬¬ä¸€ç±»æ–¯ç‰¹æ—æ•°æ²¡æœ‰å®ç”¨çš„é€šé¡¹å…¬å¼ã€‚</p>
]]></content>
      <categories>
        <category>æ•°å­¦</category>
      </categories>
      <tags>
        <tag>æ•°å­¦</tag>
      </tags>
  </entry>
  <entry>
    <title>L2759 èœœè¢‹é¼¯ï¼ˆãƒ•ã‚¯ãƒ­ãƒ¢ãƒ¢ãƒ³ã‚¬ï¼‰ é¢˜è§£</title>
    <url>/solutions/solution-l2759/</url>
    <content><![CDATA[<p>LibreOJ #2759</p>
<p>JOI 2014 Final T4</p>
<span id="more"></span>
<hr>
<h1 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h1><details class="note info"><summary><p>é¢˜é¢åŸæ–‡</p>
</summary>
<p>ãƒ•ã‚¯ãƒ­ãƒ¢ãƒ¢ãƒ³ã‚¬ã® $\rm{JOI}$ å›ãŒä½ã‚“ã§ã„ã‚‹æ£®ã«ã¯ãƒ¦ãƒ¼ã‚«ãƒªã®æœ¨ãŒ $N$ æœ¬ç”Ÿãˆã¦ãŠã‚Šï¼Œãã‚Œã‚‰ã®æœ¨ã«ã¯ $1$ ã‹ã‚‰ $N$ ã®ç•ªå·ãŒã¤ã„ã¦ã„ã‚‹ï¼æœ¨ $i$ ã®é«˜ã•ã¯ $H_i$ ãƒ¡ãƒ¼ãƒˆãƒ«ã§ã‚ã‚‹.<br>$\rm{JOI}$ å›ãŒç›¸äº’ã«ç›´æ¥é£›ã³ç§»ã‚‹ã“ã¨ã®ã§ãã‚‹æœ¨ã®çµ„ãŒ $M$ çµ„ã‚ã‚Šï¼Œå„çµ„ã®æœ¨ã®é–“ã‚’é£›ã³ç§»ã‚‹ãŸã‚ã«ã‹ã‹ã‚‹æ™‚é–“ãŒå®šã¾ã£ã¦ã„ã‚‹. $\rm{JOI}$ å›ãŒæœ¨ã®é–“ã‚’é£›ã³ç§»ã£ã¦ã„ã‚‹é–“ã¯ï¼Œåœ°é¢ã‹ã‚‰ã®é«˜ã•ãŒ $1$ ç§’ã‚ãŸã‚Š $1$ ãƒ¡ãƒ¼ãƒˆãƒ«ä¸‹ãŒã‚‹ï¼ã™ãªã‚ã¡ï¼Œ$\rm{JOI}$ å›ã®ç¾åœ¨ã®åœ°é¢ã‹ã‚‰ã®é«˜ã•ãŒ $h$ ãƒ¡ãƒ¼ãƒˆãƒ«ï¼Œæœ¨ã®é–“ã‚’é£›ã³ç§»ã‚‹ãŸã‚ã«ã‹ã‹ã‚‹æ™‚é–“ãŒ $t$ ç§’ã§ã‚ã‚‹ã¨ãï¼Œé£›ã³ç§»ã£ãŸå¾Œã®åœ°é¢ã‹ã‚‰ã®é«˜ã•ã¯ $h âˆ’ t$ ãƒ¡ãƒ¼ãƒˆãƒ«ã¨ãªã‚‹ï¼ãŸã ã—ï¼Œ$h âˆ’ t$ ãŒ $0$ ã‚ˆã‚Šã‚‚å°ã•ããªã‚‹å ´åˆã‚„è¡Œãå…ˆã®æœ¨ã®é«˜ã•ã‚ˆã‚Šã‚‚å¤§ãããªã‚‹å ´åˆã¯é£›ã³ç§»ã‚‹ã“ã¨ãŒã§ããªã„ï¼<br>ã•ã‚‰ã«ï¼Œ$\rm{JOI}$ å›ã¯æœ¨ã®å´é¢ã‚’ä¸Šä¸‹ã«ç§»å‹•ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ï¼Œåœ°é¢ã‹ã‚‰ã®é«˜ã•ã‚’ $0$ ãƒ¡ãƒ¼ãƒˆãƒ«ã‹ã‚‰ä»Šã„ã‚‹æœ¨ã®é«˜ã•ã®ç¯„å›²ã§å¢—æ¸›ã•ã›ã‚‹ã“ã¨ãŒã§ãã‚‹ï¼JOI å›ãŒåœ°é¢ã‹ã‚‰ã®é«˜ã•ã‚’ 1 ãƒ¡ãƒ¼ãƒˆãƒ«å¢—åŠ ã¾ãŸã¯æ¸›å°‘ã•ã›ã‚‹ãŸã‚ã«ã¯ $1$ ç§’ã®æ™‚é–“ãŒã‹ã‹ã‚‹ï¼<br>$\rm{JOI}$ å›ã¯ï¼Œæœ¨ $1$ ã®é«˜ã• $X$ ãƒ¡ãƒ¼ãƒˆãƒ«ã®ä½ç½®ã‹ã‚‰æœ¨ $N$ ã®é ‚ä¸Š (é«˜ã• $H_N$ ãƒ¡ãƒ¼ãƒˆãƒ«ã®ä½ç½®) ã«è¡Œã“ã†ã¨ã—ã¦ãŠã‚Šï¼Œãã®ãŸã‚ã«ã‹ã‹ã‚‹æ™‚é–“ã®æœ€å°å€¤ã‚’çŸ¥ã‚ŠãŸã„ï¼</p>
<p><strong>èª²é¡Œ</strong></p>
<p>å„æœ¨ã®é«˜ã•ã¨ï¼Œ$\rm{JOI}$ å›ãŒç›´æ¥é£›ã³ç§»ã‚‹ã“ã¨ãŒã§ãã‚‹æœ¨ã®çµ„ã®æƒ…å ±ã¨ï¼Œæœ€åˆ $\rm{JOI}$ å›ãŒã„ã‚‹å ´æ‰€ã®é«˜ã•ãŒä¸<br>ãˆã‚‰ã‚Œã‚‹ï¼æœ¨ $N$ ã®é ‚ä¸Šã«è¡ŒããŸã‚ã«ã‹ã‹ã‚‹æ™‚é–“ã®æœ€å°å€¤ã‚’æ±‚ã‚ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä½œæˆã›ã‚ˆ.</p>
<p><strong>å…¥åŠ›</strong></p>
<p>æ¨™æº–å…¥åŠ›ã‹ã‚‰ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚ï¼<br>â€¢ $1$ è¡Œç›®ã«ã¯ï¼Œæ•´æ•° $N, M, X$ ãŒç©ºç™½ã‚’åŒºåˆ‡ã‚Šã¨ã—ã¦æ›¸ã‹ã‚Œã¦ã„ã‚‹ï¼ã“ã‚Œã¯ï¼Œæœ¨ã®æœ¬æ•°ãŒ $N$ æœ¬ï¼Œç§»å‹•ã§ãã‚‹æœ¨ã®çµ„ãŒ $M$ çµ„ã‚ã‚Šï¼Œæœ€åˆ $\rm{JOI}$ å›ãŒæœ¨ $1$ ã®é«˜ã• $X$ ãƒ¡ãƒ¼ãƒˆãƒ«ã®ä½ç½®ã«ã„ã‚‹ã“ã¨ã‚’è¡¨ã™ï¼<br>â€¢ ç¶šã $N$ è¡Œã®ã†ã¡ã® $i$ è¡Œç›® $(1 \leq i \leq N)$ ã«ã¯ï¼Œæ•´æ•° $H_i$ ãŒæ›¸ã‹ã‚Œã¦ã„ã‚‹ï¼ã“ã‚Œã¯ï¼Œæœ¨ $i$ ã®é«˜ã•ãŒ $H_i$ ãƒ¡ãƒ¼ãƒˆãƒ«ã§ã‚ã‚‹ã“ã¨ã‚’è¡¨ã™ï¼<br>â€¢ ç¶šã $M$ è¡Œã®ã†ã¡ã® $j$ è¡Œç›® $(1 \leq j \leq M)$ ã«ã¯ï¼Œæ•´æ•° $A_j$, $B_j$, $T_j$ $(1 \leq A_j \leq N, 1 \leq B_j \leq N, A_j \neq B_j)$ ãŒç©ºç™½ã‚’åŒºåˆ‡ã‚Šã¨ã—ã¦æ›¸ã‹ã‚Œã¦ã„ã‚‹ï¼ã“ã‚Œã¯ï¼Œæœ¨ $A_j$ ã¨æœ¨ $B_j$ ã®é–“ã‚’ç›¸äº’ã« $T_j$ ç§’ã§é£›ã³ç§»ã‚‹ã“ã¨ãŒã§ãã‚‹ã“ã¨ã‚’è¡¨ã—ã¦ã„ã‚‹ï¼ã¾ãŸï¼Œ$1 \leq j &lt; k \leq M$ ãªã‚‰ã°ï¼Œ$(A_j, B_j) \neq (A_k, B_k)$ ãŠã‚ˆã³ $(A_j, B_j) \neq (B_k, A_k)$ ã‚’æº€ãŸã™ï¼</p>
<p><strong>å‡ºåŠ›</strong></p>
<p>æ¨™æº–å‡ºåŠ›ã«ï¼Œæœ¨ $1$ ã®é«˜ã• $X$ ãƒ¡ãƒ¼ãƒˆãƒ«ã®ä½ç½®ã‹ã‚‰æœ¨ $N$ ã®é ‚ä¸Šã«è¡ŒããŸã‚ã«ã‹ã‹ã‚‹æ™‚é–“ã®æœ€å°å€¤ã‚’ç§’å˜ä½ã§è¡¨ã™æ•´æ•°ã‚’ $1$ è¡Œã§å‡ºåŠ›ã›ã‚ˆï¼ãŸã ã—ï¼Œãã®ã‚ˆã†ãªæ–¹æ³•ãŒãªã„å ´åˆã¯ä»£ã‚ã‚Šã« $âˆ’1$ ã‚’å‡ºåŠ›ã›ã‚ˆï¼</p>
<p><strong>åˆ¶é™</strong></p>
<p>ã™ã¹ã¦ã®å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã¯ä»¥ä¸‹ã®æ¡ä»¶ã‚’æº€ãŸã™ï¼<br>â€¢ $2 \leq N \leq 100 000$.<br>â€¢ $1 \leq M \leq 300 000$.<br>â€¢ $1 \leq Hi \leq 1 000 000 000 (1 \leq i \leq N)$.<br>â€¢ $1 \leq T j \leq 1 000 000 000 (1 \leq j \leq M)$.<br>â€¢ $0 \leq X \leq H1$.</p>
<p><strong>å°èª²é¡Œ</strong></p>
<p>å°èª²é¡Œ 1 [25 ç‚¹]<br>ä»¥ä¸‹ã®æ¡ä»¶ã‚’æº€ãŸã™ï¼<br>â€¢ $N \leq 1 000$.<br>â€¢ $M \leq 3 000$.<br>â€¢ $Hi \leq 100 (1 \leq i \leq N)$ï¼<br>â€¢ $T j \leq 100 (1 \leq j \leq M)$ï¼</p>
<p>å°èª²é¡Œ 2 [25 ç‚¹]<br>ä»¥ä¸‹ã®æ¡ä»¶ã‚’æº€ãŸã™ï¼<br>â€¢ $X &#x3D; 0$ï¼</p>
<p>å°èª²é¡Œ 3 [50 ç‚¹]<br>è¿½åŠ ã®åˆ¶é™ã¯ãªã„ï¼</p>

</details>

<details class="note default"><summary><p>é¢˜é¢ç¿»è¯‘</p>
</summary>
<p>èœœè¢‹é¼¯ $\rm{JOI}$ å›ä½ç€çš„æ£®æ—é‡Œé•¿ç€ç¼–å·ä¸º $1$ åˆ° $N$ çš„ $N$ æ£µæ¡‰æ ‘ã€‚ç¬¬ $i$ æ£µæ ‘çš„é«˜åº¦æ˜¯ $H_i$ ç±³ã€‚<br>$\rm{JOI}$ å›èƒ½åœ¨å…¶ä¸­çš„ $M$ å¯¹æ¡‰æ ‘ä¹‹é—´ç›´æ¥é£è¡Œï¼Œåœ¨å„å¯¹æ ‘æœ¨ä¹‹é—´é£è¡Œæ‰€éœ€çš„æ—¶é—´æ˜¯å›ºå®šçš„ã€‚å½“ $\rm{JOI}$ å›åœ¨æ ‘æœ¨ä¹‹é—´é£è¡Œçš„æ—¶å€™ï¼Œä»–ç¦»åœ°é¢çš„é«˜åº¦ä¼šæ¯ç§’ä¸‹é™ $1$ ç±³ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœ $\rm{JOI}$ å›ç°åœ¨ç¦»åœ°é«˜åº¦æ˜¯ $h$ ç±³ï¼Œåœ¨æ ‘æœ¨ä¹‹é—´é£è¡Œéœ€è¦ $t$ ç§’ï¼Œé‚£ä¹ˆé£è¡Œä¹‹åçš„ç¦»åœ°é«˜åº¦å°±ä¼šå˜æˆ $h-t$ ç±³ã€‚å½“  å°äº $0$ æˆ–å¤§äºç›®æ ‡æ ‘æœ¨çš„é«˜åº¦æ—¶åˆ™ä¸èƒ½é£è¡Œã€‚<br>$\rm{JOI}$ å›è¿˜èƒ½æ²¿ç€æ ‘çš„ä¾§é¢ä¸Šä¸‹ç§»åŠ¨ï¼Œä½¿å¾—ä»–çš„ç¦»åœ°é«˜åº¦åœ¨ $0$ åˆ°å½“å‰æ‰€åœ¨æ ‘æœ¨é«˜åº¦çš„èŒƒå›´å†…å˜åŒ–ã€‚$\rm{JOI}$ å›æ¯ä½¿è‡ªå·±çš„ç¦»åœ°é«˜åº¦å¢åŠ æˆ–å‡å°‘ $1$ ç±³éƒ½éœ€è¦ $1$ ç§’çš„æ—¶é—´ã€‚<br>$\rm{JOI}$ å›è¦ä» $1$ å·æ ‘æœ¨ä¸Šé«˜åº¦ä¸º $X$ ç±³çš„ä½ç½®å‡ºå‘ï¼Œåˆ°æ ‘æœ¨ $N$ çš„é¡¶ç«¯ï¼ˆé«˜åº¦ä¸º $H_N$ ç±³çš„ä½ç½®ï¼‰å»ã€‚ä»–æƒ³çŸ¥é“ä¸ºäº†è¾¾æˆè¿™ä¸ªç›®æ ‡æ‰€éœ€æ—¶é—´çš„æœ€å°å€¼ã€‚<br>ç»™å‡ºå„æ£µæ ‘æœ¨çš„é«˜åº¦ã€$\rm{JOI}$ å›èƒ½ç›´æ¥é£è¡Œçš„æ ‘æœ¨å¯¹å’Œ $\rm{JOI}$ å›æœ€åˆæ‰€åœ¨ä½ç½®çš„é«˜åº¦ï¼Œè¯·æ±‚å‡ºåˆ°è¾¾æ ‘æœ¨ $N$ é¡¶ç«¯æ‰€éœ€æ—¶é—´çš„æœ€å°å€¼ã€‚</p>
<p><strong>è¾“å…¥æ ¼å¼</strong></p>
<p>ç¬¬ä¸€è¡ŒåŒ…å«ä¸‰ä¸ªä»¥ç©ºæ ¼åˆ†å¼€çš„æ•´æ•° $N,M$ å’Œ $X$ ï¼Œæ„ä¹‰åˆ†åˆ«ä¸é¢˜ç›®æè¿°ä¸­çš„ $N,M$ å’Œ $X$ ç›¸åŒã€‚<br>æ¥ä¸‹æ¥ $N$ è¡Œä¸­ï¼Œç¬¬ $i$ è¡Œ $(1 \leq i \leq N)$ æœ‰ä¸€ä¸ªæ•´æ•° $H_i$ ï¼Œè¡¨ç¤ºæ ‘æœ¨ $i$ çš„é«˜åº¦æ˜¯ $H_i$ ç±³ã€‚<br>æ¥ä¸‹æ¥ $M$ è¡Œä¸­ï¼Œç¬¬ $j$ è¡Œ $(1 \leq j \leq M)$ æœ‰ä¸‰ä¸ªä»¥ç©ºæ ¼åˆ†å¼€çš„æ•´æ•°  $A_j$, $B_j$, $T_j$ $(1 \leq A_j \leq N, 1 \leq B_j \leq N, A_j \neq B_j)$ ï¼Œè¡¨ç¤º IOI å›èƒ½èŠ± $T_j$ ç§’çš„æ—¶é—´ä» $A_j$ é£åˆ° $B_j$ æˆ–ä» $B_j$ é£åˆ° $A_j$ ã€‚<br>å¯¹äºä»»æ„ $1 \leq j &lt; k \leq M$ ï¼Œæ»¡è¶³ $(A_j, B_j) \neq (A_k, B_k)$ ä¸” $(A_j, B_j) \neq (B_k, A_k)$ ã€‚</p>
<p><strong>è¾“å‡ºæ ¼å¼</strong></p>
<p>è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºï¼Œä»…ä¸€è¡Œä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºä»æ ‘æœ¨ $1$ ä¸Šé«˜åº¦ä¸º $X$ ç±³å¤„ç§»åŠ¨åˆ°æ ‘æœ¨ $N$ é¡¶ç«¯æ‰€éœ€æ—¶é—´çš„æœ€å°å€¼ï¼ˆå•ä½ï¼šç§’ï¼‰ã€‚å¦‚æœä¸èƒ½åˆ°è¾¾ç›®çš„åœ°åˆ™è¾“å‡º $-1$ ã€‚</p>
<p>ï¼ˆå­ä»»åŠ¡æ•°æ®çœ‹åŸæ–‡ï¼‰</p>

</details>

<h1 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h1><p>é¦–å…ˆæˆ‘ä»¬è€ƒè™‘ä¸€ä¸‹æˆ‘ä»¬çš„ç­–ç•¥ã€‚</p>
<p>æ— è®ºç»™å‡ºä½•ç§æ–¹æ¡ˆï¼Œæˆ‘ä»¬éƒ½éœ€è¦éµå®ˆä¸€ä¸ªåŸåˆ™ï¼šéå¿…è¦ä¸çˆ¬å‡ï¼Œä¸”çˆ¬å‡æ—¶åªçˆ¬å‡è‡³è¶³å¤Ÿé£è¿‡å»çš„é«˜åº¦å³å¯ã€‚</p>
<details class="note primary"><summary><p>ç®€å•è¯´æ˜</p>
</summary>
<p>å¯¹äºå‰åŠå¥ï¼Œæˆ‘ä»¬è¿™æ ·åˆ†æï¼š</p>
<p>æˆ‘ä»¬å‡è®¾å¯ä»¥çªç ´é«˜åº¦åªèƒ½å¤§äºç­‰äº0çš„é™åˆ¶ã€‚</p>
<p>é‚£æˆ‘ä»¬å°±å¯ä»¥æŒç»­è¿›è¡Œé£è¡Œæ“ä½œï¼ŒçŸ¥é“åˆ°è¾¾ç»ˆç‚¹å†å‘ä¸Šçˆ¬åˆ°æ ‘é¡¶ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å°†æˆ‘ä»¬çš„æ“ä½œä»ä¸€ç³»åˆ—çš„â€œé£è·ƒ-çˆ¬å‡â€æ“ä½œå˜æˆäº†ä¸€ä¸²è¿ç»­çš„é£è·ƒæ“ä½œå’Œä¸€ä¸ªçˆ¬å‡æ“ä½œã€‚</p>
<p>æ˜¾ç„¶ï¼Œåªè¦æˆ‘ä»¬é€‰æ‹©çš„è·¯å¾„ä¸€å®šï¼Œæˆ‘ä»¬æœ€åçˆ¬å‡çš„è·¯ç¨‹ä¸€å®šæ˜¯ä¸€å®šçš„ã€‚<br>æˆ‘ä»¬ä¸å¦¨è®¾å…¶ä¸º $h$ ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé€‰æ‹©åœ¨ä¸­é—´è¿›è¡Œä¸€æ¬¡çˆ¬å‡æ“ä½œï¼Œå‡è®¾æˆ‘ä»¬çˆ¬å‡çš„é«˜åº¦ä¸º $hâ€™$ ã€‚<br>é‚£ä¹ˆï¼Œæˆ‘ä»¬åˆ°è¾¾æœ€åçš„é«˜åº¦å°±æ˜¯$H_N - h + hâ€™$ã€‚</p>
<p>ç„¶è€Œï¼Œæˆ‘ä»¬æ€»å…±è¿˜æ˜¯çˆ¬å‡äº† $h-hâ€™+hâ€™&#x3D;h$ çš„é«˜åº¦ï¼Œæ€»å…±çˆ¬å‡æ“ä½œæ‰€ç”¨çš„æ—¶é—´ä¹Ÿæ˜¯ä¸å˜çš„ã€‚</p>
<p>æ›´ä½•å†µæˆ‘ä»¬è¿˜ä¼šé‡åˆ°åˆ°ä¸€æ£µæ ‘æ­£ä¸Šæ–¹æ—¶é«˜åº¦å¤§äºæ ‘é«˜çš„æ—¶å€™ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±åªèƒ½é™ä½é«˜åº¦ï¼Œè€Œåœ¨æœ€åå¤šçš„æ—¶é—´æ¥çˆ¬å‡åˆšæ‰é™ä½çš„é‚£ä¸€æ®µè·ç¦»ã€‚<br>è¿™ä¼šå¯¼è‡´å¦‚æœæˆ‘ä»¬ççˆ¬å‡çš„è¯ï¼Œç»“æœä¼šåŠ£äºéå¿…è¦ä¸çˆ¬å‡çš„ç»“æœã€‚</p>
<p>é‚£ä¹ˆå¯¹äºååŠå¥ï¼Œæˆ‘ä»¬è¿™æ ·åˆ†æï¼š</p>
<p>å‡è®¾ä¸€ç§æé™æƒ…å†µï¼Œä¸€è·¯ä¸Šçš„æ ‘ä¸€æ£µæ¯”ä¸€æ£µçŸ®ï¼Œä¸”æ¯ä¸€æ¬¡ä»æ ‘é¡¶å¼€å§‹é£è¡Œéƒ½ä¼šé£è·ƒç›®æ ‡æ ‘ã€‚<br>é‚£ä¹ˆå¦‚æœæˆ‘ä»¬é€‰æ‹©çˆ¬å‡çš„é«˜åº¦å¤ªå¤šï¼Œå°±ä¼šå¯¼è‡´çˆ¬å‡é«˜åº¦çš„æµªè´¹ã€‚</p>
<p>æˆ‘ä»¬å®Œå…¨å¯ä»¥é€‰æ‹©ä¸€ç§æç«¯çš„æƒ…å†µï¼Œé‚£ä¹ˆå°±æ˜¯è®©æˆ‘ä»¬çš„é«˜åº¦ä¿æŒä¸º0å³å¯ã€‚<br>æˆ‘ä»¬åœ¨æ¯æ¬¡é£è·ƒä¸€æ¡è¾¹ï¼ˆå‡è®¾å…¶ä¸º $(u,v)$ ï¼‰æ—¶ï¼Œæˆ‘ä»¬å¦‚æœä¹‹å‰å·²ç»ä¿æŒäº†é«˜åº¦ä¸º0çš„è¯ï¼Œæˆ‘ä»¬å°±åªéœ€çˆ¬å‡ $w_{(u,v)}$ çš„é«˜åº¦å³å¯ï¼Œå³åˆ°è¾¾ $v$ ç‚¹æ—¶é«˜åº¦ä»ç„¶ä¸ºé›¶ã€‚è€Œå¦‚æœæˆ‘ä»¬ä»æœ‰é«˜åº¦$x$çš„è¯ï¼Œæˆ‘ä»¬å°±çˆ¬å‡ <code>(x-w[(u,v)]&gt;=0)?0:(w[(u,v)]-x)</code> å³å¯ã€‚<br>å¦‚æœæŒ‰ç…§è¿™æ ·æ“ä½œçš„è¯ï¼Œæˆ‘ä»¬åªä¼šåœ¨è¾¾åˆ°é«˜åº¦ä¸º0ä¹‹å‰çš„æ—¶å€™æ‰å¯èƒ½ä¸‹é™é«˜åº¦ä»¥é€‚é…è¾ƒä½çš„æ ‘é«˜ï¼Œæœ€ç»ˆå¾—åˆ°çš„å°±æ˜¯æœ€ä¼˜çš„ç»“æœã€‚</p>
<p>Q.E.D.</p>

</details>

<p>ä¹‹åå¯¹æ¯ä¸€æ¡è¾¹è¿›è¡Œåˆ†æã€‚</p>
<p>å¯¹äºæ¯ä¸€æ¡è¾¹ $(u,v)$ ï¼Œä¼šæœ‰ä»¥ä¸‹å››ç§æƒ…å†µï¼š</p>
<ol>
<li>åˆ°è¾¾ç‚¹æ­£ä¸Šæ–¹æ—¶çš„é«˜åº¦å¤§äºæ ‘é«˜ã€‚<br>éœ€è¦å…ˆå‘ä¸‹çˆ¬åˆ°é«˜åº¦ä¸º $h_v + w_{(u,v)}$ çš„ç‚¹æ‰èƒ½ä»è¯¥è¾¹é£è¿‡ï¼Œå¯ä»¥è¯æ˜è¿™æ˜¯æœ€ä¼˜é€‰æ‹©ã€‚</li>
<li>åœ¨é£è¡Œé€”ä¸­ä¸å¾—ä¸è½åœ°ã€‚<br>æˆ‘ä»¬æ— è®ºå¦‚ä½•éƒ½æ— æ³•é€šè¿‡è¿™ä¸€æ¡è¾¹ï¼Œåªèƒ½åœ¨å‘æœ‰å‘å›¾ä¸­åŠ è¾¹æ—¶å¿½ç•¥è¿™ä¸€æ¡è¾¹ã€‚</li>
<li>ä¸å‘ä¸Šçˆ¬æ— æ³•æ­£å¸¸é£åˆ°ä¸‹ä¸€ä¸ªç‚¹ã€‚<br>æ ¹æ®ä¸Šé¢çš„è¯æ˜ï¼Œæˆ‘ä»¬åªéœ€å‘ä¸Šçˆ¬å‡è‡³é«˜åº¦ $w_{(u,v)}$ ï¼Œä¿è¯å°½é‡é è¿‘åœ°é¢ã€‚</li>
<li>å¯ä»¥æ­£å¸¸é£åˆ°ä¸‹ä¸€ä¸ªç‚¹ã€‚<br>ç›´æ¥é£è·ƒå³å¯ã€‚</li>
</ol>
<p>è¿™æ ·è¿™ä¸ªé—®é¢˜å°±å˜æˆäº†ä¸€ä¸ªæœ€çŸ­è·¯é—®é¢˜ã€‚<br>è€Œå¯¹äºæœ€çŸ­è·¯çš„å¯»æ‰¾ï¼Œæˆ‘ä»¬é‡‡ç”¨dijkstraç®—æ³•ã€‚</p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">100005</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M = <span class="number">300005</span>;</span><br><span class="line"><span class="type">int</span> head[N], ne[M &lt;&lt; <span class="number">1</span>], to[M &lt;&lt; <span class="number">1</span>], cost[M &lt;&lt; <span class="number">1</span>], idx;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> add(a,b,c) to[++idx]=b,ne[idx]=head[a],head[a]=idx,cost[idx]=c</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> bianli(x) for(int i=head[x];i;i=ne[i])</span></span><br><span class="line"><span class="type">int</span> val[N];</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line">ll sum[N];</span><br><span class="line"><span class="type">int</span> H[N];</span><br><span class="line"><span class="type">bool</span> mark[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">    ll v;</span><br><span class="line">    <span class="type">int</span> id;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> &lt;(<span class="type">const</span> node &amp;A)<span class="type">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> v &gt; A.v;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">priority_queue&lt;node&gt; q;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dijkstra</span><span class="params">(<span class="type">int</span> at)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)sum[i]=<span class="number">1e18</span>;</span><br><span class="line">    q.<span class="built_in">push</span>(&#123; <span class="number">0</span>,<span class="number">1</span> &#125;);</span><br><span class="line">    H[<span class="number">1</span>] = at;</span><br><span class="line">    sum[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    ll v;</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        node now = q.<span class="built_in">top</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">if</span>(mark[now.id])<span class="keyword">continue</span>;</span><br><span class="line">        mark[now.id] = <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> h = H[now.id];</span><br><span class="line">        <span class="built_in">bianli</span>(now.id)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(h - cost[i] &gt; val[to[i]])</span><br><span class="line">            &#123;</span><br><span class="line">                v = sum[now.id] + h - cost[i] - val[to[i]] + cost[i];</span><br><span class="line">                <span class="keyword">if</span>(sum[to[i]] &gt; v)</span><br><span class="line">                &#123;</span><br><span class="line">                    sum[to[i]] = v;</span><br><span class="line">                    H[to[i]] = val[to[i]];</span><br><span class="line">                    q.<span class="built_in">push</span>(&#123; sum[to[i]],to[i] &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(h - cost[i] &lt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                v = sum[now.id] + cost[i] - h + cost[i];</span><br><span class="line">                <span class="keyword">if</span>(sum[to[i]] &gt; v)</span><br><span class="line">                &#123;</span><br><span class="line">                    sum[to[i]] = v;</span><br><span class="line">                    H[to[i]] = <span class="number">0</span>;</span><br><span class="line">                    q.<span class="built_in">push</span>(&#123; sum[to[i]],to[i] &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(sum[to[i]] &gt; sum[now.id] + cost[i])</span><br><span class="line">                &#123;</span><br><span class="line">                    sum[to[i]] = sum[now.id] + cost[i];</span><br><span class="line">                    H[to[i]] = h - cost[i];</span><br><span class="line">                    q.<span class="built_in">push</span>(&#123; sum[to[i]],to[i] &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> at;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;at);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;val[i]);</span><br><span class="line">    <span class="type">int</span> a, b, c;</span><br><span class="line">    <span class="keyword">while</span>(m--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;c);</span><br><span class="line">        <span class="keyword">if</span>(val[a] &gt;= c)<span class="built_in">add</span>(a, b, c);</span><br><span class="line">        <span class="keyword">if</span>(val[b] &gt;= c)<span class="built_in">add</span>(b, a, c);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dijkstra</span>(at);</span><br><span class="line">    <span class="keyword">if</span>(sum[n] == <span class="number">1e18</span>)<span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, sum[n] + val[n] - H[n]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>é¢˜è§£</tag>
        <tag>æœ€çŸ­è·¯</tag>
      </tags>
  </entry>
  <entry>
    <title>L2980. ã€ŒTHUSCH 2017ã€ å¤§é­”æ³•å¸ˆ é¢˜è§£</title>
    <url>/solutions/solution-l2980/</url>
    <content><![CDATA[<p>LibreOJ #2980<br>Luogu P7453</p>
<span id="more"></span>
<hr>
<p>é¦–å…ˆçœ‹é¢˜ï¼š</p>
<p>é¢˜ç›®è¦æ±‚æˆ‘ä»¬åœ¨ $[ 1,n ]$ çš„åŒºé—´ä¸Šç»´æŠ¤ä¸‰ä¸ªå€¼ $A_i,B_i,C_i$ï¼Œè¦æ±‚æ”¯æŒæŸ¥è¯¢åŒºé—´å’Œå’Œä¸‹é¢å…­ä¸­æ“ä½œï¼š</p>
<ol>
<li>åŒºé—´å†… $A_i &#x3D; A_i + B_i$ï¼›</li>
<li>åŒºé—´å†… $B_i &#x3D; B_i + C_i$ï¼›</li>
<li>åŒºé—´å†… $C_i &#x3D; C_i + A_i$ï¼›</li>
<li>åŒºé—´å†… $A_i &#x3D; A_i + k$ï¼ˆ$k$ ç»™å®šï¼‰ï¼›</li>
<li>åŒºé—´å†… $B_i &#x3D; B_i \times k$ï¼ˆ$k$ ç»™å®šï¼‰ï¼›</li>
<li>åŒºé—´å†… $C_i &#x3D; k$ï¼ˆ$k$ ç»™å®šï¼‰ã€‚</li>
</ol>
<p>æ˜¾ç„¶è¿™é“é¢˜éœ€è¦ä½¿ç”¨çº¿æ®µæ ‘æ¥ç»´æŠ¤åŒºé—´æ“ä½œã€‚<br>ä½†æ˜¯æˆ‘ä»¬ä¸èƒ½ç»™æ¯ä¸€ä¸ªæ“ä½œé™„ä¸Šä¸€ä¸ªæ‡’æ ‡è®°ï¼Œæœ€åæ‡’æ ‡è®°ä¸‹æ”¾çš„æ—¶å€™è¿˜ä¸å¾—éº»çƒ¦æ­»ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥å°è¯•ä¸€ä¸‹è½¬åŒ–ä¸€ä¸‹æˆ‘ä»¬çš„æ“ä½œã€‚</p>
<p>ä¼—æ‰€å‘¨çŸ¥ï¼Œä¸€ä¸ªçŸ©é˜µä¹˜ä»¥ä¸€ä¸ªå•ä½çŸ©é˜µ $I$ è¿˜ç­‰äºå®ƒæœ¬èº«ã€‚<br>å•ä½çŸ©é˜µçš„å½¢çŠ¶æ˜¯è¿™æ ·çš„ï¼š$\begin{bmatrix}1 &amp; &amp; &amp;\\ &amp; 1 &amp; &amp; \\ &amp; &amp; \ddots &amp; \\ &amp; &amp; &amp; 1 \end{bmatrix}$</p>
<p>å¦‚æœæˆ‘ä»¬å°† $A_i,B_i,C_i$ ä¸‰ä¸ªæ•°å€¼åŒ–ä½œä¸€ä¸ªçŸ©é˜µçš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸ªçŸ©é˜µ $\begin{bmatrix} A_i &amp; B_i &amp; C_i \end{bmatrix}$ æ‰€å¯¹åº”çš„å•ä½çŸ©é˜µæ˜¯è¿™ä¸ªæ ·å­çš„ï¼š$\begin{bmatrix}1&amp;&amp;\\&amp;1&amp;\\&amp;&amp;1\end{bmatrix}$ã€‚</p>
<p>è€Œ $\begin{bmatrix} A_i &amp; B_i &amp; C_i \end{bmatrix}$ æƒ³è¦å˜æˆ $\begin{bmatrix} A_i+B_i &amp; B_i &amp; C_i \end{bmatrix}$ çš„è¯å¯ä»¥è®©å®ƒä¹˜ä»¥ä¸€ä¸ª $\begin{bmatrix}1&amp;&amp;\\1&amp;1&amp;\\&amp;&amp;1\end{bmatrix}$ã€‚$(2,1)$ å¤„å¤šå‡ºæ¥çš„é‚£ä¸ª1å°±ä»£è¡¨ç€ç»™ç»“æœè¡ŒçŸ©é˜µçš„ç¬¬<strong>1</strong>ä¸ªä½ç½®åŠ ä¸Š<strong>1</strong>ä¸ªåŸå…ˆçš„è¡ŒçŸ©é˜µçŸ©é˜µç¬¬<strong>2</strong>ä¸ªä½ç½®çš„å€¼ï¼Œä¹Ÿå°±ç›¸å½“äºæ˜¯ç»™ç»“æœçš„ $A_i$ åŠ ä¸Šäº†ä¸€ä¸ª $B_i$ã€‚</p>
<p>åŒç†ï¼Œç¬¬äºŒä¸ªæ“ä½œä¹˜ä»¥çš„æ˜¯ä¸€ä¸ª $\begin{bmatrix}1&amp;&amp;\\&amp;1&amp;\\&amp;1&amp;1\end{bmatrix}$ï¼Œç¬¬ä¸‰ä¸ªæ“ä½œä¹˜ä»¥çš„æ˜¯ä¸€ä¸ª $\begin{bmatrix}1&amp;&amp;1\\&amp;1&amp;\\&amp;&amp;1\end{bmatrix}$ã€‚</p>
<p>ç„¶åå°±æ˜¯å¯æ¶çš„ç¬¬å››ä¸ªæ“ä½œã€‚æˆ‘ä»¬éœ€è¦ç»™ $A_i$ åŠ ä¸Šä¸€ä¸ª $k$ï¼Œä½†æ˜¯æˆ‘ä»¬æ— æ³•ä»åˆšæ‰çš„æˆ¿è´¹é‡Œé¢æ¨å‡ºæ¥ä¸€ä¸ªç±»ä¼¼çš„æ–¹æ³•ã€‚</p>
<p>äºæ˜¯æˆ‘ä»¬å¯ä»¥è€ƒè™‘å°†æˆ‘ä»¬ç»´æŠ¤çš„çŸ©é˜µç”± $\begin{bmatrix} A_i &amp; B_i &amp; C_i \end{bmatrix}$ å˜ä¸º $\begin{bmatrix} A_i &amp; B_i &amp; C_i &amp; 1 \end{bmatrix}$ã€‚<br>è¿™æ ·æˆ‘ä»¬å°±åªéœ€è¦ä¹˜ä»¥ä¸€ä¸ª $\begin{bmatrix}1&amp;&amp;&amp;\\&amp;1&amp;&amp;\\&amp;&amp;1&amp;\\k&amp;&amp;&amp;1\end{bmatrix}$ å³å¯ã€‚</p>
<p>ä¸ºäº†é€‚é…æˆ‘ä»¬æ–°çš„éœ€è¦ç»´æŠ¤çš„çŸ©é˜µï¼Œå‰é¢ä¸‰ä¸ªå°±å˜æˆäº† $\begin{bmatrix}1&amp;&amp;&amp;\\1&amp;1&amp;&amp;\\&amp;&amp;1&amp;\\&amp;&amp;&amp;1\end{bmatrix}$ï¼Œ$\begin{bmatrix}1&amp;&amp;&amp;\\&amp;1&amp;&amp;\\&amp;1&amp;1&amp;\\&amp;&amp;&amp;1\end{bmatrix}$ å’Œ $\begin{bmatrix}1&amp;&amp;1&amp;\\&amp;1&amp;&amp;\\&amp;&amp;1&amp;\\&amp;&amp;&amp;1\end{bmatrix}$ã€‚</p>
<p>ç¬¬äº”ä¸ªæ“ä½œçš„æ€è·¯ä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦ä¹˜ä»¥ä¸€ä¸ª $\begin{bmatrix}1&amp;&amp;&amp;\\&amp;k&amp;&amp;\\&amp;&amp;1&amp;\\&amp;&amp;&amp;1\end{bmatrix}$ å³å¯ã€‚</p>
<p>ç¬¬å…­ä¸ªæ“ä½œæœ‰ç‚¹éš¾ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæŠŠ $C_i$ å˜æˆ0ï¼Œé€šè¿‡ä¹˜ä»¥ä¸€ä¸ª $\begin{bmatrix}1&amp;&amp;&amp;\\&amp;1&amp;&amp;\\&amp;&amp;&amp;\\&amp;&amp;&amp;1\end{bmatrix}$ï¼Œç„¶åå†ä¹˜ä»¥ä¸€ä¸ª $\begin{bmatrix}1&amp;&amp;&amp;\\&amp;1&amp;&amp;\\&amp;&amp;1&amp;\\&amp;&amp;k&amp;1\end{bmatrix}$ï¼Œå°±å¯ä»¥ç»™ $C_i$ èµ‹æˆ $k$ äº†ã€‚<br>æœ€ç»ˆæ•ˆæœè·Ÿç›´æ¥ä¹˜ä»¥ $\begin{bmatrix}1&amp;&amp;&amp;\\&amp;1&amp;&amp;\\&amp;&amp;&amp;\\&amp;&amp;k&amp;1\end{bmatrix}$ æ•ˆæœä¸€æ ·ã€‚</p>
<p>äºæ˜¯æˆ‘ä»¬çš„çº¿æ®µæ ‘åªéœ€è¦ç»´æŠ¤ä¸€ä¸ªåŒºé—´ä¹˜å’ŒåŒºé—´æ±‚å’Œå³å¯ã€‚</p>
<p>çŸ©é˜µç»“æ„ä½“ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Matrix</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> n, m;</span><br><span class="line">    ll a[<span class="number">5</span>][<span class="number">5</span>];</span><br><span class="line">    <span class="built_in">Matrix</span>() &#123;&#125;</span><br><span class="line">    <span class="built_in">Matrix</span>(<span class="type">int</span> _n, <span class="type">int</span> _m) :<span class="built_in">n</span>(_n), <span class="built_in">m</span>(_m)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="built_in">sizeof</span>(a));</span><br><span class="line">    &#125;</span><br><span class="line">    Matrix <span class="keyword">operator</span> + (<span class="type">const</span> Matrix &amp;rhs)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function">Matrix <span class="title">res</span><span class="params">(n, m)</span></span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; j++)</span><br><span class="line">                res.a[i][j] = (a[i][j] + rhs.a[i][j]) % p;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    Matrix <span class="keyword">operator</span> * (<span class="type">const</span> Matrix &amp;rhs)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function">Matrix <span class="title">res</span><span class="params">(n, rhs.m)</span></span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= rhs.m; j++)</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">1</span>; k &lt;= m; k++)</span><br><span class="line">                    res.a[i][j] = (res.a[i][j] + a[i][k] * rhs.a[k][j]) % p;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>æ€»ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">250010</span>;</span><br><span class="line"><span class="type">const</span> ll p = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Matrix</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> n, m;</span><br><span class="line">    ll a[<span class="number">5</span>][<span class="number">5</span>];</span><br><span class="line">    <span class="built_in">Matrix</span>() &#123;&#125;</span><br><span class="line">    <span class="built_in">Matrix</span>(<span class="type">int</span> _n, <span class="type">int</span> _m) :<span class="built_in">n</span>(_n), <span class="built_in">m</span>(_m)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="built_in">sizeof</span>(a));</span><br><span class="line">    &#125;</span><br><span class="line">    Matrix <span class="keyword">operator</span> + (<span class="type">const</span> Matrix &amp;rhs)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function">Matrix <span class="title">res</span><span class="params">(n, m)</span></span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; j++)</span><br><span class="line">                res.a[i][j] = (a[i][j] + rhs.a[i][j]) % p;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    Matrix <span class="keyword">operator</span> * (<span class="type">const</span> Matrix &amp;rhs)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function">Matrix <span class="title">res</span><span class="params">(n, rhs.m)</span></span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= rhs.m; j++)</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">1</span>; k &lt;= m; k++)</span><br><span class="line">                    res.a[i][j] = (res.a[i][j] + a[i][k] * rhs.a[k][j]) % p;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">Matrix num[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SegTree</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    Matrix sum, tag;</span><br><span class="line">&#125;tr[N &lt;&lt; <span class="number">2</span>];</span><br><span class="line">Matrix base1, base2, base3, base4, base5, base6;</span><br><span class="line">Matrix base;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> &amp;root = tr[p], &amp;left = tr[p &lt;&lt; <span class="number">1</span>], &amp;rght = tr[p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">    left.sum = left.sum * root.tag;</span><br><span class="line">    rght.sum = rght.sum * root.tag;</span><br><span class="line">    left.tag = left.tag * root.tag;</span><br><span class="line">    rght.tag = rght.tag * root.tag;</span><br><span class="line">    root.tag = base;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tr[p].l = l, tr[p].r = r;</span><br><span class="line">    <span class="keyword">if</span>(l == r)</span><br><span class="line">    &#123;</span><br><span class="line">        tr[p].sum = num[l];</span><br><span class="line">        tr[p].tag = base;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">build</span>(p &lt;&lt; <span class="number">1</span>, l, mid);</span><br><span class="line">    <span class="built_in">build</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">    tr[p].sum = tr[p &lt;&lt; <span class="number">1</span>].sum + tr[p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].sum;</span><br><span class="line">    tr[p].tag = base;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">segadd</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, Matrix k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(tr[p].l &gt;= l &amp;&amp; tr[p].r &lt;= r)</span><br><span class="line">    &#123;</span><br><span class="line">        tr[p].tag = tr[p].tag * k;</span><br><span class="line">        tr[p].sum = tr[p].sum * k;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">pushdown</span>(p);</span><br><span class="line">    <span class="type">int</span> mid = (tr[p].l + tr[p].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid)<span class="built_in">segadd</span>(p &lt;&lt; <span class="number">1</span>, l, r, k);</span><br><span class="line">    <span class="keyword">if</span>(r &gt; mid)<span class="built_in">segadd</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r, k);</span><br><span class="line">    tr[p].sum = tr[p &lt;&lt; <span class="number">1</span>].sum + tr[p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].sum;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Matrix <span class="title">segsum</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(tr[p].l &gt;= l &amp;&amp; tr[p].r &lt;= r)<span class="keyword">return</span> tr[p].sum;</span><br><span class="line">    <span class="built_in">pushdown</span>(p);</span><br><span class="line">    <span class="type">int</span> mid = (tr[p].l + tr[p].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="function">Matrix <span class="title">res</span><span class="params">(<span class="number">4</span>, <span class="number">4</span>)</span></span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid)res = res + <span class="built_in">segsum</span>(p &lt;&lt; <span class="number">1</span>, l, r);</span><br><span class="line">    <span class="keyword">if</span>(r &gt; mid)res = res + <span class="built_in">segsum</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    base = <span class="built_in">Matrix</span>(<span class="number">4</span>, <span class="number">4</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">4</span>; i++)</span><br><span class="line">        base.a[i][i] = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    base1:| base2:| base3:</span></span><br><span class="line"><span class="comment">    1 0 0 | 1 0 0 | 1 0 1</span></span><br><span class="line"><span class="comment">    1 1 0 | 0 1 0 | 0 1 0</span></span><br><span class="line"><span class="comment">    0 0 1 | 0 1 1 | 0 0 1</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    base1 = base;</span><br><span class="line">    base1.a[<span class="number">2</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    base2 = base;</span><br><span class="line">    base2.a[<span class="number">3</span>][<span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line">    base3 = base;</span><br><span class="line">    base3.a[<span class="number">1</span>][<span class="number">3</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    base4:  | base5:  | base6:</span></span><br><span class="line"><span class="comment">    1 0 0 0 | 1 0 0 0 | 1 0 0 0</span></span><br><span class="line"><span class="comment">    0 1 0 0 | 0 v 0 0 | 0 1 0 0</span></span><br><span class="line"><span class="comment">    0 0 1 0 | 0 0 1 0 | 0 0 0 0</span></span><br><span class="line"><span class="comment">    v 0 0 1 | 0 0 0 1 | 0 0 v 1</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    base4 = base;</span><br><span class="line">    base5 = base;</span><br><span class="line">    base6 = base;</span><br><span class="line">    base6.a[<span class="number">3</span>][<span class="number">3</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">init</span>();</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        num[i] = <span class="built_in">Matrix</span>(<span class="number">1</span>, <span class="number">4</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld%lld&quot;</span>, &amp;num[i].a[<span class="number">1</span>][<span class="number">1</span>], &amp;num[i].a[<span class="number">1</span>][<span class="number">2</span>], &amp;num[i].a[<span class="number">1</span>][<span class="number">3</span>]);</span><br><span class="line">        num[i].a[<span class="number">1</span>][<span class="number">4</span>] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">    <span class="type">int</span> m;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;m);</span><br><span class="line">    <span class="keyword">while</span>(m--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> op, l, r, v;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;op, &amp;l, &amp;r);</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">segadd</span>(<span class="number">1</span>, l, r, base1);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">segadd</span>(<span class="number">1</span>, l, r, base2);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">3</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">segadd</span>(<span class="number">1</span>, l, r, base3);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">4</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;v);</span><br><span class="line">            base4.a[<span class="number">4</span>][<span class="number">1</span>] = v;</span><br><span class="line">            <span class="built_in">segadd</span>(<span class="number">1</span>, l, r, base4);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">5</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;v);</span><br><span class="line">            base5.a[<span class="number">2</span>][<span class="number">2</span>] = v;</span><br><span class="line">            <span class="built_in">segadd</span>(<span class="number">1</span>, l, r, base5);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">6</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;v);</span><br><span class="line">            base6.a[<span class="number">4</span>][<span class="number">3</span>] = v;</span><br><span class="line">            <span class="built_in">segadd</span>(<span class="number">1</span>, l, r, base6);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">7</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Matrix res = <span class="built_in">segsum</span>(<span class="number">1</span>, l, r);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%lld %lld %lld\n&quot;</span>, res.a[<span class="number">1</span>][<span class="number">1</span>], res.a[<span class="number">1</span>][<span class="number">2</span>], res.a[<span class="number">1</span>][<span class="number">3</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>é¢˜è§£</tag>
        <tag>çº¿æ®µæ ‘</tag>
      </tags>
  </entry>
  <entry>
    <title>P1117 [NOI2016] ä¼˜ç§€çš„æ‹†åˆ† é¢˜è§£</title>
    <url>/solutions/solution-p1117/</url>
    <content><![CDATA[<p>Luogu P1117<br>LibreOJ #2083</p>
<p>NOI 2016</p>
<span id="more"></span>
<hr>
<div class="note warning"><p>æœ¬æ–‡å›¾ç‰‡å‡ºäº†ä¸€äº›å¤§ç—…ï¼Œä¸å»ºè®®ç‚¹å‡»æ”¾å¤§ã€‚</p>
</div>

<p>æ®è¯´æš´åŠ›ç”¨å“ˆå¸Œæ‰«å¯ä»¥æ‹¿åˆ°95åˆ†ã€‚</p>
<p>è¿™ä¸€é“é¢˜çš„æ€è·¯æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š</p>
<p>æˆ‘ä»¬é¦–å…ˆå‡†å¤‡ä¸¤ä¸ªæ•°ç»„<code>a[]</code>å’Œ<code>b[]</code>ï¼Œåˆ†åˆ«è¡¨ç¤ºä»¥ $i$ ç»“å°¾çš„å½¢ä¼¼AAçš„å­—ä¸²ä¸ªæ•°å’Œä»¥ $i$ å¼€å¤´çš„å½¢ä¼¼AAçš„å­—ä¸²çš„ä¸ªæ•°ï¼Œæœ€ç»ˆç­”æ¡ˆå…¶å®å°±æ˜¯ $\displaystyle \sum_{i&#x3D;1}^n a[i] \times b[i+1]$ã€‚</p>
<p>ç„¶åè€ƒè™‘å¦‚ä½•æ±‚å‡ºè¿™ä¸¤ä¸ªæ•°ç»„ã€‚</p>
<p>å¯¹äºæ¯ä¸€ä¸ªä½ç½®ï¼Œæˆ‘ä»¬å°è¯•æšä¸¾ä¸€ä¸ª $len$ï¼Œç„¶åæ±‚å‡ºå½“å‰ä½ç½® $i$ ä¸ $i+len$ ä½ç½®å¤„çš„ <code>lcp</code> ä¸ <code>lcs</code> ã€‚</p>
<p>å½“ä¸¤è€…é•¿åº¦åŠ èµ·æ¥ä¸å°äº $len$ çš„æ—¶å€™ï¼Œå°±æ„å‘³ç€æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°è‡³å°‘ä¸€ä¸ªé•¿åº¦ä¸º $2len$ çš„AAä¸²ã€‚</p>
<p>ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬è€ƒè™‘ä»ä¸¤ä¸ªä½ç½®çš„ <code>lcs</code> çš„å¼€å¤´å¤„å¼€å§‹ï¼Œåˆ†åˆ«å‘åæˆªå–å‡ºä¸€æ®µé•¿åº¦ä¸º $len$ çš„ä¸²ã€‚</p>
<p>å¦‚æœè¿™ä¸ªä¸²è¢«ä¸¤è€…çš„ <code>lcs</code> å’Œä¸¤è€…çš„ <code>lcp</code> æ‹¼èµ·æ¥ç»„æˆçš„ä¸€ä¸ªå­—ä¸²è¦†ç›–ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æŠŠè¿™ä¸¤ä¸ªä¸²æ‹¼èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªé•¿åº¦ä¸º $2len$ çš„AAä¸²ã€‚<br>å°±åƒè¿™æ ·ï¼š</p>
<img src="https://s2.loli.net/2022/03/22/mo9Hg7zp3YlCWjf.png" alt="p1117-1.png" width="60%" />

<p>å½“ä¸¤è€…é•¿åº¦åŠ èµ·æ¥ä¸å¤Ÿ $len$ æ—¶ï¼Œæˆ‘ä»¬æˆªå‡ºæ¥çš„ä¸¤ç«¯å­—ä¸²å°±ä¸ä¿è¯ä¸€æ ·ã€‚<br>ä¸ï¼Œåº”è¯¥æ˜¯ä¿è¯ä¸ä¸€æ ·ï¼Œè¦ä¸ç„¶ä¸¤è€…çš„ <code>lcp</code> è¿˜å¯ä»¥æ›´é•¿ä¸€ç‚¹ã€‚<br>è¿™æ ·å°±æ‹¼ä¸å‡ºæ¥ä¸€ä¸ªé•¿åº¦ä¸º $2len$ çš„AAä¸²äº†ã€‚</p>
<img src="https://s2.loli.net/2022/03/22/1Yo3UAOuptlvKz5.png" alt="p1117-2.png" width="60%" />

<p>å¦‚æœä¸¤è€…ç”šè‡³æœ‰é‡åˆï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æŒ‘å‡ºæ¥å¤šä¸ªå­—ä¸²ã€‚æˆ‘ä»¬è¿™äº›ä¼šç´¯ç§¯åˆ°åé¢ã€‚</p>
<img src="https://s2.loli.net/2022/03/22/EdSZAXvpG17hPYF.gif" alt="p1117-3.gif" width="60%" />

<p>å°±æ˜¯è¿™æ ·ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼Œæˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯ï¼š</p>
<ol>
<li>æšä¸¾ $len$ï¼›è¿™ä¸ªæ“ä½œçš„å¤æ‚åº¦æ˜¯ $O(n \log n)$</li>
<li>æ±‚ <code>lcp</code> ä¸ <code>lcs</code>ï¼›ä½¿ç”¨åç¼€æ•°ç»„å³å¯ã€‚</li>
<li>åŒºé—´åŠ ï¼›å·®åˆ†å³å¯ã€‚</li>
</ol>
<p>ä¸Šä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1001000</span>;</span><br><span class="line"><span class="type">int</span> T;</span><br><span class="line">ll a[N], b[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SuffixArray</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> S[N]; <span class="type">int</span> n;</span><br><span class="line">    <span class="type">int</span> cnt[N], sa[N], rk[N], height[N];</span><br><span class="line">    <span class="type">int</span> st[N][<span class="number">25</span>], lg2[N];</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> id, x, y;</span><br><span class="line">    &#125;aa[N], bb[N];</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">buildsa</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        n = <span class="built_in">strlen</span>(S + <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">memset</span>(cnt, <span class="number">0</span>, <span class="built_in">sizeof</span>(cnt));</span><br><span class="line">        <span class="built_in">memset</span>(height, <span class="number">0</span>, <span class="built_in">sizeof</span>(height));</span><br><span class="line">        <span class="built_in">memset</span>(sa, <span class="number">0</span>, <span class="built_in">sizeof</span>(sa));</span><br><span class="line">        <span class="built_in">memset</span>(rk, <span class="number">0</span>, <span class="built_in">sizeof</span>(rk));</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) aa[i] = bb[i] = &#123; <span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span> &#125;;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) cnt[S[i]] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">256</span>; i++) cnt[i] += cnt[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) rk[i] = cnt[S[i]];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> L = <span class="number">1</span>; L &lt; n; L *= <span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) aa[i] = &#123; i,rk[i],rk[i + L] &#125;;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) cnt[i] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) cnt[aa[i].y]++;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) cnt[i] += cnt[i - <span class="number">1</span>];</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; i--) bb[cnt[aa[i].y]--] = aa[i];</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) cnt[i] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) cnt[aa[i].x]++;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) cnt[i] += cnt[i - <span class="number">1</span>];</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; i--) aa[cnt[bb[i].x]--] = bb[i];</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">                <span class="keyword">if</span>((aa[i].x == aa[i - <span class="number">1</span>].x) &amp;&amp; (aa[i].y == aa[i - <span class="number">1</span>].y))</span><br><span class="line">                    rk[aa[i].id] = rk[aa[i - <span class="number">1</span>].id];</span><br><span class="line">                <span class="keyword">else</span> rk[aa[i].id] = rk[aa[i - <span class="number">1</span>].id] + <span class="number">1</span>;</span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) sa[rk[i]] = i; <span class="type">int</span> k = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(k) k--;</span><br><span class="line">            <span class="type">int</span> j = sa[rk[i] - <span class="number">1</span>];</span><br><span class="line">            <span class="keyword">while</span>((i + k &lt;= n) &amp;&amp; (j + k &lt;= n) &amp;&amp; (S[i + k] == S[j + k])) k++;</span><br><span class="line">            height[rk[i]] = k;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">buildst</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        lg2[<span class="number">0</span>] = <span class="number">-1</span>; <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; N; i++) lg2[i] = lg2[i / <span class="number">2</span>] + <span class="number">1</span>; lg2[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) st[i][<span class="number">0</span>] = height[i];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; (<span class="number">1</span> &lt;&lt; j) &lt;= n; j++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= n; i++)</span><br><span class="line">                st[i][j] = <span class="built_in">min</span>(st[i][j - <span class="number">1</span>], st[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Lcp</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        l = rk[l], r = rk[r];</span><br><span class="line">        <span class="keyword">if</span>(l &gt; r) <span class="built_in">swap</span>(l, r); l++;</span><br><span class="line">        <span class="type">int</span> k = lg2[r - l + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">min</span>(st[l][k], st[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;SA[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, SA[<span class="number">0</span>].S + <span class="number">1</span>);</span><br><span class="line">        <span class="type">int</span> n = <span class="built_in">strlen</span>(SA[<span class="number">0</span>].S + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) a[i] = b[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            SA[<span class="number">1</span>].S[i] = SA[<span class="number">0</span>].S[n - i + <span class="number">1</span>];</span><br><span class="line">        SA[<span class="number">0</span>].<span class="built_in">buildsa</span>(), SA[<span class="number">1</span>].<span class="built_in">buildsa</span>();</span><br><span class="line">        SA[<span class="number">0</span>].<span class="built_in">buildst</span>(), SA[<span class="number">1</span>].<span class="built_in">buildst</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> Len = <span class="number">1</span>; Len &lt;= n / <span class="number">2</span>; Len++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = Len; i &lt;= n; i += Len)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">int</span> l = i, r = i + Len;</span><br><span class="line">                <span class="type">int</span> L = n - (r - <span class="number">1</span>) + <span class="number">1</span>, R = n - (l - <span class="number">1</span>) + <span class="number">1</span>;</span><br><span class="line">                <span class="type">int</span> lcp = SA[<span class="number">0</span>].<span class="built_in">Lcp</span>(l, r); lcp = <span class="built_in">min</span>(lcp, Len);</span><br><span class="line">                <span class="type">int</span> lcs = SA[<span class="number">1</span>].<span class="built_in">Lcp</span>(L, R); lcs = <span class="built_in">min</span>(lcs, Len - <span class="number">1</span>);</span><br><span class="line">                <span class="keyword">if</span>(lcp + lcs &gt;= Len)</span><br><span class="line">                &#123;</span><br><span class="line">                    b[i - lcs]++, b[i - lcs + (lcp + lcs - Len + <span class="number">1</span>)]--;</span><br><span class="line">                    a[r + lcp - (lcp + lcs - Len + <span class="number">1</span>)]++, a[r + lcp]--;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) a[i] += a[i - <span class="number">1</span>], b[i] += b[i - <span class="number">1</span>];</span><br><span class="line">        ll ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++) ans += a[i] * b[i + <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>å­—ç¬¦ä¸²</tag>
        <tag>é¢˜è§£</tag>
      </tags>
  </entry>
  <entry>
    <title>P1251 é¤å·¾è®¡åˆ’é—®é¢˜ é¢˜è§£</title>
    <url>/solutions/solution-p1251/</url>
    <content><![CDATA[<p>Luogu P1251<br>LibreOJ #6008</p>
<p>ç½‘ç»œæµ24é¢˜ä¹‹ä¸€ã€‚</p>
<span id="more"></span>
<hr>
<p>é¢˜ç›®è¦æ±‚æˆ‘ä»¬å®‰æ’é¤å·¾çš„æ¸…æ´—åˆ†é…ã€‚</p>
<p>å¯èƒ½æ˜¯æˆ´æ£®çƒè®¡åˆ’æ­äº§çº¿æ­å¤šäº†å§ï¼Œè¿™é“é¢˜æˆ‘ä¸€å¼€å§‹å°±æŠŠé¤å·¾ä»ä¸€ä¸ªåœ°æ–¹åˆ°å¦ä¸€ä¸ªåœ°æ–¹ï¼ˆå¦‚ä»é¤å…åˆ°å¿«æ´—éƒ¨ï¼‰æƒ³æˆäº†ä¸€é“æµã€‚</p>
<p>æˆ‘ä»¬å°±å¯ä»¥æŠŠé¤å…å‘å¿«æ´—éƒ¨å’Œæ…¢æ´—éƒ¨è¿è¾¹ã€‚</p>
<p>ä½†æ˜¯å‘¢ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å¤„ç†å¿«æ´—éƒ¨å’Œæ…¢æ´—éƒ¨éœ€è¦çš„æ—¶é—´é—®é¢˜ï¼Œè¿˜æœ‰å¤„ç†æ‰€æœ‰çš„å»¶æ—¶é€æ´—çš„æ“ä½œã€‚</p>
<p>æˆ‘ä»¬äºæ˜¯å°±è€ƒè™‘å°†æ¯å¤©çš„é¤å…æ‹†æˆä¸åŒçš„ç‚¹ã€‚<br>å½“ç„¶ï¼Œæ¯å¤©çš„å¿«æ´—éƒ¨å’Œæ…¢æ´—éƒ¨ä¹Ÿéœ€è¦æ‹†æˆä¸åŒçš„ç‚¹ã€‚</p>
<p>è¿™æ ·å°±å¯ä»¥ä¿è¯æˆ‘ä»¬å¯ä»¥è®©é¤å·¾è¿›è¡Œæ—¶é—´ç©¿æ¢­äº†ï¼Œè€Œä¸å†æ˜¯åªå±€é™äºä¸€å¤©ä¹‹å†…ã€‚</p>
<p>è¿˜æœ‰ï¼Œæˆ‘ä»¬éœ€è¦å°†é¤å·¾è¿›è¡Œæœ€å¤§åŒ–åˆ©ç”¨æ¥çœé’±ï¼Œæ¯•ç«Ÿæ¯å¤šå­˜åœ¨ä¸€å—é¤å·¾ï¼Œå°±å¤šéœ€è¦èŠ±è´¹æˆ‘ä»¬ $p$ åˆ†é’±ã€‚</p>
<p>æˆ‘ä»¬è€ƒè™‘å°†æ‹†åˆ†åçš„é¤å…ç»§ç»­æ‹†åˆ†ï¼Œæ‹†æˆä¸€ä¸ªè¾“å…¥å’Œä¸€ä¸ªè¾“å‡ºã€‚è¾“å…¥ä»£è¡¨ä»Šå¤©é¤å…çš„é¤å·¾åˆ°åº•æ˜¯ä»å“ªé‡Œè¿è¿‡æ¥çš„ï¼Œè€Œè¾“å‡ºå°±ä»£è¡¨ä»Šå¤©ä½¿ç”¨çš„é¤å·¾çš„æœ€ç»ˆå»å¤„ã€‚</p>
<p>è¿™æ—¶å€™ï¼Œæˆ‘ä»¬å°±å·²ç»éœ€è¦äº† $4n$ ä¸ªç‚¹äº†ï¼ˆä¸åŒ…æ‹¬æºç‚¹å’Œæ±‡ç‚¹ï¼‰ï¼Œå…¶ä¸­é¤å…è¾“å…¥ï¼Œé¤å…è¾“å‡ºï¼Œå¿«æ´—éƒ¨å’Œæ…¢æ´—éƒ¨å„ $n$ ä¸ªç‚¹ã€‚</p>
<p>ä½†æ˜¯æˆ‘ä»¬è€ƒè™‘ç®€åŒ–ä¸€ä¸‹ã€‚</p>
<p>æˆ‘ä»¬è€ƒè™‘çœå»å¿«æ´—éƒ¨å’Œæ…¢æ´—éƒ¨ï¼Œå¯ä»¥çœ‹åšè‡ªå·±å†…éƒ¨å‘˜å·¥æ´—å¹²å‡€äº†ã€‚<br>è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è¿æ¥æŸä¸€å¤©çš„è¾“å‡ºå’Œå¦ä¸€å¤©çš„è¾“å…¥äº†ã€‚</p>
<p>æœ€åå¼€å§‹è¿è¾¹ã€‚</p>
<ol>
<li>æºç‚¹ä¸é¤å…è¾“å‡ºè¿ä¸€æ¡å®¹é‡ä¸ºå½“å¤©ç”¨é‡ï¼Œè´¹ç”¨ä¸º0çš„è¾¹ï¼›</li>
<li>æ±‡ç‚¹ä¸é¤å…è¾“å…¥è¿ä¸€æ¡å®¹é‡ä¸ºå½“å¤©ç”¨é‡ï¼Œè´¹ç”¨ä¸º0çš„è¾¹ï¼›</li>
<li>é¤å…è¾“å‡ºä¸ä¸‹ä¸€æ—¥çš„é¤å…è¾“å‡ºè¿ä¸€æ¡å®¹é‡ä¸ºæ— é™ï¼Œè´¹ç”¨ä¸º0çš„è¾¹ã€‚</li>
<li>æºç‚¹ä¸é¤å…è¾“å…¥è¿ä¸€æ¡å®¹é‡ä¸ºæ— é™ï¼Œè´¹ç”¨ä¸º $p$ çš„è¾¹ï¼›</li>
<li>é¤å…è¾“å‡ºä¸ $n$ å¤©åçš„é¤å…è¾“å…¥è¿ä¸€æ¡å®¹é‡ä¸ºæ— é™ï¼Œè´¹ç”¨ä¸º $s$ çš„è¾¹ï¼Œä»£è¡¨å¿«æ´—éƒ¨ï¼›</li>
<li>é¤å…è¾“å‡ºä¸ $m$ å¤©åçš„é¤å…è¾“å…¥è¿ä¸€æ¡å®¹é‡ä¸ºæ— é™ï¼Œè´¹ç”¨ä¸º $f$ çš„è¾¹ï¼Œä»£è¡¨æ…¢æ´—éƒ¨ã€‚</li>
</ol>
<p>ç„¶åè·‘ä¸€ä¸ªæœ€å°è´¹ç”¨æœ€å¤§æµå³å¯ï¼Œæœ€ç»ˆçš„è´¹ç”¨å°±æ˜¯ç­”æ¡ˆã€‚</p>
<p>ä¸Šä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">5010</span>, M = <span class="number">100010</span>, INF = <span class="number">1e8</span>;</span><br><span class="line"><span class="type">int</span> n, m, S, T;</span><br><span class="line"><span class="type">int</span> p, x, xp, y, yp;</span><br><span class="line"><span class="type">int</span> need[N];</span><br><span class="line"><span class="type">int</span> s[N];</span><br><span class="line"><span class="type">int</span> h[N], e[M], f[M], w[M], ne[M], idx;</span><br><span class="line"><span class="type">int</span> q[N], d[N], pre[N], incf[N];</span><br><span class="line"><span class="type">bool</span> st[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c, <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[idx] = b, f[idx] = c, w[idx] = d, ne[idx] = h[a]; h[a] = idx++;</span><br><span class="line">    e[idx] = a, f[idx] = <span class="number">0</span>, w[idx] = -d, ne[idx] = h[b], h[b] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">spfa</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> hh = <span class="number">0</span>, tt = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">memset</span>(d, <span class="number">0x3f</span>, <span class="keyword">sizeof</span> d);</span><br><span class="line">    <span class="built_in">memset</span>(incf, <span class="number">0</span>, <span class="keyword">sizeof</span> incf);</span><br><span class="line">    q[<span class="number">0</span>] = S, d[S] = <span class="number">0</span>, incf[S] = INF;</span><br><span class="line">    <span class="keyword">while</span>(hh != tt)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> t = q[hh++];</span><br><span class="line">        <span class="keyword">if</span>(hh == N) hh = <span class="number">0</span>;</span><br><span class="line">        st[t] = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = h[t]; ~i; i = ne[i])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> ver = e[i];</span><br><span class="line">            <span class="keyword">if</span>(f[i] &amp;&amp; d[ver] &gt; d[t] + w[i])</span><br><span class="line">            &#123;</span><br><span class="line">                d[ver] = d[t] + w[i];</span><br><span class="line">                pre[ver] = i;</span><br><span class="line">                incf[ver] = <span class="built_in">min</span>(f[i], incf[t]);</span><br><span class="line">                <span class="keyword">if</span>(!st[ver])</span><br><span class="line">                &#123;</span><br><span class="line">                    q[tt++] = ver;</span><br><span class="line">                    <span class="keyword">if</span>(tt == N) tt = <span class="number">0</span>;</span><br><span class="line">                    st[ver] = <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> incf[T] &gt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">EK</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> cost = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">spfa</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> t = incf[T];</span><br><span class="line">        cost += t * d[T];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = T; i != S; i = e[pre[i] ^ <span class="number">1</span>])</span><br><span class="line">        &#123;</span><br><span class="line">            f[pre[i]] -= t;</span><br><span class="line">            f[pre[i] ^ <span class="number">1</span>] += t;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cost;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;n);</span><br><span class="line">    S = <span class="number">0</span>, T = n * <span class="number">2</span> + <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">memset</span>(h, <span class="number">-1</span>, <span class="keyword">sizeof</span> h);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)<span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;need[i]);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld%lld%lld%lld&quot;</span>, &amp;p, &amp;x, &amp;xp, &amp;y, &amp;yp);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> r = need[i];</span><br><span class="line">        <span class="built_in">add</span>(S, i, r, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">add</span>(n + i, T, r, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">add</span>(S, n + i, INF, p);</span><br><span class="line">        <span class="keyword">if</span>(i &lt; n) <span class="built_in">add</span>(i, i + <span class="number">1</span>, INF, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span>(i + x &lt;= n) <span class="built_in">add</span>(i, n + i + x, INF, xp);</span><br><span class="line">        <span class="keyword">if</span>(i + y &lt;= n) <span class="built_in">add</span>(i, n + i + y, INF, yp);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">EK</span>());</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>é¢˜è§£</tag>
        <tag>ç½‘ç»œæµ</tag>
      </tags>
  </entry>
  <entry>
    <title>P1486 [NOI2004] éƒé—·çš„å‡ºçº³å‘˜ é¢˜è§£</title>
    <url>/solutions/solution-p1486/</url>
    <content><![CDATA[<p>Luogu P1486<br>LibreOJ #10145</p>
<p>NOI 2004</p>
<span id="more"></span>
<hr>
<p>è¿™é“é¢˜è¦æ±‚æˆ‘ä»¬å®Œæˆä¸¤ä¸ªæ“ä½œï¼šæ’å…¥å’ŒæŸ¥è¯¢ã€‚</p>
<p>æˆ‘ä»¬æœ€å¤šåˆ†åˆ«æœ‰ $10^5$ æ¬¡æ’å…¥å’Œ $10^5$ æ¬¡æŸ¥è¯¢ã€‚<br>è€Œåœ¨é€šå¸¸æ˜¯æ–¹æ³•ä¸­ï¼ŒæŸ¥è¯¢å’Œæ’å…¥çš„å¤æ‚åº¦éƒ½æ˜¯å¾ˆé«˜çš„ï¼Œå°¤å…¶æ˜¯æŸ¥è¯¢å‰è¿˜éœ€è¦è¿›è¡Œä¸€æ¬¡æ’åºã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦é™ä½å¤æ‚åº¦ã€‚</p>
<p>æ­£å¥½ï¼Œå¹³è¡¡æ ‘å¯ä»¥å¸®åŠ©æˆ‘ä»¬å‡è½»è¿™ä¸ªè´Ÿæ‹…ã€‚</p>
<p>æˆ‘ä»¬å°è¯•ä½¿ç”¨å¹³è¡¡æ ‘æ¥ç»´æŠ¤ä¸€ä¸ªæœ‰åºçš„åºåˆ—ï¼Œä»¥é¿å…ä»»ä½•ä¸å¿…è¦çš„æ’åºæ“ä½œï¼ŒåŸåŒºæ’åºéœ€è¦çš„å¤æ‚åº¦ã€‚</p>
<p>FHQçš„æ— æ—‹Treapå¯ä»¥è¿‡ï¼Œå…·ä½“å®ç°è§<span class="exturl" data-url="aHR0cHM6Ly9vaS5iYW9zaHVvLnJlbi9sdW9ndS1wMTQ4Ni8=">è¿™ç¯‡åšå®¢<i class="fa fa-external-link-alt"></i></span>ï¼›STLè²Œä¼¼ä¹Ÿèƒ½æ°´è¿‡ï¼Œå…·ä½“å®ç°è§<span class="exturl" data-url="aHR0cHM6Ly9vaS5iYW9zaHVvLnJlbi9sdW9ndS1wMTQ4Ni8=">è¿™ç¯‡åšå®¢<i class="fa fa-external-link-alt"></i></span>ï¼›è€Œæˆ‘ä»¬è¿™é‡Œé‡‡ç”¨çš„æ˜¯Splayã€‚</p>
<p>å¯¹äºæ’å…¥ï¼Œæˆ‘ä»¬å°±åƒå¹³å¸¸æ’å…¥ä¸€æ ·ï¼Œä¸æ–­é€’å½’ç›´åˆ°å¯ä»¥æ’å…¥ä¸ºæ­¢ã€‚<br>åŒæ—¶æ³¨æ„ï¼šå¦‚æœè¿™ä¸ªå‘˜å·¥è¿˜æ²¡æœ‰æ¥å°±å‘ç°è‡ªå·±çš„å·¥èµ„ä¸è¶³å·¥èµ„ä¸‹ç•Œï¼Œé‚£ä¹ˆä»–å°±ä¸ä¼šæ¥äº†ã€‚æˆ‘ä»¬ç›´æ¥å¿½ç•¥å³å¯ã€‚</p>
<p>å¯¹äºä¿®æ”¹å·¥èµ„ï¼Œæˆ‘ä»¬å­˜å‚¨ä¸€ä¸ª $\Delta$ ä»¥æ–¹ä¾¿éšæ—¶åŠ å‡å·¥èµ„ã€‚<br>å‡è®¾æŸä¸ªå‘˜å·¥çš„å·¥èµ„æ˜¯ $k$ ï¼Œé‚£ä¹ˆæˆ‘ä»¬å­˜åˆ°å¹³è¡¡æ ‘é‡Œé¢çš„æ•°æ®æ˜¯ $k - \Delta$ã€‚<br>$\Delta$ åˆå§‹ä¸º0ï¼Œæˆ‘ä»¬æ¯æ¬¡åŠ å·¥èµ„æˆ–å‡å·¥èµ„åªéœ€è¦å¯¹ $\Delta$ è¿›è¡Œæ›´æ”¹å°±å¯ä»¥äº†ã€‚</p>
<p>åŒæ—¶æˆ‘ä»¬è¿˜éœ€è¦æ³¨æ„ç¦»èŒçš„å‘˜å·¥ã€‚æ¯ä¸€æ¬¡å‡å·¥èµ„çš„æ—¶å€™ï¼Œæˆ‘ä»¬éƒ½éœ€è¦çœ‹ä¸€ä¸‹æœ‰å“ªäº›å‘˜å·¥éœ€è¦ç¦»èŒã€‚<br>æ–¹æ³•å¾ˆç®€å•ï¼šæŸ¥æ‰¾å·¥èµ„ä¸‹ç•Œå¯¹åº”çš„èŠ‚ç‚¹â€”â€”æ—‹ä¸Šæ¥â€”â€”æ¸…ç©ºå­æ ‘ã€‚</p>
<p>å¯¹äºæŸ¥æ‰¾ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨å¹³è¡¡æ ‘çš„èŠ‚ç‚¹ä¸Šé¢ç»´æŠ¤ä¸€ä¸ª $size$ï¼Œåˆ°æ—¶å€™ç›´æ¥æŸ¥æ‰¾å°±è¡Œäº†ã€‚<br>æŸ¥æ‰¾çš„æ€è·¯æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š<br>æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå‚æ•° $k$ï¼Œä»æ ¹èŠ‚ç‚¹å¼€å§‹æœç´¢ã€‚<br>å½“å½“å‰çš„å·¦å­æ ‘çš„ $size \geq k$ æ—¶ï¼Œè¯æ˜æˆ‘ä»¬çš„ç›®æ ‡èŠ‚ç‚¹åœ¨å·¦å­æ ‘é‡Œé¢ï¼Œæˆ‘ä»¬é€’å½’æœç´¢å·¦å­æ ‘ã€‚<br>å¦‚æœå½“å‰çš„å·¦å­æ ‘çš„ $size + 1 &#x3D; k$ æ—¶ï¼Œè¯æ˜æˆ‘ä»¬çš„ç›®æ ‡èŠ‚ç‚¹å°±æ˜¯æˆ‘ä»¬å½“å‰æœç´¢åˆ°çš„èŠ‚ç‚¹ï¼Œç›´æ¥<code>return</code>ã€‚<br>å…¶ä»–æƒ…å†µå°±æ˜¯è¯æ˜æˆ‘ä»¬çš„ç›®æ ‡èŠ‚ç‚¹åœ¨å³å­æ ‘é‡Œé¢ï¼Œæˆ‘ä»¬æŠŠå½“å‰çš„ $k$ å‡å»å·¦å­æ ‘çš„ $size$ï¼Œå†å‡å»ä»£è¡¨å½“å‰èŠ‚ç‚¹çš„ $1$ï¼Œç„¶åå¸¦ç€æ–°çš„ $k$ å»é€’å½’æœç´¢å³å­æ ‘ã€‚</p>
<p>ä¸Šä»£ç ï¼š</p>
<div class="note warning"><p>æ³¨æ„ï¼šæˆ‘è¿™é‡Œä½¿ç”¨äº†éASCIIå­—ç¬¦<code>Î”</code>åšå˜é‡åï¼Œè¿™ç§æƒ…å†µä¸‹åªèƒ½åœ¨C++20çš„æƒ…å†µä¸‹é€šè¿‡ç¼–è¯‘ï¼Œè¯·æ ¹æ®éœ€è¦ä¿®æ”¹å˜é‡åã€‚</p>
</div>

<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">100010</span>, INF = <span class="number">1e9</span>;</span><br><span class="line"><span class="type">int</span> n, m, Î”;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> s[<span class="number">2</span>], p, v;</span><br><span class="line">    <span class="type">int</span> size;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> _v, <span class="type">int</span> _p)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        v = _v, p = _p;</span><br><span class="line">        size = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;tr[N];</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> root, idx;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tr[x].size = tr[tr[x].s[<span class="number">0</span>]].size + tr[tr[x].s[<span class="number">1</span>]].size + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rotate</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> y = tr[x].p, z = tr[y].p;</span><br><span class="line">    <span class="type">int</span> k = tr[y].s[<span class="number">1</span>] == x;</span><br><span class="line">    tr[z].s[tr[z].s[<span class="number">1</span>] == y] = x, tr[x].p = z;</span><br><span class="line">    tr[y].s[k] = tr[x].s[k ^ <span class="number">1</span>], tr[tr[x].s[k ^ <span class="number">1</span>]].p = y;</span><br><span class="line">    tr[x].s[k ^ <span class="number">1</span>] = y, tr[y].p = x;</span><br><span class="line">    <span class="built_in">pushup</span>(y), <span class="built_in">pushup</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">splay</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(tr[x].p != k)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> y = tr[x].p, z = tr[y].p;</span><br><span class="line">        <span class="keyword">if</span>(z != k)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>((tr[y].s[<span class="number">1</span>] == x) ^ (tr[z].s[<span class="number">1</span>] == y))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">rotate</span>(x);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">rotate</span>(y);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">rotate</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!k) root = x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> u = root, p = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(u) p = u, u = tr[u].s[v &gt; tr[u].v];</span><br><span class="line">    u = ++idx;</span><br><span class="line">    <span class="keyword">if</span>(p) tr[p].s[v &gt; tr[p].v] = u;</span><br><span class="line">    tr[u].<span class="built_in">init</span>(v, p);</span><br><span class="line">    <span class="built_in">splay</span>(u, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> u;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> u = root, res;</span><br><span class="line">    <span class="keyword">while</span>(u)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(tr[u].v &gt;= v)</span><br><span class="line">        &#123;</span><br><span class="line">            res = u;</span><br><span class="line">            u = tr[u].s[<span class="number">0</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            u = tr[u].s[<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get_k</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> u = root;</span><br><span class="line">    <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(tr[tr[u].s[<span class="number">0</span>]].size &gt;= k)</span><br><span class="line">        &#123;</span><br><span class="line">            u = tr[u].s[<span class="number">0</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(tr[tr[u].s[<span class="number">0</span>]].size + <span class="number">1</span> == k)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> tr[u].v;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            k -= tr[tr[u].s[<span class="number">0</span>]].size + <span class="number">1</span>;</span><br><span class="line">            u = tr[u].s[<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="type">int</span> L = <span class="built_in">insert</span>(-INF), R = <span class="built_in">insert</span>(INF);</span><br><span class="line">    <span class="type">int</span> tot = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(n--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">char</span> op[<span class="number">10</span>];</span><br><span class="line">        <span class="type">int</span> k;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s%d&quot;</span>, &amp;op, &amp;k);</span><br><span class="line">        <span class="keyword">if</span>(op[<span class="number">0</span>] == <span class="string">&#x27;I&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(k &gt;= m)</span><br><span class="line">            &#123;</span><br><span class="line">                k -= Î”;</span><br><span class="line">                <span class="built_in">insert</span>(k);</span><br><span class="line">                tot++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op[<span class="number">0</span>] == <span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Î” += k;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op[<span class="number">0</span>] == <span class="string">&#x27;S&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Î” -= k;</span><br><span class="line">            R = <span class="built_in">get</span>(m - Î”);</span><br><span class="line">            <span class="built_in">splay</span>(R, <span class="number">0</span>), <span class="built_in">splay</span>(L, R);</span><br><span class="line">            tr[L].s[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">pushup</span>(L), <span class="built_in">pushup</span>(R);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(tr[root].size - <span class="number">2</span> &lt; k)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">get_k</span>(tr[root].size - k) + Î”);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, tot - (tr[root].size - <span class="number">2</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>å¹³è¡¡æ ‘</tag>
        <tag>é¢˜è§£</tag>
      </tags>
  </entry>
  <entry>
    <title>P1505 [å›½å®¶é›†è®­é˜Ÿ] æ—…æ¸¸ é¢˜è§£</title>
    <url>/solutions/solution-p1505/</url>
    <content><![CDATA[<p>Luogu P1505</p>
<span id="more"></span>
<hr>
<p>é¢˜ç›®ç»™å®šä¸€æ£µ n ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œè¾¹å¸¦æƒï¼Œç¼–å· $0 \sim n-1$ï¼Œéœ€è¦æˆ‘ä»¬æ”¯æŒäº”ç§æ“ä½œï¼š</p>
<ul>
<li><code>C i w</code> å°†è¾“å…¥çš„ç¬¬ $i$ æ¡è¾¹æƒå€¼æ”¹ä¸º $w$</li>
<li><code>N u v</code> å°† $u,v$ èŠ‚ç‚¹ä¹‹é—´çš„è¾¹æƒéƒ½å˜ä¸ºç›¸åæ•°</li>
<li><code>SUM u v</code> è¯¢é—® $u,v$ èŠ‚ç‚¹ä¹‹é—´è¾¹æƒå’Œ</li>
<li><code>MAX u v</code> è¯¢é—® $u,v$ èŠ‚ç‚¹ä¹‹é—´è¾¹æƒæœ€å¤§å€¼</li>
<li><code>MIN u v</code> è¯¢é—® $u,v$ èŠ‚ç‚¹ä¹‹é—´è¾¹æƒæœ€å°å€¼</li>
</ul>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ ‘å‰–æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>ä½†æ˜¯æ ‘å‰–ä½œç”¨çš„æ˜¯ç‚¹æƒï¼Œè€Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¾¹æƒè½¬ç‚¹æƒçš„æ–¹æ³•æ¥è§£å†³ã€‚</p>
<p>æˆ‘ä»¬å°†è¾¹æƒè½¬å…¥å…¶ä¸‹æ–¹çš„èŠ‚ç‚¹é‡Œé¢ï¼Œåœ¨è®¿é—®çš„æ—¶å€™å¿½ç•¥æ‰æœ€é¡¶ç«¯çš„èŠ‚ç‚¹å³å¯ã€‚</p>
<p>è¿˜æœ‰åŒºé—´å–åã€‚</p>
<p>æˆ‘ä»¬è€ƒè™‘ä½¿ç”¨ä¸€ä¸ªæ‡’æ ‡è®°æ¥å¼‚æˆ–ç»´æŠ¤ä¸€ä¸‹ï¼Œå½“æˆ‘ä»¬éœ€è¦è®¿é—®çš„æ—¶å€™å°±è®©minå’Œmaxå–åå¹¶äº’æ¢å³å¯ã€‚</p>
<p>ä¸Šä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> cnt, h[N], e[N &lt;&lt; <span class="number">1</span>], ne[N &lt;&lt; <span class="number">1</span>], val[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> idx, fa[N], son[N], top[N], dep[N], dfn[N], sz[N], tmp[N], w[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SegTree</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    <span class="type">int</span> sum, max, min, tag;</span><br><span class="line">&#125;tr[N &lt;&lt; <span class="number">3</span>];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> x, y;</span><br><span class="line">&#125;id[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> w)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ne[++cnt] = h[x]; e[cnt] = y; val[cnt] = w; h[x] = cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> f)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    dep[x] = dep[f] + <span class="number">1</span>; fa[x] = f; sz[x] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h[x]; i; i = ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> v = e[i];</span><br><span class="line">        <span class="keyword">if</span>(v == f) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs1</span>(v, x);</span><br><span class="line">        tmp[v] = val[i];</span><br><span class="line">        sz[x] += sz[v];</span><br><span class="line">        <span class="keyword">if</span>(sz[son[x]] &lt; sz[v]) son[x] = v;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> topf)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    dfn[x] = ++idx; w[idx] = tmp[x]; top[x] = topf;</span><br><span class="line">    <span class="keyword">if</span>(son[x]) <span class="built_in">dfs2</span>(son[x], topf);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h[x]; i; i = ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> v = e[i];</span><br><span class="line">        <span class="keyword">if</span>(v == fa[x] || v == son[x]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs2</span>(v, v);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tr[p].sum = tr[p &lt;&lt; <span class="number">1</span>].sum + tr[p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].sum;</span><br><span class="line">    tr[p].max = <span class="built_in">max</span>(tr[p &lt;&lt; <span class="number">1</span>].max, tr[p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].max);</span><br><span class="line">    tr[p].min = <span class="built_in">min</span>(tr[p &lt;&lt; <span class="number">1</span>].min, tr[p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].min);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> &amp;root = tr[p], &amp;left = tr[p &lt;&lt; <span class="number">1</span>], &amp;rght = tr[p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">    left.tag ^= <span class="number">1</span>; rght.tag ^= <span class="number">1</span>;</span><br><span class="line">    left.sum = -left.sum; rght.sum = -rght.sum;</span><br><span class="line">    left.max = -left.max; rght.max = -rght.max;</span><br><span class="line">    left.min = -left.min; rght.min = -rght.min;</span><br><span class="line">    <span class="built_in">swap</span>(left.max, left.min);</span><br><span class="line">    <span class="built_in">swap</span>(rght.max, rght.min);</span><br><span class="line">    root.tag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tr[p].l = l, tr[p].r = r;</span><br><span class="line">    <span class="keyword">if</span>(l == r)</span><br><span class="line">    &#123;</span><br><span class="line">        tr[p].sum = tr[p].max = tr[p].min = w[l];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">build</span>(p &lt;&lt; <span class="number">1</span>, l, mid);</span><br><span class="line">    <span class="built_in">build</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="built_in">pushup</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> q, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>((tr[p].l == q) &amp;&amp; (tr[p].r == q))</span><br><span class="line">    &#123;</span><br><span class="line">        tr[p].sum = tr[p].max = tr[p].min = k;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(tr[p].tag) <span class="built_in">pushdown</span>(p);</span><br><span class="line">    <span class="type">int</span> mid = (tr[p].l + tr[p].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(q &lt;= mid) <span class="built_in">change</span>(p &lt;&lt; <span class="number">1</span>, q, k);</span><br><span class="line">    <span class="keyword">if</span>(q &gt; mid)  <span class="built_in">change</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, q, k);</span><br><span class="line">    <span class="built_in">pushup</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">segrev</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>((l &lt;= tr[p].l) &amp;&amp; (r &gt;= tr[p].r))</span><br><span class="line">    &#123;</span><br><span class="line">        tr[p].tag ^= <span class="number">1</span>;</span><br><span class="line">        tr[p].sum = -tr[p].sum;</span><br><span class="line">        tr[p].max = -tr[p].max;</span><br><span class="line">        tr[p].min = -tr[p].min;</span><br><span class="line">        <span class="built_in">swap</span>(tr[p].max, tr[p].min);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(tr[p].tag) <span class="built_in">pushdown</span>(p);</span><br><span class="line">    <span class="type">int</span> mid = (tr[p].l + tr[p].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid) <span class="built_in">segrev</span>(p &lt;&lt; <span class="number">1</span>, l, r);</span><br><span class="line">    <span class="keyword">if</span>(r &gt; mid)  <span class="built_in">segrev</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r);</span><br><span class="line">    <span class="built_in">pushup</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">segsum</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>((l &lt;= tr[p].l) &amp;&amp; (r &gt;= tr[p].r))<span class="keyword">return</span> tr[p].sum;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(tr[p].tag)<span class="built_in">pushdown</span>(p);</span><br><span class="line">    <span class="type">int</span> mid = (tr[p].l + tr[p].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid)res += <span class="built_in">segsum</span>(p &lt;&lt; <span class="number">1</span>, l, r);</span><br><span class="line">    <span class="keyword">if</span>(r &gt; mid)res += <span class="built_in">segsum</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">segmax</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>((l &lt;= tr[p].l) &amp;&amp; (r &gt;= tr[p].r))<span class="keyword">return</span> tr[p].max;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">-2147483647</span>;</span><br><span class="line">    <span class="keyword">if</span>(tr[p].tag)<span class="built_in">pushdown</span>(p);</span><br><span class="line">    <span class="type">int</span> mid = (tr[p].l + tr[p].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid)res = <span class="built_in">max</span>(res, <span class="built_in">segmax</span>(p &lt;&lt; <span class="number">1</span>, l, r));</span><br><span class="line">    <span class="keyword">if</span>(r &gt; mid)res = <span class="built_in">max</span>(res, <span class="built_in">segmax</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r));</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">segmin</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>((l &lt;= tr[p].l) &amp;&amp; (r &gt;= tr[p].r))<span class="keyword">return</span> tr[p].min;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">2147483647</span>;</span><br><span class="line">    <span class="keyword">if</span>(tr[p].tag)<span class="built_in">pushdown</span>(p);</span><br><span class="line">    <span class="type">int</span> mid = (tr[p].l + tr[p].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid)res = <span class="built_in">min</span>(res, <span class="built_in">segmin</span>(p &lt;&lt; <span class="number">1</span>, l, r));</span><br><span class="line">    <span class="keyword">if</span>(r &gt; mid)res = <span class="built_in">min</span>(res, <span class="built_in">segmin</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r));</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">revpath</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(top[x] != top[y])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(dep[top[x]] &lt; dep[top[y]]) <span class="built_in">swap</span>(x, y);</span><br><span class="line">        <span class="built_in">segrev</span>(<span class="number">1</span>, dfn[top[x]], dfn[x]);</span><br><span class="line">        x = fa[top[x]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(dep[x] &gt; dep[y]) <span class="built_in">swap</span>(x, y);</span><br><span class="line">    <span class="keyword">if</span>(x != y) <span class="built_in">segrev</span>(<span class="number">1</span>, dfn[x] + <span class="number">1</span>, dfn[y]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">sumpath</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(top[x] != top[y])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(dep[top[x]] &lt; dep[top[y]]) <span class="built_in">swap</span>(x, y);</span><br><span class="line">        res += <span class="built_in">segsum</span>(<span class="number">1</span>, dfn[top[x]], dfn[x]);</span><br><span class="line">        x = fa[top[x]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(dep[x] &gt; dep[y]) <span class="built_in">swap</span>(x, y);</span><br><span class="line">    <span class="keyword">if</span>(x != y) res += <span class="built_in">segsum</span>(<span class="number">1</span>, dfn[x] + <span class="number">1</span>, dfn[y]);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">maxpath</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">-2147483647</span>;</span><br><span class="line">    <span class="keyword">while</span>(top[x] != top[y])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(dep[top[x]] &lt; dep[top[y]]) <span class="built_in">swap</span>(x, y);</span><br><span class="line">        res = <span class="built_in">max</span>(res, <span class="built_in">segmax</span>(<span class="number">1</span>, dfn[top[x]], dfn[x]));</span><br><span class="line">        x = fa[top[x]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(dep[x] &gt; dep[y]) <span class="built_in">swap</span>(x, y);</span><br><span class="line">    <span class="keyword">if</span>(x != y) res = <span class="built_in">max</span>(res, <span class="built_in">segmax</span>(<span class="number">1</span>, dfn[x] + <span class="number">1</span>, dfn[y]));</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">minpath</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">2147483647</span>;</span><br><span class="line">    <span class="keyword">while</span>(top[x] != top[y])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(dep[top[x]] &lt; dep[top[y]]) <span class="built_in">swap</span>(x, y);</span><br><span class="line">        res = <span class="built_in">min</span>(res, <span class="built_in">segmin</span>(<span class="number">1</span>, dfn[top[x]], dfn[x]));</span><br><span class="line">        x = fa[top[x]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(dep[x] &gt; dep[y]) <span class="built_in">swap</span>(x, y);</span><br><span class="line">    <span class="keyword">if</span>(x != y) res = <span class="built_in">min</span>(res, <span class="built_in">segmin</span>(<span class="number">1</span>, dfn[x] + <span class="number">1</span>, dfn[y]));</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> a, b, c;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld%lld&quot;</span>, &amp;a, &amp;b, &amp;c);</span><br><span class="line">        <span class="built_in">add</span>(++a, ++b, c);</span><br><span class="line">        <span class="built_in">add</span>(b, a, c);</span><br><span class="line">        id[i].x = a;</span><br><span class="line">        id[i].y = b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dfs1</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">dfs2</span>(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;m);</span><br><span class="line">    <span class="keyword">while</span>(m--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">char</span> s[<span class="number">10</span>];</span><br><span class="line">        <span class="type">int</span> a, b;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s%lld%lld&quot;</span>, s, &amp;a, &amp;b);</span><br><span class="line">        <span class="keyword">if</span>(s[<span class="number">0</span>] == <span class="string">&#x27;C&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> target;</span><br><span class="line">            <span class="keyword">if</span>(dep[id[a].x] &gt; dep[id[a].y]) target = id[a].x;</span><br><span class="line">            <span class="keyword">else</span> target = id[a].y;</span><br><span class="line">            <span class="built_in">change</span>(<span class="number">1</span>, dfn[target], b);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(s[<span class="number">0</span>] == <span class="string">&#x27;N&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">revpath</span>(++a, ++b);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(s[<span class="number">0</span>] == <span class="string">&#x27;S&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">sumpath</span>(++a, ++b));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(s[<span class="number">0</span>] == <span class="string">&#x27;M&#x27;</span> &amp;&amp; s[<span class="number">1</span>] == <span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">maxpath</span>(++a, ++b));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(s[<span class="number">0</span>] == <span class="string">&#x27;M&#x27;</span> &amp;&amp; s[<span class="number">1</span>] == <span class="string">&#x27;I&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">minpath</span>(++a, ++b));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>é¢˜è§£</tag>
        <tag>æ ‘é“¾å‰–åˆ†</tag>
      </tags>
  </entry>
  <entry>
    <title>P2042 [NOI2005] ç»´æŠ¤æ•°åˆ— é¢˜è§£</title>
    <url>/solutions/solution-p2042/</url>
    <content><![CDATA[<p>Luogu P2042</p>
<p>NOI 2005</p>
<span id="more"></span>
<hr>
<p>é¢˜ç›®è¦æ±‚æˆ‘ä»¬ç»´æŠ¤ä¸€ä¸ªæ•°åˆ—ï¼Œæ”¯æŒä¸‹é¢å…­ç§æ“ä½œï¼š</p>
<ol>
<li>æ’å…¥ï¼šåœ¨å½“å‰æ•°åˆ—çš„ç¬¬ $posi$ ä¸ªæ•°å­—åé¢æ’å…¥ $c_1,c_2,\cdots,c_tot$ å…±è®¡ $tot$ ä¸ªæ•°å­—ï¼›</li>
<li>åˆ é™¤ï¼šä»å½“å‰æ•°åˆ—çš„ç¬¬ $posi$ ä¸ªæ•°å­—å¼€å§‹è¿ç»­åˆ é™¤ $tot$ ä¸ªæ•°å­—ï¼›</li>
<li>æ¨å¹³ï¼šä»å½“å‰æ•°åˆ—çš„ç¬¬ $posi$ ä¸ªæ•°å­—å¼€å§‹çš„è¿ç»­ $tot$ ä¸ªæ•°å­—æ”¹ä¸º $c$ï¼›</li>
<li>ç¿»è½¬ï¼šå°†åŒºé—´ $[ posi,posi+tot-1 ]$ ç¿»è½¬ï¼›</li>
<li>æ±‚å’Œï¼šæ±‚å‡ºåŒºé—´ $[ posi,posi+tot-1 ]$ å†…æ‰€æœ‰æ•°å­—çš„å’Œï¼›</li>
<li>æ±‚æœ€å¤§å­åºåˆ—å’Œï¼šæ±‚å‡ºå½“å‰æ•°åˆ—ä¸­æœ€å¤§çš„ä¸€æ®µå­åºåˆ—å¹¶è¾“å‡ºå…¶åºåˆ—å’Œã€‚</li>
</ol>
<p>çœ‹è§åŒºé—´ç¿»è½¬æˆ‘å°±æƒ³åˆ°äº†å¹³è¡¡æ ‘ã€‚</p>
<p>å¹¸å¥½ä¸Šé¢éœ€è¦æˆ‘ä»¬æ”¯æŒçš„æ“ä½œéƒ½æ˜¯å¯ä»¥åˆ©ç”¨å¹³è¡¡æ ‘æ¥ç»´æŠ¤çš„ã€‚</p>
<p>æˆ‘ä»¬åœ¨ç»´æŠ¤åŒºé—´ç¿»è½¬çš„æ—¶å€™å°±ç”¨åˆ°äº†æ‡’æ ‡è®°çš„æ€æƒ³ï¼Œè¿™é‡Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨æ‡’æ ‡è®°ã€‚</p>
<p>æˆ‘ä»¬çš„ç»“æ„ä½“é•¿çš„æ˜¯è¿™ä¸ªæ ·å­ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> s[<span class="number">2</span>], p, v;</span><br><span class="line">    <span class="type">int</span> rev, same;</span><br><span class="line">    <span class="type">int</span> sz, sum, ms, ls, rs;</span><br><span class="line">&#125;tr[N];</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­åˆ†åˆ«ç»´æŠ¤çš„æ˜¯ï¼š</p>
<ul>
<li><code>s[2]</code>ï¼šå·¦å³å„¿å­ï¼›</li>
<li><code>p</code>ï¼šçˆ¶äº²ï¼›</li>
<li><code>v</code>ï¼šå½“å‰èŠ‚ç‚¹çš„å€¼ï¼›</li>
<li><code>rev</code>ï¼šç¿»è½¬æ‡’æ ‡è®°ï¼›</li>
<li><code>same</code>ï¼šæ¨å¹³æ‡’æ ‡è®°ï¼›</li>
<li><code>sz</code>ï¼šå­æ ‘å¤§å°ï¼›</li>
<li><code>sum</code>ï¼šåŒºé—´å’Œï¼›</li>
<li><code>ms</code>ï¼šåŒºé—´æœ€å¤§å­åºåˆ—å’Œï¼›</li>
<li><code>ls</code>ï¼šåŒºé—´æœ€å¤§å‰ç¼€å’Œï¼›</li>
<li><code>rs</code>ï¼šåŒºé—´æœ€å¤§åç¼€å’Œã€‚</li>
</ul>
<p>æˆ‘ä»¬åˆå§‹åŒ–çš„æ—¶å€™è¿™æ ·åˆå§‹åŒ–ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> _v, <span class="type">int</span> _p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    s[<span class="number">0</span>] = s[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    p = _p, v = _v;</span><br><span class="line">    rev = same = <span class="number">0</span>;</span><br><span class="line">    sz = <span class="number">1</span>;</span><br><span class="line">    sum = ms = v;</span><br><span class="line">    ls = rs = <span class="built_in">max</span>(v, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶åæ˜¯åŒºé—´åˆå¹¶ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> &amp;u = tr[x], &amp;l = tr[u.s[<span class="number">0</span>]], &amp;r = tr[u.s[<span class="number">1</span>]];</span><br><span class="line">    u.sz = l.sz + r.sz + <span class="number">1</span>;</span><br><span class="line">    u.sum = l.sum + r.sum + u.v;</span><br><span class="line">    u.ls = <span class="built_in">max</span>(l.ls, l.sum + u.v + r.ls);</span><br><span class="line">    u.rs = <span class="built_in">max</span>(r.rs, r.sum + u.v + l.rs);</span><br><span class="line">    u.ms = <span class="built_in">max</span>(<span class="built_in">max</span>(l.ms, r.ms), l.rs + u.v + r.ls);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç»´æŠ¤å½“å‰åŒºé—´çš„æœ€å¤§å­åºåˆ—å¯ä»¥çœ‹<a href="/OI/segment-tree/#%E5%8C%BA%E9%97%B4%E6%9C%80%E5%A4%A7%E5%AD%90%E6%AE%B5%E5%92%8C">è¿™é‡Œ</a>çš„æ€è·¯ã€‚</p>
<p>å†ç„¶åæ˜¯æ ‡è®°çš„ä¸‹ä¼ ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> &amp;u = tr[x], &amp;l = tr[u.s[<span class="number">0</span>]], &amp;r = tr[u.s[<span class="number">1</span>]];</span><br><span class="line">    <span class="keyword">if</span>(u.same)</span><br><span class="line">    &#123;</span><br><span class="line">        u.same = u.rev = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(u.s[<span class="number">0</span>]) l.same = <span class="number">1</span>, l.v = u.v, l.sum = l.v * l.sz;</span><br><span class="line">        <span class="keyword">if</span>(u.s[<span class="number">1</span>]) r.same = <span class="number">1</span>, r.v = u.v, r.sum = r.v * r.sz;</span><br><span class="line">        <span class="keyword">if</span>(u.v &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(u.s[<span class="number">0</span>]) l.ms = l.ls = l.rs = l.sum;</span><br><span class="line">            <span class="keyword">if</span>(u.s[<span class="number">1</span>]) r.ms = r.ls = r.rs = r.sum;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(u.s[<span class="number">0</span>]) l.ms = l.v, l.ls = l.rs = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span>(u.s[<span class="number">1</span>]) r.ms = r.v, r.ls = r.rs = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(u.rev)</span><br><span class="line">    &#123;</span><br><span class="line">        u.rev = <span class="number">0</span>, l.rev ^= <span class="number">1</span>, r.rev ^= <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">swap</span>(l.ls, l.rs), <span class="built_in">swap</span>(r.ls, r.rs);</span><br><span class="line">        <span class="built_in">swap</span>(l.s[<span class="number">0</span>], l.s[<span class="number">1</span>]), <span class="built_in">swap</span>(r.s[<span class="number">0</span>], r.s[<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åŒºé—´æ¨å¹³çš„ä¼˜å…ˆçº§æ˜¯å…ˆäºåŒºé—´ç¿»è½¬çš„ï¼Œä¸”å¦‚æœè¿™ä¸ªåŒºé—´æ•´ä½“è¢«æ¨å¹³äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªåŒºé—´ç¿»è½¬äº†å’Œæ²¡ç¿»è½¬æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œæ‰€ä»¥æ¯ä¸€æ¬¡æ ‡è®°ä¸‹ä¼ çš„æ—¶å€™åªéœ€è¦ä¸‹ä¼ ä¸¤è€…å…¶ä¸€å³å¯ã€‚</p>
<p>ç„¶åæ˜¯å…­ç§æ“ä½œï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; N; i++) recycle[++tt] = i;<span class="comment">//å¾ªç¯ä½¿ç”¨ä¸‹æ ‡ï¼ŒèŠ‚çº¦ç©ºé—´</span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    tr[<span class="number">0</span>].ms = w[<span class="number">0</span>] = w[n + <span class="number">1</span>] = -INF;<span class="comment">//å“¨å…µ</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;w[i]);</span><br><span class="line">    rt = <span class="built_in">build</span>(<span class="number">0</span>, n + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="type">char</span> op[<span class="number">20</span>];</span><br><span class="line">    <span class="keyword">while</span>(m--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, op);</span><br><span class="line">        <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(op, <span class="string">&quot;INSERT&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> posi, tot;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;posi, &amp;tot);</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; tot; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;w[i]);</span><br><span class="line">            <span class="type">int</span> l = <span class="built_in">get_k</span>(posi + <span class="number">1</span>), r = <span class="built_in">get_k</span>(posi + <span class="number">2</span>);</span><br><span class="line">            <span class="built_in">splay</span>(l, <span class="number">0</span>), <span class="built_in">splay</span>(r, l);</span><br><span class="line">            <span class="type">int</span> u = <span class="built_in">build</span>(<span class="number">0</span>, tot - <span class="number">1</span>, r);</span><br><span class="line">            tr[r].s[<span class="number">0</span>] = u;</span><br><span class="line">            <span class="built_in">pushup</span>(r), <span class="built_in">pushup</span>(l);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(op, <span class="string">&quot;DELETE&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> posi, tot;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;posi, &amp;tot);</span><br><span class="line">            <span class="type">int</span> l = <span class="built_in">get_k</span>(posi), r = <span class="built_in">get_k</span>(posi + tot + <span class="number">1</span>);</span><br><span class="line">            <span class="built_in">splay</span>(l, <span class="number">0</span>), <span class="built_in">splay</span>(r, l);</span><br><span class="line">            <span class="built_in">del</span>(tr[r].s[<span class="number">0</span>]);</span><br><span class="line">            tr[r].s[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">pushup</span>(r), <span class="built_in">pushup</span>(l);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(op, <span class="string">&quot;MAKE-SAME&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> posi, tot, c;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;posi, &amp;tot, &amp;c);</span><br><span class="line">            <span class="type">int</span> l = <span class="built_in">get_k</span>(posi), r = <span class="built_in">get_k</span>(posi + tot + <span class="number">1</span>);</span><br><span class="line">            <span class="built_in">splay</span>(l, <span class="number">0</span>), <span class="built_in">splay</span>(r, l);</span><br><span class="line">            <span class="keyword">auto</span> &amp;son = tr[tr[r].s[<span class="number">0</span>]];</span><br><span class="line">            son.same = <span class="number">1</span>, son.v = c, son.sum = c * son.sz;</span><br><span class="line">            <span class="keyword">if</span>(c &gt; <span class="number">0</span>) son.ms = son.ls = son.rs = son.sum;</span><br><span class="line">            <span class="keyword">else</span> son.ms = c, son.ls = son.rs = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">pushup</span>(r), <span class="built_in">pushup</span>(l);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(op, <span class="string">&quot;REVERSE&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> posi, tot;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;posi, &amp;tot);</span><br><span class="line">            <span class="type">int</span> l = <span class="built_in">get_k</span>(posi), r = <span class="built_in">get_k</span>(posi + tot + <span class="number">1</span>);</span><br><span class="line">            <span class="built_in">splay</span>(l, <span class="number">0</span>), <span class="built_in">splay</span>(r, l);</span><br><span class="line">            <span class="keyword">auto</span> &amp;son = tr[tr[r].s[<span class="number">0</span>]];</span><br><span class="line">            son.rev ^= <span class="number">1</span>;</span><br><span class="line">            <span class="built_in">swap</span>(son.ls, son.rs);</span><br><span class="line">            <span class="built_in">swap</span>(son.s[<span class="number">0</span>], son.s[<span class="number">1</span>]);</span><br><span class="line">            <span class="built_in">pushup</span>(r), <span class="built_in">pushup</span>(l);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(op, <span class="string">&quot;GET-SUM&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> posi, tot;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;posi, &amp;tot);</span><br><span class="line">            <span class="type">int</span> l = <span class="built_in">get_k</span>(posi), r = <span class="built_in">get_k</span>(posi + tot + <span class="number">1</span>);</span><br><span class="line">            <span class="built_in">splay</span>(l, <span class="number">0</span>), <span class="built_in">splay</span>(r, l);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, tr[tr[r].s[<span class="number">0</span>]].sum);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, tr[rt].ms);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>æ’å…¥ä¸€æ•´æ®µåŒºé—´çš„æ“ä½œä¸ä¸€å¼€å§‹å»ºæ ‘çš„æ—¶å€™å·®ä¸å¤šã€‚<br> æˆ‘ä»¬éœ€è¦é¦–å…ˆé¢„ç•™å‡ºæ¥æ–°åŒºé—´çš„ä½ç½®ï¼Œæ¯”å¦‚è¯´ $posi+1$ èŠ‚ç‚¹çš„å·¦å­æ ‘ã€‚æ­¤æ—¶è¿™æ£µæ ‘é•¿è¿™ä¸ªæ ·å­ï¼š<br> <img src="/%5Cpics%5Cp2042-1.bmp" alt="p2042-1.bmp"><br> æˆ‘ä»¬å°±æ˜¯è¦åœ¨è‚©å¤´æŒ‡å‘çš„ä½ç½®æ’å…¥æˆ‘ä»¬çš„æ–°åºåˆ—ã€‚<br> ç„¶åå°±åƒä¸€å¼€å§‹çš„æ—¶å€™é‚£æ ·ï¼ŒåŸºäºæ–°è¯»å…¥çš„åºåˆ—å»ºç«‹ä¸€æ£µå¹³è¡¡æ ‘ï¼Œæ ¹èŠ‚ç‚¹ä¸º $u$ã€‚<br> ç„¶åè®© $u$ æˆä¸º $posi+1$ çš„å·¦å„¿å­ï¼Œå°±åƒè¿™æ ·ï¼š<br> <img src="/%5Cpics%5Cp2042-2.bmp" alt="p2042-2.bmp"><br> ç°åœ¨æˆ‘ä»¬å°±åœ¨ $posi$ åé¢æ’å…¥äº†ä¸€æ®µæ–°çš„åºåˆ—ã€‚</li>
<li>åˆ é™¤ä¸€æ•´æ®µåŒºé—´çš„æ“ä½œä¸æ­£å¸¸çš„åˆ é™¤æ“ä½œæ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚<br> è¿™é‡Œå°±ä¸è®²äº†ã€‚</li>
<li>åŒºé—´æ¨å¹³ä¸åŒºé—´ç¿»è½¬çš„é“ç†ç±»ä¼¼ï¼Œéƒ½æ˜¯ç»™æ•´ä¸ªåŒºé—´æ‰“ä¸Šä¸€ä¸ªæ ‡è®°ï¼ŒåŒæ—¶åŒºé—´æ¨å¹³è¿˜ä¼šé¢å¤–ä¿®æ”¹ä¸€ä¸‹åŒºé—´å’Œã€åŒºé—´æœ€å¤§å­æ®µå’Œã€åŒºé—´æœ€å¤§å‰ç¼€å’Œä¸åŒºé—´æœ€å¤§åç¼€å’Œï¼Œåˆ«çš„å°±æ²¡æœ‰ä»€ä¹ˆå¥½è¯´çš„äº†ã€‚</li>
<li>åŒºé—´æ±‚å’Œçš„æ€è·¯ä¸åŒºé—´ç¿»è½¬ã€åŒºé—´æ¨å¹³ç±»ä¼¼ï¼Œåªä¸è¿‡ä¸æ˜¯ä¿®æ”¹è€Œæ˜¯æŸ¥è¯¢ã€‚æˆªå‡ºæ¥è¯¢é—®åŒºé—´ä¹‹åç›´æ¥è¾“å‡ºå€¼å³å¯ã€‚</li>
<li>ä¸Šé¢çš„äº”ç§æ“ä½œéƒ½éœ€è¦æˆªå‡ºå¯¹åº”åŒºé—´ï¼Œä½†æ˜¯è¯¢é—®åŒºé—´æœ€å¤§å­æ®µå’Œåªéœ€è¦è®¿é—®å½“å‰æ ¹èŠ‚ç‚¹å³å¯ã€‚</li>
</ol>
<p>æœ€åæ”¾ä¸€ä¸‹æ€»çš„ä»£ç ï¼š</p>
<details class="note success"><summary><p>ç¤ºä¾‹ä»£ç </p>
</summary>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">500010</span>, INF = <span class="number">1000000000</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> s[<span class="number">2</span>], p, v;</span><br><span class="line">    <span class="type">int</span> rev, same;</span><br><span class="line">    <span class="type">int</span> sz, sum, ms, ls, rs;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> _v, <span class="type">int</span> _p)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        s[<span class="number">0</span>] = s[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">        p = _p, v = _v;</span><br><span class="line">        rev = same = <span class="number">0</span>;</span><br><span class="line">        sz = <span class="number">1</span>;</span><br><span class="line">        sum = ms = v;</span><br><span class="line">        ls = rs = <span class="built_in">max</span>(v, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;tr[N];</span><br><span class="line"><span class="type">int</span> rt, recycle[N], tt;</span><br><span class="line"><span class="type">int</span> w[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> &amp;u = tr[x], &amp;l = tr[u.s[<span class="number">0</span>]], &amp;r = tr[u.s[<span class="number">1</span>]];</span><br><span class="line">    u.sz = l.sz + r.sz + <span class="number">1</span>;</span><br><span class="line">    u.sum = l.sum + r.sum + u.v;</span><br><span class="line">    u.ls = <span class="built_in">max</span>(l.ls, l.sum + u.v + r.ls);</span><br><span class="line">    u.rs = <span class="built_in">max</span>(r.rs, r.sum + u.v + l.rs);</span><br><span class="line">    u.ms = <span class="built_in">max</span>(<span class="built_in">max</span>(l.ms, r.ms), l.rs + u.v + r.ls);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> &amp;u = tr[x], &amp;l = tr[u.s[<span class="number">0</span>]], &amp;r = tr[u.s[<span class="number">1</span>]];</span><br><span class="line">    <span class="keyword">if</span>(u.same)</span><br><span class="line">    &#123;</span><br><span class="line">        u.same = u.rev = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(u.s[<span class="number">0</span>]) l.same = <span class="number">1</span>, l.v = u.v, l.sum = l.v * l.sz;</span><br><span class="line">        <span class="keyword">if</span>(u.s[<span class="number">1</span>]) r.same = <span class="number">1</span>, r.v = u.v, r.sum = r.v * r.sz;</span><br><span class="line">        <span class="keyword">if</span>(u.v &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(u.s[<span class="number">0</span>]) l.ms = l.ls = l.rs = l.sum;</span><br><span class="line">            <span class="keyword">if</span>(u.s[<span class="number">1</span>]) r.ms = r.ls = r.rs = r.sum;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(u.s[<span class="number">0</span>]) l.ms = l.v, l.ls = l.rs = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span>(u.s[<span class="number">1</span>]) r.ms = r.v, r.ls = r.rs = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(u.rev)</span><br><span class="line">    &#123;</span><br><span class="line">        u.rev = <span class="number">0</span>, l.rev ^= <span class="number">1</span>, r.rev ^= <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">swap</span>(l.ls, l.rs), <span class="built_in">swap</span>(r.ls, r.rs);</span><br><span class="line">        <span class="built_in">swap</span>(l.s[<span class="number">0</span>], l.s[<span class="number">1</span>]), <span class="built_in">swap</span>(r.s[<span class="number">0</span>], r.s[<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rotate</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> y = tr[x].p, z = tr[y].p;</span><br><span class="line">    <span class="type">int</span> k = tr[y].s[<span class="number">1</span>] == x;</span><br><span class="line">    tr[z].s[tr[z].s[<span class="number">1</span>] == y] = x, tr[x].p = z;</span><br><span class="line">    tr[y].s[k] = tr[x].s[k ^ <span class="number">1</span>], tr[tr[x].s[k ^ <span class="number">1</span>]].p = y;</span><br><span class="line">    tr[x].s[k ^ <span class="number">1</span>] = y, tr[y].p = x;</span><br><span class="line">    <span class="built_in">pushup</span>(y), <span class="built_in">pushup</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">splay</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(tr[x].p != k)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> y = tr[x].p, z = tr[y].p;</span><br><span class="line">        <span class="keyword">if</span>(z != k)</span><br><span class="line">            <span class="keyword">if</span>((tr[y].s[<span class="number">1</span>] == x) ^ (tr[z].s[<span class="number">1</span>] == y)) <span class="built_in">rotate</span>(x);</span><br><span class="line">            <span class="keyword">else</span> <span class="built_in">rotate</span>(y);</span><br><span class="line">        <span class="built_in">rotate</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!k) rt = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get_k</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> u = rt;</span><br><span class="line">    <span class="keyword">while</span>(u)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">pushdown</span>(u);</span><br><span class="line">        <span class="keyword">if</span>(tr[tr[u].s[<span class="number">0</span>]].sz &gt;= k) u = tr[u].s[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(tr[tr[u].s[<span class="number">0</span>]].sz + <span class="number">1</span> == k) <span class="keyword">return</span> u;</span><br><span class="line">        <span class="keyword">else</span> k -= tr[tr[u].s[<span class="number">0</span>]].sz + <span class="number">1</span>, u = tr[u].s[<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">build</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> u = recycle[tt--];</span><br><span class="line">    tr[u].<span class="built_in">init</span>(w[mid], p);</span><br><span class="line">    <span class="keyword">if</span>(l &lt; mid) tr[u].s[<span class="number">0</span>] = <span class="built_in">build</span>(l, mid - <span class="number">1</span>, u);</span><br><span class="line">    <span class="keyword">if</span>(mid &lt; r) tr[u].s[<span class="number">1</span>] = <span class="built_in">build</span>(mid + <span class="number">1</span>, r, u);</span><br><span class="line">    <span class="built_in">pushup</span>(u);</span><br><span class="line">    <span class="keyword">return</span> u;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">del</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(tr[u].s[<span class="number">0</span>]) <span class="built_in">del</span>(tr[u].s[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">if</span>(tr[u].s[<span class="number">1</span>]) <span class="built_in">del</span>(tr[u].s[<span class="number">1</span>]);</span><br><span class="line">    recycle[++tt] = u;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; N; i++) recycle[++tt] = i;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    tr[<span class="number">0</span>].ms = w[<span class="number">0</span>] = w[n + <span class="number">1</span>] = -INF;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;w[i]);</span><br><span class="line">    rt = <span class="built_in">build</span>(<span class="number">0</span>, n + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="type">char</span> op[<span class="number">20</span>];</span><br><span class="line">    <span class="keyword">while</span>(m--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, op);</span><br><span class="line">        <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(op, <span class="string">&quot;INSERT&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> posi, tot;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;posi, &amp;tot);</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; tot; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;w[i]);</span><br><span class="line">            <span class="type">int</span> l = <span class="built_in">get_k</span>(posi + <span class="number">1</span>), r = <span class="built_in">get_k</span>(posi + <span class="number">2</span>);</span><br><span class="line">            <span class="built_in">splay</span>(l, <span class="number">0</span>), <span class="built_in">splay</span>(r, l);</span><br><span class="line">            <span class="type">int</span> u = <span class="built_in">build</span>(<span class="number">0</span>, tot - <span class="number">1</span>, r);</span><br><span class="line">            tr[r].s[<span class="number">0</span>] = u;</span><br><span class="line">            <span class="built_in">pushup</span>(r), <span class="built_in">pushup</span>(l);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(op, <span class="string">&quot;DELETE&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> posi, tot;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;posi, &amp;tot);</span><br><span class="line">            <span class="type">int</span> l = <span class="built_in">get_k</span>(posi), r = <span class="built_in">get_k</span>(posi + tot + <span class="number">1</span>);</span><br><span class="line">            <span class="built_in">splay</span>(l, <span class="number">0</span>), <span class="built_in">splay</span>(r, l);</span><br><span class="line">            <span class="built_in">del</span>(tr[r].s[<span class="number">0</span>]);</span><br><span class="line">            tr[r].s[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">pushup</span>(r), <span class="built_in">pushup</span>(l);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(op, <span class="string">&quot;MAKE-SAME&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> posi, tot, c;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;posi, &amp;tot, &amp;c);</span><br><span class="line">            <span class="type">int</span> l = <span class="built_in">get_k</span>(posi), r = <span class="built_in">get_k</span>(posi + tot + <span class="number">1</span>);</span><br><span class="line">            <span class="built_in">splay</span>(l, <span class="number">0</span>), <span class="built_in">splay</span>(r, l);</span><br><span class="line">            <span class="keyword">auto</span> &amp;son = tr[tr[r].s[<span class="number">0</span>]];</span><br><span class="line">            son.same = <span class="number">1</span>, son.v = c, son.sum = c * son.sz;</span><br><span class="line">            <span class="keyword">if</span>(c &gt; <span class="number">0</span>) son.ms = son.ls = son.rs = son.sum;</span><br><span class="line">            <span class="keyword">else</span> son.ms = c, son.ls = son.rs = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">pushup</span>(r), <span class="built_in">pushup</span>(l);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(op, <span class="string">&quot;REVERSE&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> posi, tot;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;posi, &amp;tot);</span><br><span class="line">            <span class="type">int</span> l = <span class="built_in">get_k</span>(posi), r = <span class="built_in">get_k</span>(posi + tot + <span class="number">1</span>);</span><br><span class="line">            <span class="built_in">splay</span>(l, <span class="number">0</span>), <span class="built_in">splay</span>(r, l);</span><br><span class="line">            <span class="keyword">auto</span> &amp;son = tr[tr[r].s[<span class="number">0</span>]];</span><br><span class="line">            son.rev ^= <span class="number">1</span>;</span><br><span class="line">            <span class="built_in">swap</span>(son.ls, son.rs);</span><br><span class="line">            <span class="built_in">swap</span>(son.s[<span class="number">0</span>], son.s[<span class="number">1</span>]);</span><br><span class="line">            <span class="built_in">pushup</span>(r), <span class="built_in">pushup</span>(l);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(op, <span class="string">&quot;GET-SUM&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> posi, tot;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;posi, &amp;tot);</span><br><span class="line">            <span class="type">int</span> l = <span class="built_in">get_k</span>(posi), r = <span class="built_in">get_k</span>(posi + tot + <span class="number">1</span>);</span><br><span class="line">            <span class="built_in">splay</span>(l, <span class="number">0</span>), <span class="built_in">splay</span>(r, l);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, tr[tr[r].s[<span class="number">0</span>]].sum);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, tr[rt].ms);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</details>


]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>å¹³è¡¡æ ‘</tag>
        <tag>é¢˜è§£</tag>
      </tags>
  </entry>
  <entry>
    <title>P2146 è½¯ä»¶åŒ…ç®¡ç†å™¨ é¢˜è§£</title>
    <url>/solutions/solution-p2146/</url>
    <content><![CDATA[<p>Luogu P2146<br>LibreOJ #2130</p>
<p>2015 NOI</p>
<span id="more"></span>
<hr>
<p>æ ‘å‰–æ¨¡æ¿é¢˜ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬çœ‹ä¸€ä¸‹<span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL3Byb2JsZW0vUDIxNDY=">é¢˜é¢<i class="fa fa-external-link-alt"></i></span>ï¼›</p>
<p>å°†é¢˜é¢ç®€åŒ–ä¸€ä¸‹ï¼Œå°±æ˜¯ä¸‹é¢è¿™æ ·ï¼š</p>
<blockquote>
<p>ç»™å®šä¸€æ£µå¤§å°ä¸º $n$ çš„ï¼Œæ ¹èŠ‚ç‚¹ä¸º0çš„æ ‘ï¼Œæˆ‘ä»¬éœ€è¦å¯¹è¿™æ£µæ ‘è¿›è¡Œä¸¤ç§æ“ä½œï¼Œå¹¶æ±‚å‡ºæœ‰å¤šå°‘ä¸ªèŠ‚ç‚¹çš„çŠ¶æ€è¢«æ”¹å˜ï¼š</p>
<ol>
<li>å°†æ ¹èŠ‚ç‚¹åˆ°ç»™å®šèŠ‚ç‚¹çš„è·¯å¾„å…¨éƒ¨å˜æˆ1ï¼Œè¾“å…¥æ ¼å¼ä¸º <code>install x</code> ï¼›</li>
<li>å°†ç»™å®šèŠ‚ç‚¹åŠå…¶å­æ ‘å…¨éƒ¨å˜æˆ0ï¼Œè¾“å…¥æ ¼å¼ä¸º <code>uninstall x</code> ï¼›<br>åˆå§‹æƒ…å†µä¸‹æ‰€æœ‰èŠ‚ç‚¹éƒ½æ˜¯0ã€‚</li>
</ol>
</blockquote>
<p>å¯¹äºæˆ‘ä»¬çš„ç»“æœï¼Œæˆ‘ä»¬ç›´æ¥å¯ä»¥å¯¹æ¯”æ“ä½œå‰åæ•´æ£µæ ‘çš„æƒå€¼å’Œï¼ˆå­˜åœ¨æ ¹èŠ‚ç‚¹é‡Œé¢ï¼‰ï¼Œç„¶åç›´æ¥è¾“å‡ºä¸¤æ•°ä¹‹å·®å³å¯ã€‚</p>
<p>ä½†æ˜¯æˆ‘ä»¬è¿˜éœ€è¦æ³¨æ„ä¸€ç‚¹ï¼š<strong>é»˜è®¤æ‡’æ ‡è®°å€¼</strong>ã€‚<br>æˆ‘ä»¬ä¹‹å‰ä¸€ç›´è®¾æ‡’æ ‡è®°çš„é»˜è®¤å€¼ä¸º0ï¼Œè€Œåœ¨æ­¤é¢˜çš„ç¯å¢ƒå†…ï¼Œ0ä»£è¡¨çš„æ˜¯ä¸€ç§çŠ¶æ€ï¼Œè€Œéä¸€ä¸ªå€¼ã€‚å¦‚æœå°†æ‡’æ ‡è®°å€¼ä¸º0çš„æ—¶å€™ç›´æ¥è·³è¿‡çš„è¯ï¼Œå°±æ— æ³•å¸è½½æ‰€æœ‰éœ€è¦å¸è½½çš„è½¯ä»¶ã€‚<br>æ‰€ä»¥æˆ‘ä»¬åœ¨æ­¤å°†é»˜è®¤æ‡’æ ‡è®°å€¼å®šä¸º-1ã€‚pushupçš„æ—¶å€™ä¹Ÿæ˜¯ä¸€æ ·ã€‚</p>
<p>å½“ç„¶ï¼Œæœ¬é¢˜è¦æ±‚çš„æ˜¯åŒºé—´è¦†ç›–è€ŒéåŒºé—´å¢å‡ï¼Œè€Œè¿™ä¸ªå°±åªå°†segaddå’Œpushdownä¸¤ä¸ªå‡½æ•°é‡Œé¢çš„<code>+=</code>æ¢æˆ<code>=</code>å³å¯ã€‚<br>æ¯”å¦‚è¿™æ ·ï¼š</p>
<p>segaddï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">segadd</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>((l &lt;= tr[p].l) &amp;&amp; (r &gt;= tr[p].r))</span><br><span class="line">    &#123;</span><br><span class="line">        tr[p].add = k;</span><br><span class="line">        tr[p].sum = k * (tr[p].r - tr[p].l + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">pushdown</span>(p);</span><br><span class="line">    <span class="type">int</span> mid = (tr[p].l + tr[p].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid) <span class="built_in">segadd</span>(p &lt;&lt; <span class="number">1</span>, l, r, k);</span><br><span class="line">    <span class="keyword">if</span>(r &gt; mid) <span class="built_in">segadd</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r, k);</span><br><span class="line">    <span class="built_in">pushup</span>(p);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>pushdownï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> &amp;root = tr[p], &amp;left = tr[p &lt;&lt; <span class="number">1</span>], &amp;rght = tr[p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span>(root.add!=<span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        left.add = root.add, left.sum = root.add * (left.r - left.l + <span class="number">1</span>);</span><br><span class="line">        rght.add = root.add, rght.sum = root.add * (rght.r - rght.l + <span class="number">1</span>);</span><br><span class="line">        root.add = <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å› ä¸ºæœ¬é¢˜çš„æ ¹èŠ‚ç‚¹æ˜¯0ï¼Œæ‰€ä»¥æˆ‘å°†æ‰€æœ‰èŠ‚ç‚¹çš„ç¼–å·éƒ½åŠ ä¸Šäº†1ï¼Œè¿™æ ·å°±ä¸æ­£å¸¸æƒ…å†µä¸‹å·®ä¸å¤šäº†ã€‚<br>å®Œæ•´ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">100010</span>, M = N &lt;&lt; <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> h[N], e[M], ne[M], idx;</span><br><span class="line"><span class="type">int</span> id[N], cnt;</span><br><span class="line"><span class="type">int</span> dep[N], sz[N], top[N], fa[N], son[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">segtree</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    ll add, sum;</span><br><span class="line">&#125;tr[N &lt;&lt; <span class="number">3</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[idx] = b, ne[idx] = h[a], h[a] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> father, <span class="type">int</span> depth)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    dep[p] = depth, fa[p] = father, sz[p] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h[p]; ~i; i = ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> j = e[i];</span><br><span class="line">        <span class="keyword">if</span>(j == father) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs1</span>(j, p, depth + <span class="number">1</span>);</span><br><span class="line">        sz[p] += sz[j];</span><br><span class="line">        <span class="keyword">if</span>(sz[son[p]] &lt; sz[j]) son[p] = j;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    id[p] = ++cnt, top[p] = t;</span><br><span class="line">    <span class="keyword">if</span>(!son[p]) <span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">dfs2</span>(son[p], t);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h[p]; ~i; i = ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> j = e[i];</span><br><span class="line">        <span class="keyword">if</span>(j == fa[p] || j == son[p]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs2</span>(j, j);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tr[p].sum = tr[p &lt;&lt; <span class="number">1</span>].sum + tr[p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].sum;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> &amp;root = tr[p], &amp;left = tr[p &lt;&lt; <span class="number">1</span>], &amp;rght = tr[p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span>(root.add!=<span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        left.add = root.add, left.sum = root.add * (left.r - left.l + <span class="number">1</span>);</span><br><span class="line">        rght.add = root.add, rght.sum = root.add * (rght.r - rght.l + <span class="number">1</span>);</span><br><span class="line">        root.add = <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tr[p] = &#123; l, r, <span class="number">-1</span>, <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="keyword">if</span>(l == r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">build</span>(p &lt;&lt; <span class="number">1</span>, l, mid);</span><br><span class="line">    <span class="built_in">build</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="comment">//pushup(p);</span></span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">segadd</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>((l &lt;= tr[p].l) &amp;&amp; (r &gt;= tr[p].r))</span><br><span class="line">    &#123;</span><br><span class="line">        tr[p].add = k;</span><br><span class="line">        tr[p].sum = k * (tr[p].r - tr[p].l + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">pushdown</span>(p);</span><br><span class="line">    <span class="type">int</span> mid = (tr[p].l + tr[p].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid) <span class="built_in">segadd</span>(p &lt;&lt; <span class="number">1</span>, l, r, k);</span><br><span class="line">    <span class="keyword">if</span>(r &gt; mid) <span class="built_in">segadd</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r, k);</span><br><span class="line">    <span class="built_in">pushup</span>(p);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">install</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll prev = tr[<span class="number">1</span>].sum;</span><br><span class="line">    <span class="type">int</span> v = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(top[p] != top[v])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(dep[top[p]] &lt; dep[top[v]]) <span class="built_in">swap</span>(p, v);</span><br><span class="line">        <span class="built_in">segadd</span>(<span class="number">1</span>, id[top[p]], id[p], <span class="number">1</span>);</span><br><span class="line">        p = fa[top[p]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(dep[p] &lt; dep[v]) <span class="built_in">swap</span>(p, v);</span><br><span class="line">    <span class="built_in">segadd</span>(<span class="number">1</span>, id[v], id[p], <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> tr[<span class="number">1</span>].sum - <span class="number">114514</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">uninstall</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll prev = tr[<span class="number">1</span>].sum;</span><br><span class="line">    <span class="built_in">segadd</span>(<span class="number">1</span>, id[p], id[p] + sz[p] - <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">114514</span> - tr[<span class="number">1</span>].sum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(h, <span class="number">-1</span>, <span class="built_in">sizeof</span>(h));</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> a;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a);</span><br><span class="line">        a++;</span><br><span class="line">        <span class="built_in">add</span>(a, i);</span><br><span class="line">        <span class="built_in">add</span>(i, a);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dfs1</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">dfs2</span>(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;m);</span><br><span class="line">    <span class="keyword">while</span>(m--)</span><br><span class="line">    &#123;</span><br><span class="line">        string s;</span><br><span class="line">        <span class="type">int</span> x;</span><br><span class="line">        cin &gt;&gt; s;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">        <span class="keyword">if</span>(s[<span class="number">0</span>] == <span class="string">&#x27;i&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">install</span>(x + <span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(s[<span class="number">0</span>] == <span class="string">&#x27;u&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">uninstall</span>(x + <span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;Youwike AK IOI!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">114514</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>é¢˜è§£</tag>
        <tag>æ ‘é“¾å‰–åˆ†</tag>
      </tags>
  </entry>
  <entry>
    <title>P2414 [NOI2011] é˜¿ç‹¸çš„æ‰“å­—æœº é¢˜è§£</title>
    <url>/solutions/solution-p2414/</url>
    <content><![CDATA[<p>Luogu P2414<br>LibreOJ #2444</p>
<p>NOI 2011</p>
<span id="more"></span>
<hr>
<p>é¢˜ç›®è¿™ä¸ªæ ·å­å°±ç›¸å½“äºæ˜¯æ„é€ äº†ä¸€ä¸ªå­—ç¬¦ä¸²çš„é›†åˆï¼ŒåŒæ—¶è¯¢é—®æˆ‘ä»¬æŸä¸€ä¸ªå­—ç¬¦ä¸²åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²å†…å‡ºç°äº†å¤šå°‘æ¬¡ã€‚</p>
<p>é¦–å…ˆçœ‹ä¸€ä¸‹æ•°æ®èŒƒå›´ï¼š<br>å­—ç¬¦ä¸²æ•°é‡ $n \leq 10^5$ï¼Œè¯¢é—®æ•°é‡ $m \leq 10^5$ã€‚</p>
<p>å†µä¸”å­—ç¬¦ä¸²çš„è¾“å…¥æ ¼å¼è¿˜ç‰¹åˆ«å¥‡æ€ªï¼š</p>
<blockquote>
<p>é˜¿ç‹¸å–œæ¬¢æ”¶è—å„ç§ç¨€å¥‡å¤æ€ªçš„ä¸œè¥¿ï¼Œæœ€è¿‘ä»–æ·˜åˆ°ä¸€å°è€å¼çš„æ‰“å­—æœºã€‚æ‰“å­—æœºä¸Šåªæœ‰ $28$ ä¸ªæŒ‰é”®ï¼Œåˆ†åˆ«å°æœ‰ $26$ ä¸ªå°å†™è‹±æ–‡å­—æ¯å’Œ <code>B</code>ã€<code>P</code> ä¸¤ä¸ªå­—æ¯ã€‚ç»é˜¿ç‹¸ç ”ç©¶å‘ç°ï¼Œè¿™ä¸ªæ‰“å­—æœºæ˜¯è¿™æ ·å·¥ä½œçš„ï¼š</p>
<ul>
<li>è¾“å…¥å°å†™å­—æ¯ï¼Œæ‰“å­—æœºçš„ä¸€ä¸ªå‡¹æ§½ä¸­ä¼šåŠ å…¥è¿™ä¸ªå­—æ¯(è¿™ä¸ªå­—æ¯åŠ åœ¨å‡¹æ§½çš„æœ€å)ã€‚</li>
<li>æŒ‰ä¸€ä¸‹å°æœ‰ <code>B</code> çš„æŒ‰é”®ï¼Œæ‰“å­—æœºå‡¹æ§½ä¸­æœ€åä¸€ä¸ªå­—æ¯ä¼šæ¶ˆå¤±ã€‚</li>
<li>æŒ‰ä¸€ä¸‹å°æœ‰ <code>P</code> çš„æŒ‰é”®ï¼Œæ‰“å­—æœºä¼šåœ¨çº¸ä¸Šæ‰“å°å‡ºå‡¹æ§½ä¸­ç°æœ‰çš„æ‰€æœ‰å­—æ¯å¹¶æ¢è¡Œï¼Œä½†å‡¹æ§½ä¸­çš„å­—æ¯ä¸ä¼šæ¶ˆå¤±ã€‚</li>
</ul>
<p>ä¾‹å¦‚ï¼Œé˜¿ç‹¸è¾“å…¥ <code>aPaPBbP</code>ï¼Œçº¸ä¸Šè¢«æ‰“å°çš„å­—ç¬¦å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a</span><br><span class="line">aa</span><br><span class="line">ab</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬æŠŠçº¸ä¸Šæ‰“å°å‡ºæ¥çš„å­—ç¬¦ä¸²ä» $1$ å¼€å§‹é¡ºåºç¼–å·ï¼Œä¸€ç›´åˆ° $n$ã€‚</p>
</blockquote>
<p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥ç”±æ­¤è”æƒ³åˆ°Trieï¼Œä»¥åŠä»¥å…¶ä¸ºåŸºç¡€çš„ACè‡ªåŠ¨æœºã€‚</p>
<p>ACè‡ªåŠ¨æœºæ˜¯æœ‰å­—ç¬¦ä¸²åŒ¹é…çš„åŠŸèƒ½çš„ï¼Œä½†æ˜¯è¿™æ ·ç›´æ¥åŒ¹é…è¿˜æ˜¯æœ‰ç‚¹æ…¢ã€‚<br>å…¶æ¯ä¸€æ¬¡è¯¢é—®çš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ä¸æ–‡æœ¬ä¸²çš„é•¿åº¦æˆæ­£ç›¸å…³çš„ã€‚</p>
<p>å½“ç„¶æˆ‘ä»¬å¯ä»¥æƒ³åˆ°ç¦»çº¿è¯¢é—®ï¼Œå¯¹äºå¤„ç†ç›¸åŒæ–‡æœ¬ä¸²çš„è¯¢é—®ç¡®å®æ˜¯èŠ‚çœäº†æ—¶é—´ã€‚</p>
<p>åŒæ—¶æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªæ€§è´¨ï¼š</p>
<p><strong>æˆ‘ä»¬çš„æ‰€æœ‰æ–‡æœ¬ä¸²å‡ä¼šå‡ºç°åœ¨ACè‡ªåŠ¨æœºä¸­ã€‚</strong></p>
<p>æˆ–è€…è¯´ï¼Œæˆ‘ä»¬ç›¸å½“äºæ˜¯æ‹¿æ¨¡å¼ä¸²ä¸æ¨¡å¼ä¸²ç›¸æ¯”å¯¹ã€‚</p>
<p>è¿™æ ·æˆ‘ä»¬å°±å®Œå…¨æ˜¯åœ¨ACè‡ªåŠ¨æœºå†…éƒ¨åšåŒ¹é…ï¼Œä¸éœ€è¦è€ƒè™‘ä»€ä¹ˆè¢«æŠ›å¼ƒçš„éƒ¨åˆ†äº†ã€‚</p>
<hr>
<p>å¦‚ä½•è§£å†³è¯¢é—®ï¼Ÿ</p>
<p>æˆ‘ä»¬åˆšæ‰è€ƒè™‘è¿‡ç¦»çº¿å¹¶æŒ‰ç…§æ–‡æœ¬ä¸²åˆ†ç»„ã€‚</p>
<p>æˆ‘ä»¬å¯¹äºæŸä¸€ä¸ªæ–‡æœ¬ä¸²ï¼Œè¦å¦‚ä½•æ‰èƒ½ææºœå‡ºæ¥å…¶æ‰€æœ‰çš„å­ä¸²å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬è€ƒè™‘è¿™æ ·ä¸€ä¸ªæœ‰å…³failè¾¹çš„æ€§è´¨ï¼š</p>
<blockquote>
<p>ç”±äºfailè¾¹è·³åˆ°çš„æ˜¯å½“å‰å­—ç¬¦ä¸²åœ¨Trieå†…å­˜åœ¨çš„æœ€é•¿åç¼€ï¼Œä¸”å¦‚æœå½“å‰çš„æ¨¡å¼ä¸²å‡ºç°åœ¨äº†æ–‡æœ¬ä¸²å†…çš„è¯ï¼Œå…¶å­ä¸²ä¹Ÿä¼šå‡ºç°åœ¨æ–‡æœ¬ä¸²å†…ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ²¿ç€failæŒ‡é’ˆä¸€è·¯éå†å½“å‰æ¨¡å¼ä¸²çš„æ‰€æœ‰åç¼€ã€‚</p>
</blockquote>
<p>æ‰€ä»¥å¯¹äºæŸä¸€ä¸ªå­—ç¬¦ä¸² $s$ï¼Œä»æ ¹èŠ‚ç‚¹åˆ°ä»£è¡¨ $s$ çš„èŠ‚ç‚¹çš„è¿™ä¸€æ¡è·¯å¾„ä¸Šæ‰€æœ‰èŠ‚ç‚¹åŠæ²¿ç€å…¶failæŒ‡é’ˆè·³åˆ°æ ¹èŠ‚ç‚¹çš„æ‰€æœ‰è·¯å¾„ä¸Šçš„ç‚¹ä»£è¡¨çš„å­—ç¬¦ä¸²éƒ½åœ¨ $s$ é‡Œé¢å‡ºç°è¿‡ã€‚</p>
<p>è¿™å…¶ä¸­åŒ…å«äº† $s$ çš„æ‰€æœ‰å­ä¸²ï¼Œå› ä¸ºå…¶çš„æŸä¸ªå­ä¸²ä¸€å®šæ˜¯æŸä¸€ä¸ªåç¼€çš„æŸä¸ªå‰ç¼€ã€‚</p>
<hr>
<p>æ—¢ç„¶è¿™ä¸ªæ ·å­äº†ï¼Œæˆ‘ä»¬ä¸å¦‚å°±ä¸ç›´æ¥éå†æ•´ä¸ªACè‡ªåŠ¨æœºï¼Œè€Œå•ç‹¬æŠŠfailæŒ‡é’ˆææºœå‡ºæ¥å»ºæˆä¸€å¼ å›¾éå†å¥½äº†ã€‚</p>
<p>è¿™é‡Œè¿˜é™„åŠ äº†ä¸€ä¸ªç‰¹æ®Šæ€§è´¨ï¼Œå°±æ˜¯æˆ‘ä»¬å•ç‹¬æŠŠfailæŒ‡é’ˆæ‹å‡ºæ¥ä¹‹åä¼šæ„å»ºå‡ºæ¥ä¸€æ£µæ ‘ï¼Œè€Œä¸æ˜¯ä¸€å¼ å›¾ã€‚</p>
<p>ç„¶åæˆ‘ä»¬è€ƒè™‘è®°å½•ä¸¤ä¸ªå€¼ï¼šå½“å‰èŠ‚ç‚¹çš„DFSåºå’Œå›æº¯åˆ°å½“å‰èŠ‚ç‚¹æ—¶çš„æ—¶é—´ã€‚</p>
<p>æˆ‘ä»¬è®°å½•äº†è¿™ä¸¤ä¸ªå€¼ä»¥åï¼Œå°±å¯ä»¥å•ç‹¬æŠŠè¿™ä¸ªèŠ‚ç‚¹çš„å­æ ‘ç»™ææºœå‡ºæ¥äº†ã€‚</p>
<p>ç”±äºæˆ‘ä»¬failè¾¹æŒ‡å‘çš„æ˜¯å½“å‰å­—ç¬¦ä¸²çš„æœ€é•¿åç¼€ï¼Œé‚£ä¹ˆæˆ‘ä»¬failæ ‘é‡Œé¢æŸä¸€ä¸ªèŠ‚ç‚¹ç»å¯¹æ˜¯å…¶å­æ ‘å†…æ‰€æœ‰ç‚¹çš„æŸä¸€ä¸ªåç¼€ã€‚<br>é‚£ä¹ˆå¦‚æœè¿™ä¸ªèŠ‚ç‚¹å‡ºç°è¿‡ä¸€æ¬¡ï¼Œé‚£ä¹ˆè¿™ä¸ªèŠ‚ç‚¹ä»£è¡¨çš„å­—ç¬¦ä¸²åœ¨å…¶å­æ ‘å†…èŠ‚ç‚¹æ‰€ä»£è¡¨çš„å­—ç¬¦ä¸²å†…å°±å¿…å®šå‡ºç°è¿‡ä¸€æ¬¡ã€‚<br>åŒç†ï¼Œå¦‚æœè¿™ä¸ªèŠ‚ç‚¹çš„å­æ ‘å†…çš„èŠ‚ç‚¹ä»£è¡¨çš„å­—ç¬¦ä¸²å‡ºç°è¿‡ä¸€æ¬¡ï¼Œè¿™ä¸ªèŠ‚ç‚¹ä»£è¡¨çš„å­—ç¬¦ä¸²å¿…å®šä¹Ÿå‡ºç°è¿‡ä¸€æ¬¡ã€‚<br>æ‰€ä»¥æˆ‘ä»¬ç»Ÿè®¡æŸä¸€ä¸ªå­—ç¬¦ä¸²å‡ºç°çš„æ¬¡æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦ç»Ÿè®¡è¯¥èŠ‚ç‚¹åŠå…¶å­æ ‘çš„æ‰€æœ‰ä¿¡æ¯ã€‚</p>
<p>é‚£æˆ‘ä»¬å¥½åƒå¯ä»¥ä½¿ç”¨æ ‘çŠ¶æ•°ç»„æˆ–çº¿æ®µæ ‘ç»´æŠ¤â€¦â€¦</p>
<hr>
<p>é‚£æˆ‘ä»¬æ€ä¹ˆç»Ÿè®¡ä¿¡æ¯å‘¢ï¼Ÿ</p>
<p>é¡ºåºéå†å­—ç¬¦ä¸²å³å¯ã€‚<br>åŒæ—¶è¿˜è¦æ²¿ç€ACè‡ªåŠ¨æœºè·³ã€‚</p>
<p>æ¯ä¸€æ¬¡é‡åˆ°ä¸€ä¸ªæ–°çš„å­—ç¬¦çš„æ—¶å€™åˆ†ç±»è®¨è®ºï¼š</p>
<ul>
<li>å¦‚æœæ˜¯å°å†™å­—æ¯ï¼Œé‚£å°±æ²¿ç€ACè‡ªåŠ¨æœºè·³ï¼ŒåŒæ—¶è¯¥èŠ‚ç‚¹å‡ºç°çš„æ¬¡æ•°<code>+1</code>ã€‚</li>
<li>å¦‚æœæ˜¯ <code>P</code>ï¼Œé‚£å°±æ„å‘³ç€ï¼ˆå¯èƒ½ï¼‰æœ‰è¯¢é—®éœ€è¦å¤„ç†ã€‚éå†æ‰€æœ‰è¯¥å­—ç¬¦ä¸²ä¸‹çš„è¯¢é—®ï¼Œå¹¶å­˜å‚¨ç­”æ¡ˆã€‚</li>
<li>å¦‚æœæ˜¯ <code>B</code>ï¼Œé‚£å°±æ„å‘³ç€ä¸Šä¸€ä¸ªå­—ç¬¦ä¸²éå†çš„æ‰€æœ‰ä¿¡æ¯å°±ä¸ç®—äº†ï¼Œè¯¥èŠ‚ç‚¹å‡ºç°çš„æ¬¡æ•°<code>-1</code>ï¼ŒåŒæ—¶è·³åˆ°å½“å‰èŠ‚ç‚¹çš„çˆ¶äº²ã€‚</li>
</ul>
<p>åˆ†æå®Œæ¯•ã€‚</p>
<hr>
<p>ç„¶åæ˜¯ä»£ç éƒ¨åˆ†ï¼š</p>
<p>ACè‡ªåŠ¨æœºï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">AC</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> s[<span class="number">26</span>];</span><br><span class="line">    <span class="type">int</span> v, fail, fa;</span><br><span class="line">&#125;tr[N];</span><br><span class="line"><span class="type">int</span> cnt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    len = <span class="built_in">strlen</span>(s);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, now = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(s[i] &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; s[i] &lt;= <span class="string">&#x27;z&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(!tr[now].s[s[i] - <span class="string">&#x27;a&#x27;</span>])</span><br><span class="line">            &#123;</span><br><span class="line">                tr[now].s[s[i] - <span class="string">&#x27;a&#x27;</span>] = ++cnt;</span><br><span class="line">                tr[cnt].fa = now;</span><br><span class="line">            &#125;</span><br><span class="line">            now = tr[now].s[s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(s[i] == <span class="string">&#x27;P&#x27;</span>)</span><br><span class="line">            a[++n] = now;</span><br><span class="line">        <span class="keyword">if</span>(s[i] == <span class="string">&#x27;B&#x27;</span>)</span><br><span class="line">            now = tr[now].fa;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build_fail</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    queue&lt;<span class="type">int</span>&gt;q;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++)</span><br><span class="line">        <span class="keyword">if</span>(tr[<span class="number">0</span>].s[i])q.<span class="built_in">push</span>(tr[<span class="number">0</span>].s[i]);</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> u = q.<span class="built_in">front</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(tr[u].s[i])</span><br><span class="line">            &#123;</span><br><span class="line">                tr[tr[u].s[i]].fail = tr[tr[u].fail].s[i];</span><br><span class="line">                q.<span class="built_in">push</span>(tr[u].s[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                tr[u].s[i] = tr[tr[u].fail].s[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>dfsä»¥åŠç›¸å…³ä¿¡æ¯å­˜å‚¨ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> h[N], e[M], ne[M], idx;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[++idx] = b, ne[idx] = h[a], h[a] = idx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> a[N];</span><br><span class="line"><span class="type">int</span> dfn[N], out[N], indx;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä¸­é—´ç•¥è¿‡ä¸€æ®µâ€¦â€¦ */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    dfn[u] = ++indx;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h[u]; ~i; i = ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> v = e[i];</span><br><span class="line">        <span class="keyword">if</span>(v ^ p)<span class="built_in">dfs</span>(v, u);</span><br><span class="line">    &#125;</span><br><span class="line">    out[u] = indx;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ï¼ˆæ ‘çŠ¶æ•°ç»„å°±ä¸å†™äº†ï¼‰</p>
<p>ä¸»å‡½æ•°ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">query</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> x, id;</span><br><span class="line">&#125;;</span><br><span class="line">vector&lt;query&gt;g[N];</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> ans[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(h, <span class="number">-1</span>, <span class="built_in">sizeof</span>(h));</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s);</span><br><span class="line">    <span class="built_in">insert</span>();</span><br><span class="line">    <span class="built_in">build_fail</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= cnt; i++)</span><br><span class="line">        <span class="built_in">add</span>(i, tr[i].fail), <span class="built_in">add</span>(tr[i].fail, i);</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    m = <span class="built_in">read</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> x = <span class="built_in">read</span>(), y = <span class="built_in">read</span>();</span><br><span class="line">        g[y].<span class="built_in">push_back</span>(&#123; x,i &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, now = <span class="number">0</span>, j = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(s[i] == <span class="string">&#x27;P&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            j++;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>; k &lt; g[j].<span class="built_in">size</span>(); k++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">int</span> x = g[j][k].x, id = g[j][k].id;</span><br><span class="line">                ans[id] = <span class="built_in">segsum</span>(out[a[x]]) - <span class="built_in">segsum</span>(dfn[a[x]] - <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(s[i] == <span class="string">&#x27;B&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">segadd</span>(dfn[now], <span class="number">-1</span>);</span><br><span class="line">            now = tr[now].fa;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(s[i] &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; s[i] &lt;= <span class="string">&#x27;z&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            now = tr[now].s[s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">            <span class="built_in">segadd</span>(dfn[now], <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœ€åæ”¾ä¸€éå…¨éƒ¨åŠ èµ·æ¥çš„ï¼š</p>
<details class="note success"><summary><p>ç¤ºä¾‹ä»£ç </p>
</summary>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">100010</span>, M = N &lt;&lt; <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> x = <span class="number">0</span>, flag = <span class="number">1</span>; <span class="type">char</span> c;</span><br><span class="line">    <span class="keyword">while</span>((c = <span class="built_in">getchar</span>()) &lt; <span class="string">&#x27;0&#x27;</span> || c &gt; <span class="string">&#x27;9&#x27;</span>) <span class="keyword">if</span>(c == <span class="string">&#x27;-&#x27;</span>) flag = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">while</span>(c &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span>) x = (x &lt;&lt; <span class="number">3</span>) + (x &lt;&lt; <span class="number">1</span>) + (c ^ <span class="number">48</span>), c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">return</span> x * flag;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">char</span> s[N];</span><br><span class="line"><span class="type">int</span> len;</span><br><span class="line"><span class="type">int</span> h[N], e[M], ne[M], idx;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[++idx] = b, ne[idx] = h[a], h[a] = idx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> a[N];</span><br><span class="line"><span class="type">int</span> dfn[N], out[N], indx;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">AC</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> s[<span class="number">26</span>];</span><br><span class="line">    <span class="type">int</span> v, fail, fa;</span><br><span class="line">&#125;tr[N];</span><br><span class="line"><span class="type">int</span> cnt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    len = <span class="built_in">strlen</span>(s);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, now = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(s[i] &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; s[i] &lt;= <span class="string">&#x27;z&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(!tr[now].s[s[i] - <span class="string">&#x27;a&#x27;</span>])</span><br><span class="line">            &#123;</span><br><span class="line">                tr[now].s[s[i] - <span class="string">&#x27;a&#x27;</span>] = ++cnt;</span><br><span class="line">                tr[cnt].fa = now;</span><br><span class="line">            &#125;</span><br><span class="line">            now = tr[now].s[s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(s[i] == <span class="string">&#x27;P&#x27;</span>)</span><br><span class="line">            a[++n] = now;</span><br><span class="line">        <span class="keyword">if</span>(s[i] == <span class="string">&#x27;B&#x27;</span>)</span><br><span class="line">            now = tr[now].fa;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build_fail</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    queue&lt;<span class="type">int</span>&gt;q;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++)</span><br><span class="line">        <span class="keyword">if</span>(tr[<span class="number">0</span>].s[i])q.<span class="built_in">push</span>(tr[<span class="number">0</span>].s[i]);</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> u = q.<span class="built_in">front</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(tr[u].s[i])</span><br><span class="line">            &#123;</span><br><span class="line">                tr[tr[u].s[i]].fail = tr[tr[u].fail].s[i];</span><br><span class="line">                q.<span class="built_in">push</span>(tr[u].s[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                tr[u].s[i] = tr[tr[u].fail].s[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    dfn[u] = ++indx;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h[u]; ~i; i = ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> v = e[i];</span><br><span class="line">        <span class="keyword">if</span>(v ^ p)<span class="built_in">dfs</span>(v, u);</span><br><span class="line">    &#125;</span><br><span class="line">    out[u] = indx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lowbit</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x &amp; -x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> c[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">segadd</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = x; i &lt;= indx; i += <span class="built_in">lowbit</span>(i))</span><br><span class="line">        c[i] += v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">segsum</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = x; i &gt; <span class="number">0</span>; i -= <span class="built_in">lowbit</span>(i))</span><br><span class="line">        ans += c[i];</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">query</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> x, id;</span><br><span class="line">&#125;;</span><br><span class="line">vector&lt;query&gt;g[N];</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> ans[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(h, <span class="number">-1</span>, <span class="built_in">sizeof</span>(h));</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s);</span><br><span class="line">    <span class="built_in">insert</span>();</span><br><span class="line">    <span class="built_in">build_fail</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= cnt; i++)</span><br><span class="line">        <span class="built_in">add</span>(i, tr[i].fail), <span class="built_in">add</span>(tr[i].fail, i);</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    m = <span class="built_in">read</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> x = <span class="built_in">read</span>(), y = <span class="built_in">read</span>();</span><br><span class="line">        g[y].<span class="built_in">push_back</span>(&#123; x,i &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, now = <span class="number">0</span>, j = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(s[i] == <span class="string">&#x27;P&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            j++;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>; k &lt; g[j].<span class="built_in">size</span>(); k++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">int</span> x = g[j][k].x, id = g[j][k].id;</span><br><span class="line">                ans[id] = <span class="built_in">segsum</span>(out[a[x]]) - <span class="built_in">segsum</span>(dfn[a[x]] - <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(s[i] == <span class="string">&#x27;B&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">segadd</span>(dfn[now], <span class="number">-1</span>);</span><br><span class="line">            now = tr[now].fa;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(s[i] &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; s[i] &lt;= <span class="string">&#x27;z&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            now = tr[now].s[s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">            <span class="built_in">segadd</span>(dfn[now], <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</details>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>å­—ç¬¦ä¸²</tag>
        <tag>é¢˜è§£</tag>
        <tag>ACè‡ªåŠ¨æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>P3586 [POI2015] Logistyka é¢˜è§£</title>
    <url>/solutions/solution-p3586/</url>
    <content><![CDATA[<p>Luogu P3586</p>
<p>POI 2015</p>
<span id="more"></span>
<hr>
<h1 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h1><p>è¿™é“é¢˜æƒ³è®©æˆ‘ä»¬ç»´æŠ¤ä¸€ä¸ªæ•°åˆ—ï¼Œæ”¯æŒå¯¹å…¶çš„ä¿®æ”¹ä¸è¯¢é—®ã€‚</p>
<p>é¢˜ç›®ç»™å‡ºäº†ä¸¤ç§æ“ä½œï¼š</p>
<ol>
<li><code>U k a</code> å°†åºåˆ—ä¸­ç¬¬ $k$ ä¸ªæ•°ä¿®æ”¹ä¸º $a$ã€‚</li>
<li><code>Z c s</code> åœ¨è¿™ä¸ªåºåˆ—ä¸Šï¼Œæ¯æ¬¡é€‰å‡º $c$ ä¸ªæ­£æ•°ï¼Œå¹¶å°†å®ƒä»¬éƒ½å‡å» $1$ï¼Œè¯¢é—®èƒ½å¦è¿›è¡Œ $s$ æ¬¡æ“ä½œã€‚</li>
</ol>
<p>å›ç­”è¯¢é—®çš„æ€è·¯æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š</p>
<p>æˆ‘ä»¬å‡è®¾åœ¨è¿™ä¸ªæ•°åˆ—é‡Œé¢ï¼Œ$( 0,s )$ èŒƒå›´å†…çš„æ•°æœ‰ $x$ ä¸ªï¼Œ$[ s, \infty )$ èŒƒå›´å†…çš„æ•°æœ‰ $y$ ä¸ªã€‚</p>
<p>å¦‚æœ $x+y &lt; c$ çš„è¯å°±ç»å¯¹ä¸è¡Œï¼Œç›´æ¥è¿”å› <code>NIE</code>ã€‚</p>
<p>æˆ‘ä»¬è´ªä¸€ä¸‹å¿ƒï¼Œåæ­£é¢˜ç›®è¯¢é—®çš„æ˜¯å¯è¡Œæ€§ï¼Œä¸å¦‚å°±å…ˆè®©ç€ $y$ ä¸ªæ•°å…ˆé¡¶ä¸Šã€‚</p>
<p>å¦‚æœè¿™ $y$ ä¸ªæ•°éƒ½é¡¶ä¸Šå»ä¹‹åå°±å¯ä»¥å®Œæˆä»»åŠ¡ï¼Œç”šè‡³è¿˜æœ‰äº›å¯Œä½™ï¼Œå°±å¯ä»¥ç›´æ¥è¿”å› <code>TAK</code>ã€‚<br>è€Œå¦‚æœ $y &lt; c$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦ç»§ç»­å¾€ä¸‹è®¨è®ºã€‚</p>
<p>æˆ‘ä»¬è€ƒè™‘è®©å‰©ä¸‹çš„æ•°é¡¶ä¸Šå»ã€‚</p>
<p>å¦‚æœè¿™äº›æ•°å­—çš„å’Œå°äº $s \times c$ï¼Œé‚£å°±ç»å¯¹å®Œä¸æˆä»»åŠ¡ã€‚<br>åä¹‹åˆ™ä¸€å®šå®Œå¾—æˆä»»åŠ¡ã€‚</p>
<p>QED.</p>
<hr>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦ç»´æŠ¤ä¸¤ä¸ªä¿¡æ¯ï¼Œä¸€æ˜¯å¤§äºæŸä¸ªæ•°çš„æ•°æœ‰å¤šå°‘ä¸ªï¼ŒäºŒæ˜¯å¤§äºæŸä¸ªæ•°çš„æ‰€æœ‰æ•°ä¹‹å’Œã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ ‘çŠ¶æ•°ç»„ã€‚</p>
<p>ä½†æ˜¯æˆ‘ä¸ä¼šï¼Œæ‰€ä»¥å°±ç”¨åŠ¨æ€å¼€ç‚¹æƒå€¼çº¿æ®µæ ‘äº†ã€‚</p>
<p>æˆ‘ä»¬è€ƒè™‘ç»“æ„ä½“é‡Œé¢å­˜ä»€ä¹ˆï¼š</p>
<p>é¦–å…ˆæˆ‘ä»¬éœ€è¦å­˜åŒºé—´å·¦å³ç«¯ç‚¹ï¼ˆæŒ‰ä¸ªäººæƒ…å†µï¼‰å’Œå·¦å³å„¿å­ã€‚<br>æˆ‘ä»¬è¿˜éœ€è¦ç»´æŠ¤åŒºé—´å†…æ•°çš„ä¸ªæ•°ã€‚</p>
<p>ä¸ºäº†ä¸å¤šå†™æ•°æ®ç»“æ„ï¼Œæˆ‘ä¹Ÿå°†ç¬¬äºŒä¸ªè¦æ±‚å†™è¿›äº†çº¿æ®µæ ‘é‡Œé¢ã€‚</p>
<p>äºæ˜¯æˆ‘çš„ç»“æ„ä½“é•¿çš„æ˜¯è¿™ä¸ªæ ·å­ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">SegTree</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    <span class="type">int</span> ls, rs;</span><br><span class="line">    ll sum;</span><br><span class="line">    ll tot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ <code>sum</code> ç»´æŠ¤çš„æ˜¯å½“å‰åŒºé—´å†…æ•°çš„ä¸ªæ•°ï¼Œ<code>tot</code> ç»´æŠ¤çš„æ˜¯å½“å‰åŒºé—´å†…æ‰€æœ‰æ•°çš„å’Œã€‚ä¸¤è€…åŒæ—¶ç»´æŠ¤ï¼Œä½†æ˜¯æŸ¥è¯¢çš„æ—¶å€™æ˜¯åˆ†å¼€çš„ã€‚</p>
<p>çº¿æ®µæ ‘éƒ¨åˆ†ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">SegTree</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    <span class="type">int</span> ls, rs;</span><br><span class="line">    ll sum;</span><br><span class="line">    ll tot;</span><br><span class="line">&#125;tr[N &lt;&lt; <span class="number">3</span>];</span><br><span class="line"><span class="type">int</span> idx;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">segadd</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> pos, ll k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(tr[p].l == tr[p].r)</span><br><span class="line">    &#123;</span><br><span class="line">        tr[p].sum += k;</span><br><span class="line">        tr[p].tot = tr[p].sum * tr[p].l;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid = (tr[p].l + tr[p].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(pos &lt;= mid)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!tr[p].ls)</span><br><span class="line">        &#123;</span><br><span class="line">            tr[p].ls = ++idx;</span><br><span class="line">            tr[tr[p].ls].l = tr[p].l;</span><br><span class="line">            tr[tr[p].ls].r = mid;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">segadd</span>(tr[p].ls, pos, k);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(pos &gt; mid)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!tr[p].rs)</span><br><span class="line">        &#123;</span><br><span class="line">            tr[p].rs = ++idx;</span><br><span class="line">            tr[tr[p].rs].l = mid + <span class="number">1</span>;</span><br><span class="line">            tr[tr[p].rs].r = tr[p].r;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">segadd</span>(tr[p].rs, pos, k);</span><br><span class="line">    &#125;</span><br><span class="line">    tr[p].sum = tr[tr[p].ls].sum + tr[tr[p].rs].sum;</span><br><span class="line">    tr[p].tot = tr[tr[p].ls].tot + tr[tr[p].rs].tot;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">segsum</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;<span class="comment">//æ±‚åŒºé—´å†…æ•°çš„ä¸ªæ•°</span></span><br><span class="line">    <span class="keyword">if</span>(!p)<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(tr[p].l &gt;= l &amp;&amp; tr[p].r &lt;= r)<span class="keyword">return</span> tr[p].sum;</span><br><span class="line">    <span class="type">int</span> mid = (tr[p].l + tr[p].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    ll res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid)res += <span class="built_in">segsum</span>(tr[p].ls, l, r);</span><br><span class="line">    <span class="keyword">if</span>(r &gt; mid)res += <span class="built_in">segsum</span>(tr[p].rs, l, r);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">segtot</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;<span class="comment">//æ±‚åŒºé—´å†…æ‰€æœ‰æ•°çš„å’Œ</span></span><br><span class="line">    <span class="keyword">if</span>(!p)<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(tr[p].l &gt;= l &amp;&amp; tr[p].r &lt;= r)<span class="keyword">return</span> tr[p].tot;</span><br><span class="line">    <span class="type">int</span> mid = (tr[p].l + tr[p].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    ll res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid)res += <span class="built_in">segtot</span>(tr[p].ls, l, r);</span><br><span class="line">    <span class="keyword">if</span>(r &gt; mid)res += <span class="built_in">segtot</span>(tr[p].rs, l, r);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h1><p>ï¼ˆéœ€è¦O2ï¼‰</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1000010</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line">ll a[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SegTree</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    <span class="type">int</span> ls, rs;</span><br><span class="line">    ll sum;</span><br><span class="line">    ll tot;</span><br><span class="line">&#125;tr[N &lt;&lt; <span class="number">3</span>];</span><br><span class="line"><span class="type">int</span> idx;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">segadd</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> pos, ll k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(tr[p].l == tr[p].r)</span><br><span class="line">    &#123;</span><br><span class="line">        tr[p].sum += k;</span><br><span class="line">        tr[p].tot = tr[p].sum * tr[p].l;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid = (tr[p].l + tr[p].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(pos &lt;= mid)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!tr[p].ls)</span><br><span class="line">        &#123;</span><br><span class="line">            tr[p].ls = ++idx;</span><br><span class="line">            tr[tr[p].ls].l = tr[p].l;</span><br><span class="line">            tr[tr[p].ls].r = mid;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">segadd</span>(tr[p].ls, pos, k);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(pos &gt; mid)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!tr[p].rs)</span><br><span class="line">        &#123;</span><br><span class="line">            tr[p].rs = ++idx;</span><br><span class="line">            tr[tr[p].rs].l = mid + <span class="number">1</span>;</span><br><span class="line">            tr[tr[p].rs].r = tr[p].r;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">segadd</span>(tr[p].rs, pos, k);</span><br><span class="line">    &#125;</span><br><span class="line">    tr[p].sum = tr[tr[p].ls].sum + tr[tr[p].rs].sum;</span><br><span class="line">    tr[p].tot = tr[tr[p].ls].tot + tr[tr[p].rs].tot;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">segsum</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!p)<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(tr[p].l &gt;= l &amp;&amp; tr[p].r &lt;= r)<span class="keyword">return</span> tr[p].sum;</span><br><span class="line">    <span class="type">int</span> mid = (tr[p].l + tr[p].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    ll res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid)res += <span class="built_in">segsum</span>(tr[p].ls, l, r);</span><br><span class="line">    <span class="keyword">if</span>(r &gt; mid)res += <span class="built_in">segsum</span>(tr[p].rs, l, r);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">segtot</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!p)<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(tr[p].l &gt;= l &amp;&amp; tr[p].r &lt;= r)<span class="keyword">return</span> tr[p].tot;</span><br><span class="line">    <span class="type">int</span> mid = (tr[p].l + tr[p].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    ll res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid)res += <span class="built_in">segtot</span>(tr[p].ls, l, r);</span><br><span class="line">    <span class="keyword">if</span>(r &gt; mid)res += <span class="built_in">segtot</span>(tr[p].rs, l, r);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="type">int</span> maxn = <span class="number">0</span>;</span><br><span class="line">    tr[++idx] = &#123; <span class="number">0</span>,<span class="number">100000001</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span> &#125;;</span><br><span class="line">    <span class="keyword">while</span>(m--)</span><br><span class="line">    &#123;</span><br><span class="line">        string op;</span><br><span class="line">        <span class="type">int</span> x, k;</span><br><span class="line">        cin &gt;&gt; op;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;x, &amp;k);</span><br><span class="line">        <span class="keyword">if</span>(op[<span class="number">0</span>] == <span class="string">&#x27;U&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(k &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">segadd</span>(<span class="number">1</span>, k, <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(a[x] &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">segadd</span>(<span class="number">1</span>, a[x], <span class="number">-1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            a[x] = k;</span><br><span class="line">            maxn = <span class="built_in">max</span>(maxn, k);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op[<span class="number">0</span>] == <span class="string">&#x27;Z&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            ll pos = <span class="built_in">segsum</span>(<span class="number">1</span>, <span class="number">1</span>, maxn), cnt = <span class="built_in">segsum</span>(<span class="number">1</span>, <span class="number">1</span>, k);</span><br><span class="line">            <span class="keyword">if</span>(pos &lt; x)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">puts</span>(<span class="string">&quot;NIE&quot;</span>);</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(pos - cnt &gt;= x)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">puts</span>(<span class="string">&quot;TAK&quot;</span>);</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            ll tot = <span class="built_in">segtot</span>(<span class="number">1</span>, <span class="number">1</span>, k);</span><br><span class="line">            <span class="keyword">if</span>(tot &gt;= (x + cnt - pos) * k)</span><br><span class="line">                <span class="built_in">puts</span>(<span class="string">&quot;TAK&quot;</span>);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="built_in">puts</span>(<span class="string">&quot;NIE&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>é¢˜è§£</tag>
        <tag>çº¿æ®µæ ‘</tag>
      </tags>
  </entry>
  <entry>
    <title>P3644 [APIO2015] å…«é‚»æ—ä¹‹æ¡¥ é¢˜è§£</title>
    <url>/solutions/solution-p3644/</url>
    <content><![CDATA[<p>Luogu P3644<br>LibreOJ #2888</p>
<p>APIO 2015</p>
<span id="more"></span>
<hr>
<p>é¢˜ç›®å¤§æ„ï¼š</p>
<p>ç°åœ¨æœ‰ä¸€æ¡æ²³ï¼Œå°†å·´é‚»æ—å¸‚åˆ†æˆäº† $A$ã€$B$ ä¸¤ä¸ªåŒºåŸŸã€‚<br>æ²³çš„ä¸¤å²¸å‡æœ‰ $10^9+1$ æ ‹æˆ¿å­ã€‚æ¯ä¸€æ ‹æˆ¿å­å‡æœ‰å…¶ç¼–å·ï¼Œä» $A_1,B_1$ ä¸€ç›´åˆ° $A_{10^9+1},B_{10^9+1}$ã€‚å…¶ä¸­ï¼Œç¼–å·ä¸º $A_i$ çš„æˆ¿å­ä¸ç¼–å·ä¸ $B_i$ çš„æˆ¿å­æ­£å¥½éš”æ²³ç›¸æœ›ã€‚<br>ç›¸é‚»ä¸¤æ ‹æˆ¿å­ä¹‹é—´çš„è·ç¦»ä¸º $1$ã€‚è¿™åŒ…æ‹¬ç±»ä¼¼ $A_i,A_{i+1}$ çš„æƒ…å†µï¼Œä¹ŸåŒ…æ‹¬ $A_i,B_i$ çš„æƒ…å†µã€‚</p>
<p>ç°åœ¨æœ‰ $n$ æ¡é€šå‹¤çº¿è·¯ï¼Œæœ‰ä¸€äº›æ˜¯éœ€è¦è·¨æ²³æ‰èƒ½åˆ°è¾¾çš„ã€‚<br>ä»¥å‰äººä»¬éƒ½åèˆ¹ï¼Œä½†æ˜¯ç°åœ¨æ”¿åºœå†³å®šå»ºé€  $k$ åº§å¤§æ¡¥æ¥å¸®åŠ©å¸‚æ°‘è¿›è¡Œæ—¥å¸¸çš„é€šå‹¤ï¼Œä½¿å¾—æ‰€æœ‰äººéƒ½å¯ä»¥ï¼ˆä¸”å¿…é¡»ï¼‰å¼€è½¦æ¥é€šå‹¤ã€‚</p>
<p>ç°åœ¨æ”¿åºœäº¤ç»™äº†ä½ è¿™ $n$ æ¡é€šå‹¤çº¿è·¯å’Œæ¡¥æ¢çš„ä¸ªæ•° $k$ï¼Œè¦æ±‚ä½ æœ€å°åŒ–æ‰€æœ‰äººé€šå‹¤æ‰€éœ€è¦çš„æ—¶é—´ä¹‹å’Œã€‚</p>
<p>æ‰€æœ‰çš„æ¡¥æ¢å¿…é¡»å‚ç›´äºæ²³æµã€‚</p>
<hr>
<p>é¦–å…ˆçŒ›åœ°ä¸€çœ‹å¯èƒ½æ²¡æœ‰ä»€ä¹ˆå¤ªå¤§çš„æ€è·¯ï¼Œæ€»è§‰å¾—æ˜¯ä¸ªè´ªå¿ƒï¼Œæˆ–è€…æ˜¯ä¸ªç»“è®ºé¢˜ã€‚</p>
<p>ç„¶åçœ‹ä¸€çœ¼æ•°æ®èŒƒå›´ï¼š</p>
<p>$1 \leq K \leq 2$<br>$1 \leq N \leq 10^5$</p>
<p>é‚£å°±ç®€å•å¤šäº†ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥åˆ†ç±»è®¨è®ºï¼š</p>
<h1 id="K-x3D-1"><a href="#K-x3D-1" class="headerlink" title="$K&#x3D;1$"></a>$K&#x3D;1$</h1><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦å¿½ç•¥æ‰€æœ‰ä¸è·¨æ²³çš„äººã€‚<br>è¿™ä¸ªåœ¨è¾“å…¥çš„æ—¶å€™å°±ç›´æ¥ç»Ÿè®¡å…¥ç­”æ¡ˆäº†ã€‚</p>
<p>å½“æˆ‘ä»¬åªæœ‰ä¸€åº§æ¡¥çš„æ—¶å€™ï¼Œå°±æ„å‘³ç€<strong>æ‰€æœ‰äººéƒ½å¿…é¡»é€šè¿‡è¿™åº§æ¡¥ã€‚</strong></p>
<p>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å°†è¿™äº›æ‰€æœ‰çš„è·¯çº¿æ‹†æˆä¸‰éƒ¨åˆ†ï¼šåœ¨Aå²¸çš„ã€åœ¨æ¡¥ä¸Šçš„å’Œåœ¨Bå²¸çš„ã€‚<br>è€Œä¸”å› ä¸ºæ¡¥æ˜¯å‚ç›´äºæ²³æµçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å®Œå…¨å¯ä»¥æŠŠåœ¨Bå²¸çš„å’Œåœ¨Aå²¸çš„æ”¾åœ¨ä¸€èµ·ç»Ÿè®¡ã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬çš„é—®é¢˜å°±å¯ä»¥è½¬åŒ–ä¸ºï¼Œæ‰¾ä¸€ä¸ªç‚¹ï¼Œä½¿å¾—æ‰€æœ‰çš„ç‚¹åˆ°è¿™ä¸ªç‚¹çš„è·ç¦»ä¹‹å’Œæœ€å°ã€‚</p>
<p>å®¹æ˜“å¾—å‡ºæˆ‘ä»¬éœ€è¦æ±‚çš„å°±æ˜¯æ‰€æœ‰æ•°å­—çš„ä¸­ä½æ•°ã€‚</p>
<p>ç»Ÿè®¡ç­”æ¡ˆå³å¯ã€‚</p>
<p>ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="type">int</span> t[N], tot, ans;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld&quot;</span>, &amp;k, &amp;n);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s%lld%s%lld&quot;</span>, x, &amp;u, y, &amp;v);</span><br><span class="line">    <span class="keyword">if</span>(x[<span class="number">0</span>] == y[<span class="number">0</span>]) ans += <span class="built_in">abs</span>(u - v);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        t[++tot] = u, t[++tot] = v;</span><br><span class="line">        ans++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">sort</span>(t + <span class="number">1</span>, t + <span class="number">1</span> + tot);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= tot; i++)</span><br><span class="line">    ans += <span class="built_in">abs</span>(t[tot &gt;&gt; <span class="number">1</span>] - t[i]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br></pre></td></tr></table></figure>

<h1 id="K-x3D-2"><a href="#K-x3D-2" class="headerlink" title="$K&#x3D;2$"></a>$K&#x3D;2$</h1><p>æˆ‘ä»¬è€ƒè™‘ä¸€ä¸‹æ¯ä¸€ä¸ªè·¯çº¿çš„å®é™…è·¯ç¨‹ã€‚</p>
<p>å‡è®¾ä¸€ä¸ªè·¯çº¿çš„ç«¯ç‚¹çš„ç¼–å·åˆ†åˆ«æ˜¯ $i$ å’Œ $j$ï¼ˆ$i \leq j$ï¼‰ï¼Œé‚£ä¹ˆï¼š</p>
<ul>
<li>å¦‚æœ $i$ã€$j$ åˆ†åˆ«åœ¨æ¡¥çš„ä¸¤ä¾§ï¼Œå…¶å®é™…è·¯ç¨‹ä¸º $j-i$ã€‚</li>
<li>å¦‚æœ $i$ã€$j$ å¤¹åœ¨ä¸¤ä¸ªæ¡¥çš„ä¸­é—´ï¼Œå…¶å®é™…è·¯ç¨‹ä¸ $\frac{i+j}{2}$ æœ‰å…³ã€‚</li>
</ul>
<p>äºæ˜¯æˆ‘ä»¬å¯ä»¥è€ƒè™‘æŒ‰ç…§ $i+j$ æ¥å¯¹æ‰€æœ‰çš„é€šå‹¤è·¯çº¿è¿›è¡Œæ’åºã€‚åŒæ—¶æšä¸¾ä¸€ä¸ªåˆ’åˆ†çš„ä½ç½®ï¼Œå·¦è¾¹çš„éƒ½èµ°å·¦è¾¹çš„æ¡¥ï¼Œå³è¾¹çš„éƒ½èµ°å³è¾¹çš„æ¡¥ã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬éœ€è¦æ±‚çš„å°±æ˜¯åŠ¨æ€ä¸­ä½æ•°é—®é¢˜äº†ã€‚</p>
<p>æˆ‘ä»¬ä»ç„¶è€ƒè™‘ä½¿ç”¨ä¸€ä¸ªå¤§æ ¹å †å’Œä¸€ä¸ªå°æ ¹å †æ¥ç»´æŠ¤åŠ¨æ€ä¸­ä½æ•°ï¼Œåªä¸è¿‡æˆ‘ä»¬ç»Ÿè®¡ç­”æ¡ˆçš„æ—¶å€™æ¢ä¸ªæ€è·¯ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ç»Ÿè®¡å‰ç¼€å’Œï¼Œå¹¶ä¸”æŠŠè¿™ä¸ªå‰ç¼€å’ŒæŒ‰ç…§æ¡¥çš„ä½ç½®åˆ†æˆå·¦å³ä¸¤éƒ¨åˆ†ã€‚</p>
<p>æ­¤æ—¶çš„æœ€å°è·ç¦»ä¹‹å’Œå°±æ˜¯æ¡¥å³ä¾§ç‚¹çš„åæ ‡å’Œå‡å»å·¦ä¾§ç‚¹çš„åæ ‡å’Œã€‚</p>
<p>æ¡¥å·¦è¾¹çš„éƒ¨åˆ†æšä¸¾çš„æ˜¯å‰ç¼€å’Œï¼Œå³è¾¹çš„éƒ¨åˆ†æšä¸¾çš„æ˜¯åç¼€å’Œã€‚</p>
<p>ç„¶åæˆ‘ä»¬å–æœ€å°å€¼å³å¯ã€‚</p>
<p>ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">need</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> x, y;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> need &amp;a) <span class="type">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> (x + y) &lt; (a.x + a.y);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;order[N];</span><br><span class="line">priority_queue &lt;<span class="type">int</span>, vector&lt;<span class="type">int</span>&gt;               &gt; q1;</span><br><span class="line">priority_queue &lt;<span class="type">int</span>, vector&lt;<span class="type">int</span>&gt;, greater&lt;<span class="type">int</span>&gt; &gt; q2;</span><br><span class="line"><span class="type">int</span> n, k, u, v, cnt;</span><br><span class="line"><span class="type">int</span> ans1[N], ans2[N];</span><br><span class="line"><span class="type">int</span> res, sum1, sum2;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">exchange</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(q1.<span class="built_in">top</span>() &gt; q2.<span class="built_in">top</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> u = q1.<span class="built_in">top</span>(), v = q2.<span class="built_in">top</span>();</span><br><span class="line">        q1.<span class="built_in">pop</span>(), q1.<span class="built_in">push</span>(v);</span><br><span class="line">        q2.<span class="built_in">pop</span>(), q2.<span class="built_in">push</span>(u);</span><br><span class="line">        sum1 += v - u, sum2 -= v - u;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(!q1.<span class="built_in">empty</span>()) q1.<span class="built_in">pop</span>();</span><br><span class="line">    <span class="keyword">while</span>(!q2.<span class="built_in">empty</span>()) q2.<span class="built_in">pop</span>();</span><br><span class="line">    sum1 = sum2 = <span class="number">0</span>;</span><br><span class="line">    u = v = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">senhan</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">clear</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= cnt; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        q1.<span class="built_in">push</span>(order[i].x), q1.<span class="built_in">push</span>(order[i].y);</span><br><span class="line">        sum1 += order[i].x + order[i].y, sum1 -= q1.<span class="built_in">top</span>(), sum2 += q1.<span class="built_in">top</span>();</span><br><span class="line">        q2.<span class="built_in">push</span>(q1.<span class="built_in">top</span>()); q1.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="built_in">exchange</span>();</span><br><span class="line">        ans1[i] = sum2 - sum1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">gohan</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">clear</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = cnt; i &gt;= <span class="number">1</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">        q1.<span class="built_in">push</span>(order[i].x), q1.<span class="built_in">push</span>(order[i].y);</span><br><span class="line">        sum1 += order[i].x + order[i].y, sum1 -= q1.<span class="built_in">top</span>(), sum2 += q1.<span class="built_in">top</span>();</span><br><span class="line">        q2.<span class="built_in">push</span>(q1.<span class="built_in">top</span>()); q1.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="built_in">exchange</span>();</span><br><span class="line">        ans2[i] = sum2 - sum1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sum1 = <span class="number">0</span>, sum2 = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">sort</span>(order + <span class="number">1</span>, order + <span class="number">1</span> + cnt);</span><br><span class="line"><span class="built_in">senhan</span>();</span><br><span class="line"><span class="built_in">gohan</span>();</span><br><span class="line">res = <span class="number">1e18</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt;= cnt; i++)</span><br><span class="line">    res = <span class="built_in">min</span>(res, ans1[i] + ans2[i + <span class="number">1</span>]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans + res);</span><br></pre></td></tr></table></figure>

<p>å…¨éƒ¨åŠ èµ·æ¥ï¼š</p>
<details class="note success"><summary><p>ç¤ºä¾‹ä»£ç </p>
</summary>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_WARNINGS</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">400010</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">need</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> x, y;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> need &amp;a) <span class="type">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> (x + y) &lt; (a.x + a.y);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;order[N];</span><br><span class="line">priority_queue &lt;<span class="type">int</span>, vector&lt;<span class="type">int</span>&gt;               &gt; q1;</span><br><span class="line">priority_queue &lt;<span class="type">int</span>, vector&lt;<span class="type">int</span>&gt;, greater&lt;<span class="type">int</span>&gt; &gt; q2;</span><br><span class="line"><span class="type">int</span> n, k, ans, u, v, cnt;</span><br><span class="line"><span class="type">int</span> ans1[N], ans2[N];</span><br><span class="line"><span class="type">char</span> x[<span class="number">2</span>], y[<span class="number">2</span>];</span><br><span class="line"><span class="type">int</span> t[N], tot, res, sum1, sum2;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">exchange</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(q1.<span class="built_in">top</span>() &gt; q2.<span class="built_in">top</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> u = q1.<span class="built_in">top</span>(), v = q2.<span class="built_in">top</span>();</span><br><span class="line">        q1.<span class="built_in">pop</span>(), q1.<span class="built_in">push</span>(v);</span><br><span class="line">        q2.<span class="built_in">pop</span>(), q2.<span class="built_in">push</span>(u);</span><br><span class="line">        sum1 += v - u, sum2 -= v - u;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(!q1.<span class="built_in">empty</span>()) q1.<span class="built_in">pop</span>();</span><br><span class="line">    <span class="keyword">while</span>(!q2.<span class="built_in">empty</span>()) q2.<span class="built_in">pop</span>();</span><br><span class="line">    sum1 = sum2 = <span class="number">0</span>;</span><br><span class="line">    u = v = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">senhan</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">clear</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= cnt; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        q1.<span class="built_in">push</span>(order[i].x), q1.<span class="built_in">push</span>(order[i].y);</span><br><span class="line">        sum1 += order[i].x + order[i].y, sum1 -= q1.<span class="built_in">top</span>(), sum2 += q1.<span class="built_in">top</span>();</span><br><span class="line">        q2.<span class="built_in">push</span>(q1.<span class="built_in">top</span>()); q1.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="built_in">exchange</span>();</span><br><span class="line">        ans1[i] = sum2 - sum1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">gohan</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">clear</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = cnt; i &gt;= <span class="number">1</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">        q1.<span class="built_in">push</span>(order[i].x), q1.<span class="built_in">push</span>(order[i].y);</span><br><span class="line">        sum1 += order[i].x + order[i].y, sum1 -= q1.<span class="built_in">top</span>(), sum2 += q1.<span class="built_in">top</span>();</span><br><span class="line">        q2.<span class="built_in">push</span>(q1.<span class="built_in">top</span>()); q1.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="built_in">exchange</span>();</span><br><span class="line">        ans2[i] = sum2 - sum1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld&quot;</span>, &amp;k, &amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s%lld%s%lld&quot;</span>, x, &amp;u, y, &amp;v);</span><br><span class="line">        <span class="keyword">if</span>(x[<span class="number">0</span>] == y[<span class="number">0</span>]) ans += <span class="built_in">abs</span>(u - v);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            order[++cnt] = &#123; u, v &#125;;</span><br><span class="line">            t[++tot] = u, t[++tot] = v;</span><br><span class="line">            ans++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(k == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">sort</span>(t + <span class="number">1</span>, t + <span class="number">1</span> + tot);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= tot; i++)</span><br><span class="line">            ans += <span class="built_in">abs</span>(t[tot &gt;&gt; <span class="number">1</span>] - t[i]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(k == <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        sum1 = <span class="number">0</span>, sum2 = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">sort</span>(order + <span class="number">1</span>, order + <span class="number">1</span> + cnt);</span><br><span class="line">        <span class="built_in">senhan</span>();</span><br><span class="line">        <span class="built_in">gohan</span>();</span><br><span class="line">        res = <span class="number">1e18</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt;= cnt; i++)</span><br><span class="line">            res = <span class="built_in">min</span>(res, ans1[i] + ans2[i + <span class="number">1</span>]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans + res);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</details>

]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>é¢˜è§£</tag>
        <tag>è´ªå¿ƒ</tag>
      </tags>
  </entry>
  <entry>
    <title>P4551 æœ€é•¿å¼‚æˆ–è·¯å¾„ é¢˜è§£</title>
    <url>/solutions/solution-p4551/</url>
    <content><![CDATA[<p>Luogu P4551</p>
<span id="more"></span>
<hr>
<p>åšè¿™é“é¢˜éœ€è¦ä¸€ä¸ªæœ‰å…³å¼‚æˆ–çš„æ€§è´¨ï¼Œå°±æ˜¯ï¼š</p>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸¤ä¸ªæ•° $x$ å’Œ $y$ï¼Œä¸è®º $x$ å’Œ $y$ æ˜¯å¤šå°‘ï¼Œæˆ‘ä»¬éƒ½æœ‰ $x \oplus y \oplus y &#x3D; x$ï¼Œå³ä¸€ä¸ªæ•°å¼‚æˆ–å¦ä¸€ä¸ªæ•°ä¸¤æ¬¡ä»ä¸ºè‡ªèº«ã€‚</p>
<p>é‚£æˆ‘ä»¬éœ€è¦æ‰¾çš„æœ€é•¿å¼‚æˆ–è·¯å¾„ï¼Œå¯ä»¥è½¬åŒ–ä¸ºä¸¤ä¸ªç‚¹åˆ°æ ¹çš„è·¯å¾„çš„å¼‚æˆ–å€¼çš„æœ€å¤§å€¼ã€‚</p>
<p>å› ä¸ºå¯¹äºä¸¤ä¸ªç‚¹ $x$ å’Œ $y$ï¼Œæˆ‘ä»¬éœ€è¦æ±‚çš„å°±æ˜¯ $\operatorname{dis}(x,\operatorname{lca}(x,y)) \oplus \operatorname{dis}(y,\operatorname{lca}(x,y))$ã€‚æˆ‘ä»¬å¯ä»¥å°† $\operatorname{dis}(1,x) \oplus \operatorname{dis}(1,y)$ åˆ†è§£ä¸º $\operatorname{dis}(1,\operatorname{lca}(x,y)) \oplus \operatorname{dis}(\operatorname{lca}(x,y),x) \oplus \operatorname{dis}(1,\operatorname{lca}(x,y)) \oplus \operatorname{dis}(1,\operatorname{lca}(x,y))$ï¼Œç„¶ååˆ©ç”¨æ€§è´¨è½¬åŒ–ä¸º $\operatorname{dis}(x,\operatorname{lca}(x,y)) \oplus \operatorname{dis}(y,\operatorname{lca}(x,y))$ã€‚</p>
<p>è€Œæ‰€æœ‰çš„ $\operatorname{dis}(1,x)$ åªéœ€è¦ä½¿ç”¨ä¸€æ¬¡DFSå³å¯æ±‚å‡ºã€‚</p>
<p>ç„¶åå°±æ˜¯æ‰¾å¼‚æˆ–æœ€å¤§å€¼ã€‚</p>
<p>æˆ‘ä»¬å°†æ‰€æœ‰çš„ $\operatorname{dis}(1,x)$ æ”¾è¿›ä¸€æ£µTrieæ ‘é‡Œé¢ï¼Œç„¶åå°±å¯ä»¥å¯»æ‰¾å¼‚æˆ–æœ€å¤§å€¼äº†ã€‚</p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">100010</span>, M = N &lt;&lt; <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">TrieTree</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> s[<span class="number">2</span>];</span><br><span class="line">    <span class="type">int</span> occ;</span><br><span class="line">&#125;tr[N * <span class="number">32</span>];</span><br><span class="line"><span class="type">int</span> tot = <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> w[M], h[N], e[M], ne[M], idx;</span><br><span class="line"><span class="type">int</span> dis[N];</span><br><span class="line"><span class="type">int</span> ans;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[idx] = b;</span><br><span class="line">    w[idx] = v;</span><br><span class="line">    ne[idx] = h[a];</span><br><span class="line">    h[a] = idx++;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">30</span>, p = <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> c = ((x &gt;&gt; i) &amp; <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span>(!tr[p].s[c])tr[p].s[c] = ++tot;</span><br><span class="line">        p = tr[p].s[c];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">30</span>, p = <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> c = ((x &gt;&gt; i) &amp; <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span>(tr[p].s[c ^ <span class="number">1</span>])</span><br><span class="line">        &#123;</span><br><span class="line">            p = tr[p].s[c ^ <span class="number">1</span>];</span><br><span class="line">            res |= (<span class="number">1</span> &lt;&lt; i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            p = tr[p].s[c];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ans = <span class="built_in">max</span>(ans, res);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">insert</span>(dis[p]);</span><br><span class="line">    <span class="built_in">get</span>(dis[p]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h[p]; ~i; i = ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> v = e[i];</span><br><span class="line">        <span class="keyword">if</span>(v == fa)<span class="keyword">continue</span>;</span><br><span class="line">        dis[v] = dis[p] ^ w[i];</span><br><span class="line">        <span class="built_in">dfs</span>(v, p);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="built_in">memset</span>(h, <span class="number">-1</span>, <span class="built_in">sizeof</span>(h));</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> a, b, v;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;v);</span><br><span class="line">        <span class="built_in">add</span>(a, b, v);</span><br><span class="line">        <span class="built_in">add</span>(b, a, v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>é¢˜è§£</tag>
        <tag>å­—å…¸æ ‘</tag>
      </tags>
  </entry>
  <entry>
    <title>P4643 [å›½å®¶é›†è®­é˜Ÿ] é˜¿ç‹¸å’Œæ¡ƒå­çš„æ¸¸æˆ é¢˜è§£</title>
    <url>/solutions/solution-p4643/</url>
    <content><![CDATA[<p>Luogu P4643</p>
<span id="more"></span>
<hr>
<p>é¢˜ç›®å¤§æ„æ˜¯ï¼Œæˆ‘ä»¬éœ€è¦ä»ä¸€ä¸ªå¸¦æœ‰è¾¹æƒå’Œç‚¹æƒçš„å›¾ä¸Šå¯¹ç‚¹è¿›è¡ŒæŸ“è‰²ï¼Œå¹¶æŒ‰ç…§ä¸€ä¸ªç‰¹å®šçš„è§„åˆ™è®¡åˆ†ï¼Œæœ€ç»ˆè¾“å‡ºä¸¤äººå¾—åˆ†ä¹‹å·®ï¼Œè¦æ±‚å·®æœ€å¤§ã€‚</p>
<p>æŸä¸€ä¸ªäººçš„å¾—åˆ†æ˜¯å…¶æŸ“è‰²çš„ç‚¹æƒå€¼ä¹‹å’Œï¼Œå†åŠ ä¸Šä¸¤ç«¯ç‚¹å‡è¢«å…¶æŸ“è‰²çš„è¾¹æƒä¹‹å’Œã€‚</p>
<hr>
<p>å› ä¸ºæˆ‘ä»¬éœ€è¦æ±‚çš„æ˜¯ä¸¤äººå¾—åˆ†ä¹‹å·®ï¼Œæ‰€ä»¥åŸæœ¬ä¸€æ¡è¾¹çš„ä¸¤ç«¯ç‚¹åˆ†åˆ«è¢«ä¸¤äººæŸ“è‰²ä¹‹åè¾¹æƒäº’ä¸å½’å±çš„æƒ…å†µå¯ä»¥çœ‹åšä¸¤äººå„å–ä¸€åŠã€‚<br>åŒç†ï¼Œå¦‚æœä¸€æ¡è¾¹çš„ä¸¤ä¸ªç«¯ç‚¹éƒ½è¢«åŒä¸€ä¸ªäººæŸ“äº†è‰²ä¹‹åï¼Œè¿™æ¡è¾¹çš„ä¸¤åŠæƒå€¼éƒ½è¢«è¿™ä¸ªäººæ‹¿èµ°äº†ï¼Œä¸æˆ‘ä»¬é¢˜ç›®é‡Œçš„æƒ…å†µç¬¦åˆã€‚</p>
<p>é‚£æˆ‘ä»¬å°±å¯ä»¥å°†è¾¹çš„æƒå€¼ä¸€åˆ†ä¸ºäºŒï¼Œåˆ†åˆ«åŠ åˆ°ä¸¤ä¸ªç«¯ç‚¹ä¸Šï¼Œç„¶åå°†è¿™é“é¢˜ç›®å˜æˆé€‰æ‹©æœ€å¤§ç‚¹æƒå’Œã€‚</p>
<p>å› ä¸ºä¸¤äººå‡é‡‡å–æœ€ä¼˜ç­–ç•¥ï¼Œæ‰€ä»¥æ¡ƒå­å–åˆ°äº†æœ€å¤§å€¼ä¹‹åï¼Œé˜¿ç‹¸å°±ä¼šå–æ¬¡å¤§å€¼ï¼Œç„¶åæ¡ƒå­å»ç¬¬ä¸‰å¤§çš„å€¼ï¼Œå¦‚æ­¤å¾€å¤ã€‚</p>
<p>äºæ˜¯æˆ‘ä»¬å°±å¯ä»¥å°†ç‚¹æŒ‰ç…§æƒå€¼é™åºä¸¤ä¸¤ä¸€ç»„ï¼Œæ±‚æ‰€æœ‰ç»„å†…ç‚¹æƒä¹‹å·®çš„æ€»å’Œã€‚</p>
<p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥è¾“å‡ºç­”æ¡ˆäº†ã€‚</p>
<p>ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">10010</span>;</span><br><span class="line"><span class="type">int</span> a[N];</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> n, m;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> k;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;k);</span><br><span class="line">        a[i] = k &lt;&lt; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> x, y, z;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;x, &amp;y, &amp;z);</span><br><span class="line">        a[x] += z;</span><br><span class="line">        a[y] += z;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(a + <span class="number">1</span>, a + <span class="number">1</span> + n);</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; i -= <span class="number">2</span>)ans += a[i] - a[i - <span class="number">1</span>];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, ans / <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>é¢˜è§£</tag>
        <tag>è´ªå¿ƒ</tag>
      </tags>
  </entry>
  <entry>
    <title>#549. å†œå¤«å¥¶ç‰›çš„çº¦ç¿°ä»¬ é¢˜è§£</title>
    <url>/solutions/solution-sy549/</url>
    <content><![CDATA[<p><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMC4xMTE6MTkyNi9wcm9ibGVtLzU0OQ==">http://192.168.0.111:1926/problem/549<i class="fa fa-external-link-alt"></i></span></p>
<span id="more"></span>

<h1 id="é¢˜æ„è½¬åŒ–"><a href="#é¢˜æ„è½¬åŒ–" class="headerlink" title="é¢˜æ„è½¬åŒ–"></a>é¢˜æ„è½¬åŒ–</h1><p>è¿™é“é¢˜ç›®è¦æ±‚æˆ‘ä»¬æ±‚å‡ºæ ‘ä¸Šä¸¤ç‚¹ $x$ã€$y$ ä¹‹é—´æœ€çŸ­è·¯çš„é•¿åº¦ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“ä¸€ä¸ªç»“è®ºï¼Œå°±æ˜¯æ ‘ä¸Šè¿æ¥ä¸¤ä¸ªç‚¹çš„ç®€å•è·¯å¾„æœ‰ä¸”åªæœ‰ä¸€æ¡ï¼Œå³ä¸ºä»ä¸€ä¸ªç‚¹ç»è¿‡ä¸¤ä¸ªç‚¹çš„æœ€è¿‘å…¬å…±ç¥–å…ˆå†åˆ°å¦ä¸€ä¸ªç‚¹çš„è·¯å¾„ã€‚</p>
<p>äºæ˜¯è¿™é“é¢˜ç›®å°±è¢«åˆ†è§£æˆä¸ºäº†ä¸¤ä¸ªå°ä¸€ç‚¹çš„é—®é¢˜ï¼šæ±‚ä¸¤ä¸ªç‚¹çš„LCAï¼Œå’Œæ±‚å‡ºè¿™ä¸¤ä¸ªç‚¹åˆ†åˆ«åˆ°LCAçš„è·ç¦»ã€‚</p>
<h1 id="åˆ†æåšæ³•"><a href="#åˆ†æåšæ³•" class="headerlink" title="åˆ†æåšæ³•"></a>åˆ†æåšæ³•</h1><p>å¯¹äºå‰è€…ï¼Œæˆ‘ä»¬å·²ç»æœ‰äº†ä¸€äº›é€‰é¡¹ï¼šæœ´ç´ ã€å€å¢æˆ–è€…æ ‘å‰–ã€‚</p>
<p>ç„ä¸€çœ¼æ•°æ®èŒƒå›´ï¼Œ$n \leq 10^6$ï¼Œ$m \leq 2 \times 10^5$ã€‚</p>
<p>ï¼ˆä¹‹å‰æœ‰äººé—®äº†ï¼Œé‚£æˆ‘å°±åœ¨è¿™é‡Œè®²ä¸€ä¸‹ï¼‰<br>ï¼ˆä¸‹é¢æˆ‘è¿™é‡Œä½¿ç”¨å½¢å¦‚ $O(\text{é¢„å¤„ç†}) \sim O(\text{å•æ¬¡è¯¢é—®})$ çš„å½¢å¼æ¥æè¿°å¤æ‚åº¦ï¼‰</p>
<p>æœ´ç´ ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(n) \sim \Theta(n)$ï¼Œæ€»ä½“çš„æ—¶é—´å¤æ‚åº¦ï¼ˆå¯¹äºéšæœºæ•°æ®ï¼‰å¤§æ¦‚åœ¨ $10^7$ çº§åˆ«ï¼Œä¼˜åŒ–ä¸€ä¸‹åº”è¯¥å¯ä»¥è¿‡ã€‚<br>ä½†æ˜¯å¦‚æœæ•°æ®æœ‰æ„å¡æ‰æœ´ç´ ç®—æ³•ï¼Œé‚£ä¹ˆå…¶æ—¶é—´å¤æ‚åº¦ä¼šè¢«å¡åˆ° $O(nm)$ï¼Œå¤§æ¦‚åœ¨ $10^11$ çº§åˆ«ï¼Œè¿™æ ·å­çš„è¿ç®—é‡ç»å¯¹æ˜¯è¿‡ä¸å»çš„ã€‚<br><del>ï¼ˆæ‰€ä»¥ä¸ºä»€ä¹ˆæœ´ç´ ç®—æ³•å¯ä»¥è¿‡ï¼‰</del></p>
<p>å€å¢ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(n \log n) \sim O(\log n)$ï¼Œæ€»ä½“çš„æ—¶é—´å¤æ‚åº¦å¤§æ¦‚åœ¨ $10^8$ çº§åˆ«ï¼Œä½†æ˜¯ä¸€èˆ¬ä¸ä¼šè·‘å¤ªæ»¡ã€‚<br>è™½ç„¶çœ‹ä¸Šå»æ˜¯æŒºå”¬äººçš„ï¼Œä½†æ˜¯æ¯•ç«Ÿæ˜¯ä¼˜åŒ–è¿‡çš„ç®—æ³•ï¼Œæ—¶é—´å¤æ‚åº¦çš„ç¨³å®šæ€§ä¹Ÿæ˜¯æ¯”è¾ƒé«˜çš„ï¼Œè™½ç„¶è¯´åº”ä»˜éšæœºæ•°æ®ä¸å¦‚æœ´ç´ å¥½ç½¢äº†ã€‚</p>
<p>æ ‘å‰–ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(n) \sim O(\log n)$ï¼Œæ€»ä½“çš„æ—¶é—´å¤æ‚åº¦å¤§æ¦‚åœ¨ $10^6$ çº§åˆ«å·¦å³ï¼Œä¸”å¸¸æ•°ä¸€èˆ¬è¾ƒå°ã€‚</p>
<p>ç»¼åˆæ¯”å¯¹äº†ä»¥ä¸‹ï¼Œçœ‹ä¸Šå»è¿˜æ˜¯æ ‘å‰–æ¯”è¾ƒé è°±ã€‚</p>
<hr>
<p>å¯¹äºåè€…ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€æ¬¡ DFS æ¥æ±‚å‡ºæ‰€æœ‰èŠ‚ç‚¹åˆ°æ ¹èŠ‚ç‚¹çš„è·ç¦» $\operatorname{dis}(x)$ã€‚<br>ç”±äºè¿™é“é¢˜æ²¡æœ‰ç»™å‡ºæ ¹èŠ‚ç‚¹ï¼Œæˆ‘è¿™é‡Œä¹ æƒ¯ä½¿ç”¨1å·èŠ‚ç‚¹æ¥å½“åšæ ¹èŠ‚ç‚¹ã€‚<br>æ ¹èŠ‚ç‚¹çš„é€‰æ‹©æ˜¯ä¸ä¼šå½±å“ç®—æ³•çš„æ­£ç¡®æ€§çš„ï¼Œä¸¤ä¸ªç‚¹ä¹‹é—´çš„è·¯å¾„ç›–ä¸–å“ªæ¡è¿˜æ˜¯å“ªæ¡ï¼Œä¸ä¼šå› ä¸ºæ ¹èŠ‚ç‚¹å˜äº†è€Œæ”¹å˜çš„ã€‚</p>
<p>æ¯æ¬¡åœ¨è¯¢é—®çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯¹äºç»™å‡ºçš„èŠ‚ç‚¹ $x$ å’Œ $y$ï¼Œåªéœ€è¦å›ç­” $\operatorname{dis}(x) + \operatorname{dis}(y) - 2 \times \operatorname{dis}(\operatorname{lca}(x,y))$ å³å¯ã€‚<br>å› ä¸º $x$ åˆ°æ ¹çš„è·¯å¾„å¯ä»¥åˆ†ä¸º $x$ åˆ° $\operatorname{lca}(x,y)$ å’Œ $\operatorname{lca}(x,y)$ åˆ°æ ¹ä¸¤æ®µï¼Œ$y$ ä¹ŸåŒç†ã€‚æˆ‘ä»¬åªéœ€è¦å›ç­” $x$ åˆ° $\operatorname{lca}(x,y)$ å’Œ $y$ åˆ° $\operatorname{lca}(x,y)$ è¿™ä¸¤æ®µè·¯å¾„çš„é•¿åº¦ä¹‹å’Œå³å¯ã€‚</p>
<p>å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©åœ¨è¿›è¡Œæ ‘å‰–çš„æ—¶å€™ç»“åˆçº¿æ®µæ ‘æˆ–è€…æ ‘çŠ¶æ•°ç»„ç»´æŠ¤åŒºé—´å’Œï¼ŒåŒæ—¶è¿›è¡Œä¸€ä¸‹è¾¹æƒè½¬ç‚¹æƒçš„æ–¹æ³•æ¥ç»´æŠ¤è¿™ä¸ªä¸œè¥¿ã€‚</p>
<h1 id="æ ‘å‰–ï¼Ÿ"><a href="#æ ‘å‰–ï¼Ÿ" class="headerlink" title="æ ‘å‰–ï¼Ÿ"></a>æ ‘å‰–ï¼Ÿ</h1><p>æ ‘å‰–ï¼Œå…¨ç§°ä¸ºæ ‘é“¾å‰–åˆ†ï¼Œæ˜¯ä¸€ç§é€šè¿‡å°†ä¸€æ£µæ ‘æŒ‰ç…§ä¸€å®šçš„è§„åˆ™åˆ†ä¸ºè‹¥å¹²æ¡é“¾çš„æ–¹æ¡ˆã€‚</p>
<p>æŒ‰ç…§ä¸åŒçš„æ³•åˆ™ï¼Œæ ‘é“¾å‰–åˆ†å¯ä»¥åˆ†ä¸ºé‡é“¾å‰–åˆ†ã€é•¿é“¾å‰–åˆ†ã€å®é“¾å‰–åˆ†ç­‰ç­‰ã€‚ä¸€èˆ¬æ¯”è¾ƒå¸¸ç”¨çš„æ˜¯é‡é“¾å‰–åˆ†ã€‚</p>
<h2 id="é‡é“¾å‰–åˆ†"><a href="#é‡é“¾å‰–åˆ†" class="headerlink" title="é‡é“¾å‰–åˆ†"></a>é‡é“¾å‰–åˆ†</h2><p>é‡é“¾å‰–åˆ†çš„æ€æƒ³æ˜¯ï¼Œå°†ä¸€æ£µæ ‘æŒ‰ç…§â€œé‡è¾¹â€æ¥åˆ’åˆ†ç§°ä¸ºè‹¥å¹²æ¡â€œé‡é“¾â€ã€‚</p>
<h3 id="é‡é“¾"><a href="#é‡é“¾" class="headerlink" title="é‡é“¾"></a>é‡é“¾</h3><p>â€œé‡é“¾â€çš„å®šä¹‰æ˜¯è‹¥å¹²æ¡é¦–å°¾è¡”æ¥çš„â€œé‡è¾¹â€ã€‚<br>é‚£ä¹ˆï¼Œå¦‚æœæƒ³è¦äº†è§£é‡é“¾ï¼Œå°±éœ€è¦å…ˆäº†è§£<strong>é‡è¾¹</strong>ã€‚</p>
<h3 id="é‡è¾¹"><a href="#é‡è¾¹" class="headerlink" title="é‡è¾¹"></a>é‡è¾¹</h3><p>â€œé‡è¾¹â€çš„åˆ’åˆ†æ ‡å‡†æ˜¯å®ƒè¿æ¥å‘ä¸€ä¸ªé‡å„¿å­ã€‚<br>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå®ƒåªéœ€è¦ç»“æŸäºä¸€ä¸ªé‡å„¿å­ï¼Œè€Œæ— å…¶ä»–é™åˆ¶ã€‚<br>é‚£ä¹ˆ<strong>é‡å„¿å­</strong>åˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<h3 id="é‡å„¿å­"><a href="#é‡å„¿å­" class="headerlink" title="é‡å„¿å­"></a>é‡å„¿å­</h3><p>â€œé‡å„¿å­â€æ˜¯â€œé‡å­èŠ‚ç‚¹â€çš„åˆ«ç§°ã€‚<br>æˆ‘ä»¬åˆ¤æ–­ä¸€ä¸ªå­èŠ‚ç‚¹æ˜¯å¦ä¸ºé‡å­èŠ‚ç‚¹çš„æ ‡å‡†æ˜¯å®ƒçš„å­æ ‘å¤§å°ã€‚</p>
<p>å¯¹äºä¸€ä¸ªèŠ‚ç‚¹çš„æ‰€æœ‰å„¿å­ï¼Œå…¶ä¸­å­æ ‘æœ€å¤§çš„é‚£ä¸ªå„¿å­ç§°ä¸ºâ€œé‡å„¿å­â€ï¼Œå…¶ä½™çš„ï¼Œåˆ™ç›¸å¯¹åœ°ç§°ä¹‹ä¸ºâ€œè½»å„¿å­â€ã€‚<br>è¿æ¥æŸä¸ªèŠ‚ç‚¹å’Œå…¶é‡å„¿å­çš„è¾¹å«åšâ€œé‡è¾¹â€ï¼Œè€Œè¿æ¥å…¶ä¸å…¶è½»å„¿å­çš„è¾¹åˆ™ç›¸åº”åœ°å«åšâ€œè½»è¾¹â€ã€‚</p>
<p>è¯¦ç»†ä¸€ç‚¹çš„è§£é‡Šå¯ä»¥çœ‹<span class="exturl" data-url="aHR0cHM6Ly9vaS13aWtpLm9yZy9ncmFwaC9obGQv">OI-Wiki<i class="fa fa-external-link-alt"></i></span>æˆ–è€…<a href="https://kaiserwilheim.eu.org/OI/heavy-path-decomposition/">æˆ‘çš„åšå®¢</a>ã€‚</p>
<h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><p>æ ‘å‰–çš„å®ç°æ˜¯é€šè¿‡ä¸¤ä¸ªDFSè¿›è¡Œçš„ã€‚</p>
<p>æˆ‘ä»¬è¿™æ¬¡ä½¿ç”¨é‚»æ¥è¡¨æ¥å­˜å‚¨æ ‘çš„è¾¹ä¿¡æ¯ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> w[N], h[N], e[M], ne[M], idx;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸€ä¸ªDFSè®°å½•äº†æ¯ä¸ªèŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹(fa)ã€æ·±åº¦(dep)ã€å­æ ‘å¤§å°(sz)å’Œé‡å„¿å­(son)ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> dep[N], sz[N], fa[N], son[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> father, <span class="type">int</span> depth)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    dep[p] = depth, fa[p] = father, sz[p] = <span class="number">1</span>;<span class="comment">//åˆå§‹åŒ–èŠ‚ç‚¹çŠ¶æ€ï¼Œè®°å½•å…¶æ·±åº¦å’Œçˆ¶èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h[p]; ~i; i = ne[i])<span class="comment">//éå†å…¶æ‰€æœ‰å„¿å­</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> j = e[i];</span><br><span class="line">        <span class="keyword">if</span>(j == father) <span class="keyword">continue</span>;<span class="comment">//é˜²æ­¢éå†å…¶çˆ¶äº²</span></span><br><span class="line">        <span class="built_in">dfs1</span>(j, p, depth + <span class="number">1</span>);<span class="comment">//æœç´¢å½“å‰å„¿å­</span></span><br><span class="line">        sz[p] += sz[j];<span class="comment">//æ›´æ–°å­æ ‘å¤§å°</span></span><br><span class="line">        <span class="keyword">if</span>(sz[son[p]] &lt; sz[j]) son[p] = j;<span class="comment">//åˆ¤æ–­æ˜¯å¦ä¸ºé‡å„¿å­</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¬¬äºŒä¸ªDFSè®°å½•äº†æ¯ä¸ªèŠ‚ç‚¹æ‰€åœ¨é‡é“¾çš„é“¾é¡¶èŠ‚ç‚¹(top)ã€dfsåº(id)å’Œé‡æ–°å®šå‘çš„èŠ‚ç‚¹æƒå€¼(nw)ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> id[N], top[N], nw[N], cnt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    id[p] = ++cnt, nw[cnt] = w[p], top[p] = t;<span class="comment">//åˆå§‹åŒ–èŠ‚ç‚¹ä¿¡æ¯ï¼Œè®°å½•å…¶DFSåº</span></span><br><span class="line">    <span class="keyword">if</span>(!son[p]) <span class="keyword">return</span>;<span class="comment">//æ˜¯å¦ä¸ºå¶èŠ‚ç‚¹</span></span><br><span class="line">    <span class="built_in">dfs2</span>(son[p], t);<span class="comment">//ä¼˜å…ˆæœç´¢åœ¨åŒä¸€æ¡é‡é“¾ä¸Šçš„é‡å„¿å­</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h[p]; ~i; i = ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> j = e[i];</span><br><span class="line">        <span class="keyword">if</span>(j == fa[p] || j == son[p]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs2</span>(j, j);<span class="comment">//æœç´¢è½»å„¿å­ï¼Œå¼€ä¸€æ¡æ–°çš„é‡é“¾ï¼Œé“¾é¡¶ä¸ºå½“å‰è½»å„¿å­</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶æˆ‘ä»¬å°†æ¯ä¸€æ¡é‡é“¾éƒ½è½¬åŒ–ä¸ºäº†ä¸€æ®µè¿ç»­çš„åŒºé—´ï¼ŒåŒæ—¶æ¯ä¸€ä¸ªèŠ‚ç‚¹çš„å­æ ‘ä¹Ÿè½¬åŒ–ä¸ºäº†ä¸€æ®µè¿ç»­çš„åŒºé—´ï¼Œè¿™æ ·å­å°±ä¼šæ–¹ä¾¿æˆ‘ä»¬ç»“åˆçº¿æ®µæ ‘æˆ–è€…æ ‘çŠ¶æ•°ç»„ç­‰é’ˆå¯¹åŒºé—´çš„æ•°æ®ç»“æ„è¿›è¡Œç»´æŠ¤ã€‚</p>
<p>è¿™ä¸€ç‚¹ä¹Ÿæ˜¯æ ‘å‰–å¯¹æ ‘ä¸Šè·¯å¾„çš„é—®é¢˜å¾ˆå‹å¥½çš„åŸå› æ‰€åœ¨ã€‚</p>
<hr>
<p>è¿™é‡Œæˆ‘ä»¬å®ç°çš„æ—¶å€™éœ€è¦å°†è¾¹æƒè½¬ä¸ºç‚¹æƒï¼Œæˆ‘ä»¬çš„æ–¹æ³•æ˜¯å°†æ¯ä¸€æ¡è¾¹çš„è¾¹æƒéƒ½è½¬åˆ°å…¶ä¸¤ä¸ªç«¯ç‚¹æ·±åº¦è¾ƒå¤§çš„é‚£ä¸€ä¸ªä¸Šé¢ã€‚</p>
<p>æˆ‘ä»¬åœ¨ç¬¬ä¸€éDFSçš„æ—¶å€™ï¼Œå°±é¦–å…ˆå°†è¾¹æƒè½¬åˆ°å¯¹åº”çš„ç‚¹ä¸Šå»ã€‚<br>æˆ‘ä»¬è€ƒè™‘è®°å½•ä¸€ä¸ª<code>rw</code>æ•°ç»„ï¼Œåœ¨ç¬¬ä¸€ä¸ªDFSé‡Œé¢éå†å½“å‰èŠ‚ç‚¹çš„æ‰€æœ‰å­èŠ‚ç‚¹çš„æ—¶å€™åŠ ä¸Šä¸€ä¸ª<code>rw[j] = w[i]</code>å°±å¯ä»¥äº†ã€‚<br>è€Œåœ¨ç¬¬äºŒéDFSçš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±æŠŠ<code>rw</code>æ•°ç»„é‡Œé¢çš„å€¼ä»£æ›¿åœ¨æ­£å¸¸æƒ…å†µä¸‹å­˜å‚¨ç‚¹æƒçš„<code>w</code>æ•°ç»„èµ‹åˆ°<code>nw</code>é‡Œé¢å»å°±å¯ä»¥äº†ã€‚</p>
<p>è€Œåœ¨æŸ¥è¯¢çš„æ—¶å€™ï¼Œå› ä¸º $\operatorname{lca}(x,y)$ è¿™ä¸ªç‚¹é‡Œé¢å­˜çš„æ˜¯å®ƒä¸ $fa[\operatorname{lca}(x,y)]$ ä¹‹é—´çš„è¿™æ¡è¾¹çš„è¾¹æƒï¼Œä¸åœ¨æˆ‘ä»¬éœ€è¦æ±‚çš„è·¯å¾„ä¸Šï¼Œæˆ‘ä»¬å°±ä¸éœ€è¦è®¿é—®å®ƒäº†ã€‚</p>
<hr>
<p>æŸ¥è¯¢çš„æ—¶å€™ï¼Œæˆ‘ä»¬å®šä¹‰ä¸¤ä¸ªæ¸¸æ ‡ï¼Œåˆå§‹ä½ç½®åˆ†åˆ«åœ¨ä¸¤ä¸ªç‚¹ä¸Šï¼Œç„¶åä¸æ–­å‘ä¸Šè·³è‡³å½“å‰é‡é“¾é“¾é¡¶çš„çˆ¶äº²ï¼Œä¹Ÿå°±æ˜¯<code>fa[top[p]]</code>ï¼Œç›´åˆ°è·³åˆ°åŒä¸€ä¸ªé‡é“¾ä¸Šï¼Œæ­¤æ—¶æ·±åº¦è¾ƒå°çš„é‚£ä¸€ä¸ªå°±æ˜¯ä¸¤ä¸ªç‚¹çš„LCAã€‚</p>
<p>åŒæ—¶æˆ‘ä»¬åœ¨æ¯ä¸€æ¬¡æ¸¸æ ‡è·³è½¬ä¹‹å‰è®°å½•ä¸€ä¸‹æ¸¸æ ‡å½“å‰ä½ç½®åˆ°æ¸¸æ ‡å½“å‰æ‰€åœ¨é‡é“¾é“¾é¡¶çš„è¿™ä¸€æ®µåŒºé—´çš„è¾¹æƒå’Œï¼Œæˆ‘ä»¬ä½¿ç”¨æ ‘çŠ¶æ•°ç»„è¿›è¡Œç»Ÿè®¡ã€‚ï¼ˆå› ä¸ºçº¿æ®µæ ‘å¸¸æ•°å¤ªå¤§ï¼Œæ— æ³•é€šè¿‡æ­¤é¢˜ï¼‰</p>
<p>æŸ¥è¯¢çš„ä»£ç é•¿è¿™æ ·ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">sumpath</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> q)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(top[p] != top[q])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(dep[top[p]] &lt; dep[top[q]])<span class="built_in">swap</span>(p, q);<span class="comment">//ä¸¤ä¸ªæ¸¸æ ‡è½®æµè·³ï¼Œä»¥é˜²è·³è¿‡äº†</span></span><br><span class="line">        res += <span class="built_in">segsum</span>(id[p]) - <span class="built_in">segsum</span>(id[top[p]] - <span class="number">1</span>);</span><br><span class="line">        p = fa[top[p]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(dep[p] &lt; dep[q])<span class="built_in">swap</span>(p, q);</span><br><span class="line">    res += <span class="built_in">segsum</span>(id[p]) - <span class="built_in">segsum</span>(id[q]);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬åœ¨æœ€åè¯¢é—®çš„æ—¶å€™åªéœ€è¦è¾“å‡ºä¸€ä¸ª<code>sumpath(x,y)</code>å³å¯ã€‚</p>
<p>å‚è€ƒä»£ç è§<span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMC4xMTE6MTkyNi9zdWJtaXNzaW9uLzQ0NjM=">è¿™ä¸ªæäº¤è®°å½•<i class="fa fa-external-link-alt"></i></span>ã€‚<br>åŠ äº†ä¸ªå¿«è¯»ï¼Œä½†æ˜¯å½±å“ä¸å¤§ã€‚</p>
<hr>
<p>å¦‚æœæˆ‘ä»¬é€‰æ‹©æ”¾å¼ƒæ ‘çŠ¶æ•°ç»„çš„è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥é­”æ”¹ä¸€ä¸‹ç¬¬ä¸€æ¬¡DFSçš„å‡½æ•°ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> dis[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> father, <span class="type">int</span> depth)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    dep[p] = depth, fa[p] = father, sz[p] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h[p]; ~i; i = ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> j = e[i];</span><br><span class="line">        <span class="keyword">if</span>(j == father) <span class="keyword">continue</span>;</span><br><span class="line">        dis[j] = dis[p] + w[i];</span><br><span class="line">        <span class="built_in">dfs1</span>(j, p, depth + <span class="number">1</span>);</span><br><span class="line">        sz[p] += sz[j];</span><br><span class="line">        <span class="keyword">if</span>(sz[son[p]] &lt; sz[j]) son[p] = j;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶åå°†æŸ¥è¯¢çš„å‡½æ•°æ”¹ä¸€ä¸‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">lca</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> q)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(top[p] != top[q])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(dep[top[p]] &lt; dep[top[q]])<span class="built_in">swap</span>(p, q);</span><br><span class="line">        p = fa[top[p]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(dep[p] &lt; dep[q])<span class="built_in">swap</span>(p, q);</span><br><span class="line">    <span class="keyword">return</span> q;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·å­å°±å¯ä»¥å¤„ç†å‡ºæ¥æˆ‘ä»¬çš„ $\operatorname{dis}$ å’Œ $\operatorname{lca}(x,y)$ï¼Œæœ€åæŒ‰ç…§ä¹‹å‰è®²è¿‡çš„è¾“å‡ºå°±å¯ä»¥äº†ã€‚</p>
<p>å‚è€ƒä»£ç è§<span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMC4xMTE6MTkyNi9zdWJtaXNzaW9uLzQ0OTk=">è¿™ä¸ªæäº¤è®°å½•<i class="fa fa-external-link-alt"></i></span>ã€‚è¿™ä¸ªæ²¡æœ‰åŠ å¿«è¯»ï¼Œä½†æ˜¯ä¹Ÿä¸æ…¢ã€‚</p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>é¢˜è§£</tag>
        <tag>æ ‘é“¾å‰–åˆ†</tag>
      </tags>
  </entry>
  <entry>
    <title>ç½‘ç»œæµ åšé¢˜è®°å½•</title>
    <url>/solution-flow/</url>
    <content><![CDATA[<p>ç½‘ç»œæµç›¸å…³åšé¢˜è®°å½•ã€‚</p>
<span id="more"></span>

<p>ï¼ˆæˆ‘ä¸ºä»€ä¹ˆè¦é€ å­½æ”¾ä»£ç ä¸Šæ¥â€¦â€¦ï¼‰</p>
<h1 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h1><h2 id="ç½‘ç»œæµ24é¢˜"><a href="#ç½‘ç»œæµ24é¢˜" class="headerlink" title="ç½‘ç»œæµ24é¢˜"></a>ç½‘ç»œæµ24é¢˜</h2><ul>
<li>LibreOJ #6000 &#x2F; Luogu P2756 é£è¡Œå‘˜é…å¯¹æ–¹æ¡ˆé—®é¢˜ <a href="/solution-flow/#%E9%A3%9E%E8%A1%8C%E5%91%98%E9%85%8D%E5%AF%B9%E6%96%B9%E6%A1%88%E9%97%AE%E9%A2%98">&gt;</a></li>
<li>LibreOJ #6004 &#x2F; Luogu P3254 åœ†æ¡Œé—®é¢˜ <a href="/solution-flow/#%E5%9C%86%E6%A1%8C%E9%97%AE%E9%A2%98">&gt;</a></li>
<li>LibreOJ #6007 &#x2F; Luogu P2774 æ–¹æ ¼å–æ•°é—®é¢˜ <a href="/solution-flow/#%E6%96%B9%E6%A0%BC%E5%8F%96%E6%95%B0%E9%97%AE%E9%A2%98">&gt;</a></li>
<li>LibreOJ #6008 &#x2F; Luogu P1251 é¤å·¾è®¡åˆ’é—®é¢˜ <a href="/solution-flow/#%E9%A4%90%E5%B7%BE%E8%AE%A1%E5%88%92%E9%97%AE%E9%A2%98">&gt;</a></li>
<li>LibreOJ #6011 &#x2F; Luogu P4015 è¿è¾“é—®é¢˜ <a href="/solution-flow/#%E8%BF%90%E8%BE%93%E9%97%AE%E9%A2%98">&gt;</a></li>
<li>LibreOJ #6012 &#x2F; Luogu P4014 åˆ†é…é—®é¢˜ <a href="/solution-flow/#%E5%88%86%E9%85%8D%E9%97%AE%E9%A2%98">&gt;</a></li>
<li>LibreOJ #6013 &#x2F; Luogu P4016 è´Ÿè½½å¹³è¡¡é—®é¢˜ <a href="/solution-flow/#%E8%B4%9F%E8%BD%BD%E5%B9%B3%E8%A1%A1%E9%97%AE%E9%A2%98">&gt;</a></li>
<li>LibreOJ #6015 &#x2F; Luogu P2754 [CTSC1999] å®¶å›­ <a href="/solution-flow/#CTSC1999-%E5%AE%B6%E5%9B%AD">&gt;</a></li>
<li>LibreOJ #6122 &#x2F; Luogu P2770 èˆªç©ºè·¯çº¿é—®é¢˜ <a href="/solution-flow/#%E8%88%AA%E7%A9%BA%E8%B7%AF%E7%BA%BF%E9%97%AE%E9%A2%98">&gt;</a></li>
<li>LibreOJ #6224 &#x2F; Luogu P4012 æ·±æµ·æœºå™¨äººé—®é¢˜ <a href="/solution-flow/#%E6%B7%B1%E6%B5%B7%E6%9C%BA%E5%99%A8%E4%BA%BA%E9%97%AE%E9%A2%98">&gt;</a></li>
</ul>
<h2 id="æœ€å¤§æµ"><a href="#æœ€å¤§æµ" class="headerlink" title="æœ€å¤§æµ"></a>æœ€å¤§æµ</h2><ul>
<li>Luogu P2936 [USACO09JAN] Total Flow S <a href="/solution-flow/#USACO09JAN-Total-Flow-S">&gt;</a></li>
<li>Luogu P1343 åœ°éœ‡é€ƒç”Ÿ <a href="/solution-flow/#%E5%9C%B0%E9%9C%87%E9%80%83%E7%94%9F">&gt;</a></li>
<li>Luogu P2472 [SCOI2007] èœ¥èœ´ <a href="/solution-flow/#SCOI2007-%E8%9C%A5%E8%9C%B4">&gt;</a></li>
<li>Luogu P2891 [USACO07OPEN] Dining G <a href="/solution-flow/#USACO07OPEN-Dining-G">&gt;</a><br>Luogu P1402 é…’åº—ä¹‹ç‹ ^<br>Luogu P1231 æ•™è¾…çš„ç»„æˆ ^</li>
<li>Luogu P3701 ä¸»ä¸»æ ‘ <a href="/solution-flow/#%E4%B8%BB%E4%B8%BB%E6%A0%91">&gt;</a></li>
</ul>
<h2 id="äºŒåˆ†å›¾"><a href="#äºŒåˆ†å›¾" class="headerlink" title="äºŒåˆ†å›¾"></a>äºŒåˆ†å›¾</h2><ul>
<li>Luogu P7368 [USACO05NOV] Asteroids G <a href="/solution-flow/#USACO05NOV-Asteroids-G">&gt;</a></li>
</ul>
<h2 id="æœ€å°å‰²"><a href="#æœ€å°å‰²" class="headerlink" title="æœ€å°å‰²"></a>æœ€å°å‰²</h2><ul>
<li>Luogu P3931 SAC E#1 - ä¸€é“éš¾é¢˜ Tree <a href="/solution-flow/#SAC-E-1-%E4%B8%80%E9%81%93%E9%9A%BE%E9%A2%98-Tree">&gt;</a></li>
<li>Luogu P1345 [USACO5.4] å¥¶ç‰›çš„ç”µä¿¡Telecowmunication <a href="/solution-flow/#USACO5-4-%E5%A5%B6%E7%89%9B%E7%9A%84%E7%94%B5%E4%BF%A1Telecowmunication">&gt;</a></li>
<li>Luogu P2057 [SHOI2007] å–„æ„çš„æŠ•ç¥¨ &#x2F; [JLOI2010] å† å†›è°ƒæŸ¥ <a href="/solution-flow/#SHOI2007-%E5%96%84%E6%84%8F%E7%9A%84%E6%8A%95%E7%A5%A8-x2F-JLOI2010-%E5%86%A0%E5%86%9B%E8%B0%83%E6%9F%A5">&gt;</a></li>
</ul>
<h2 id="è´¹ç”¨æµ"><a href="#è´¹ç”¨æµ" class="headerlink" title="è´¹ç”¨æµ"></a>è´¹ç”¨æµ</h2><ul>
<li>Luogu P1004 [NOIP2000 æé«˜ç»„] æ–¹æ ¼å–æ•° <a href="/solution-flow/#NOIP2000-%E6%8F%90%E9%AB%98%E7%BB%84-%E6%96%B9%E6%A0%BC%E5%8F%96%E6%95%B0">&gt;</a></li>
<li>Luogu P1006 [NOIP2008 æé«˜ç»„] ä¼ çº¸æ¡ <a href="/solution-flow/#NOIP2008-%E6%8F%90%E9%AB%98%E7%BB%84-%E4%BC%A0%E7%BA%B8%E6%9D%A1">&gt;</a></li>
<li>Luogu P2457 [SDOI2006] ä»“åº“ç®¡ç†å‘˜çš„çƒ¦æ¼ <a href="/solution-flow/#SDOI2006-%E4%BB%93%E5%BA%93%E7%AE%A1%E7%90%86%E5%91%98%E7%9A%84%E7%83%A6%E6%81%BC">&gt;</a></li>
<li>Luogu P2517 [HAOI2010] è®¢è´§ <a href="/solution-flow/#HAOI2010-%E8%AE%A2%E8%B4%A7">&gt;</a></li>
<li>Luogu P2153 [SDOI2009] æ™¨è·‘ <a href="/solution-flow/#SDOI2009-%E6%99%A8%E8%B7%91">&gt;</a></li>
</ul>
<h1 id="ç½‘ç»œæµ24é¢˜-1"><a href="#ç½‘ç»œæµ24é¢˜-1" class="headerlink" title="ç½‘ç»œæµ24é¢˜"></a>ç½‘ç»œæµ24é¢˜</h1><h2 id="é£è¡Œå‘˜é…å¯¹æ–¹æ¡ˆé—®é¢˜"><a href="#é£è¡Œå‘˜é…å¯¹æ–¹æ¡ˆé—®é¢˜" class="headerlink" title="é£è¡Œå‘˜é…å¯¹æ–¹æ¡ˆé—®é¢˜"></a>é£è¡Œå‘˜é…å¯¹æ–¹æ¡ˆé—®é¢˜</h2><p>è‹±å›½é£è¡Œå‘˜è¿å‘æºç‚¹ï¼Œå¤–ç±é£è¡Œå‘˜è¿å‘æ±‡ç‚¹ï¼Œå¯ä»¥æ­é…çš„è‹±å›½é£è¡Œå‘˜è¿å‘å¤–ç±é£è¡Œå‘˜ã€‚è¾¹æƒå‡ä¸º $1$ã€‚<br>è·‘ä¸€éæœ€å¤§æµå³å¯ã€‚</p>
<p>æœ€åæšä¸¾æ‰€æœ‰è¾¹ï¼Œå¦‚æœå½“å‰è¾¹è¿æ¥ä¸€ä¸ªå¤–ç±é£è¡Œå‘˜å’Œä¸€ä¸ªè‹±å›½é£è¡Œå‘˜ï¼Œä¸”å…¶å®¹é‡ä¸ºç©ºï¼Œé‚£ä¹ˆè¿™æ¡è¾¹å°±è¢«æµç»è¿‡ï¼Œè¯´æ˜è¿™æ¡è¾¹ä»£è¡¨çš„ä¸€å †é£è¡Œå‘˜å¯ä»¥é…å¯¹ï¼Œè¾“å‡ºä¸¤ç«¯ç‚¹å³å¯ã€‚</p>
<details class="note success"><summary><p>ç¤ºä¾‹ä»£ç </p>
</summary>
<p><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Luogu/p2000-p2999/p2756/p2756.cpp"><code>Luogu</code></a><br><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Libre%20OJ/6000/l6000.cpp"><code>Libre OJ</code></a></p>

</details>

<h2 id="åœ†æ¡Œé—®é¢˜"><a href="#åœ†æ¡Œé—®é¢˜" class="headerlink" title="åœ†æ¡Œé—®é¢˜"></a>åœ†æ¡Œé—®é¢˜</h2><p>å› ä¸ºæˆ‘ä»¬æƒ³è¦è®©ååœ¨ä¸€ä¸ªæ¡Œå­æ—çš„äººä¸¤ä¸¤ä¸å±äºåŒä¸€ä¸ªä»£è¡¨å›¢ï¼Œé‚£å°±å¯ä»¥è½¬åŒ–ä¸ºè®©ä¸€ä¸ªä»£è¡¨å›¢çš„äººåˆ†æ•£åœ¨ä¸åŒçš„æ¡Œå­ä¸Šã€‚</p>
<p>äºæ˜¯æˆ‘ä»¬å°†æ‰€æœ‰çš„ä»£è¡¨å›¢å’Œæ¡Œå­éƒ½æŠ½è±¡æˆç‚¹ã€‚<br>æˆ‘ä»¬ä»æºç‚¹å‘æ¯ä¸ªä»£è¡¨å›¢çš„ç‚¹è¿ä¸€æ¡å®¹é‡ä¸ºä»£è¡¨å›¢äººæ•°çš„è¾¹ï¼Œå†ä»æ¯ä¸€å¼ æ¡Œå­å‘æ±‡ç‚¹è¿ä¸€æ¡å®¹é‡ä¸ºæ¡Œå­å®¹é‡çš„è¾¹ã€‚</p>
<p>ç„¶åæˆ‘ä»¬å°†æ¯ä¸€ä¸ªä»£è¡¨å›¢éƒ½å‘æ¯ä¸€ä¸ªæ¡Œå­è¿ä¸€æ¡å®¹é‡ä¸º1çš„è¾¹ã€‚</p>
<p>æœ€åè·‘æœ€å¤§æµï¼Œå¾—åˆ°çš„å¾—æ•°å°±æ˜¯æœ€å¤šèƒ½ç»™å¤šå°‘ä¸ªäººå®‰æ’ä¸Šæ¡Œå­ã€‚</p>
<p>å¦‚æœæœ‰äººæ²¡æœ‰å®‰æ’ä¸Šæ¡Œå­ï¼Œé‚£ä¹ˆä¹…ç›´æ¥è¾“å‡º0å³å¯ã€‚<br>å¦‚æœæ‰€æœ‰äººéƒ½å®‰æ’ä¸Šæ¡Œå­äº†ï¼Œå°±æœä¸€ä¸‹æ¥ç¡®å®šæ–¹æ¡ˆã€‚</p>
<details class="note success"><summary><p>ç¤ºä¾‹ä»£ç </p>
</summary>
<p><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Luogu/p3000-p3999/p3254/p3254.cpp"><code>Luogu</code></a><br><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Libre%20OJ/6004/l6004.cpp"><code>Libre OJ</code></a></p>

</details> 

<h2 id="æ–¹æ ¼å–æ•°é—®é¢˜"><a href="#æ–¹æ ¼å–æ•°é—®é¢˜" class="headerlink" title="æ–¹æ ¼å–æ•°é—®é¢˜"></a>æ–¹æ ¼å–æ•°é—®é¢˜</h2><p>æˆ‘ä»¬ä¸€æ—¦å–èµ°ä¸€ä¸ªæ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªæ•°å‘¨å›´çš„å››ä¸ªæ ¼å­é‡Œé¢çš„æ•°å°±ä¸èƒ½è¢«å–èµ°äº†ã€‚</p>
<p>é‚£æˆ‘ä»¬å¯ä»¥è½¬åŒ–ä¸€ä¸‹ï¼Œä¸è€ƒè™‘<strong>å…è®¸</strong>ï¼Œè€Œæ˜¯è€ƒè™‘<strong>ç¦æ­¢</strong>ã€‚</p>
<p>é‚£æˆ‘ä»¬å°±å¯ä»¥æŒ‰ç…§æƒå€¼å’Œæœ€å°çš„åŸåˆ™æ¥å¾—åˆ°ä¸€ç§æ–¹æ¡ˆå¹¶å–å‡ºï¼Œå‰©ä¸‹çš„å°±æ˜¯æˆ‘ä»¬æ‰€è¦æ±‚çš„æ–¹æ¡ˆã€‚</p>
<p>é‚£æˆ‘ä»¬æŒ‰ç…§å›½é™…è±¡æ£‹æ£‹ç›˜çš„æŸ“è‰²æ–¹æ¡ˆè¿›è¡ŒæŸ“è‰²ï¼Œå³å¯¹äºä½äºç¬¬ $i$ è¡Œ $j$ åˆ—çš„ç‚¹ï¼Œå¦‚æœ $i+j$ ä¸ºå¥‡æ•°åˆ™å‘æºç‚¹è¿ä¸€æ¡è¾¹æƒä¸ºå½“å‰æ ¼å­æƒå€¼çš„è¾¹ï¼Œå¹¶åŒæ—¶å‘å‘¨å›´å››ä¸ªç‚¹è¿ä¸€æ¡è¾¹æƒä¸ºæ— é™å¤§çš„è¾¹ï¼›å¦åˆ™è¿å‘æ±‡ç‚¹ï¼Œè¾¹æƒä¸ºå½“å‰æ ¼å­æƒå€¼ã€‚</p>
<p>ç”±äºæœ€å°å‰²æœ€å¤§æµå®šç†ï¼Œæˆ‘ä»¬åœ¨æ±‚å‡ºæœ€å¤§æµä¹‹åï¼Œæ‹¿æ‰€æœ‰æ ¼å­çš„æƒå€¼æ€»å’Œå‡å»æœ€å¤§æµå³ä½¿æˆ‘ä»¬è¦çš„ç­”æ¡ˆã€‚</p>
<details class="note success"><summary><p>ç¤ºä¾‹ä»£ç </p>
</summary>
<p><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Luogu/p2000-p2999/p2774/p2774.cpp"><code>Luogu</code></a><br><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Libre%20OJ/6007/l6007.cpp"><code>Libre OJ</code></a></p>

</details>

<h2 id="é¤å·¾è®¡åˆ’é—®é¢˜"><a href="#é¤å·¾è®¡åˆ’é—®é¢˜" class="headerlink" title="é¤å·¾è®¡åˆ’é—®é¢˜"></a>é¤å·¾è®¡åˆ’é—®é¢˜</h2><p>è¯¦ç»†åˆ†æå¯ä»¥è§ä¹‹å‰å†™çš„<a href="/solutions/solution-p1251/">è¿™ç¯‡åšå®¢</a>ã€‚</p>
<p>æˆ‘ä»¬è¿™æ ·è¿è¾¹ï¼š</p>
<ol>
<li>æºç‚¹ä¸é¤å…è¾“å‡ºè¿ä¸€æ¡å®¹é‡ä¸ºå½“å¤©ç”¨é‡ï¼Œè´¹ç”¨ä¸º0çš„è¾¹ï¼›</li>
<li>æ±‡ç‚¹ä¸é¤å…è¾“å…¥è¿ä¸€æ¡å®¹é‡ä¸ºå½“å¤©ç”¨é‡ï¼Œè´¹ç”¨ä¸º0çš„è¾¹ï¼›</li>
<li>é¤å…è¾“å‡ºä¸ä¸‹ä¸€æ—¥çš„é¤å…è¾“å‡ºè¿ä¸€æ¡å®¹é‡ä¸ºæ— é™ï¼Œè´¹ç”¨ä¸º0çš„è¾¹ã€‚</li>
<li>æºç‚¹ä¸é¤å…è¾“å…¥è¿ä¸€æ¡å®¹é‡ä¸ºæ— é™ï¼Œè´¹ç”¨ä¸º $p$ çš„è¾¹ï¼›</li>
<li>é¤å…è¾“å‡ºä¸ $n$ å¤©åçš„é¤å…è¾“å…¥è¿ä¸€æ¡å®¹é‡ä¸ºæ— é™ï¼Œè´¹ç”¨ä¸º $s$ çš„è¾¹ï¼Œä»£è¡¨å¿«æ´—éƒ¨ï¼›</li>
<li>é¤å…è¾“å‡ºä¸ $m$ å¤©åçš„é¤å…è¾“å…¥è¿ä¸€æ¡å®¹é‡ä¸ºæ— é™ï¼Œè´¹ç”¨ä¸º $f$ çš„è¾¹ï¼Œä»£è¡¨æ…¢æ´—éƒ¨ã€‚</li>
</ol>
<p>ç„¶åè·‘ä¸€ä¸ªæœ€å°è´¹ç”¨æœ€å¤§æµå³å¯ï¼Œæœ€ç»ˆçš„è´¹ç”¨å°±æ˜¯ç­”æ¡ˆã€‚</p>
<details class="note success"><summary><p>ç¤ºä¾‹ä»£ç </p>
</summary>
<p><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Luogu/p1000-p1999/p1251/p1251.cpp"><code>Luogu</code></a><br><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Libre%20OJ/6008/l6008.cpp"><code>Libre OJ</code></a></p>

</details>

<h2 id="è¿è¾“é—®é¢˜"><a href="#è¿è¾“é—®é¢˜" class="headerlink" title="è¿è¾“é—®é¢˜"></a>è¿è¾“é—®é¢˜</h2><p>è´¹ç”¨æµã€‚</p>
<p>æºç‚¹å‘ä»“åº“è¿è¾¹ï¼Œä»“åº“å‘å•†åº—è¿è¾¹ï¼Œå•†åº—å‘æ±‡ç‚¹è¿è¾¹ã€‚</p>
<p>è·‘è´¹ç”¨æµå³å¯ã€‚</p>
<details class="note success"><summary><p>ç¤ºä¾‹ä»£ç </p>
</summary>
<p><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Luogu/p4000-p4999/p4015/p4015.cpp"><code>Luogu</code></a><br><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Libre%20OJ/6011/l6011.cpp"><code>Libre OJ</code></a></p>

</details>

<h2 id="åˆ†é…é—®é¢˜"><a href="#åˆ†é…é—®é¢˜" class="headerlink" title="åˆ†é…é—®é¢˜"></a>åˆ†é…é—®é¢˜</h2><p>è´¹ç”¨æµã€‚</p>
<p>æºç‚¹å‘å·¥äººè¿è¾¹ï¼Œå·¥äººå‘å·¥ä»¶è¿è¾¹ï¼Œå·¥ä»¶å‘æ±‡ç‚¹è¿è¾¹ã€‚</p>
<p>è·‘è´¹ç”¨æµå³å¯ã€‚</p>
<p>å’Œä¸Šä¸€é“é¢˜æƒŠäººåœ°ç›¸ä¼¼ã€‚</p>
<details class="note success"><summary><p>ç¤ºä¾‹ä»£ç </p>
</summary>
<p><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Luogu/p4000-p4999/p4014/p4014.cpp"><code>Luogu</code></a><br><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Libre%20OJ/6012/l6012.cpp"><code>Libre OJ</code></a></p>

</details>

<h2 id="è´Ÿè½½å¹³è¡¡é—®é¢˜"><a href="#è´Ÿè½½å¹³è¡¡é—®é¢˜" class="headerlink" title="è´Ÿè½½å¹³è¡¡é—®é¢˜"></a>è´Ÿè½½å¹³è¡¡é—®é¢˜</h2><p>é¦–å…ˆæ¯ä¸ªç‚¹å‘å·¦å³ä¸¤è¾¹çš„ç‚¹è¿è¾¹ï¼Œè´¹ç”¨ä¸º1ï¼Œç„¶åï¼š</p>
<p>å¦‚æœè¿™ä¸ªç‚¹å¤šäºå¹³å‡å€¼ï¼Œé‚£å°±å‘æºç‚¹è¿å…¶æƒå€¼ä¸å¹³å‡å€¼ä¹‹å·®ï¼›<br>å¦‚æœè¿™ä¸ªç‚¹å°‘äºå¹³å‡å€¼ï¼Œé‚£å°±åƒæ±‡ç‚¹è¿å…¶æƒå€¼ä¸å¹³å‡å€¼ä¹‹å·®ã€‚</p>
<p>è¿™ä¸¤ç§è¾¹çš„è´¹ç”¨ä¸º0ã€‚</p>
<p>ç„¶åè·‘è´¹ç”¨æµå³å¯ã€‚</p>
<details class="note success"><summary><p>ç¤ºä¾‹ä»£ç </p>
</summary>
<p><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Luogu/p4000-p4999/p4016/p4016.cpp"><code>Luogu</code></a><br><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Libre%20OJ/6013/l6013.cpp"><code>Libre OJ</code></a></p>

</details>

<h2 id="CTSC1999-å®¶å›­"><a href="#CTSC1999-å®¶å›­" class="headerlink" title="[CTSC1999]å®¶å›­"></a>[CTSC1999]å®¶å›­</h2><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦åˆ¤æ–­ä¸€ä¸‹åœ°çƒå’Œæœˆçƒæ˜¯å¦è”é€šï¼Œè¿™ä¸ªåªéœ€è¦ä½¿ç”¨å¹¶æŸ¥é›†å³å¯ã€‚</p>
<p>ç„¶åæˆ‘ä»¬æšä¸¾å¤©æ•°ï¼Œç›´åˆ°æŸä¸€å¤©è½¬ç§»çš„äººè¾¾åˆ°è¦æ±‚äº†ä¹‹åå°±åœæ­¢å¾ªç¯ï¼Œå¹¶è¾“å‡ºå¤©æ•°ã€‚</p>
<p>æˆ‘ä»¬åœ¨æšä¸¾çš„æ—¶å€™ï¼Œé€å¤©æŒ‰ç…§é£èˆ¹çš„è¡Œè¿›è·¯çº¿åŠ è¾¹ã€‚å› ä¸ºæ¯ä¸€æ¬¡é£èˆ¹éƒ½éœ€è¦èŠ±ä¸€å¤©æ—¶é—´æ¥èµ°ä¸€æ¬¡çš„è·¯ç¨‹ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¯ä¸€æ¡è¾¹éƒ½æ˜¯ä»æŸä¸€å¤©çš„æŸä¸€ä¸ªç«™ç‚¹åˆ°ä¸‹ä¸€å¤©çš„ä¸‹ä¸€ä¸ªç«™ç‚¹ï¼Œå®¹é‡ä¸ºé£èˆ¹å®¹é‡ã€‚</p>
<p>ç„¶åæ¯ä¸€å¤©è·‘æœ€å¤§æµï¼Œå¾—åˆ°çš„æœ€å¤§æµç»“æœå°±æ˜¯å½“å¤©ä»¥åŠä¹‹å‰æ‰€æœ‰å¤©çš„è½¬ç§»äººæ•°æ€»å’Œã€‚</p>
<details class="note success"><summary><p>ç¤ºä¾‹ä»£ç </p>
</summary>
<p><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Luogu/p2000-p2999/p2754/p2754.cpp"><code>Luogu</code></a><br><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Libre%20OJ/6015/l6015.cpp"><code>Libre OJ</code></a></p>

</details>

<h2 id="èˆªç©ºè·¯çº¿é—®é¢˜"><a href="#èˆªç©ºè·¯çº¿é—®é¢˜" class="headerlink" title="èˆªç©ºè·¯çº¿é—®é¢˜"></a>èˆªç©ºè·¯çº¿é—®é¢˜</h2><p>é¢˜ç›®è¦æ±‚æˆ‘ä»¬æ‰¾åˆ°ä¸€æ¡ä»èµ·ç‚¹åŸå¸‚åˆ°é‡ç‚¹åŸå¸‚å†å›åˆ°èµ·ç‚¹åŸå¸‚çš„è·¯å¾„ï¼Œå¹¶è¦æ±‚é™¤èµ·ç‚¹åŸå¸‚å¤–æ¯ä¸€ä¸ªç‚¹åªèƒ½ç»è¿‡ä¸€æ¬¡ã€‚</p>
<p>æˆ‘ä»¬è€ƒè™‘æ‹†ç‚¹ï¼Œé™¤èµ·ç‚¹å’Œç»ˆç‚¹å®¹é‡ä¸º2ä¹‹å¤–å®¹é‡å‡ä¸º1ï¼Œç„¶åæŒ‰ç…§é£æœºèˆªçº¿æ¥å»ºè¾¹ï¼Œå®¹é‡ä¸º1ã€‚</p>
<p>å½“ç„¶è¿™æ ·æˆ‘ä»¬æ˜¯ä¸å¯èƒ½å¾—å‡ºæœ€å¤§ç»è¿‡çš„åŸå¸‚ä¸ªæ•°çš„ï¼Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°è´¹ç”¨æµçš„æ‰‹æ®µã€‚</p>
<p>æˆ‘ä»¬å°†æ¯ä¸ªåŸå¸‚æ‹†ç‚¹çš„æ—¶å€™å»ºçš„è¾¹çš„è´¹ç”¨èµ‹ä¸º1ï¼Œå…¶ä»–çš„è¾¹èµ‹ä¸º0ã€‚</p>
<p>ç„¶åæˆ‘ä»¬è·‘è´¹ç”¨æµå³å¯ã€‚</p>
<p>ç„¶åé¢˜ç›®è¿˜è®©æˆ‘ä»¬è¾“å‡ºä¸€ä¸ªå¯èƒ½çš„æ–¹æ¡ˆã€‚</p>
<p>äºæ˜¯æˆ‘ä»¬å°±ç›´æ¥å¤§æš´æœå°±å¯ä»¥äº†ã€‚<br>è¿˜è¦æ³¨æ„èµ·ç‚¹ç»ˆç‚¹ç›´é€šçš„æƒ…å†µã€‚</p>
<details class="note success"><summary><p>ç¤ºä¾‹ä»£ç </p>
</summary>
<p><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Luogu/p2000-p2999/p2770/p2770.cpp"><code>Luogu</code></a><br><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Libre%20OJ/6122/l6122.cpp"><code>Libre OJ</code></a></p>

</details>

<h2 id="æ·±æµ·æœºå™¨äººé—®é¢˜"><a href="#æ·±æµ·æœºå™¨äººé—®é¢˜" class="headerlink" title="æ·±æµ·æœºå™¨äººé—®é¢˜"></a>æ·±æµ·æœºå™¨äººé—®é¢˜</h2><p>è¿™ä¸ªå°±æ˜¯å¾ˆæ˜æ˜¾çš„æœ€å¤§è´¹ç”¨æœ€å¤§æµï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠç”Ÿç‰©æ ‡æœ¬çš„ä»·å€¼æŠ½è±¡æˆä¸ºè´¹ç”¨å³å¯ã€‚</p>
<p>æŒ‰ç…§é¢˜ç›®è¦æ±‚ï¼Œæˆ‘ä»¬æ¯ä¸€ä¸ªç‚¹éƒ½å‘ä¸Šå’Œå‘å³åˆ†åˆ«å»ºä¸¤æ¡è¾¹ï¼Œä¸€æ¡ä»£è¡¨é‡‡é›†äº†ç”Ÿç‰©æ ‡æœ¬ï¼Œå®¹é‡ä¸º1ä»·å€¼ä¸ºcï¼Œå¦å¤–ä¸€æ¡ä»£è¡¨å·²ç»è¢«é‡‡é›†å®Œäº†ï¼Œå®¹é‡ä¸ºæ— é™ä»·å€¼ä¸º0ã€‚</p>
<p>æŠŠæ‰€æœ‰çš„å¯ä»¥å‡ºå‘çš„åæ ‡è¿å‘æºç‚¹ï¼Œå®¹é‡ä¸º $k$ï¼›æ‰€æœ‰çš„å¯ä»¥ä½œä¸ºç›®çš„åœ°çš„åæ ‡è¿å‘æ±‡ç‚¹ï¼Œå®¹é‡ä¸º $r$ã€‚</p>
<p>ç„¶åè·‘ä¸€éè´¹ç”¨æµå³å¯ã€‚</p>
<details class="note success"><summary><p>ç¤ºä¾‹ä»£ç </p>
</summary>
<p><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Luogu/p4000-p4999/p4012/p4012.cpp"><code>Luogu</code></a><br><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Libre%20OJ/6224/l6224.cpp"><code>Libre OJ</code></a></p>

</details>

<h1 id="æœ€å¤§æµ-1"><a href="#æœ€å¤§æµ-1" class="headerlink" title="æœ€å¤§æµ"></a>æœ€å¤§æµ</h1><h2 id="USACO09JAN-Total-Flow-S"><a href="#USACO09JAN-Total-Flow-S" class="headerlink" title="[USACO09JAN] Total Flow S"></a>[USACO09JAN] Total Flow S</h2><p>æœ€å¤§æµæ¿å­ã€‚<br>å°†å­—ç¬¦è½¬æ¢æˆæ•°å­—è¿›è¡Œå»ºå›¾å³å¯ã€‚</p>
<details class="note success"><summary><p>ç¤ºä¾‹ä»£ç </p>
</summary>
<p><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Luogu/p2000-p2999/p2936/p2936.cpp"><code>Luogu</code></a></p>

</details>

<h2 id="åœ°éœ‡é€ƒç”Ÿ"><a href="#åœ°éœ‡é€ƒç”Ÿ" class="headerlink" title="åœ°éœ‡é€ƒç”Ÿ"></a>åœ°éœ‡é€ƒç”Ÿ</h2><p>ä¹Ÿæ˜¯æœ€å¤§æµæ¿å­ï¼Œåªä¸è¿‡åœ¨è·‘ä¹‹å‰å…ˆè¦ç”¨å¹¶æŸ¥é›†æ¥åˆ¤æ–­ä¸€ä¸‹è¿é€šæ€§ã€‚<br>å½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥è·‘ï¼Œåˆ¤æ–­æœ€å¤§æµé‡æ˜¯å¦ä¸º0ã€‚</p>
<details class="note success"><summary><p>ç¤ºä¾‹ä»£ç </p>
</summary>
<p><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Luogu/p1000-p1999/p1343/p1343.cpp"><code>Luogu</code></a></p>

</details>

<h2 id="SCOI2007-èœ¥èœ´"><a href="#SCOI2007-èœ¥èœ´" class="headerlink" title="[SCOI2007] èœ¥èœ´"></a>[SCOI2007] èœ¥èœ´</h2><p>è¿™é“é¢˜åœ¨åšä¹‹å‰å¾—é¦–å…ˆè§£å†³<strong>å¹³é¢è·ç¦»</strong>æ˜¯ä»€ä¹ˆã€‚</p>
<p>æ ¹æ®å®é™…æµ‹è¯•ï¼Œæœ¬é¢˜ä¸­çš„<strong>å¹³é¢è·ç¦»</strong>å…¶å®æŒ‡çš„å°±æ˜¯<strong>æ¬§å‡ é‡Œå¾—è·ç¦»</strong>ã€‚</p>
<p>ç”±äºå…¶ $d \leq 4$ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥æš´åŠ›æšä¸¾ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€å¼ å›¾ï¼Œä»£è¡¨ç€æˆ‘ä»¬è¿™é“é¢˜æŸä¸ªç‚¹åœ¨ä¸åŒçš„ $d$ æ—¶éœ€è¦è¿è¾¹çš„èŒƒå›´ï¼š</p>
<p><img src="https://s2.loli.net/2022/04/21/5IUqMYC4FfsnXSD.png" alt="flowsolu1.png"></p>
<p>ç„¶åå¤„ç†é¢˜ç›®æ‰€ç»™çš„ä¿¡æ¯ï¼š<br>çŸ³æŸ±çš„é«˜åº¦å°±æ˜¯å½“å‰ç‚¹çš„å®¹é‡ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‹†ç‚¹ï¼›<br>è·³å‡ºåœ°å›¾å¤–é¢äº†å°±ä»£è¡¨å¯ä»¥è¿å‘æ±‡ç‚¹ï¼›<br>æœ‰èœ¥èœ´å°±ä»£è¡¨ç€å¯ä»¥è¿å‘æºç‚¹ã€‚</p>
<p>ç„¶åå°±è·‘æœ€å¤§æµï¼Œå¾—åˆ°çš„æ˜¯å¯ä»¥é€ƒç¦»åœ°å›¾çš„èœ¥èœ´ä¸ªæ•°çš„æœ€å¤§å€¼ï¼Œè¾“å‡ºèœ¥èœ´æ€»æ•°ä¸å…¶ä¹‹å·®å³å¯ã€‚</p>
<details class="note success"><summary><p>ç¤ºä¾‹ä»£ç </p>
</summary>
<p><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Luogu/p2000-p2999/p2472/p2472.cpp"><code>Luogu</code></a></p>

</details>

<h2 id="USACO07OPEN-Dining-G"><a href="#USACO07OPEN-Dining-G" class="headerlink" title="[USACO07OPEN] Dining G"></a>[USACO07OPEN] Dining G</h2><p>P1402ã€P2891å’ŒP1231å®è´¨ä¸Šæ˜¯ä¸€ç±»é—®é¢˜ï¼Œéƒ½æ˜¯ä¸‰ç§ç‰©å“è¿›è¡ŒåŒ¹é…ï¼Œæ±‚æœ€å¤§åŒ¹é…ä¸ªæ•°ã€‚</p>
<p>å¯¹äºè¿™ç±»é—®é¢˜ï¼Œæˆ‘ä»¬çš„æ€è·¯å°±æ˜¯æ‹†ç‚¹ã€‚</p>
<p>å°†åŒ¹é…çš„ä¸»ä½“ï¼ˆæ¯”å¦‚P2891çš„å¥¶ç‰›ã€P1402çš„é¡¾å®¢å’ŒP1231çš„ç»ƒä¹ å†Œï¼‰æ‹†æˆä¸¤ä¸ªç‚¹ï¼Œä¸­é—´è¿ä¸€æ¡å®¹é‡ä¸º1çš„è¾¹ï¼Œç„¶åä¸¤ä¸ªç‚¹åˆ†åˆ«ä¸å‰©ä¸‹çš„ä¸¤ç§ç‰©å“è¿è¾¹ï¼Œç„¶åè·‘æœ€å¤§æµå³å¯ã€‚</p>
<details class="note success"><summary><p>ç¤ºä¾‹ä»£ç </p>
</summary>
<p><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Luogu/p2000-p2999/p2891/p2891.cpp"><code>Luogu P2891</code></a><br><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Luogu/p1000-p1999/p1402/p1402.cpp"><code>Luogu P1402</code></a><br><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Luogu/p1000-p1999/p1231/p1231.cpp"><code>Luogu P1231</code></a></p>

</details>

<h2 id="ä¸»ä¸»æ ‘"><a href="#ä¸»ä¸»æ ‘" class="headerlink" title="ä¸»ä¸»æ ‘"></a>ä¸»ä¸»æ ‘</h2><p>ç»å…¸é¢˜ç›®ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦æ€è€ƒä¸€ä¸‹ä¸ºä»€ä¹ˆå›¾ä¸­ç®­å¤´æŒ‡å‘çš„æ˜¯è¾“çš„ä¸€æ–¹ã€‚<br>åŠ å…¥æˆ‘ä»¬æŒ‰ç…§è¿™ä¸ªæ€è·¯ï¼Œæ¯ä¸€ä¸ªbyxçš„äººéƒ½å‘èƒ½å¤Ÿèµ¢çš„è¯—ä¹ƒçš„äººè¿ä¸€æ¡è¾¹ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªæ–°çš„å›¾ã€‚<br>æˆ‘ä»¬æƒ³è¦æ‰¾åˆ°æœ€å¤§çš„è¾¹é›†ï¼Œä½¿å¾—è¾¹é›†å†…çš„è¾¹ä¸¤ä¸¤ä¸å…±ç”¨ç«¯ç‚¹ï¼Œæœ€åæˆ‘ä»¬æ±‚å‡ºçš„è¾¹é›†çš„å¤§å°å°±æ˜¯byxå¯ä»¥èµ¢çš„åœºæ•°ã€‚</p>
<p>é‚£æˆ‘ä»¬è€ƒè™‘å¯¹è¿™å¼ å›¾å»ºç«‹ç½‘ç»œæµæ¨¡å‹ã€‚<br>æˆ‘ä»¬é¦–å…ˆæŠŠåŸå›¾ä¸­çš„æ‰€æœ‰è¾¹å»ºç«‹èµ·æ¥ï¼Œå®¹é‡ä¸º1ã€‚<br>ç„¶åæŠŠæ‰€æœ‰byxçš„äººè¿å‘æºç‚¹ï¼Œæ‰€æœ‰è¯—ä¹ƒçš„äººè¿å‘æ±‡ç‚¹ã€‚è¿™æ ·æ¯ä¸€ä¸ªæµé‡å°±ä»£è¡¨byxèƒ½èµ¢çš„ä¸€åœºã€‚<br>ç„¶åæˆ‘ä»¬éœ€è¦é™åˆ¶ç‚¹çš„è®¿é—®æ¬¡æ•°ï¼Œæˆ‘ä»¬å¯ä»¥æ‹†ç‚¹ã€‚<br>ç„¶åå°±è·‘æœ€å¤§æµå³å¯ã€‚</p>
<p>æ³¨æ„æˆ‘ä»¬éœ€è¦å°†å¾—åˆ°çš„æœ€å¤§æµé‡ä¸æ¯”èµ›çš„åœºæ¬¡å–<code>min</code>å†è¾“å‡ºï¼Œæœ€åæ‰æ˜¯çœŸæ­£èƒ½èµ¢çš„åœºæ•°ã€‚ï¼ˆæ²¡æ¯”èµ›ä½ èµ¢ä¸ªä»€ä¹ˆï¼‰</p>
<details class="note success"><summary><p>ç¤ºä¾‹ä»£ç </p>
</summary>
<p><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Luogu/p3000-p3999/p3701/p3701.cpp"><code>Luogu</code></a></p>

</details>

<h1 id="äºŒåˆ†å›¾-1"><a href="#äºŒåˆ†å›¾-1" class="headerlink" title="äºŒåˆ†å›¾"></a>äºŒåˆ†å›¾</h1><h2 id="USACO05NOV-Asteroids-G"><a href="#USACO05NOV-Asteroids-G" class="headerlink" title="[USACO05NOV] Asteroids G"></a>[USACO05NOV] Asteroids G</h2><p>æˆ‘ä»¬å¦‚æœæƒ³è¦æ¶ˆé™¤ä¸€é¢—å°è¡Œæ˜Ÿï¼Œé‚£ä¹ˆå…¶è‚¯å®šåœ¨åˆ—ä¸Šæˆ–è€…è¡Œä¸Šæœ‰å¸ƒç½®è¿‡ä¸€æ¬¡æ­¦å™¨ï¼Œæˆ–è€…ä¸¤è€…å…¼æœ‰ã€‚</p>
<p>é‚£ä¹ˆï¼Œæ¯ä¸€é¢—å°è¡Œæ˜Ÿå°±å¯ä»¥å¯¹åº”äºŒåˆ†å›¾ä¸Šçš„ä¸€æ¡è¾¹ï¼Œæˆ‘ä»¬å°±éœ€è¦æ‰¾ä¸€ä¸ªç‚¹é›†ï¼Œä½¿å¾—æ‰€æœ‰è¾¹çš„ä¸¤ä¸ªç«¯ç‚¹ä¹‹ä¸€åœ¨è¿™ä¸ªç‚¹é›†ä¸­ã€‚</p>
<p>è¿™ä¾¿æ˜¯äºŒåˆ†å›¾æœ€å°ç‚¹è¦†ç›–ã€‚</p>
<p>æˆ‘ä»¬å°±å¯ä»¥ç”¨äºŒåˆ†å›¾æœ€å¤§åŒ¹é…æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<details class="note success"><summary><p>ç¤ºä¾‹ä»£ç </p>
</summary>
<p><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Luogu/p6000%2B/p7368/p7368.cpp"><code>Luogu</code></a></p>

</details>

<h1 id="æœ€å°å‰²-1"><a href="#æœ€å°å‰²-1" class="headerlink" title="æœ€å°å‰²"></a>æœ€å°å‰²</h1><h2 id="SAC-E-1-ä¸€é“éš¾é¢˜-Tree"><a href="#SAC-E-1-ä¸€é“éš¾é¢˜-Tree" class="headerlink" title="SAC E#1 - ä¸€é“éš¾é¢˜ Tree"></a>SAC E#1 - ä¸€é“éš¾é¢˜ Tree</h2><p>è¿™é“é¢˜è¦æ±‚æˆ‘ä»¬æ±‚å‡ºä½¿ä»»ä½•å¶å­ç»“ç‚¹ä¸æ ¹èŠ‚ç‚¹ä¸è¿é€šçš„æœ€å°ä»£ä»·ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥è½¬åŒ–ä¸€ä¸‹ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå¦‚æœæˆ‘ä»¬è¦æ±‚ä»»ä½•å¶å­ç»“ç‚¹éƒ½ä¸æ ¹èŠ‚ç‚¹ä¸è¿é€šï¼Œé‚£ä¹ˆä»æ ¹èŠ‚ç‚¹åˆ°æ¯ä¸€ä¸ªå¶å­ç»“ç‚¹çš„è·¯å¾„ä¸Šé¢ä¸€å®šè¢«å‰²å¼€è¿‡è¾¹ã€‚<br>æˆ‘ä»¬è¿˜éœ€è¦è®©è´¹ç”¨æœ€å°ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ€å¤šæ¯æ¡è·¯å¾„ä¸Šå‰²å¼€ä¸€æ¡è¾¹ã€‚</p>
<p>äºæ˜¯æˆ‘ä»¬å°±å¯ä»¥ç”¨æœ€å°å‰²æ¥æ±‚è§£ã€‚è®©æ ¹èŠ‚ç‚¹è¿ä¸Šæºç‚¹ï¼Œæ‰€æœ‰å¶å­ç»“ç‚¹è¿ä¸Šæ±‡ç‚¹ï¼Œç„¶åè·‘æœ€å°å‰²å³å¯ã€‚</p>
<details class="note success"><summary><p>ç¤ºä¾‹ä»£ç </p>
</summary>
<p><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Luogu/p3000-p3999/p3931/p3931.cpp"><code>Luogu</code></a></p>

</details>

<h2 id="USACO5-4-å¥¶ç‰›çš„ç”µä¿¡Telecowmunication"><a href="#USACO5-4-å¥¶ç‰›çš„ç”µä¿¡Telecowmunication" class="headerlink" title="[USACO5.4] å¥¶ç‰›çš„ç”µä¿¡Telecowmunication"></a>[USACO5.4] å¥¶ç‰›çš„ç”µä¿¡Telecowmunication</h2><p>é¢˜ç›®è¦æ±‚æˆ‘ä»¬æ±‚å‡ºï¼Œæˆ‘ä»¬éœ€è¦åˆ é™¤å¤šå°‘ä¸ªç‚¹æ‰èƒ½ä½¿é¢˜ç›®ç»™å‡ºçš„ä¸¤ä¸ªç‚¹ä¹‹é—´ä¸è¿é€šã€‚</p>
<p>æˆ‘ä»¬ä¹‹å‰åªåšè¿‡å‰²è¾¹çš„é¢˜ç›®ï¼Œæ²¡æœ‰åšè¿‡è¿™ç§é¢˜ç›®ï¼Œè€ƒè™‘å°†å…¶è½¬åŒ–ä¸€ä¸‹ã€‚<br>æ–¹æ³•å¾ˆç®€å•ï¼Œå°±æ˜¯æ‹†ç‚¹ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥å°†åˆ é™¤ç‚¹æ”¹ä¸ºåˆ é™¤è¿æ¥è¢«æ‹†çš„ç‚¹çš„ä¸¤éƒ¨åˆ†çš„è¾¹ï¼Œè¿™æ ·å°±å¯ä»¥è½¬åŒ–ä¸ºå‰²è¾¹çš„é—®é¢˜äº†ã€‚</p>
<p>ç„¶åå»ºå›¾ï¼ŒåŸå›¾ä¸­çš„è¾¹å®¹é‡å‡ä¸ºæ— é™å¤§ï¼Œæ‹†ç‚¹å¾—åˆ°çš„è¾¹çš„å®¹é‡å‡ä¸º1å³å¯ã€‚</p>
<p>ç„¶åè·‘æœ€å°å‰²ã€‚</p>
<details class="note success"><summary><p>ç¤ºä¾‹ä»£ç </p>
</summary>
<p><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Luogu/p1000-p1999/p1345/p1345.cpp"><code>Luogu</code></a></p>

</details>

<h2 id="SHOI2007-å–„æ„çš„æŠ•ç¥¨-x2F-JLOI2010-å† å†›è°ƒæŸ¥"><a href="#SHOI2007-å–„æ„çš„æŠ•ç¥¨-x2F-JLOI2010-å† å†›è°ƒæŸ¥" class="headerlink" title="[SHOI2007] å–„æ„çš„æŠ•ç¥¨ &#x2F; [JLOI2010] å† å†›è°ƒæŸ¥"></a>[SHOI2007] å–„æ„çš„æŠ•ç¥¨ &#x2F; [JLOI2010] å† å†›è°ƒæŸ¥</h2><p>é¢˜ç›®å‘Šè¯‰æˆ‘ä»¬ï¼Œæˆ‘ä»¬éœ€è¦æ±‚å‡ºæ¥å†²çªæ•°é‡ã€‚</p>
<p>æˆ‘ä»¬å…ˆåˆ†æå†²çªçš„äº§ç”Ÿã€‚</p>
<p>å†²çªä¹‹æ‰€ä»¥ä¼šäº§ç”Ÿï¼Œå…¶æ ¹æœ¬åŸå› å°±åœ¨äºä¸è‡ªå·±è‡³å°‘ä¸€ä¸ªå¥½æœ‹å‹çš„æ”¿è§ä¸åˆã€‚ä»–ä»¬è¦ä¹ˆè¿åè‡ªå·±çš„æ„æ„¿è€Œäº§ç”Ÿä¸€å•ä½çš„å†²çªï¼Œè¦ä¹ˆè¿åå¥½æœ‹å‹çš„æ„æ„¿è€Œäº§ç”Ÿä¸€å•ä½çš„å†²çªã€‚</p>
<p>å…¶ä¸­ç¬¬ä¸€ç§å†²çªå®Œå…¨æ˜¯ç”±äºç¬¬äºŒç§å†²çªè€Œäº§ç”Ÿçš„ã€‚<br>å¦‚æœè¿™é‡Œæ²¡æœ‰å¥½æœ‹å‹å…³ç³»ï¼Œé‚£ä¹ˆå°±ä¸ä¼šæœ‰å¥½æœ‹å‹ä¹‹é—´æ”¿è§ä¸åˆè€Œå¯¼è‡´çš„å†²çªäº†ã€‚</p>
<p>è€Œç¬¬äºŒç§å†²çªå‘¢ï¼Ÿ<br>æ¥æºæ˜¯ä¸€å¯¹å¥½æœ‹å‹ä¹‹é—´è¦æ±‚ä¸å¯¹æ–¹æŒç›¸åŒæ”¿è§ã€‚</p>
<p>å¦‚ä½•è§£å†³ç¬¬äºŒç§å†²çªï¼Ÿ<br>ç®€å•ï¼Œä¸å†æŒè‡ªå·±çš„ç«‹åœºæˆ–è€…ä¸å†ä¸ºå¥½æœ‹å‹å…³ç³»å³å¯ã€‚</p>
<p>äºæ˜¯æˆ‘ä»¬å°±å¯ä»¥è¿è¾¹äº†ã€‚</p>
<p>æ¯ä¸€å¯¹å¥½æœ‹å‹ä¹‹é—´è¿åŒå‘è¾¹ï¼Œç„¶åæ¯ä¸€ä¸ªå°æœ‹å‹å‘è‡ªå·±çš„ç«‹åœºï¼ˆæºç‚¹ä¸æ±‡ç‚¹ä¹‹é—´è‡ªå·±çœ‹ç€é€‰ï¼‰è¿ä¸€æ¡è¾¹ã€‚å®¹é‡å‡ä¸º1ã€‚</p>
<p>ç„¶åè·‘æœ€å°å‰²å³å¯ã€‚</p>
<details class="note success"><summary><p>ç¤ºä¾‹ä»£ç </p>
</summary>
<p><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Luogu/p2000-p2999/p2057/p2057.cpp"><code>Luogu</code></a></p>

</details>

<h1 id="è´¹ç”¨æµ-1"><a href="#è´¹ç”¨æµ-1" class="headerlink" title="è´¹ç”¨æµ"></a>è´¹ç”¨æµ</h1><h2 id="NOIP2000-æé«˜ç»„-æ–¹æ ¼å–æ•°"><a href="#NOIP2000-æé«˜ç»„-æ–¹æ ¼å–æ•°" class="headerlink" title="[NOIP2000 æé«˜ç»„] æ–¹æ ¼å–æ•°"></a>[NOIP2000 æé«˜ç»„] æ–¹æ ¼å–æ•°</h2><p>æ¯ä¸€ä¸ªç‚¹å‘å…¶å³ä¾§å’Œä¸‹ä¾§çš„ä¸¤ä¸ªç‚¹åˆ†åˆ«è¿è¾¹ï¼ŒåŒæ—¶æ¯ä¸ªç‚¹æ‹†ç‚¹ï¼Œå®¹é‡ä¸º2ï¼Œè¾¹æƒä¸ºæ–¹æ ¼ä¸­çš„æ•°ã€‚<br>$(0,0)$ è¿å‘æºç‚¹ï¼Œ$(n,n)$ è¿å‘æ±‡ç‚¹ã€‚</p>
<p>ç„¶åè·‘æœ€å¤§è´¹ç”¨æœ€å¤§æµå³å¯ã€‚</p>
<details class="note success"><summary><p>ç¤ºä¾‹ä»£ç </p>
</summary>
<p><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Luogu/p1000-p1999/p1004/p1004.cpp"><code>Luogu</code></a></p>

</details>

<h2 id="NOIP2008-æé«˜ç»„-ä¼ çº¸æ¡"><a href="#NOIP2008-æé«˜ç»„-ä¼ çº¸æ¡" class="headerlink" title="[NOIP2008 æé«˜ç»„] ä¼ çº¸æ¡"></a>[NOIP2008 æé«˜ç»„] ä¼ çº¸æ¡</h2><p>æ¯ä¸€ä¸ªç‚¹å‘å…¶å³ä¾§å’Œä¸‹ä¾§çš„ä¸¤ä¸ªç‚¹åˆ†åˆ«è¿è¾¹ï¼ŒåŒæ—¶æ¯ä¸ªç‚¹æ‹†ç‚¹ï¼Œå®¹é‡ä¸º1ï¼Œè¾¹æƒä¸ºå¥½æ„Ÿåº¦ã€‚<br>$(0,0)$ è¿å‘æºç‚¹ï¼Œ$(n,m)$ è¿å‘æ±‡ç‚¹ã€‚</p>
<p>ç„¶åè·‘æœ€å¤§è´¹ç”¨æœ€å¤§æµå³å¯ã€‚</p>
<details class="note success"><summary><p>ç¤ºä¾‹ä»£ç </p>
</summary>
<p><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Luogu/p1000-p1999/p1006/p1006.cpp"><code>Luogu</code></a></p>

</details>

<h2 id="SDOI2006-ä»“åº“ç®¡ç†å‘˜çš„çƒ¦æ¼"><a href="#SDOI2006-ä»“åº“ç®¡ç†å‘˜çš„çƒ¦æ¼" class="headerlink" title="[SDOI2006] ä»“åº“ç®¡ç†å‘˜çš„çƒ¦æ¼"></a>[SDOI2006] ä»“åº“ç®¡ç†å‘˜çš„çƒ¦æ¼</h2><p>æˆ‘ä»¬æƒ³è¦æ‰¾åˆ°çš„æ˜¯ä¸€ç§æ–¹æ¡ˆï¼Œä½¿å¾—æ¯ä¸€ç§è´§ç‰©èƒ½å¤Ÿä»¥æœ€å°çš„ä»£ä»·å„è‡ªè¢«åˆ†åˆ°ä¸€ä¸ªå•ç‹¬çš„ä»“åº“é‡Œé¢ã€‚<br>ä½†æ˜¯é¢˜ç›®å¹¶ä¸éœ€è¦æˆ‘ä»¬è¾“å‡ºå…·ä½“çš„æ–¹æ¡ˆï¼Œåªéœ€è¦æˆ‘ä»¬è¾“å‡ºæœ€å°ä»£ä»·ã€‚</p>
<p>å› ä¸ºæœ¬ä»“åº“çš„ç‰©å“å†è¿å›åˆ°æœ¬ä»“åº“æ˜¯ä¸ä¼šäº§ç”Ÿä»£ä»·çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¯ä¸€ä¸ªä»“åº“è¿é€è´§ç‰©çš„ä»£ä»·éƒ½å¯ä»¥è¡¨ç¤ºä¸ºè¿è¿›è¯¥ä»“åº“çš„å•†å“çš„ä»£ä»·ä¹‹å’Œï¼Œè¿™ç­‰äºæ‰€æœ‰è¯¥ç±»å•†å“çš„æ•°é‡ä¹‹å’Œå‡å»å½“å‰ä»“åº“å†…çš„è¯¥ç§å•†å“æ€»æ•°ã€‚</p>
<p>äºæ˜¯æˆ‘ä»¬å»ºç«‹ $2n$ ä¸ªç‚¹ï¼Œä¸€åŠä»£è¡¨ä»“åº“ï¼Œä¸€åŠä»£è¡¨è´§ç‰©ç§ç±»ã€‚<br>æ¯ä¸€ä¸ªä»“åº“éƒ½å‘æ‰€æœ‰çš„è´§ç‰©ç§ç±»è¿ä¸€æ¡å®¹é‡ä¸º1ï¼Œè´¹ç”¨ä¸ºæ‰€æœ‰è¯¥ç±»å•†å“çš„æ•°é‡ä¹‹å’Œå‡å»å½“å‰ä»“åº“å†…çš„è¯¥ç§å•†å“æ€»æ•°ã€‚</p>
<p>ç„¶åè·‘è´¹ç”¨æµå³å¯ã€‚</p>
<details class="note success"><summary><p>ç¤ºä¾‹ä»£ç </p>
</summary>
<p><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Luogu/p2000-p2999/p2457/p2457.cpp"><code>Luogu</code></a></p>

</details>

<h2 id="HAOI2010-è®¢è´§"><a href="#HAOI2010-è®¢è´§" class="headerlink" title="[HAOI2010] è®¢è´§"></a>[HAOI2010] è®¢è´§</h2><p>æˆ‘ä»¬è€ƒè™‘ä»¥æ¯æœˆä»“åº“çš„çŠ¶æ€æ¥å»ºç«‹èŠ‚ç‚¹ã€‚</p>
<p>æ¯ä¸ªèŠ‚ç‚¹éƒ½ä»æºç‚¹è¿ä¸€æ¡è¾¹ï¼Œå®¹é‡ä¸ºæ— é™ï¼Œè´¹ç”¨ä¸º $d_i$ï¼Œä»£è¡¨è¿›è´§ï¼›<br>åŒæ—¶æ¯ä¸ªèŠ‚ç‚¹éƒ½å‘æ±‡ç‚¹è¿ä¸€æ¡è¾¹ï¼Œå®¹é‡ä¸º $U_i$ï¼Œè´¹ç”¨ä¸º0ï¼Œä»£è¡¨ä¾›åº”å¸‚åœºï¼›<br>æ¯ä¸ªä¸æ˜¯æœ€åä¸€ä¸ªèŠ‚ç‚¹çš„èŠ‚ç‚¹éƒ½å‘å…¶ä¸‹ä¸€ä¸ªèŠ‚ç‚¹è¿ä¸€æ¡è¾¹ï¼Œå®¹é‡ä¸º $S$ï¼Œä»£ä»·ä¸º $m$ï¼Œä»£è¡¨å­˜è´®ã€‚</p>
<p>æœ€åè·‘æœ€å°è´¹ç”¨æœ€å¤§æµå³å¯ã€‚</p>
<details class="note success"><summary><p>ç¤ºä¾‹ä»£ç </p>
</summary>
<p><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Luogu/p2000-p2999/p2517/p2517.cpp"><code>Luogu</code></a></p>

</details>

<h2 id="SDOI2009-æ™¨è·‘"><a href="#SDOI2009-æ™¨è·‘" class="headerlink" title="[SDOI2009] æ™¨è·‘"></a>[SDOI2009] æ™¨è·‘</h2><p>å°†åå­—è·¯å£æŠ½è±¡ä¸ºèŠ‚ç‚¹ï¼Œå°†è¡—é“æŠ½è±¡ä¸ºè¾¹ã€‚<br>è¿™é“é¢˜å°±ä¸éœ€è¦æˆ‘ä»¬å¦å»ºæºæ±‡ç‚¹äº†ï¼Œé¢˜ç›®ä¸­å·²ç»ç»™å‡ºäº†æºæ±‡ç‚¹ã€‚</p>
<p>ä¸€ä¸ªå‘¨æœŸå°±ç›¸å½“äºæ˜¯ä»æºç‚¹åˆ°æ±‡ç‚¹çš„ä¸€ä¸ªæµï¼Œè·¯ç¨‹å°±ç›¸å½“äºæ˜¯å…¶ä»£ä»·ã€‚</p>
<p>äºæ˜¯å°±å»ºè¾¹ï¼Œè·‘æœ€å°è´¹ç”¨æœ€å¤§æµã€‚</p>
<details class="note success"><summary><p>ç¤ºä¾‹ä»£ç </p>
</summary>
<p><a href="https://github.com/KaiserWilheim/OIcodes/blob/main/Luogu/p2000-p2999/p2153/p2153.cpp"><code>Luogu</code></a></p>

</details>

<!-- <details class="note success"><summary><p>ç¤ºä¾‹ä»£ç </p>
</summary>

</details> -->
]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>é¢˜è§£</tag>
        <tag>ç½‘ç»œæµ</tag>
      </tags>
  </entry>
  <entry>
    <title>ç½‘ç»œæµ</title>
    <url>/OI/flow/</url>
    <content><![CDATA[<p>ç½‘ç»œæµã€‚</p>
<span id="more"></span>

<p>ï¼ˆ3-13è‡³3-14é‡ä¿®ï¼‰</p>
<h1 id="ä»€ä¹ˆæ˜¯ç½‘ç»œæµ"><a href="#ä»€ä¹ˆæ˜¯ç½‘ç»œæµ" class="headerlink" title="ä»€ä¹ˆæ˜¯ç½‘ç»œæµ"></a>ä»€ä¹ˆæ˜¯ç½‘ç»œæµ</h1><p>ç½‘ç»œæµæ˜¯æŒ‡åœ¨<strong>ç½‘ç»œ</strong>ï¼ˆæˆ–è€…æµç½‘ç»œï¼Œ Flow Network ï¼‰ä¸­çš„<strong>æµ</strong>ã€‚</p>
<h2 id="ç½‘ç»œ"><a href="#ç½‘ç»œ" class="headerlink" title="ç½‘ç»œ"></a>ç½‘ç»œ</h2><p>ç½‘ç»œæ˜¯æŒ‡ä¸€ä¸ªæœ‰å‘å›¾ $G&#x3D;(V,E)$ã€‚</p>
<p>æ¯æ¡è¾¹ $(u,v)\in E$ éƒ½æœ‰ä¸€ä¸ªæƒå€¼ $c(u,v)$ï¼Œç§°ä¹‹ä¸ºå®¹é‡ï¼ˆCapacityï¼‰ï¼Œå½“ $(u,v)\notin E$ æ—¶æœ‰ $c(u,v)&#x3D;0$ã€‚</p>
<p>å…¶ä¸­æœ‰ä¸¤ä¸ªç‰¹æ®Šçš„ç‚¹ï¼šæºç‚¹ï¼ˆSourceï¼‰$s\in V$ å’Œæ±‡ç‚¹ï¼ˆSinkï¼‰$t\in V,(s\neq t)$ã€‚</p>
<h2 id="æµ"><a href="#æµ" class="headerlink" title="æµ"></a>æµ</h2><p>è®¾ $f(u,v)$ å®šä¹‰åœ¨äºŒå…ƒç»„ $(u\in V,v\in V)$ ä¸Šçš„å®æ•°å‡½æ•°ä¸”æ»¡è¶³</p>
<ol>
<li>å®¹é‡é™åˆ¶ï¼šå¯¹äºæ¯æ¡è¾¹ï¼Œæµç»è¯¥è¾¹çš„æµé‡ä¸å¾—è¶…è¿‡è¯¥è¾¹çš„å®¹é‡ï¼Œå³ï¼Œ$f(u,v)\leq c(u,v)$</li>
<li>æ–œå¯¹ç§°æ€§ï¼šæ¯æ¡è¾¹çš„æµé‡ä¸å…¶ç›¸åè¾¹çš„æµé‡ä¹‹å’Œä¸º 0ï¼Œå³ $f(u,v)&#x3D;-f(v,u)$</li>
<li>æµå®ˆæ’æ€§ï¼šä»æºç‚¹æµå‡ºçš„æµé‡ç­‰äºæ±‡ç‚¹æµå…¥çš„æµé‡ï¼Œå³ $\forall x\in V - \lbrace s,t \rbrace , \sum_{(u,x) \in E} f(u,x) &#x3D; \sum_{(x,v) \in E} f(x,v)$</li>
</ol>
<p>é‚£ä¹ˆ $f$ ç§°ä¸ºç½‘ç»œ $G$ çš„æµå‡½æ•°ã€‚å¯¹äº $(u,v)\in E$ï¼Œ$f(u,v)$ ç§°ä¸ºè¾¹çš„<strong>æµé‡</strong>ï¼Œ$c(u,v)-f(u,v)$ ç§°ä¸ºè¾¹çš„<strong>å‰©ä½™å®¹é‡</strong>ã€‚æ•´ä¸ªç½‘ç»œçš„æµé‡ä¸º $\sum_{(s,v)\in E}f(s,v)$ï¼Œå³<strong>ä»æºç‚¹å‘å‡ºçš„æ‰€æœ‰æµé‡ä¹‹å’Œ</strong>ã€‚</p>
<p>ä¸€èˆ¬è€Œè¨€ä¹Ÿå¯ä»¥æŠŠç½‘ç»œæµç†è§£ä¸ºæ•´ä¸ªå›¾çš„æµé‡ã€‚è€Œè¿™ä¸ªæµé‡å¿…æ»¡è¶³ä¸Šè¿°ä¸‰ä¸ªæ€§è´¨ã€‚</p>
<p>æµå‡½æ•°çš„å®Œæ•´å®šä¹‰ä¸º</p>
<p>$$<br>f(u,v)&#x3D;<br>\begin{cases}<br>f(u,v), &amp; (u,v) \in E, \\<br>-f(v,u), &amp; (v,u) \in E, \\<br>0, &amp; (u,v) \not\in E , (v,u) \not\in E.<br>\end{cases}<br>$$</p>
<h3 id="åå‘è¾¹"><a href="#åå‘è¾¹" class="headerlink" title="åå‘è¾¹"></a>åå‘è¾¹</h3><p>åå‘è¾¹æ˜¯ç½‘ç»œæµä¸­å¾ˆé‡è¦çš„ä¸€ç±»è¾¹ã€‚</p>
<p>ä¸€èˆ¬çš„æ—¶å€™ï¼Œåœ¨é¢˜ç›®ç»™å®šçš„æµç½‘ç»œä¸­æ˜¯ä¸åŒ…å«æœ‰å…³åå‘è¾¹çš„ä¿¡æ¯çš„ï¼Œæˆ‘ä»¬ç”»å›¾çš„æ—¶å€™ä¹Ÿä¸€èˆ¬ä¸å°†åå‘è¾¹ç”»å‡ºæ¥ã€‚</p>
<p>ä½†æ˜¯ï¼Œåå‘è¾¹å¯ä»¥åˆ©ç”¨æµç½‘ç»œçš„ä¸€äº›æ€§è´¨ï¼Œé€šè¿‡å¯¹å…¶æµé‡è¿›è¡Œæ“ä½œï¼Œä½¿å¾—æˆ‘ä»¬çš„å­ç¨‹åºå¯ä»¥ç»ç”±å…¶è¿›è¡Œåæ‚”çš„æ“ä½œã€‚</p>
<p>å»ºç«‹åå‘è¾¹çš„æ—¶å€™å¯ä»¥ä½¿ç”¨ä¸€äº›å°trickã€‚</p>
<p>æˆ‘ä»¬å¦‚æœä½¿ç”¨é‚»æ¥è¡¨ï¼ˆæˆ–ç§°é“¾å¼å‰å‘æ˜Ÿï¼‰æ¥å»ºå›¾çš„è¯ï¼Œå¯ä»¥é€‰æ‹©åŒæ—¶å»ºæ­£å‘è¾¹å’Œåå‘è¾¹ï¼Œå¹¶ä½¿è¾¹çš„ç¼–å·ä»0å¼€å§‹ï¼Œä»è€Œå¯ä»¥é€šè¿‡ä½¿ç”¨å¼‚æˆ–æ“ä½œæ¥è®¿é—®å½“å‰è¾¹çš„åå‘è¾¹ã€‚</p>
<h2 id="ç½‘ç»œæµçš„å¸¸è§é—®é¢˜"><a href="#ç½‘ç»œæµçš„å¸¸è§é—®é¢˜" class="headerlink" title="ç½‘ç»œæµçš„å¸¸è§é—®é¢˜"></a>ç½‘ç»œæµçš„å¸¸è§é—®é¢˜</h2><p>ç½‘ç»œæµé—®é¢˜ä¸­å¸¸è§çš„æœ‰ä»¥ä¸‹ä¸‰ç§ï¼šæœ€å¤§æµï¼Œæœ€å°å‰²ï¼Œè´¹ç”¨æµã€‚</p>
<p>è§£å†³ç½‘ç»œæµé—®é¢˜çš„éš¾ç‚¹ä¸æ˜¯ç®—æ³•æˆ–è€…ä»£ç ï¼Œè€Œæ˜¯å»ºå›¾ã€‚å¯¹äºå¤§å¤šæ•°çš„ç½‘ç»œæµé¢˜ç›®ï¼Œæˆ‘ä»¬éœ€è¦ä»”ç»†åˆ†è¾¨ç¢ç£¨æ‰å¯ä»¥çŸ¥é“å¦‚ä½•å°†é—®é¢˜è½¬æ¢ä¸ºç½‘ç»œæµè¿™å‡ ç§é—®é¢˜çš„å…¶ä¸­ä¸€ç§æˆ–å‡ ç§ï¼Œå¹¶å°†é¢˜ç›®ä¸­çš„é™åˆ¶ç”¨è¾¹&#x2F;ç‚¹çš„é™åˆ¶ä½“ç°å‡ºæ¥ã€‚</p>
<h1 id="æœ€å¤§æµ"><a href="#æœ€å¤§æµ" class="headerlink" title="æœ€å¤§æµ"></a>æœ€å¤§æµ</h1><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>å¯¹äºä¸€ä¸ªç»™å®šçš„ç½‘ç»œï¼Œå…¶åˆæ³•çš„æµå‡½æ•°å…¶å®æœ‰å¾ˆå¤šã€‚å…¶ä¸­ä½¿å¾—æ•´ä¸ªç½‘ç»œçš„æµé‡æœ€å¤§çš„æµå‡½æ•°è¢«ç§°ä¸ºç½‘ç»œçš„æœ€å¤§æµã€‚</p>
<p>æ±‚è§£ä¸€ä¸ªç½‘ç»œçš„æœ€å¤§æµå…¶å®æœ‰å¾ˆå¤šç”¨å¤„ï¼Œä¾‹å¦‚å¯ä»¥å°†äºŒåˆ†å›¾çš„æœ€å¤§åŒ¹é…é—®é¢˜è½¬åŒ–ä¸ºæ±‚è§£æœ€å¤§æµã€‚</p>
<p>æ±‚è§£æœ€å¤§æµçš„ç®—æ³•æœ‰å¾ˆå¤šç§ï¼Œæ¯”å¦‚Ford-Fulkersonå¢å¹¿è·¯ç®—æ³•ã€Push-Relableé¢„æµæ¨è¿›ç®—æ³•ç­‰ç­‰ã€‚<br>å®é™…ä¸Šï¼Œæœ€å¸¸ç”¨çš„è¿˜æ˜¯Ford-Fulkersonå¢å¹¿è·¯ç®—æ³•ä¸­çš„EKå’ŒDinicä¸¤ç§ã€‚</p>
<h2 id="Ford-Fulkerson-å¢å¹¿è·¯ç®—æ³•"><a href="#Ford-Fulkerson-å¢å¹¿è·¯ç®—æ³•" class="headerlink" title="Ford-Fulkerson å¢å¹¿è·¯ç®—æ³•"></a>Ford-Fulkerson å¢å¹¿è·¯ç®—æ³•</h2><p>è¯¥æ–¹æ³•é€šè¿‡å¯»æ‰¾å¢å¹¿è·¯æ¥æ›´æ–°æœ€å¤§æµï¼Œæœ‰EK,dinic,SAP,ISAPç­‰ä¸»æµç®—æ³•ã€‚</p>
<p>æ±‚è§£æœ€å¤§æµä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆè®¤è¯†ä¸€äº›æ¦‚å¿µã€‚</p>
<h3 id="æ®‹é‡ç½‘ç»œ"><a href="#æ®‹é‡ç½‘ç»œ" class="headerlink" title="æ®‹é‡ç½‘ç»œ"></a>æ®‹é‡ç½‘ç»œ</h3><p>é¦–å…ˆæˆ‘ä»¬ä»‹ç»ä¸€ä¸‹ä¸€æ¡è¾¹çš„å‰©ä½™å®¹é‡ $c_f(u,v)$ï¼ˆResidual Capacityï¼‰ï¼Œå®ƒè¡¨ç¤ºçš„æ˜¯è¿™æ¡è¾¹çš„å®¹é‡ä¸æµé‡ä¹‹å·®ï¼Œå³ $c_f(u,v) &#x3D; c(u,v) - f(u,v)$ã€‚</p>
<p>å¯¹äºæµå‡½æ•° $f$ï¼Œæ®‹å­˜ç½‘ç»œ $G_f$ï¼ˆResidual Networkï¼‰æ˜¯ç½‘ç»œ $G$ ä¸­æ‰€æœ‰ç»“ç‚¹å’Œ<strong>å‰©ä½™å®¹é‡å¤§äº 0</strong> çš„è¾¹æ„æˆçš„å­å›¾ã€‚å½¢å¼åŒ–çš„å®šä¹‰ï¼Œå³ $G_f &#x3D; (V_f &#x3D; V,E_f &#x3D; \lbrace(u,v) \in E,c_f(u,v) &gt; 0 \rbrace)$ã€‚</p>
<p>æ³¨æ„ï¼Œå‰©ä½™å®¹é‡å¤§äº 0 çš„è¾¹å¯èƒ½ä¸åœ¨åŸå›¾ $G$ ä¸­ï¼ˆæ ¹æ®å®¹é‡ã€å‰©ä½™å®¹é‡çš„å®šä¹‰ä»¥åŠæµå‡½æ•°çš„æ–œå¯¹ç§°æ€§å¾—åˆ°ï¼‰ã€‚å¯ä»¥ç†è§£ä¸ºï¼Œæ®‹é‡ç½‘ç»œä¸­åŒ…æ‹¬äº†é‚£äº›è¿˜å‰©äº†æµé‡ç©ºé—´çš„è¾¹æ„æˆçš„å›¾ï¼Œä¹ŸåŒ…æ‹¬è™šè¾¹ï¼ˆå³åå‘è¾¹ï¼‰ã€‚</p>
<h3 id="å¢å¹¿è·¯"><a href="#å¢å¹¿è·¯" class="headerlink" title="å¢å¹¿è·¯"></a>å¢å¹¿è·¯</h3><p>åœ¨åŸå›¾ $G$ ä¸­è‹¥ä¸€æ¡ä»æºç‚¹åˆ°æ±‡ç‚¹çš„è·¯å¾„ä¸Šæ‰€æœ‰è¾¹çš„<strong>å‰©ä½™å®¹é‡éƒ½å¤§äº 0</strong>ï¼Œè¿™æ¡è·¯è¢«ç§°ä¸ºå¢å¹¿è·¯ï¼ˆAugmenting Pathï¼‰ã€‚</p>
<p>æˆ–è€…è¯´ï¼Œåœ¨æ®‹å­˜ç½‘ç»œ $G_f$ ä¸­ï¼Œä¸€æ¡ä»æºç‚¹åˆ°æ±‡ç‚¹çš„è·¯å¾„è¢«ç§°ä¸ºå¢å¹¿è·¯ã€‚å¦‚å›¾ï¼š</p>
<p><img src="https://s2.loli.net/2022/02/28/T4tHBFq3yCSarhu.png" alt="maxflow1.png"></p>
<p>æˆ‘ä»¬ä» $4$ åˆ° $3$ï¼Œè‚¯å®šå¯ä»¥å…ˆä»æµé‡ä¸º $20$ çš„è¿™æ¡è¾¹å…ˆèµ°ã€‚é‚£ä¹ˆè¿™æ¡è¾¹å°±è¢«èµ°æ‰äº†ï¼Œä¸èƒ½å†é€‰ï¼Œæ€»çš„æµé‡ä¸º $20$ï¼ˆç°åœ¨ï¼‰ã€‚ç„¶åæˆ‘ä»¬å¯ä»¥è¿™æ ·é€‰æ‹©ï¼š</p>
<ol>
<li><p>$4 \to 2 \to 3$ è¿™æ¡ <strong>å¢å¹¿è·¯</strong> çš„æ€»æµé‡ä¸º $20$ã€‚åˆ° $2$ çš„æ—¶å€™è¿˜æ˜¯ $30$ï¼Œåˆ° $3$ äº†å°±åªæœ‰ $20$ äº†ã€‚</p>
</li>
<li><p>$4 \to 2 \to 1 \to 3$ è¿™æ ·å­æˆ‘ä»¬å°±å¾ˆå¥½çš„ä¿ç•™äº† $30$ çš„æµé‡ã€‚</p>
</li>
</ol>
<p>æ‰€ä»¥æˆ‘ä»¬è¿™å¼ å›¾çš„æœ€å¤§æµå°±åº”è¯¥æ˜¯ $20 + 30 &#x3D; 50$ã€‚</p>
<h3 id="Edmonds-Karp-åŠ¨èƒ½ç®—æ³•"><a href="#Edmonds-Karp-åŠ¨èƒ½ç®—æ³•" class="headerlink" title="Edmonds-Karp åŠ¨èƒ½ç®—æ³•"></a>Edmonds-Karp åŠ¨èƒ½ç®—æ³•</h3><p>è¿™ä¸ªç®—æ³•å¾ˆç®€å•ï¼Œå°±æ˜¯BFS<strong>æ‰¾å¢å¹¿è·¯</strong>ï¼Œç„¶åå¯¹å…¶è¿›è¡Œ<strong>å¢å¹¿</strong>ï¼Œç›´åˆ°å›¾ä¸Šå†ä¹Ÿæ²¡æœ‰å¢å¹¿è·¯äº†ä¸ºæ­¢ã€‚</p>
<p>æˆ‘ä»¬ä¸ç”¨ç®¡æˆ‘ä»¬æ‰¾åˆ°çš„å¢å¹¿è·¯çš„æ­£ç¡®æ€§ï¼Œæ¯•ç«Ÿå¦‚æœæˆ‘ä»¬æ‰¾åˆ°äº†ä¸€æ¡æ›´ä¼˜çš„è·¯å¾„çš„è¯å¯ä»¥é€šè¿‡ä¹‹å‰ç»è¿‡çš„åå‘è¾¹è¿›è¡Œåæ‚”ã€‚è¿™ä¹Ÿå°±æ„å‘³ç€ï¼Œæˆ‘ä»¬æ¯æ¬¡éœ€è¦BFSçš„è¾¹é¸¡æ˜¯åŒ…æ‹¬åå‘è¾¹çš„ã€‚</p>
<p>åœ¨å…·ä½“å®ç°çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ¯ä¸€æ¬¡æ‰¾åˆ°å¢å¹¿è·¯çš„æ—¶å€™ï¼Œè®°å½•ä¸‹è¿™æ¡è·¯å¾„ä¸Šæ‰€æœ‰çš„æœ€å°æµé‡ $minf$ ï¼Œé‚£ä¹ˆæ•´ä¸ªå›¾çš„æµé‡å°±å¢åŠ äº† $minf$ã€‚åŒæ—¶æˆ‘ä»¬ç»™è¿™æ¡è·¯å¾„ä¸Šçš„æ‰€æœ‰è¾¹çš„åå‘è¾¹éƒ½åŠ ä¸Š $minf$ çš„å®¹é‡ï¼Œä»¥ä¾¿å°†æ¥åæ‚”ã€‚</p>
<p>EK ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º $O(nm^2)$ï¼ˆå…¶ä¸­ $n$ ä¸ºç‚¹æ•°ï¼Œ$m$ ä¸ºè¾¹æ•°ï¼‰ã€‚<br>å…¶æ•ˆç‡è¿˜æœ‰å¾ˆå¤§æå‡ç©ºé—´ï¼Œä½†å®é™…æƒ…å†µä¸‹ä¸ä¸€å®šèƒ½è·‘æ»¡ï¼Œåº”ä»˜ $10^3 \sim 10^4$ å¤§å°çš„å›¾åº”è¯¥è¶³å¤Ÿäº†ã€‚</p>
<p>å‚è€ƒä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1010</span>, M = <span class="number">20010</span>, INF = <span class="number">1e8</span>;</span><br><span class="line"><span class="type">int</span> n, m, S, T;</span><br><span class="line"><span class="type">int</span> h[N], e[M], f[M], ne[M], idx;</span><br><span class="line"><span class="type">int</span> q[N], d[N], pre[N];</span><br><span class="line"><span class="type">bool</span> st[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[idx] = b, f[idx] = c, ne[idx] = h[a], h[a] = idx++;</span><br><span class="line">    e[idx] = a, f[idx] = <span class="number">0</span>, ne[idx] = h[b], h[b] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">bfs</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> hh = <span class="number">0</span>, tt = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(st, <span class="literal">false</span>, <span class="built_in">sizeof</span>(st));</span><br><span class="line">    q[<span class="number">0</span>] = S, st[S] = <span class="literal">true</span>, d[S] = INF;</span><br><span class="line">    <span class="keyword">while</span>(hh &lt;= tt)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> t = q[hh++];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = h[t]; ~i; i = ne[i])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> ver = e[i];</span><br><span class="line">            <span class="keyword">if</span>(!st[ver] &amp;&amp; f[i])</span><br><span class="line">            &#123;</span><br><span class="line">                st[ver] = <span class="literal">true</span>;</span><br><span class="line">                d[ver] = <span class="built_in">min</span>(d[t], f[i]);</span><br><span class="line">                pre[ver] = i;</span><br><span class="line">                <span class="keyword">if</span>(ver == T) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                q[++tt] = ver;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">EK</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> r = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">bfs</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        r += d[T];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = T; i != S; i = e[pre[i] ^ <span class="number">1</span>])</span><br><span class="line">            f[pre[i]] -= d[T], f[pre[i] ^ <span class="number">1</span>] += d[T];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;S, &amp;T);</span><br><span class="line">    <span class="built_in">memset</span>(h, <span class="number">-1</span>, <span class="built_in">sizeof</span>(h));</span><br><span class="line">    <span class="keyword">while</span>(m--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> a, b, c;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;c);</span><br><span class="line">        <span class="built_in">add</span>(a, b, c);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">EK</span>());</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Dinic-ç®—æ³•"><a href="#Dinic-ç®—æ³•" class="headerlink" title="Dinic ç®—æ³•"></a>Dinic ç®—æ³•</h3><p>EK ç®—æ³•æ¯ä¸€æ¬¡éå†æ®‹é‡ç½‘ç»œçš„æ—¶å€™åªèƒ½æœ€å¤šæ‰¾åˆ°ä¸€æ¡å¢å¹¿è·¯ï¼Œä½†å¾ˆå¯èƒ½æˆ‘ä»¬çš„å­ç¨‹åºä¸ºæ­¤è€Œéå†äº†æ•´ä¸ªæ®‹é‡ç½‘ç»œã€‚è¿™é‡Œè¿˜æœ‰å¾ˆå¤§çš„ä¼˜åŒ–ç©ºé—´ã€‚</p>
<p><strong>Dinic ç®—æ³•</strong>çš„è¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼šæ¯æ¬¡å¢å¹¿å‰ï¼Œæˆ‘ä»¬å…ˆç”¨ BFS æ¥å°†å›¾åˆ†å±‚ã€‚è®¾æºç‚¹çš„å±‚æ•°ä¸º $0$ï¼Œé‚£ä¹ˆä¸€ä¸ªç‚¹çš„å±‚æ•°ä¾¿æ˜¯å®ƒç¦»æºç‚¹çš„æœ€è¿‘è·ç¦»ã€‚</p>
<p>é€šè¿‡åˆ†å±‚ï¼Œæˆ‘ä»¬å¯ä»¥å¹²ä¸¤ä»¶äº‹æƒ…ï¼š</p>
<ol>
<li>å¦‚æœä¸å­˜åœ¨åˆ°æ±‡ç‚¹çš„å¢å¹¿è·¯ï¼ˆå³æ±‡ç‚¹çš„å±‚æ•°ä¸å­˜åœ¨ï¼‰ï¼Œæˆ‘ä»¬å³å¯åœæ­¢å¢å¹¿ã€‚</li>
<li>ç¡®ä¿æˆ‘ä»¬æ‰¾åˆ°çš„å¢å¹¿è·¯æ˜¯æœ€çŸ­çš„ã€‚ï¼ˆåŸå› è§ä¸‹æ–‡ï¼‰</li>
</ol>
<p>æ¥ä¸‹æ¥æ˜¯ DFS æ‰¾å¢å¹¿è·¯çš„è¿‡ç¨‹ã€‚</p>
<p>æˆ‘ä»¬æ¯æ¬¡æ‰¾å¢å¹¿è·¯çš„æ—¶å€™ï¼Œéƒ½åªæ‰¾æ¯”å½“å‰ç‚¹å±‚æ•°å¤š $1$ çš„ç‚¹è¿›è¡Œå¢å¹¿ï¼ˆè¿™æ ·å°±å¯ä»¥ç¡®ä¿æˆ‘ä»¬æ‰¾åˆ°çš„å¢å¹¿è·¯æ˜¯æœ€çŸ­çš„ï¼‰ã€‚</p>
<p>Dinic ç®—æ³•ä¼šä¸æ–­é‡å¤è¿™ä¸¤ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°æ²¡æœ‰å¢å¹¿è·¯äº†ä¸ºæ­¢ã€‚</p>
<p>Dinic ç®—æ³•æœ‰ä¸¤ä¸ªä¼˜åŒ–ï¼š</p>
<ol>
<li><strong>å¤šè·¯å¢å¹¿</strong>ï¼šæ¯æ¬¡æ‰¾åˆ°ä¸€æ¡å¢å¹¿è·¯çš„æ—¶å€™ï¼Œå¦‚æœæ®‹ä½™æµé‡æ²¡æœ‰ç”¨å®Œæ€ä¹ˆåŠå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ®‹ä½™éƒ¨åˆ†æµé‡ï¼Œå†æ‰¾å‡ºä¸€æ¡å¢å¹¿è·¯ã€‚è¿™æ ·å°±å¯ä»¥åœ¨ä¸€æ¬¡ DFS ä¸­æ‰¾å‡ºå¤šæ¡å¢å¹¿è·¯ï¼Œå¤§å¤§æé«˜äº†ç®—æ³•çš„æ•ˆç‡ã€‚</li>
<li><strong>å½“å‰å¼§ä¼˜åŒ–</strong>ï¼šå¦‚æœä¸€æ¡è¾¹å·²ç»è¢«å¢å¹¿è¿‡ï¼Œé‚£ä¹ˆå®ƒå°±æ²¡æœ‰å¯èƒ½è¢«å¢å¹¿ç¬¬äºŒæ¬¡ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬ä¸‹ä¸€æ¬¡è¿›è¡Œå¢å¹¿çš„æ—¶å€™ï¼Œå°±å¯ä»¥ä¸å¿…å†èµ°é‚£äº›å·²ç»è¢«å¢å¹¿è¿‡çš„è¾¹ã€‚</li>
</ol>
<p>Dinic ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(n^2m)$ çº§åˆ«çš„ï¼Œä½†å®é™…ä¸Šå…¶å®è·‘ä¸æ»¡è¿™ä¸ªä¸Šé™ã€‚<br>Dinicç®—æ³•å¯ä»¥è¯´æ˜¯ç®—æ³•å®ç°éš¾æ˜“ç¨‹åº¦ä¸æ—¶é—´å¤æ‚åº¦è¾ƒä¸ºå¹³è¡¡çš„ä¸€ä¸ªç®—æ³•ï¼Œå¯ä»¥åº”å¯¹ $10^4 \sim 10^5$çº§åˆ«çš„å›¾ã€‚<br>ç‰¹åˆ«çš„ï¼ŒDinicç®—æ³•åœ¨æ±‚è§£äºŒåˆ†å›¾æœ€å¤§åŒ¹é…é—®é¢˜çš„æ—¶å€™çš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(m\sqrt{n})$ çº§åˆ«çš„ï¼Œå®é™…æƒ…å†µä¸‹åˆ™æ¯”è¿™æ›´ä¼˜ã€‚</p>
<details class="note info"><summary><p>æ—¶é—´å¤æ‚åº¦è¯æ˜</p>
</summary>
<p>æ¬è‡ª OI-Wiki</p>
<h4 id="æ—¶é—´å¤æ‚åº¦"><a href="#æ—¶é—´å¤æ‚åº¦" class="headerlink" title="æ—¶é—´å¤æ‚åº¦"></a>æ—¶é—´å¤æ‚åº¦</h4><p>è®¾ç‚¹æ•°ä¸º $n$ï¼Œè¾¹æ•°ä¸º $m$ï¼Œé‚£ä¹ˆ Dinic ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ï¼ˆåœ¨åº”ç”¨ä¸Šé¢ä¸¤ä¸ªä¼˜åŒ–çš„å‰æä¸‹ï¼‰æ˜¯ $O(n^2m)$ï¼Œåœ¨ç¨€ç–å›¾ä¸Šæ•ˆç‡å’Œ EK ç®—æ³•ç›¸å½“ï¼Œä½†åœ¨ç¨ å¯†å›¾ä¸Šæ•ˆç‡è¦æ¯” EK ç®—æ³•é«˜å¾ˆå¤šã€‚</p>
<p>é¦–å…ˆè€ƒè™‘å•è½®å¢å¹¿çš„è¿‡ç¨‹ã€‚åœ¨åº”ç”¨äº†<strong>å½“å‰å¼§ä¼˜åŒ–</strong>çš„å‰æä¸‹ï¼Œå¯¹äºæ¯ä¸ªç‚¹ï¼Œæˆ‘ä»¬ç»´æŠ¤ä¸‹ä¸€æ¡å¯ä»¥å¢å¹¿çš„è¾¹ï¼Œè€Œå½“å‰å¼§æœ€å¤šå˜åŒ– $m$ æ¬¡ï¼Œä»è€Œå•è½®å¢å¹¿çš„æœ€åæ—¶é—´å¤æ‚åº¦ä¸º $O(nm)$ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬è¯æ˜ï¼Œæœ€å¤šåªéœ€ $n-1$ è½®å¢å¹¿å³å¯å¾—åˆ°æœ€å¤§æµã€‚</p>
<p>æˆ‘ä»¬å…ˆå›é¡¾ä¸‹ Dinic çš„å¢å¹¿è¿‡ç¨‹ã€‚å¯¹äºæ¯ä¸ªç‚¹ï¼ŒDinic åªä¼šæ‰¾æ¯”è¯¥ç‚¹å±‚æ•°å¤š $1$ çš„ç‚¹è¿›è¡Œå¢å¹¿ã€‚</p>
<p>é¦–å…ˆå®¹æ˜“å‘ç°ï¼Œå¯¹äºå›¾ä¸Šçš„æ¯ä¸ªç‚¹ï¼Œä¸€è½®å¢å¹¿åå…¶å±‚æ•°ä¸€å®šä¸ä¼šå‡å°ã€‚è€Œå¯¹äºæ±‡ç‚¹ $t$ï¼Œæƒ…å†µä¼šç‰¹æ®Šä¸€äº›ï¼Œå…¶å±‚æ•°åœ¨ä¸€è½®å¢å¹¿åä¸€å®šå¢å¤§ã€‚</p>
<p>å¯¹äºåè€…ï¼Œæˆ‘ä»¬è€ƒè™‘ç”¨åè¯æ³•è¯æ˜ã€‚å¦‚æœ $t$ çš„å±‚æ•°åœ¨ä¸€è½®å¢å¹¿åä¸å˜ï¼Œåˆ™æ„å‘³ç€åœ¨ä¸Šä¸€æ¬¡å¢å¹¿ä¸­ï¼Œä»ç„¶å­˜åœ¨ç€ä¸€æ¡ä» $s$ åˆ° $t$ çš„å¢å¹¿è·¯ï¼Œä¸”è¯¥å¢å¹¿è·¯ä¸Šç›¸é‚»ä¸¤ç‚¹é—´çš„å±‚æ•°å·®ä¸º $1$ã€‚è¿™æ¡å¢å¹¿è·¯åº”è¯¥åœ¨ä¸Šä¸€æ¬¡å¢å¹¿è¿‡ç¨‹ä¸­å°±è¢«å¢å¹¿äº†ï¼Œè¿™å°±å‡ºç°äº†çŸ›ç›¾ã€‚</p>
<p>ä»è€Œæˆ‘ä»¬è¯æ˜äº†æ±‡ç‚¹çš„å±‚æ•°åœ¨ä¸€è½®å¢å¹¿åä¸€å®šå¢å¤§ï¼Œå³å¢å¹¿è¿‡ç¨‹æœ€å¤šè¿›è¡Œ $n-1$ æ¬¡ã€‚</p>
<p>ç»¼ä¸Š Dinic çš„æœ€åæ—¶é—´å¤æ‚åº¦ä¸º $O(n^{2}m)$ã€‚äº‹å®ä¸Šåœ¨ä¸€èˆ¬çš„ç½‘ç»œä¸Šï¼ŒDinic ç®—æ³•å¾€å¾€è¾¾ä¸åˆ°è¿™ä¸ªä¸Šç•Œã€‚</p>
<p>ç‰¹åˆ«åœ°ï¼Œåœ¨æ±‚è§£äºŒåˆ†å›¾æœ€å¤§åŒ¹é…é—®é¢˜æ—¶ï¼ŒDinic ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(m\sqrt{n})$ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°†ç»™å‡ºè¯æ˜ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬æ¥ç®€å•å½’çº³ä¸‹æ±‚è§£äºŒåˆ†å›¾æœ€å¤§åŒ¹é…é—®é¢˜æ—¶ï¼Œå»ºç«‹çš„ç½‘ç»œçš„ç‰¹ç‚¹ã€‚æˆ‘ä»¬å‘ç°è¿™ä¸ªç½‘ç»œä¸­ï¼Œæ‰€æœ‰è¾¹çš„æµé‡å‡ä¸º $1$ï¼Œä¸”é™¤äº†æºç‚¹å’Œæ±‡ç‚¹å¤–çš„æ‰€æœ‰ç‚¹ï¼Œéƒ½æ»¡è¶³å…¥è¾¹æœ€å¤šåªæœ‰ä¸€æ¡ï¼Œæˆ–å‡ºè¾¹æœ€å¤šåªæœ‰ä¸€æ¡ã€‚æˆ‘ä»¬ç§°è¿™æ ·çš„ç½‘ç»œä¸º<strong>å•ä½ç½‘ç»œ</strong>ã€‚</p>
<p>å¯¹äºå•ä½ç½‘ç»œï¼Œä¸€è½®å¢å¹¿çš„æ—¶é—´å¤æ‚åº¦ä¸º $O(m)$ï¼Œå› ä¸ºæ¯æ¡è¾¹åªä¼šè¢«è€ƒè™‘æœ€å¤šä¸€æ¬¡ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬è¯•ç€æ±‚å‡ºå¢å¹¿è½®æ•°çš„ä¸Šç•Œã€‚å‡è®¾æˆ‘ä»¬å·²ç»å…ˆå®Œæˆäº†å‰ $\sqrt{n}$ è½®å¢å¹¿ï¼Œå› ä¸ºæ±‡ç‚¹çš„å±‚æ•°åœ¨æ¯æ¬¡å¢å¹¿åå‡ä¸¥æ ¼å¢åŠ ï¼Œå› æ­¤æ‰€æœ‰é•¿åº¦ä¸è¶…è¿‡ $\sqrt{n}$ çš„å¢å¹¿è·¯éƒ½å·²ç»åœ¨ä¹‹å‰çš„å¢å¹¿è¿‡ç¨‹ä¸­è¢«å¢å¹¿ã€‚è®¾å‰ $\sqrt{n}$ è½®å¢å¹¿åï¼Œç½‘ç»œçš„æµé‡ä¸º $f$ï¼Œè€Œæ•´ä¸ªç½‘ç»œçš„æœ€å¤§æµä¸º $fâ€™$ï¼Œè®¾ä¸¤è€…é—´çš„å·®å€¼ $d&#x3D;fâ€™-f$ã€‚</p>
<p>å› ä¸ºç½‘ç»œä¸Šæ‰€æœ‰è¾¹çš„æµé‡å‡ä¸º $1$ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦æ‰¾åˆ° $d$ æ¡å¢å¹¿è·¯æ‰èƒ½æ‰¾åˆ°ç½‘ç»œæœ€å¤§æµã€‚åˆå› ä¸ºå•ä½ç½‘ç»œçš„ç‰¹ç‚¹ï¼Œè¿™äº›å¢å¹¿è·¯ä¸ä¼šåœ¨æºç‚¹å’Œæ±‡ç‚¹ä»¥å¤–çš„ç‚¹ç›¸äº¤ã€‚å› æ­¤è¿™äº›å¢å¹¿è·¯è‡³å°‘ç»è¿‡äº† $d\sqrt{n}$ ä¸ªç‚¹ï¼ˆæ¯æ¡å¢å¹¿è·¯çš„é•¿åº¦è‡³å°‘ä¸º $\sqrt{n}$ï¼‰ï¼Œä¸”ä¸èƒ½è¶…è¿‡ $n$ ä¸ªç‚¹ã€‚å› æ­¤æ®‹é‡ç½‘ç»œä¸Šæœ€å¤šè¿˜å­˜åœ¨ $\sqrt{n}$ æ¡å¢å¹¿è·¯ã€‚ä¹Ÿå³æœ€å¤šè¿˜éœ€å¢å¹¿ $\sqrt{n}$ è½®ã€‚</p>
<p>ç»¼ä¸Šï¼Œå¯¹äºåŒ…å«äºŒåˆ†å›¾æœ€å¤§åŒ¹é…åœ¨å†…çš„å•ä½ç½‘ç»œï¼ŒDinic ç®—æ³•å¯ä»¥åœ¨ $O(m\sqrt{n})$ çš„æ—¶é—´å†…æ±‚å‡ºå…¶æœ€å¤§æµã€‚</p>

</details>

<p>å‚è€ƒä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">10010</span>, M = <span class="number">200010</span>, INF = <span class="number">1e8</span>;</span><br><span class="line"><span class="type">int</span> n, m, S, T;</span><br><span class="line"><span class="type">int</span> h[N], e[M], f[M], ne[M], idx;</span><br><span class="line"><span class="type">int</span> q[N], d[N], cur[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[idx] = b, f[idx] = c, ne[idx] = h[a], h[a] = idx++;</span><br><span class="line">    e[idx] = a, f[idx] = <span class="number">0</span>, ne[idx] = h[b], h[b] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">bfs</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> hh = <span class="number">0</span>, tt = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(d, <span class="number">-1</span>, <span class="built_in">sizeof</span>(d));</span><br><span class="line">    q[<span class="number">0</span>] = S, d[S] = <span class="number">0</span>, cur[S] = h[S];</span><br><span class="line">    <span class="keyword">while</span>(hh &lt;= tt)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> t = q[hh++];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = h[t]; ~i; i = ne[i])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> ver = e[i];</span><br><span class="line">            <span class="keyword">if</span>(d[ver] == <span class="number">-1</span> &amp;&amp; f[i])</span><br><span class="line">            &#123;</span><br><span class="line">                d[ver] = d[t] + <span class="number">1</span>;</span><br><span class="line">                cur[ver] = h[ver];</span><br><span class="line">                <span class="keyword">if</span>(ver == T)  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                q[++tt] = ver;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> limit)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(u == T) <span class="keyword">return</span> limit;</span><br><span class="line">    <span class="type">int</span> flow = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = cur[u]; ~i &amp;&amp; flow &lt; limit; i = ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        cur[u] = i;  <span class="comment">// å½“å‰å¼§ä¼˜åŒ–</span></span><br><span class="line">        <span class="type">int</span> ver = e[i];</span><br><span class="line">        <span class="keyword">if</span>(d[ver] == d[u] + <span class="number">1</span> &amp;&amp; f[i])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> t = <span class="built_in">find</span>(ver, <span class="built_in">min</span>(f[i], limit - flow));</span><br><span class="line">            <span class="keyword">if</span>(!t) d[ver] = <span class="number">-1</span>;</span><br><span class="line">            f[i] -= t, f[i ^ <span class="number">1</span>] += t, flow += t;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> flow;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dinic</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> r = <span class="number">0</span>, flow;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">bfs</span>()) <span class="keyword">while</span>(flow = <span class="built_in">find</span>(S, INF)) r += flow;</span><br><span class="line">    <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;S, &amp;T);</span><br><span class="line">    <span class="built_in">memset</span>(h, <span class="number">-1</span>, <span class="built_in">sizeof</span>(h));</span><br><span class="line">    <span class="keyword">while</span>(m--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> a, b, c;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;c);</span><br><span class="line">        <span class="built_in">add</span>(a, b, c);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">dinic</span>());</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="æœ€å°å‰²"><a href="#æœ€å°å‰²" class="headerlink" title="æœ€å°å‰²"></a>æœ€å°å‰²</h1><h2 id="ç®€ä»‹-1"><a href="#ç®€ä»‹-1" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>å¯¹äºä¸€ä¸ªç»™å®šçš„ç½‘ç»œï¼Œæˆ‘ä»¬åˆ å»ç½‘ç»œä¸­çš„ä¸€ä¸ªè¾¹é›†ï¼Œä½¿å¾—æºç‚¹ä¸æ±‡ç‚¹ä¸è¿é€šï¼Œè¿™ä¸ªè¢«åˆ å»çš„è¾¹é›†å°±æ˜¯è¿™å¼ å›¾çš„ä¸€ä¸ª<strong>å‰²</strong>ã€‚åœ¨æ‰€æœ‰çš„å‰²ä¸­ï¼Œè¾¹é›†çš„å®¹é‡å’Œæœ€å°çš„è¢«ç§°ä¸ºæœ€å°å‰²ã€‚</p>
<h2 id="æœ€å¤§æµæœ€å°å‰²å®šç†"><a href="#æœ€å¤§æµæœ€å°å‰²å®šç†" class="headerlink" title="æœ€å¤§æµæœ€å°å‰²å®šç†"></a>æœ€å¤§æµæœ€å°å‰²å®šç†</h2><p>ä»»ä½•ä¸€ä¸ªç½‘ç»œçš„æœ€å¤§æµé‡ç­‰äºæœ€å°å‰²ä¸­è¾¹çš„å®¹é‡å€¼å’Œã€‚</p>
<h3 id="è¯æ˜"><a href="#è¯æ˜" class="headerlink" title="è¯æ˜"></a>è¯æ˜</h3><p>æˆ‘ä»¬å¦‚æœå›æƒ³ä¸€ä¸‹æœ€å¤§æµç®—æ³•èµ°å®Œä¹‹åçš„ç»“æœã€‚</p>
<p>å¯¹äºæ¯ä¸€æ¡ä»æºç‚¹åˆ°æ±‡ç‚¹çš„æµé‡ä¸ºæ­£çš„è·¯å¾„ï¼Œæˆ‘ä»¬éƒ½èƒ½æ‰¾åˆ°è‡³å°‘ä¸€æ¡å®¹é‡è·‘æ»¡çš„è¾¹ã€‚</p>
<p>è¿™äº›è¾¹çš„å®¹é‡ä¹‹å’Œå°±æ˜¯æˆ‘ä»¬æœ€ç»ˆå¾—åˆ°çš„æœ€å¤§æµã€‚</p>
<p>æˆ‘ä»¬è€ƒè™‘å°†è¿™äº›è¾¹åˆ å»ã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬å¦‚æœå¯¹å‰©ä¸‹çš„è¾¹è·‘æœ€å¤§æµç®—æ³•çš„è¯ï¼Œæˆ‘ä»¬å¾—åˆ°çš„æœ€å¤§æµå°†ä¼šæ˜¯0ï¼Œä¹Ÿå°±æ„å‘³ç€æºç‚¹å°†ä¸å†ä¸æ±‡ç‚¹ç›´æ¥è¿é€šã€‚</p>
<p>è¿™äº›è·‘æ»¡çš„è¾¹æ„æˆçš„è¾¹é›†å°±æ»¡è¶³äº†æˆ‘ä»¬å¯¹å‰²çš„å®šä¹‰ã€‚</p>
<h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><p>æ‰€ä»¥è¯´ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥ç”¨æ±‚è§£æœ€å¤§æµçš„ç®—æ³•æ¥æ±‚è§£æœ€å°å‰²é—®é¢˜ã€‚</p>
<h1 id="è´¹ç”¨æµ"><a href="#è´¹ç”¨æµ" class="headerlink" title="è´¹ç”¨æµ"></a>è´¹ç”¨æµ</h1><h2 id="ç®€ä»‹-2"><a href="#ç®€ä»‹-2" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>ç»™å®šä¸€ä¸ªç½‘ç»œ $G&#x3D;(V,E)$ï¼Œæ¯æ¡è¾¹é™¤äº†æœ‰å®¹é‡é™åˆ¶ $c(u,v)$ï¼Œè¿˜æœ‰ä¸€ä¸ªå•ä½æµé‡çš„è´¹ç”¨ $w(u,v)$ã€‚</p>
<p>å½“ $(u,v)$ çš„æµé‡ä¸º $f(u,v)$ æ—¶ï¼Œéœ€è¦èŠ±è´¹ $f(u,v)\times w(u,v)$ çš„è´¹ç”¨ã€‚</p>
<p>$w$ ä¹Ÿæ»¡è¶³æ–œå¯¹ç§°æ€§ï¼Œå³ $w(u,v)&#x3D;-w(v,u)$ã€‚</p>
<p>åˆ™è¯¥ç½‘ç»œä¸­æ€»èŠ±è´¹æœ€å°çš„æœ€å¤§æµç§°ä¸º<strong>æœ€å°è´¹ç”¨æœ€å¤§æµ</strong>ï¼Œå³åœ¨æœ€å¤§åŒ– $\sum_{(s,v)\in E}f(s,v)$ çš„å‰æä¸‹æœ€å°åŒ– $\sum_{(u,v)\in E}f(u,v)\times w(u,v)$ã€‚</p>
<p>æœ€å°è´¹ç”¨æœ€å¤§æµé—®é¢˜ä¸å¸¦æƒäºŒåˆ†å›¾æœ€å¤§åŒ¹é…é—®é¢˜çš„å…³ç³»å°±å’Œæœ€å¤§æµé—®é¢˜å’ŒäºŒåˆ†å›¾æœ€å¤§åŒ¹é…é—®é¢˜çš„å…³ç³»ç±»ä¼¼ï¼Œè¿™å°±æ„å‘³ç€æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ±‚è§£è´¹ç”¨æµé—®é¢˜çš„ç®—æ³•æ¥æ±‚è§£å¸¦æƒäºŒåˆ†å›¾æœ€å¤§åŒ¹é…é—®é¢˜ã€‚</p>
<h2 id="SSP-ç®—æ³•"><a href="#SSP-ç®—æ³•" class="headerlink" title="SSP ç®—æ³•"></a>SSP ç®—æ³•</h2><p>SSPï¼ˆSuccessive Shortest Pathï¼‰ç®—æ³•æ˜¯ä¸€ä¸ªè´ªå¿ƒçš„ç®—æ³•ã€‚å®ƒçš„æ€è·¯æ˜¯æ¯æ¬¡å¯»æ‰¾å•ä½è´¹ç”¨æœ€å°çš„å¢å¹¿è·¯è¿›è¡Œå¢å¹¿ï¼Œç›´åˆ°å›¾ä¸Šä¸å­˜åœ¨å¢å¹¿è·¯ä¸ºæ­¢ã€‚</p>
<p>å¦‚æœå›¾ä¸Šå­˜åœ¨å•ä½è´¹ç”¨ä¸ºè´Ÿçš„åœˆï¼ŒSSP ç®—æ³•æ­£ç¡®æ— æ³•æ±‚å‡ºè¯¥ç½‘ç»œçš„æœ€å°è´¹ç”¨æœ€å¤§æµã€‚æ­¤æ—¶éœ€è¦å…ˆä½¿ç”¨æ¶ˆåœˆç®—æ³•æ¶ˆå»å›¾ä¸Šçš„è´Ÿåœˆã€‚</p>
<details class="note info"><summary><p>è¯æ˜</p>
</summary>
<p>æ¬è‡ª OI-Wiki</p>
<h3 id="è¯æ˜"><a href="#è¯æ˜" class="headerlink" title="è¯æ˜"></a>è¯æ˜</h3><p>æˆ‘ä»¬è€ƒè™‘ä½¿ç”¨æ•°å­¦å½’çº³æ³•å’Œåè¯æ³•æ¥è¯æ˜ SSP ç®—æ³•çš„æ­£ç¡®æ€§ã€‚</p>
<p>è®¾æµé‡ä¸º $i$ çš„æ—¶å€™æœ€å°è´¹ç”¨ä¸º $f_i$ã€‚æˆ‘ä»¬å‡è®¾æœ€åˆçš„ç½‘ç»œä¸Š <strong>æ²¡æœ‰è´Ÿåœˆ</strong>ï¼Œè¿™ç§æƒ…å†µä¸‹ $f_0&#x3D;0$ã€‚</p>
<p>å‡è®¾ç”¨ SSP ç®—æ³•æ±‚å‡ºçš„ $f_i$ æ˜¯æœ€å°è´¹ç”¨ï¼Œæˆ‘ä»¬åœ¨ $f_i$ çš„åŸºç¡€ä¸Šï¼Œæ‰¾åˆ°ä¸€æ¡æœ€çŸ­çš„å¢å¹¿è·¯ï¼Œä»è€Œæ±‚å‡º $f_{i+1}$ã€‚è¿™æ—¶ $f_{i+1}-f_i$ æ˜¯è¿™æ¡æœ€çŸ­å¢å¹¿è·¯çš„é•¿åº¦ã€‚</p>
<p>å‡è®¾å­˜åœ¨æ›´å°çš„ $f_{i+1}$ï¼Œè®¾å®ƒä¸º $f_{i+1}â€™$ã€‚å› ä¸º $f_{i+1}-f_i$ å·²ç»æ˜¯æœ€çŸ­å¢å¹¿è·¯äº†ï¼Œæ‰€ä»¥ $f_{i+1}â€™-f_i$ ä¸€å®šå¯¹åº”ä¸€ä¸ªç»è¿‡ <strong>è‡³å°‘ä¸€ä¸ªè´Ÿåœˆ</strong> çš„å¢å¹¿è·¯ã€‚</p>
<p>è¿™æ—¶å€™çŸ›ç›¾å°±å‡ºç°äº†ï¼šæ—¢ç„¶å­˜åœ¨ä¸€æ¡ç»è¿‡è‡³å°‘ä¸€ä¸ªè´Ÿåœˆçš„å¢å¹¿è·¯ï¼Œé‚£ä¹ˆ $f_i$ å°±ä¸æ˜¯æœ€å°è´¹ç”¨äº†ã€‚å› ä¸ºåªè¦ç»™è¿™ä¸ªè´Ÿåœˆæ·»åŠ æµé‡ï¼Œå°±å¯ä»¥åœ¨ä¸å¢åŠ  $s$ æµå‡ºçš„æµé‡çš„å‰æä¸‹ï¼Œä½¿ $f_i$ å¯¹åº”çš„è´¹ç”¨æ›´å°ã€‚</p>
<p>ç»¼ä¸Šï¼ŒSSP ç®—æ³•å¯ä»¥æ­£ç¡®æ±‚å‡ºæ— è´Ÿåœˆç½‘ç»œçš„æœ€å°è´¹ç”¨æœ€å¤§æµã€‚</p>

</details>

<h3 id="æ—¶é—´å¤æ‚åº¦"><a href="#æ—¶é—´å¤æ‚åº¦" class="headerlink" title="æ—¶é—´å¤æ‚åº¦"></a>æ—¶é—´å¤æ‚åº¦</h3><p>å¦‚æœä½¿ç”¨ Bellman-Ford ç®—æ³•æ±‚è§£æœ€çŸ­è·¯ï¼Œæ¯æ¬¡æ‰¾å¢å¹¿è·¯çš„æ—¶é—´å¤æ‚åº¦ä¸º $O(nm)$ã€‚è®¾è¯¥ç½‘ç»œçš„æœ€å¤§æµä¸º $f$ï¼Œåˆ™æœ€åæ—¶é—´å¤æ‚åº¦ä¸º $O(nmf)$ã€‚äº‹å®ä¸Šï¼Œè¿™ä¸ªæ—¶é—´å¤æ‚åº¦æ˜¯<strong>ä¼ªå¤šé¡¹å¼çš„</strong>ã€‚</p>
<h3 id="å®ç°-1"><a href="#å®ç°-1" class="headerlink" title="å®ç°"></a>å®ç°</h3><p>åªéœ€å°† EK ç®—æ³•æˆ– Dinic ç®—æ³•ä¸­æ‰¾å¢å¹¿è·¯çš„è¿‡ç¨‹ï¼Œæ›¿æ¢ä¸ºç”¨æœ€çŸ­è·¯ç®—æ³•å¯»æ‰¾å•ä½è´¹ç”¨æœ€å°çš„å¢å¹¿è·¯å³å¯ã€‚</p>
<p>åŸºäºEKç®—æ³•çš„å®ç°ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">5010</span>, M = <span class="number">100010</span>, INF = <span class="number">1e8</span>;</span><br><span class="line"><span class="type">int</span> n, m, S, T;</span><br><span class="line"><span class="type">int</span> h[N], e[M], f[M], w[M], ne[M], idx;</span><br><span class="line"><span class="type">int</span> q[N], d[N], pre[N], incf[N];</span><br><span class="line"><span class="type">bool</span> st[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c, <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[idx] = b, f[idx] = c, w[idx] = d, ne[idx] = h[a], h[a] = idx++;</span><br><span class="line">    e[idx] = a, f[idx] = <span class="number">0</span>, w[idx] = -d, ne[idx] = h[b], h[b] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">spfa</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> hh = <span class="number">0</span>, tt = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">memset</span>(d, <span class="number">0x3f</span>, <span class="built_in">sizeof</span>(d));</span><br><span class="line">    <span class="built_in">memset</span>(incf, <span class="number">0</span>, <span class="built_in">sizeof</span>(incf));</span><br><span class="line">    q[<span class="number">0</span>] = S, d[S] = <span class="number">0</span>, incf[S] = INF;</span><br><span class="line">    <span class="keyword">while</span>(hh != tt)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> t = q[hh++];</span><br><span class="line">        <span class="keyword">if</span>(hh == N) hh = <span class="number">0</span>;</span><br><span class="line">        st[t] = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = h[t]; ~i; i = ne[i])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> ver = e[i];</span><br><span class="line">            <span class="keyword">if</span>(f[i] &amp;&amp; d[ver] &gt; d[t] + w[i])</span><br><span class="line">            &#123;</span><br><span class="line">                d[ver] = d[t] + w[i];</span><br><span class="line">                pre[ver] = i;</span><br><span class="line">                incf[ver] = <span class="built_in">min</span>(f[i], incf[t]);</span><br><span class="line">                <span class="keyword">if</span>(!st[ver])</span><br><span class="line">                &#123;</span><br><span class="line">                    q[tt++] = ver;</span><br><span class="line">                    <span class="keyword">if</span>(tt == N) tt = <span class="number">0</span>;</span><br><span class="line">                    st[ver] = <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> incf[T] &gt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">EK</span><span class="params">(<span class="type">int</span> &amp;flow, <span class="type">int</span> &amp;cost)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    flow = cost = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">spfa</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> t = incf[T];</span><br><span class="line">        flow += t, cost += t * d[T];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = T; i != S; i = e[pre[i] ^ <span class="number">1</span>])</span><br><span class="line">        &#123;</span><br><span class="line">            f[pre[i]] -= t;</span><br><span class="line">            f[pre[i] ^ <span class="number">1</span>] += t;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;S, &amp;T);</span><br><span class="line">    <span class="built_in">memset</span>(h, <span class="number">-1</span>, <span class="built_in">sizeof</span>(h));</span><br><span class="line">    <span class="keyword">while</span>(m--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> a, b, c, d;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;c, &amp;d);</span><br><span class="line">        <span class="built_in">add</span>(a, b, c, d);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> flow, cost;</span><br><span class="line">    <span class="built_in">EK</span>(flow, cost);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, flow, cost);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åŸºäº Dinic ç®—æ³•çš„å®ç°ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">5010</span>, M = <span class="number">200010</span>, INF = <span class="number">1e16</span>;</span><br><span class="line"><span class="type">int</span> n, m, S, T;</span><br><span class="line"><span class="type">int</span> h[N], e[M], f[M], w[M], ne[M], idx;</span><br><span class="line"><span class="type">int</span> q[N], d[N], cur[N], pre[N], incf[N];</span><br><span class="line"><span class="type">bool</span> st[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c, <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[idx] = b, f[idx] = c, w[idx] = d, ne[idx] = h[a], h[a] = idx++;</span><br><span class="line">    e[idx] = a, f[idx] = <span class="number">0</span>, w[idx] = -d, ne[idx] = h[b], h[b] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">spfa</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> hh = <span class="number">0</span>, tt = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">memset</span>(d, <span class="number">0x3f</span>, <span class="built_in">sizeof</span>(d));</span><br><span class="line">    <span class="built_in">memset</span>(incf, <span class="number">0</span>, <span class="built_in">sizeof</span>(incf));</span><br><span class="line">    <span class="built_in">memcpy</span>(cur, h, <span class="built_in">sizeof</span>(h));</span><br><span class="line">    q[<span class="number">0</span>] = S, d[S] = <span class="number">0</span>, incf[S] = INF;</span><br><span class="line">    <span class="keyword">while</span>(hh != tt)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> t = q[hh++];</span><br><span class="line">        <span class="keyword">if</span>(hh == N)hh = <span class="number">0</span>;</span><br><span class="line">        st[t] = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = h[t]; ~i; i = ne[i])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> ver = e[i];</span><br><span class="line">            <span class="keyword">if</span>((f[i]) &amp;&amp; (d[ver] &gt; d[t] + w[i]))</span><br><span class="line">            &#123;</span><br><span class="line">                d[ver] = d[t] + w[i];</span><br><span class="line">                pre[ver] = i;</span><br><span class="line">                incf[ver] = <span class="built_in">min</span>(f[i], incf[t]);</span><br><span class="line">                <span class="keyword">if</span>(!st[ver])</span><br><span class="line">                &#123;</span><br><span class="line">                    q[tt++] = ver;</span><br><span class="line">                    <span class="keyword">if</span>(tt == N)tt = <span class="number">0</span>;</span><br><span class="line">                    st[ver] = <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> incf[T] &gt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> lim)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(u == T)<span class="keyword">return</span> lim;</span><br><span class="line">    <span class="type">int</span> flow = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = cur[u]; ~i &amp;&amp; flow &lt; lim; i = ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        cur[u] = i;</span><br><span class="line">        <span class="type">int</span> ver = e[i];</span><br><span class="line">        <span class="keyword">if</span>((d[ver] == d[u] + <span class="number">1</span>) &amp;&amp; (f[i]))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> t = <span class="built_in">dfs</span>(ver, <span class="built_in">min</span>(f[i], lim - flow));</span><br><span class="line">            <span class="keyword">if</span>(!t)d[ver] = <span class="number">-1</span>;</span><br><span class="line">            f[i] -= t, f[i ^ <span class="number">1</span>] += t, flow += t;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> flow;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dinic</span><span class="params">(<span class="type">int</span> &amp;flow, <span class="type">int</span> &amp;cost)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    flow = cost = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> r = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">spfa</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(r = <span class="built_in">dfs</span>(S, INF))</span><br><span class="line">        &#123;</span><br><span class="line">            flow = r;</span><br><span class="line">            cost += r * d[T];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;S, &amp;T);</span><br><span class="line">    <span class="built_in">memset</span>(h, <span class="number">-1</span>, <span class="built_in">sizeof</span>(h));</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> a, b, c, d;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;c, &amp;d);</span><br><span class="line">        <span class="built_in">add</span>(a, b, c, d);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> flow, cost;</span><br><span class="line">    <span class="built_in">dinic</span>(flow, cost);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, flow, cost);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>ï¼ˆè²Œä¼¼å¯„äº†ï¼Œæ±‚è°ƒï¼‰</p>
<h1 id="å¸¸è§æŠ€å·§"><a href="#å¸¸è§æŠ€å·§" class="headerlink" title="å¸¸è§æŠ€å·§"></a>å¸¸è§æŠ€å·§</h1><h2 id="æ‹†ç‚¹"><a href="#æ‹†ç‚¹" class="headerlink" title="æ‹†ç‚¹"></a>æ‹†ç‚¹</h2><p>æˆ‘ä»¬ç»å¸¸éœ€è¦åº”å¯¹ä¸€äº›å¯¹ç‚¹çš„è®¿é—®æ¬¡æ•°æˆ–è€…æµé‡ä¸Šé™æœ‰é™åˆ¶çš„é¢˜ç›®ã€‚</p>
<p>æˆ–è€…æˆ‘ä»¬æœ‰æ—¶å€™éœ€è¦å¤„ç†å¤šç±»ç‚¹çš„åŒ¹é…é—®é¢˜ï¼Œä¾‹å¦‚<span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL3Byb2JsZW0vUDI4OTE=">æŸä¸€ä¸ªUSACOçš„é¢˜ç›®<i class="fa fa-external-link-alt"></i></span>ã€‚</p>
<p>å¯¹äºè¿™ç§é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸€ä¸ªç‚¹æ‹†æˆä¸¤ä¸ªç‚¹ï¼Œå¹¶ç”¨ä¸€æ¡è¾¹è¿æ¥è¿™ä¸¤ä¸ªç‚¹ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬å¯¹ç‚¹çš„æœ€å¤§æµé‡æœ‰é™åˆ¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å°†è¿™æ¡è¾¹çš„æµé‡è®¾ç½®ä¸ºåŸå›¾ä¸­å¯¹åº”çš„ç‚¹çš„æœ€å¤§æµé‡ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬èµ°è¿‡ç‚¹çš„æ—¶å€™æœ‰è´¹ç”¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æŠŠè´¹ç”¨åŠ åˆ°è¾¹ä¸Šã€‚</p>
<p>ç­‰ç­‰ç­‰ç­‰ã€‚</p>
<p>ä»¥åˆšæ‰æˆ‘ä»¬æåˆ°çš„é¢˜ç›®ä¸ºä¾‹ã€‚</p>
<p>è¿™é“é¢˜è¦æ±‚æˆ‘ä»¬å°†é£Ÿç‰©ã€é¥®æ–™ä¸ç‰›è¿›è¡Œé…å¯¹ã€‚<br>ä¸ºäº†é˜²æ­¢ä¸€å¤´ç‰›åƒä¸¤é¡¿é¥­ï¼Œæˆ‘ä»¬å°†ä»£è¡¨ç‰›çš„ç‚¹æ‹†æˆä¸¤ä¸ªï¼Œä¸­é—´è¿æ¥ä¸€æ¡å®¹é‡ä¸º1çš„è¾¹ï¼Œä»£è¡¨è¿™ä¸ªç‚¹åªèƒ½è¢«è®¿é—®ä¸€æ¬¡ã€‚</p>
<p>ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">510</span>, M = <span class="number">200010</span>, INF = <span class="number">1e8</span>;</span><br><span class="line"><span class="type">int</span> n, f, d;</span><br><span class="line"><span class="type">int</span> h[N], e[M], c[M], ne[M], idx;</span><br><span class="line"><span class="type">int</span> num[N];</span><br><span class="line"><span class="type">int</span> minn, s, t, minflow, maxflow, tot;</span><br><span class="line">queue&lt;<span class="type">int</span>&gt;q;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[++idx] = v, c[idx] = a, ne[idx] = h[u], h[u] = idx;</span><br><span class="line">    e[++idx] = u, c[idx] = <span class="number">0</span>, ne[idx] = h[v], h[v] = idx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">add_num</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())q.<span class="built_in">pop</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = s; i &lt;= t + n; i++)num[i] = <span class="number">-1</span>;</span><br><span class="line">    num[s] = <span class="number">1</span>;</span><br><span class="line">    q.<span class="built_in">push</span>(s);</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> now = q.<span class="built_in">front</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = h[now]; i; i = ne[i])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(c[i] &amp;&amp; num[e[i]] == <span class="number">-1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                num[e[i]] = num[now] + <span class="number">1</span>;</span><br><span class="line">                q.<span class="built_in">push</span>(e[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(num[t] == <span class="number">-1</span>)<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(u == t)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h[u]; i; i = ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(c[i] &amp;&amp; num[u] + <span class="number">1</span> == num[e[i]] &amp;&amp; (minflow = <span class="built_in">dfs</span>(e[i], <span class="built_in">min</span>(s, c[i]))))</span><br><span class="line">        &#123;</span><br><span class="line">            c[i] -= minflow;</span><br><span class="line">            c[i ^ <span class="number">1</span>] += minflow;</span><br><span class="line">            <span class="keyword">return</span> minflow;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dinic</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">add_num</span>())</span><br><span class="line">        <span class="keyword">while</span>((minn = <span class="built_in">dfs</span>(<span class="number">1</span>, INF)))</span><br><span class="line">            maxflow += minn;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;f, &amp;d);</span><br><span class="line">    idx = <span class="number">1</span>;</span><br><span class="line">    s = <span class="number">1</span>;</span><br><span class="line">    t = <span class="number">1</span> + f + n + d + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= f; i++)<span class="built_in">add</span>(s, <span class="number">1</span> + i, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= d; i++)<span class="built_in">add</span>(<span class="number">1</span> + f + n + i, t, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)<span class="built_in">add</span>(<span class="number">1</span> + f + i, <span class="number">1</span> + f + n + d + <span class="number">1</span> + i, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> dn, fn;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;fn, &amp;dn);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> q = <span class="number">1</span>; q &lt;= fn; q++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> fi;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;fi);</span><br><span class="line">            <span class="built_in">add</span>(<span class="number">1</span> + fi, <span class="number">1</span> + f + i, <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> q = <span class="number">1</span>; q &lt;= dn; q++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> di;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;di);</span><br><span class="line">            <span class="built_in">add</span>(<span class="number">1</span> + f + n + d + <span class="number">1</span> + i, <span class="number">1</span> + f + n + di, <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dinic</span>();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, maxflow);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>










































































































]]></content>
      <categories>
        <category>å›¾è®º</category>
      </categories>
      <tags>
        <tag>å›¾è®º</tag>
        <tag>ç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title>çº¿æ®µæ ‘</title>
    <url>/OI/segment-tree/</url>
    <content><![CDATA[<p>çº¿æ®µæ ‘åŠå…¶è¡ç”Ÿï¼Œå¦‚åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘ã€å¯æŒä¹…åŒ–æƒå€¼çº¿æ®µæ ‘ç­‰ç­‰ã€‚</p>
<span id="more"></span>

<h1 id="ä»€ä¹ˆæ˜¯çº¿æ®µæ ‘ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯çº¿æ®µæ ‘ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯çº¿æ®µæ ‘ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯çº¿æ®µæ ‘ï¼Ÿ</h1><p>çº¿æ®µæ ‘æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œå…¶å¯ä»¥ä»¥ $O( \log n)$ çš„æ—¶é—´å¤æ‚åº¦å¤„ç†ç»´æŠ¤åŒºé—´ä¿¡æ¯çš„é—®é¢˜ã€‚<br>å…¶ç»´æŠ¤çš„ä¿¡æ¯æ»¡è¶³å¯ä»¥å¿«é€Ÿåˆå¹¶ä¸¤ä¸ªåŒºé—´çš„ä¿¡æ¯ï¼ˆä¾‹å¦‚åŒºé—´å’Œã€åŒºé—´æœ€å¤§ï¼ˆå°ï¼‰å€¼ã€‚</p>
<p>çº¿æ®µæ ‘åŒæ—¶å¯ä»¥æ”¯æŒåŒºé—´ä¿®æ”¹ï¼Œä½†æ˜¯åŒºé—´ä¿®æ”¹æ—¶å¿…é¡»èƒ½å¤Ÿå¿«é€Ÿæ±‚å‡ºæ¯ä¸ªåŒºé—´ç»´æŠ¤çš„ä¿¡æ¯ã€‚</p>
<h1 id="çº¿æ®µæ ‘çš„ç»“æ„"><a href="#çº¿æ®µæ ‘çš„ç»“æ„" class="headerlink" title="çº¿æ®µæ ‘çš„ç»“æ„"></a>çº¿æ®µæ ‘çš„ç»“æ„</h1><p>çº¿æ®µæ ‘åœ¨å»ºç«‹çš„æ—¶å€™ï¼Œä¼šå°†æ¯ä¸€ä¸ªåŒºé—´é•¿åº¦ä¸ä¸º1çš„åŒºé—´è¿›è¡ŒäºŒåˆ†ï¼Œå¹¶é€’å½’å¯¹è¿™ä¸¤ä¸ªåŒºé—´è¿›è¡Œåˆ¤å®šã€‚</p>
<p>è¿™æ˜¯ä¸€æ£µåŒºé—´é•¿åº¦ä¸º12çš„çº¿æ®µæ ‘ï¼š</p>
<p><img src="https://s2.loli.net/2022/04/13/wjkzCcr7e4pBQyS.png" alt="segtree1.png"></p>
<p>æˆ‘ä»¬å¯ä»¥æ˜æ˜¾çœ‹åˆ°ï¼Œçº¿æ®µæ ‘æ˜¯ä¸€æ£µäºŒå‰æ ‘ã€‚<br>çº¿æ®µæ ‘çš„é«˜åº¦ä¸€èˆ¬æ˜¯ $\log n$ çš„ï¼Œè¿™å°±éœ€è¦æˆ‘ä»¬å»ºç«‹ $2^{\lceil \log n \rceil + 1}$ ä¸ªèŠ‚ç‚¹ï¼Œè¿™å°†ä¼šè€—è´¹æˆ‘ä»¬å¤§é‡çš„ç©ºé—´ã€‚</p>
<p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸ºäº†è®¿é—®æ–¹ä¾¿ï¼Œä¹Ÿä¸ºäº†èŠ‚çœç©ºé—´ï¼Œæˆ‘ä»¬ä¸€èˆ¬å°†ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆè®¾å…¶ç¼–å·ä¸º $p$ï¼‰çš„å·¦å„¿å­å’Œå³å„¿å­åˆ†åˆ«è®¾ä¸º $p &lt;&lt; 1$ å’Œ $p &lt;&lt; 1 | 1$ï¼Œå°±ç›¸å½“äºæ˜¯åœ¨ä¸€æ£µæ»¡äºŒå‰æ ‘ä¸Šé¢è®¿é—®ã€‚</p>
<p>äºæ˜¯æˆ‘ä»¬å°±ç»™å‡ºç¼–å·ï¼š</p>
<p><img src="https://s2.loli.net/2022/04/13/BYmKAP7NDaSytMq.png" alt="segtree2.png"></p>
<p>ä¸‹é¢ç»™å‡ºç¤ºä¾‹ä»£ç ï¼š</p>
<p>å‡è®¾æˆ‘ä»¬ç»´æŠ¤çš„æ˜¯åŒºé—´å’Œï¼Œå¹¶ä½¿ç”¨ç±»ä¼¼</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">SegTree</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    <span class="type">int</span> sum;</span><br><span class="line">&#125;tr;</span><br></pre></td></tr></table></figure>

<p>çš„ç»“æ„ä½“æ¥å­˜å‚¨æ•°æ®ï¼Œé‚£ä¹ˆå»ºç«‹çº¿æ®µæ ‘çš„å‡½æ•°å°±æ˜¯åƒä¸‹é¢è¿™ä¸ªæ ·å­çš„ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tr[p].l = l, tr[p].r = r;</span><br><span class="line">    <span class="keyword">if</span>(l == r)</span><br><span class="line">    &#123;</span><br><span class="line">        tr[p].sum = a[l];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">build</span>(p &lt;&lt; <span class="number">1</span>, l, mid);</span><br><span class="line">    <span class="built_in">build</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">    tr[p].sum = tr[p &lt;&lt; <span class="number">1</span>].sum + tr[p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].sum;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="çº¿æ®µæ ‘çš„åŒºé—´è¯¢é—®"><a href="#çº¿æ®µæ ‘çš„åŒºé—´è¯¢é—®" class="headerlink" title="çº¿æ®µæ ‘çš„åŒºé—´è¯¢é—®"></a>çº¿æ®µæ ‘çš„åŒºé—´è¯¢é—®</h1><p>æˆ‘ä»¬è¿™é‡Œä»¥åŒºé—´æ±‚å’Œä¸ºä¾‹ã€‚</p>
<p>æˆ‘ä»¬å…ˆæ‰‹åŠ¨æ¨¡æ‹Ÿä¸€ä¸‹åŒºé—´æ±‚å’Œçš„è¿‡ç¨‹ï¼š</p>
<p>å‡è®¾æˆ‘ä»¬å¯¹è¿™æ ·ä¸€ä¸ªé•¿åº¦ä¸º12çš„åºåˆ— $\lbrace 1,1,4,5,1,4,1,9,1,9,8,1 \rbrace$ å»ºç«‹çº¿æ®µæ ‘ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¯ä¸€ä¸ªåŒºé—´çš„æ•°æ®æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š</p>
<p><img src="https://s2.loli.net/2022/04/13/kHphs28SOJVRoGT.png" alt="segtree3.png"></p>
<p>æˆ‘ä»¬å‡è®¾éœ€è¦å¯¹ $[ 2,8 ]$ è¿™ä¸ªåŒºé—´å†…çš„æ•°æ®è¿›è¡Œæ±‚å’Œï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦†ç›–çš„åŒºé—´å°±æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š</p>
<p><img src="https://s2.loli.net/2022/04/13/hRWnlYSrVU7d51f.png" alt="segtree4.png"></p>
<p>æˆ‘ä»¬æƒ³è±¡ä¸€ä¸‹å°†åŒºé—´å‘ä¸Šæ¨ï¼š</p>
<p><img src="https://s2.loli.net/2022/04/13/Zphkae3wVJO1Lrq.gif" alt="segtree4.gif"></p>
<p>æœ€åæˆ‘ä»¬å°† $[ 2,8 ]$ è¿™ä¸ªå¤§åŒºé—´åˆ†ä¸º $[ 2,2 ] \cup [ 3,3 ] \cup [ 4,6 ] \cup [ 7,8 ]$ è¿™å‡ ä¸ªå°åŒºé—´ã€‚</p>
<p><img src="https://s2.loli.net/2022/04/13/O6IKkaHo5cg1i3V.png" alt="segtree5.png"></p>
<p>æˆ‘ä»¬æ¯ä¸€æ¬¡äºŒåˆ†é€’å½’çš„æ—¶å€™ï¼Œå¦‚æœå½“å‰åŒºé—´è¢«æˆ‘ä»¬è¯¢é—®çš„åŒºé—´å®Œå…¨åŒ…å«å°±è¿”å›å½“å‰åŒºé—´çš„å€¼ï¼Œå¦‚æœæ²¡æœ‰å®Œå…¨åŒ…å«å°±é€’å½’è¯¢é—®å·¦å³åŒºé—´ï¼Œå¹¶è¾“å‡ºä¸¤ä¸ªåŒºé—´çš„è¿”å›å€¼ä¹‹å’Œã€‚</p>
<p>åœ¨é€’å½’è¯¢é—®å·¦å³ä¸¤åŒºé—´çš„æ—¶å€™éœ€è¦æ³¨æ„ä¸€ä¸‹å­åŒºé—´æ˜¯å¦ä¸è¯¢é—®çš„åŒºé—´æœ‰é‡åˆéƒ¨åˆ†ï¼Œå¦‚æœä¸¤è€…äº¤é›†ä¸ºç©ºï¼Œé‚£å°±ä¸éœ€è¦è¯¢é—®äº†ã€‚</p>
<p>ä¸‹é¢ç»™å‡ºç¤ºä¾‹ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">segadd</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(tr[p].l &gt;= l &amp;&amp; tr[p].r &lt;= r)<span class="keyword">return</span> tr[p].sum;</span><br><span class="line">    <span class="type">int</span> mid = (tr[p].l + tr[p].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid)res += <span class="built_in">segsum</span>(p &lt;&lt; <span class="number">1</span>, l, r);</span><br><span class="line">    <span class="keyword">if</span>(r &gt; mid)res += <span class="built_in">segsum</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="çº¿æ®µæ ‘çš„åŒºé—´ä¿®æ”¹"><a href="#çº¿æ®µæ ‘çš„åŒºé—´ä¿®æ”¹" class="headerlink" title="çº¿æ®µæ ‘çš„åŒºé—´ä¿®æ”¹"></a>çº¿æ®µæ ‘çš„åŒºé—´ä¿®æ”¹</h1><p>åŒºé—´ä¿®æ”¹å’ŒåŒºé—´æ±‚å’Œæœ‰ç€ç›¸åŒçš„æ€è·¯ã€‚</p>
<p>æˆ‘ä»¬è¿™é‡Œä»¥åŒºé—´åŠ ä¸ºä¾‹ã€‚</p>
<p>è¿˜æ˜¯ä¹‹å‰çš„ä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦ç»™åŒºé—´ $[ 2,8 ]$ åŒæ—¶åŠ ä¸Šä¸€ä¸ªæ•°ä¼šæ€æ ·ï¼Ÿ</p>
<p>è®©æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹è¿™ä¸ªå›¾ï¼š</p>
<p><img src="https://s2.loli.net/2022/04/13/O6IKkaHo5cg1i3V.png" alt="segtree5.png"></p>
<p>å…¶ä¸­ç™½è‰²çš„åŒºé—´æ˜¯å®Œå…¨å’Œæˆ‘ä»¬è¯¢é—®æ²¡æœ‰ä»»ä½•å…³ç³»çš„åŒºé—´ï¼Œé»„è‰²çš„åŒºé—´æ˜¯ä¸æˆ‘ä»¬è¯¢é—®çš„åŒºé—´æœ‰äº¤é›†ï¼Œä½†æ˜¯æ²¡æœ‰è¢«æ–°é—»åŒºé—´æ‰€åŒ…å«çš„åŒºé—´ã€‚</p>
<p>çº¢è‰²çš„åŒºé—´å’Œæ©™è‰²çš„åŒºé—´éƒ½è¢«è¯¢é—®åŒºé—´æ‰€åŒ…å«ï¼Œå…¶ä¸­çº¢è‰²çš„åŒºé—´æ˜¯æˆ‘ä»¬åœ¨åŒºé—´æ±‚å’Œçš„æ—¶å€™è¿”å›äº†å€¼çš„åŒºé—´ï¼Œæ©™è‰²çš„åŒºé—´è™½ç„¶è¢«è¯¢é—®åŒºé—´åŒ…å«ï¼Œä½†æ˜¯æˆ‘ä»¬æ²¡æœ‰è®¿é—®åˆ°ä»–ä»¬ã€‚</p>
<p>åŒºé—´ä¿®æ”¹ä¹Ÿæ˜¯ä¸€æ ·çš„æ€è·¯ã€‚æˆ‘ä»¬åªéœ€è¦å°†éœ€è¦çš„åŒºé—´ä¿®æ”¹å³å¯ï¼Œå‰©ä¸‹çš„è¢«è¯¢é—®åŒºé—´åŒ…å«çš„åŒºé—´åªéœ€è¦æ ‡è®°ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚</p>
<p>è¿™é‡Œéœ€è¦ç”¨åˆ°æ‡’æ ‡è®°çš„æ€æƒ³ã€‚</p>
<h2 id="æ‡’æ ‡è®°"><a href="#æ‡’æ ‡è®°" class="headerlink" title="æ‡’æ ‡è®°"></a>æ‡’æ ‡è®°</h2><p>æ‡’æ ‡è®°çš„æ„æ€å°±æ˜¯å¾ˆæ‡’çš„æ ‡è®°ã€‚æˆ‘ä»¬ç”¨åˆ°å®ƒçš„æ—¶å€™æ‰ä¼šå°†å®ƒå…‘ç°ï¼Œå¦åˆ™ä»–å°±åœ¨é‚£é‡Œé™é™åœ°å¾…ç€å°±å¯ä»¥äº†ã€‚</p>
<p>æˆ‘ä»¬è€ƒè™‘ç»™ç»“æ„ä½“é‡Œé¢åŠ ä¸Šä¸€ä¸ªæ‡’æ ‡è®°ï¼Œå°±åƒè¿™æ ·ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">SegTree</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    <span class="type">int</span> sum;</span><br><span class="line">    <span class="type">int</span> tag;<span class="comment">//&lt;- å°±æ˜¯è¿™ä¸ª</span></span><br><span class="line">&#125;tr;</span><br></pre></td></tr></table></figure>

<p>å½“æŸä¸ªåŒºé—´æœ‰æ‡’æ ‡è®°çš„æ—¶å€™ï¼Œå°±æ„å‘³ç€å®ƒçš„å­æ ‘é‡Œé¢çš„æ‰€æœ‰åŒºé—´éƒ½åº”è¯¥è¢«ä¿®æ”¹ï¼Œä½†æ˜¯ç›®å‰æ²¡æœ‰åº”ç”¨ä¸Šã€‚</p>
<p>ä½†æ˜¯æ‹¥æœ‰æ‡’æ ‡è®°çš„åŒºé—´çš„å€¼åœ¨ä¿®æ”¹çš„æ—¶å€™å·²ç»è¢«ä¿®æ”¹å¥½äº†ã€‚</p>
<p>æ¯ä¸€æ¬¡æˆ‘ä»¬é€’å½’è¯¢é—®å­åŒºé—´çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦å°†è¿™ä¸ªæ‡’æ ‡è®°ä¸‹ä¼ ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ã€‚<br>æˆ‘ä»¬éœ€è¦ä¸€ä¸ª<code>pushdown</code>å‡½æ•°æ¥å®Œæˆè¿™ä»¶äº‹ã€‚</p>
<p>æˆ‘ä»¬è¿™é‡Œä»ç„¶ä»¥åŒºé—´åŠ ä¸ºä¾‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> &amp;root = tr[p], &amp;left = tr[p &lt;&lt; <span class="number">1</span>], &amp;rght = tr[p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span>(root.tag)</span><br><span class="line">    &#123;</span><br><span class="line">        left.sum += root.tag * (left.r - left.l + <span class="number">1</span>);</span><br><span class="line">        rght.sum += root.tag * (rght.r - rght.l + <span class="number">1</span>);</span><br><span class="line">        <span class="comment">//æ›´æ–°å­åŒºé—´å€¼</span></span><br><span class="line">        left.tag += root.tag;</span><br><span class="line">        rght.tag += root.tag;</span><br><span class="line">        <span class="comment">//æ›´æ–°å­åŒºé—´æ‡’æ ‡è®°</span></span><br><span class="line">        root.tag = <span class="number">0</span>;<span class="comment">//æ‡’æ ‡è®°æ¸…ç©º</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h1><details class="note info"><summary><p>ä¾‹é¢˜1</p>
</summary>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL3Byb2JsZW0vUDMzNzI=">Luogu P3372 ã€æ¨¡æ¿ã€‘çº¿æ®µæ ‘ 1<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">100010</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SegTree</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    ll sum, tag;</span><br><span class="line">&#125;tr[N &lt;&lt; <span class="number">3</span>];</span><br><span class="line">ll a[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tr[p].sum = tr[p &lt;&lt; <span class="number">1</span>].sum + tr[p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].sum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> &amp;root = tr[p], &amp;left = tr[p &lt;&lt; <span class="number">1</span>], &amp;rght = tr[p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span>(root.tag)</span><br><span class="line">    &#123;</span><br><span class="line">        left.sum += root.tag * (left.r - left.l + <span class="number">1</span>);</span><br><span class="line">        rght.sum += root.tag * (rght.r - rght.l + <span class="number">1</span>);</span><br><span class="line">        left.tag += root.tag;</span><br><span class="line">        rght.tag += root.tag;</span><br><span class="line">        root.tag = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tr[p].l = l, tr[p].r = r;</span><br><span class="line">    <span class="keyword">if</span>(l == r)</span><br><span class="line">    &#123;</span><br><span class="line">        tr[p].sum = a[l];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">build</span>(p &lt;&lt; <span class="number">1</span>, l, mid);</span><br><span class="line">    <span class="built_in">build</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="built_in">pushup</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">segadd</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(tr[p].l &gt;= l &amp;&amp; tr[p].r &lt;= r)</span><br><span class="line">    &#123;</span><br><span class="line">        tr[p].tag += k;</span><br><span class="line">        tr[p].sum += k * (tr[p].r - tr[p].l + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">pushdown</span>(p);</span><br><span class="line">    <span class="type">int</span> mid = (tr[p].l + tr[p].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid)<span class="built_in">segadd</span>(p &lt;&lt; <span class="number">1</span>, l, r, k);</span><br><span class="line">    <span class="keyword">if</span>(r &gt; mid)<span class="built_in">segadd</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r, k);</span><br><span class="line">    <span class="built_in">pushup</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">segsum</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(tr[p].l &gt;= l &amp;&amp; tr[p].r &lt;= r)<span class="keyword">return</span> tr[p].sum;</span><br><span class="line">    <span class="built_in">pushdown</span>(p);</span><br><span class="line">    ll res = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> mid = (tr[p].l + tr[p].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid)res += <span class="built_in">segsum</span>(p &lt;&lt; <span class="number">1</span>, l, r);</span><br><span class="line">    <span class="keyword">if</span>(r &gt; mid)res += <span class="built_in">segsum</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> n, m;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)<span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;a[i]);</span><br><span class="line">    <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">    <span class="keyword">while</span>(m--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> op, x, y, k;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;op, &amp;x, &amp;y);</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;k);</span><br><span class="line">            <span class="built_in">segadd</span>(<span class="number">1</span>, x, y, k);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">segsum</span>(<span class="number">1</span>, x, y));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</details>

<details class="note info"><summary><p>ä¾‹é¢˜2</p>
</summary>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL3Byb2JsZW0vUDMzNzM=">Luogu P3373 ã€æ¨¡æ¿ã€‘çº¿æ®µæ ‘ 2<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> n, m, d;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">100010</span>;</span><br><span class="line"><span class="type">int</span> a[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">segtree</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> v, ta, tm;</span><br><span class="line">&#125;node[N &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    node[p].l = l, node[p].r = r, node[p].ta = <span class="number">0</span>, node[p].tm = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l == r)</span><br><span class="line">    &#123;</span><br><span class="line">        node[p].v = a[r];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">build</span>(p &lt;&lt; <span class="number">1</span>, l, mid);</span><br><span class="line">    <span class="built_in">build</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">    node[p].v = (node[p &lt;&lt; <span class="number">1</span>].v + node[p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].v) % d;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">tag</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> &amp;root = node[p], &amp;left = node[p &lt;&lt; <span class="number">1</span>], &amp;rght = node[p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span>((root.ta != <span class="number">0</span>) || (root.tm != <span class="number">1</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        left.tm = (left.tm * root.tm) % d, left.ta = (left.ta * root.tm + root.ta) % d;</span><br><span class="line">        rght.tm = (rght.tm * root.tm) % d, rght.ta = (rght.ta * root.tm + root.ta) % d;</span><br><span class="line">        left.v = (left.v * root.tm + root.ta * (left.r - left.l + <span class="number">1</span>)) % d;</span><br><span class="line">        rght.v = (rght.v * root.tm + root.ta * (rght.r - rght.l + <span class="number">1</span>)) % d;</span><br><span class="line">        root.ta = <span class="number">0</span>, root.tm = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">segadd</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>((node[p].r &lt;= r) &amp;&amp; (node[p].l &gt;= l))</span><br><span class="line">    &#123;</span><br><span class="line">        node[p].ta = (node[p].ta + k) % d;</span><br><span class="line">        node[p].v = (node[p].v + k * (node[p].r - node[p].l + <span class="number">1</span>)) % d;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>((node[p].r &lt; l) || (node[p].l &gt; r))<span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">tag</span>(p);</span><br><span class="line">    <span class="type">int</span> mid = (node[p].r + node[p].l) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(mid &gt;= l)<span class="built_in">segadd</span>(p &lt;&lt; <span class="number">1</span>, l, r, k);</span><br><span class="line">    <span class="keyword">if</span>(mid &lt; r)<span class="built_in">segadd</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r, k);</span><br><span class="line">    node[p].v = (node[p &lt;&lt; <span class="number">1</span>].v + node[p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].v) % d;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">segmul</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>((node[p].r &lt;= r) &amp;&amp; (node[p].l &gt;= l))</span><br><span class="line">    &#123;</span><br><span class="line">        node[p].tm = (node[p].tm * k) % d;</span><br><span class="line">        node[p].ta = (node[p].ta * k) % d;</span><br><span class="line">        node[p].v = (node[p].v * k) % d;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>((node[p].r &lt; l) || (node[p].l &gt; r))<span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">tag</span>(p);</span><br><span class="line">    <span class="type">int</span> mid = (node[p].r + node[p].l) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(mid &gt;= l)<span class="built_in">segmul</span>(p &lt;&lt; <span class="number">1</span>, l, r, k);</span><br><span class="line">    <span class="keyword">if</span>(mid &lt; r)<span class="built_in">segmul</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r, k);</span><br><span class="line">    node[p].v = (node[p &lt;&lt; <span class="number">1</span>].v + node[p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].v) % d;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">long</span> <span class="type">long</span> <span class="title">segsum</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>((node[p].r &lt;= r) &amp;&amp; (node[p].l &gt;= l))<span class="keyword">return</span> node[p].v;</span><br><span class="line">    <span class="keyword">if</span>((node[p].r &lt; l) || (node[p].l &gt; r))<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">tag</span>(p);</span><br><span class="line">    <span class="type">int</span> mid = (node[p].r + node[p].l) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(mid &gt;= l)ans = ans + <span class="built_in">segsum</span>(p &lt;&lt; <span class="number">1</span>, l, r);</span><br><span class="line">    <span class="keyword">if</span>(mid &lt; r)ans = ans + <span class="built_in">segsum</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r);</span><br><span class="line">    <span class="keyword">return</span> ans % d;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;d);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">    <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> op;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;op);</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> x, y, k;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;x, &amp;y, &amp;k);</span><br><span class="line">            <span class="built_in">segmul</span>(<span class="number">1</span>, x, y, k);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> x, y, k;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;x, &amp;y, &amp;k);</span><br><span class="line">            <span class="built_in">segadd</span>(<span class="number">1</span>, x, y, k);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">3</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> x, y;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;x, &amp;y);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">segsum</span>(<span class="number">1</span>, x, y));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</details>

<h1 id="æ‰©å±•"><a href="#æ‰©å±•" class="headerlink" title="æ‰©å±•"></a>æ‰©å±•</h1><h2 id="æ ‡è®°æ°¸ä¹…åŒ–"><a href="#æ ‡è®°æ°¸ä¹…åŒ–" class="headerlink" title="æ ‡è®°æ°¸ä¹…åŒ–"></a>æ ‡è®°æ°¸ä¹…åŒ–</h2><p>æˆ‘ä»¬å¯ä»¥å°è¯•ä¸€ä¸ªæ€è·¯ï¼šä¸ä¸‹ä¼ æ ‡è®°ã€‚</p>
<p>æˆ‘ä»¬é‡æ–°æ€è€ƒä¸€ä¸‹æ‡’æ ‡è®°çš„æ„ä¹‰ã€‚</p>
<p>æ‡’æ ‡è®°ä»£è¡¨çš„æ˜¯ï¼Œè¿™ä¸ªç‚¹çš„æ‰€æœ‰å­åŒºé—´éƒ½éœ€è¦è¢«è¿™ä¸ªæ ‡è®°æ›´æ–°ä»–ä»¬çš„å€¼ã€‚</p>
<p>äºæ˜¯æˆ‘ä»¬å°±å¯ä»¥å°†æ ‡è®°æ”¾è¿›å‡½æ•°é‡Œé¢ï¼Œéšç€å‡½æ•°ä¸‹ä¼ ï¼Œåˆ°æ—¶å€™ä¹Ÿå¯ä»¥èµ·åˆ°æ›´æ–°å€¼çš„ä½œç”¨ã€‚</p>
<p>è¿™æ ·çš„æ–¹æ³•é€‚ç”¨äºä¸èƒ½<code>pushdown</code>çš„æ—¶å€™ã€‚</p>
<p>å…·ä½“æƒ…å†µæˆ‘ä¹Ÿæ²¡æœ‰é‡è§è¿‡ï¼Œæ®è¯´æ˜¯éœ€è¦é…åˆå¯æŒä¹…åŒ–æƒå€¼çº¿æ®µæ ‘ï¼ˆakaä¸»å¸­æ ‘ï¼‰ä½¿ç”¨ã€‚</p>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">ll <span class="title">segsum</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> tag)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(tr[p].l &gt;= l &amp;&amp; tr[p].r &lt;= r)<span class="keyword">return</span> tr[p].sum + tag * (tr[p].r - tr[p].l + <span class="number">1</span>);</span><br><span class="line">    ll res = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> mid = (tr[p].l + tr[p].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid)res += <span class="built_in">segsum</span>(p &lt;&lt; <span class="number">1</span>, l, r, tag + tr[p].tag);</span><br><span class="line">    <span class="keyword">if</span>(r &gt; mid)res += <span class="built_in">segsum</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r, tag + tr[p].tag);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="çº¿æ®µæ ‘ä¸ŠäºŒåˆ†"><a href="#çº¿æ®µæ ‘ä¸ŠäºŒåˆ†" class="headerlink" title="çº¿æ®µæ ‘ä¸ŠäºŒåˆ†"></a>çº¿æ®µæ ‘ä¸ŠäºŒåˆ†</h2><p>æƒ³ä¸åˆ°å§ï¼Œçº¿æ®µæ ‘è¿˜èƒ½ä¼˜åŒ–äºŒåˆ†ï¼</p>
<p>æˆ‘ä»¬è€ƒè™‘è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šæˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ä¸ªä½ç½® $pos$ï¼Œä½¿å¾— $[ 1,pos ]$ è¿™ä¸ªåŒºé—´å†…æ•°å­—çš„å’Œä¸å°äº $val$ã€‚ä¿è¯æ‰€æœ‰æƒå€¼éè´Ÿã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç›´æ¥è¿›è¡ŒäºŒåˆ†ï¼Œè¿™æ ·æ¯åšä¸€æ¬¡çš„å¤æ‚åº¦æ˜¯ $O(\log^2 n)$ çš„ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ç”¨çº¿æ®µæ ‘æ¥ä¼˜åŒ–è¿™æ ·çš„è¿‡ç¨‹ã€‚</p>
<p>æˆ‘ä»¬å¸¦ç€ $val$ åœ¨çº¿æ®µæ ‘ä¸Šæœç´¢ã€‚<br>å¦‚æœå½“å‰èŠ‚ç‚¹çš„å·¦å„¿å­çš„æƒå€¼ $\geq val$ï¼Œå°±å¸¦ç€ $val$ ç»§ç»­è·³åˆ°å·¦å„¿å­æœç´¢ï¼›<br>å¦‚æœå½“å‰èŠ‚ç‚¹çš„å·¦å„¿å­çš„æƒå€¼ $&lt; val$ï¼Œå°±å¸¦ç€ $val-tr[tr[p].ls].val$ ç»§ç»­è·³åˆ°å³å„¿å­æœç´¢ã€‚</p>
<h2 id="åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘"><a href="#åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘" class="headerlink" title="åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘"></a>åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘</h2><p>æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦ç»´æŠ¤çš„ä¸‹æ ‡åŒºåŸŸéå¸¸å¹¿ï¼ˆæ¯”å¦‚è¯´ $10^9$ï¼‰ï¼Œä½†æ˜¯çœŸæ­£æœ‰å€¼çš„åœ°æ–¹å…¶å®å¾ˆå°‘ã€‚</p>
<p>æˆ‘ä»¬å½“ç„¶ä¸å¯èƒ½ä¸ºè¿™ä¸ªåºåˆ—ç›´æ¥åˆ›å»ºä¸€æ£µå®Œæ•´çš„çº¿æ®µæ ‘ï¼Œè¿™æ ·å­ä¼šè€—è´¹æˆ‘ä»¬å¤§é‡çš„ç©ºé—´ç»´æŠ¤è®¸å¤šæ— ç”¨çš„æ•°æ®ã€‚</p>
<p>æ¯”å¦‚è¯´ç»´æŠ¤ä¸€ä¸ªåºåˆ—é‡Œé¢æœ‰å¤šå°‘ä¸ªæ•°å­—å¤§äºæŸä¸ªæ•°ï¼Œä½†æ˜¯è¿™ä¸ªæ•°åˆ—çš„å€¼åŸŸæ˜¯ $10^9$ï¼Œä½†æ˜¯æ•°åˆ—é•¿åº¦æœ€å¤šåªæœ‰ $10^5$ã€‚</p>
<p>æˆ‘ä»¬å½“ç„¶ä¸å¯èƒ½ç›´æ¥åˆ›å»ºä¸€ä¸ªè¦†ç›–æ•´ä¸ªå€¼åŸŸçš„çº¿æ®µæ ‘ï¼Œè¿™æ ·å­ä¼šéœ€è¦æˆ‘ä»¬åˆ›å»º $2^31$ ä¸ªèŠ‚ç‚¹ï¼Œå³ä½¿æˆ‘ä»¬ä¸è€ƒè™‘åŒºé—´ä¿®æ”¹ï¼Œåªç»´æŠ¤ä¸€ä¸ªåŒºé—´å’Œçš„è¯ä¹Ÿéœ€è¦é«˜è¾¾24GiBçš„ç©ºé—´ï¼Œååˆ†çš„æµªè´¹ã€‚</p>
<p>äºæ˜¯æˆ‘ä»¬å¯ä»¥åŠ¨æ€å¼€ç‚¹ï¼Œåªå»ºç«‹ç”¨åˆ°çš„åŒºé—´ï¼Œå…¶ä»–çš„å°±ä¸ä¼šè¢«å£°æ˜ï¼Œå¤§å¤§å‡å°‘äº†æˆ‘ä»¬éœ€è¦ç”¨çš„ç©ºé—´ã€‚<br>æˆ–è€…è¯´ï¼Œæˆ‘ä»¬ä»€ä¹ˆæ—¶å€™éœ€è¦ç”¨åˆ°æŸä¸ªèŠ‚ç‚¹äº†ï¼Œæˆ‘ä»¬å°±å»ºç«‹å®ƒã€‚</p>
<p>ä½†æ˜¯è¿™æ ·åšçš„ä»£ä»·å°±æ˜¯æˆ‘ä»¬æ— æ³•å†ä½¿ç”¨ç®€å•çš„ <code>p&lt;&lt;1</code> å’Œ <code>p&lt;&lt;1|1</code> æ¥è®¿é—®å½“å‰èŠ‚ç‚¹çš„å·¦å³å­èŠ‚ç‚¹äº†ã€‚<br>æˆ‘ä»¬éœ€è¦è®°å½•ä¸‹å½“å‰èŠ‚ç‚¹çš„å·¦å³èŠ‚ç‚¹çš„ç¼–å·ã€‚</p>
<p>æˆ‘ä»¬ä»¥ç»´æŠ¤ä¸€ä¸ªåºåˆ—é‡Œé¢æœ‰å¤šå°‘ä¸ªæ•°å­—å¤§äºæŸä¸ªæ•°ä¸ºä¾‹ã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬çš„ç»“æ„ä½“å°±ä¼šå˜æˆè¿™ä¸ªæ ·å­ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">SegTree</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    <span class="type">int</span> ls, rs;</span><br><span class="line">    <span class="type">int</span> sum;</span><br><span class="line">&#125;tr;</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ <code>ls</code> å’Œ <code>rs</code> åˆ†åˆ«ä»£è¡¨äº†å½“å‰èŠ‚ç‚¹çš„å·¦å„¿å­å’Œå³å„¿å­çš„ç¼–å·ã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬å°±ä¸éœ€è¦<code>build</code>äº†ï¼Œåªéœ€è¦ä¸€å¼€å§‹å°†ç¬¬ä¸€ä¸ªèŠ‚ç‚¹åˆå§‹åŒ–ä¸ºæ ¹èŠ‚ç‚¹å³å¯ã€‚</p>
<p>ç„¶åæˆ‘ä»¬çš„åŒºé—´ä¿®æ”¹å‡½æ•°å°±æ˜¯è¿™ä¸ªæ ·å­çš„ã€‚<br>æˆ‘ä»¬å¯ä»¥æœ‰ä¸¤ç§é£æ ¼ï¼š</p>
<div class="tabs" id="dongtaikaidianxiugai"><ul class="nav-tabs"><li class="tab active"><a href="#dongtaikaidianxiugai-1">æå‰å¼€ç‚¹</a></li><li class="tab"><a href="#dongtaikaidianxiugai-2">ç”¨åˆ°å†å¼€</a></li></ul><div class="tab-content"><div class="tab-pane active" id="dongtaikaidianxiugai-1"><p>æˆ‘ä»¬åœ¨è®¿é—®å­èŠ‚ç‚¹ä¹‹å‰ï¼Œé¦–å…ˆçœ‹ä¸€ä¸‹æˆ‘ä»¬å°†è¦è®¿é—®çš„è¿™ä¸ªå­èŠ‚ç‚¹åˆ°åº•æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨çš„è¯å°±æ–°å¼€ä¸€ä¸ªã€‚</p>
<p>è¿™æ ·å­çš„è¯æ”¯æŒæŠŠå½“å‰åŒºé—´çš„å·¦å³ç«¯ç‚¹æ”¾åœ¨ç»“æ„ä½“é‡Œé¢å­˜ç€ï¼Œä¹Ÿæ”¯æŒå°†åŒºé—´å·¦å³ç«¯ç‚¹å½“åšå‚æ•°æ”¾åˆ°å‡½æ•°é‡Œé¢ä¼ ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">segadd</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(tr[p].l &gt;= l &amp;&amp; tr[p].r &lt;= r)</span><br><span class="line">    &#123;</span><br><span class="line">        tr[p].sum += k * (tr[p].r - tr[p].l + <span class="number">1</span>);</span><br><span class="line">        tr[p].add += k;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid = (tr[p].l + tr[p].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!tr[p].ls)</span><br><span class="line">        &#123;</span><br><span class="line">            tr[p].ls = ++idx;</span><br><span class="line">            tr[tr[p].ls].l = tr[p].l;</span><br><span class="line">            tr[tr[p].ls].r = mid;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">segadd</span>(tr[p].ls, l, r, k);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(r &gt; mid)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!tr[p].rs)</span><br><span class="line">        &#123;</span><br><span class="line">            tr[p].rs = ++idx;</span><br><span class="line">            tr[tr[p].rs].l = mid + <span class="number">1</span>;</span><br><span class="line">            tr[tr[p].rs].r = tr[p].r;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">segadd</span>(tr[p].rs, l, r, k);</span><br><span class="line">    &#125;</span><br><span class="line">    tr[p].sum = tr[tr[p].ls].sum + tr[tr[p].rs].sum;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="dongtaikaidianxiugai-2"><p>æˆ‘ä»¬åœ¨è®¿é—®å­èŠ‚ç‚¹çš„æ—¶å€™æ‰çœ‹ä¸€ä¸‹ï¼Œæˆ‘ä»¬çš„è¿™ä¸ªå­èŠ‚ç‚¹æ˜¯å¦å­˜åœ¨ã€‚å¦‚æœä¸å­˜åœ¨çš„è¯å°±åˆ›å»ºä¸€ä¸ªã€‚</p>
<p>è¿™æ ·çš„è¯æˆ‘ä»¬å°±åœ¨å‡½æ•°é‡Œé¢ä¼ èŠ‚ç‚¹ç¼–å·çš„å¼•ç”¨ï¼Œå¹¶ä¸”åŒæ—¶æŠŠå½“å‰åŒºé—´çš„å·¦å³ç«¯ç‚¹æ”¾è¿›å‡½æ•°é‡Œé¢å½“å‚æ•°ä¼ ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">segadd</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> al, <span class="type">int</span> ar, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!p)p = ++idx;</span><br><span class="line">    <span class="keyword">if</span>(al &gt;= l &amp;&amp; ar &lt;= r)</span><br><span class="line">    &#123;</span><br><span class="line">        tr[p].sum += k * (ar - al + <span class="number">1</span>);</span><br><span class="line">        tr[p].add += k;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid = (al + ar) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid)<span class="built_in">segadd</span>(tr[p].ls, l, r, al, mid, k);</span><br><span class="line">    <span class="keyword">if</span>(r &gt; mid)<span class="built_in">segadd</span>(tr[p].rs, l, r, mid + <span class="number">1</span>, ar, k);</span><br><span class="line">    tr[p].sum = tr[tr[p].ls].sum + tr[tr[p].rs].sum;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div></div>

<p>è€ŒæŸ¥è¯¢å‡½æ•°ä¸éœ€è¦åšå¤ªå¤§çš„å˜åŠ¨ï¼Œåªéœ€è¦çœ‹ä¸€ä¸‹å½“å‰è®¿é—®çš„èŠ‚ç‚¹æ˜¯å¦å­˜åœ¨å°±å¯ä»¥äº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">segsum</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!p)<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(tr[p].l &gt;= l &amp;&amp; tr[p].r &lt;= r)<span class="keyword">return</span> tr[p].sum;</span><br><span class="line">    <span class="type">int</span> mid = (tr[p].l + tr[p].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid)res += <span class="built_in">segsum</span>(tr[p].ls, l, r);</span><br><span class="line">    <span class="keyword">if</span>(r &gt; mid)res += <span class="built_in">segsum</span>(tr[p].rs, l, r);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å¯æŒä¹…åŒ–æƒå€¼çº¿æ®µæ ‘"><a href="#å¯æŒä¹…åŒ–æƒå€¼çº¿æ®µæ ‘" class="headerlink" title="å¯æŒä¹…åŒ–æƒå€¼çº¿æ®µæ ‘"></a>å¯æŒä¹…åŒ–æƒå€¼çº¿æ®µæ ‘</h2><p>é¢å¯¹çœ¼å‰çš„åŒºé—´ç¬¬ $k$ å°é—®é¢˜ï¼Œæˆ‘ä»¬åº”è¯¥æ€ä¹ˆåŠï¼Ÿ</p>
<p>æˆ‘ä»¬çš„ä¸€ä¸ªæ€è·¯å°±æ˜¯ä½¿ç”¨ä¸»å¸­æ ‘ã€‚</p>
<p>ä¸»å¸­æ ‘ï¼Œå…¨ç§°ä¸ºå¯æŒä¹…åŒ–æƒå€¼çº¿æ®µæ ‘ï¼Œé€šè¿‡ä¿å­˜æ¯æ¬¡æ’å…¥æ“ä½œæ—¶çš„å†å²ç‰ˆæœ¬ï¼Œä»¥ä¾¿æŸ¥è¯¢åŒºé—´ç¬¬ $k$ å°ã€‚</p>
<p>æ€ä¹ˆä¿å­˜å‘¢ï¼Ÿ</p>
<p>ä¸€ç§æš´åŠ›çš„æ–¹æ³•å°±æ˜¯å¯ä»¥æ¯ä¸€æ¬¡æ’å…¥çš„æ—¶å€™éƒ½å¼€ä¸€æ£µçº¿æ®µæ ‘ã€‚<br>ä½†æ˜¯è¿™æ ·å¯¹ç©ºé—´çš„ä½¿ç”¨ä¸æ˜¯å¾ˆå‹å¥½ã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬åˆ†æä¸€ä¸‹ï¼Œæ¯ä¸€æ¬¡ä¿®æ”¹çš„æ—¶å€™æ¶‰åŠçš„éƒ½åªæœ‰ä¸€æ¡ä»æ ¹èŠ‚ç‚¹åˆ°æˆ‘ä»¬æƒ³è¦ä¿®æ”¹çš„èŠ‚ç‚¹çš„è·¯å¾„ã€‚<br>é‚£ä¹ˆæˆ‘ä»¬æ¯ä¸€æ¬¡åªéœ€è¦æ–°å»ºä»æ ¹èŠ‚ç‚¹ä¸€ç›´åˆ°æˆ‘ä»¬æƒ³è¦ä¿®æ”¹çš„èŠ‚ç‚¹çš„ä¸€æ•´æ¡è·¯å¾„å°±å¯ä»¥äº†ã€‚</p>
<p>æˆ‘ä»¬æ¯ä¸€æ¬¡å°±åªæ–°å»ºäº† $O(\log n)$ ä¸ªèŠ‚ç‚¹ï¼Œå¤§å¤§èŠ‚çœäº†æˆ‘ä»¬éœ€è¦ç”¨çš„ç©ºé—´ã€‚</p>
<p>è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°±ä¸èƒ½é‡‡ç”¨å †å¼å­˜å‚¨æ³•ï¼ˆå°±æ˜¯é‚£ä¸ªæŠŠå·¦å„¿å­å’Œå³å„¿å­åˆ†åˆ«è®¾ä¸º $p &lt;&lt; 1$ å’Œ $p &lt;&lt; 1 | 1$ çš„ï¼‰äº†ï¼Œå¿…é¡»ä½¿ç”¨åŠ¨æ€å¼€ç‚¹ã€‚</p>
<p>å¯¹äºé¢„è®¡éœ€è¦çš„èŠ‚ç‚¹ä¸ªæ•°ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨è¿™ç§åŠæ³•ï¼š</p>
<p>æˆ‘ä»¬æ¯ä¸€æ¬¡æ“ä½œæœ€å¤šéœ€è¦æ–°å¼€ $2^{\lceil \log n \rceil +1}$ ä¸ªèŠ‚ç‚¹ï¼Œæˆ‘ä»¬åªéœ€è¦æ ¹æ® $n$ å’Œ $m$ çš„å¤§å°æ¥å£°æ˜å°±å¯ä»¥äº†ã€‚</p>
<p>æ€ä¹ˆç»´æŠ¤åŒºé—´ç¬¬ $k$ å°ï¼Ÿ</p>
<p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å¯¹åŒºé—´å»ºç«‹ä¸€æ£µæƒå€¼çº¿æ®µæ ‘çš„æ–¹æ³•æ¥ç»´æŠ¤å½“å‰åŒºé—´çš„åŒºé—´ç¬¬ $k$ å°ã€‚<br>åŸç†å°±æ˜¯ï¼Œæƒå€¼çº¿æ®µæ ‘ç»´æŠ¤çš„æ˜¯åŒºé—´å†…æ¯ä¸€ä¸ªæ•°æœ‰å¤šå°‘ä¸ªã€‚<br>æˆ‘ä»¬åªéœ€è¦ç”¨ç±»ä¼¼çº¿æ®µæ ‘ä¸ŠäºŒåˆ†çš„æ€æƒ³åœ¨çº¿æ®µæ ‘ä¸Šæœç´¢å³å¯ã€‚</p>
<p>ä½†æ˜¯æˆ‘ä»¬ä¸èƒ½æ¯ä¸€æ¬¡éƒ½æ ¹æ®å½“å‰åŒºé—´å»ºç«‹ä¸€æ£µçº¿æ®µæ ‘ï¼Œè¿™æ ·åˆéº»çƒ¦åˆæµªè´¹ç©ºé—´ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬å°±åƒåˆ©ç”¨å‰ç¼€å’Œå‡å»å¦ä¸€ä¸ªå‰ç¼€å’Œå¾—åˆ°åŒºé—´å’Œä¸€æ ·ï¼Œå°†ç»™å½“å‰åŒºé—´å»ºç«‹ä¸€æ£µçº¿æ®µæ ‘çš„é—®é¢˜è½¬åŒ–æˆäº†ç»™åˆ†åˆ«å»ºç«‹åœ¨ $[ 1,l-1 ]$ å’Œ $[ 1,r ]$ ä¸Šçš„ä¸¤æ£µçº¿æ®µæ ‘åšå·®ã€‚<br>è€Œè¿™æ ·çš„ä¸¤æ£µçº¿æ®µæ ‘å¯ä»¥é€šè¿‡æ¯ä¸€æ¬¡å‘çº¿æ®µæ ‘ç»´æŠ¤çš„åŒºé—´æœ€åè¿½åŠ ä¸€ä¸ªæ•°å­—æ¥å¾—åˆ°ã€‚</p>
<p>è€Œè¿™ä¹Ÿå°±æ˜¯ä¸»å¸­æ ‘ç»´æŠ¤åŒºé—´ç¬¬ $k$ å°çš„ä¸»è¦æ€æƒ³ã€‚</p>
<details class="note info"><summary><p>ä¾‹é¢˜</p>
</summary>
<p>Luogu P3834 ã€æ¨¡æ¿ã€‘å¯æŒä¹…åŒ–çº¿æ®µæ ‘ 2ï¼š<span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL3Byb2JsZW0vUDM4MzQ=">https://www.luogu.com.cn/problem/P3834<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">200010</span>, M = <span class="number">200010</span>;</span><br><span class="line"><span class="type">int</span> n, m; <span class="type">int</span> a[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt;nums;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    <span class="type">int</span> cnt;</span><br><span class="line">&#125;tr[N * <span class="number">4</span> + N * <span class="number">17</span>]; <span class="type">int</span> root[N], idx;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">lower_bound</span>(nums.<span class="built_in">begin</span>(), nums.<span class="built_in">end</span>(), x) - nums.<span class="built_in">begin</span>(); &#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">build</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> p = ++idx;</span><br><span class="line">    <span class="keyword">if</span>(l == r)<span class="keyword">return</span> p;</span><br><span class="line">    <span class="type">int</span> mid = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    tr[p].l = <span class="built_in">build</span>(l, mid);</span><br><span class="line">    tr[p].r = <span class="built_in">build</span>(mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> q = ++idx;</span><br><span class="line">    tr[q] = tr[p];</span><br><span class="line">    <span class="keyword">if</span>(l == r)</span><br><span class="line">    &#123;</span><br><span class="line">        tr[q].cnt++;</span><br><span class="line">        <span class="keyword">return</span> q;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(x &lt;= mid)tr[q].l = <span class="built_in">insert</span>(tr[p].l, l, mid, x);</span><br><span class="line">    <span class="keyword">else</span> tr[q].r = <span class="built_in">insert</span>(tr[p].r, mid + <span class="number">1</span>, r, x);</span><br><span class="line">    tr[q].cnt = tr[tr[q].l].cnt + tr[tr[q].r].cnt;</span><br><span class="line">    <span class="keyword">return</span> q;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> q, <span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l == r)<span class="keyword">return</span> r;</span><br><span class="line">    <span class="type">int</span> cnt = tr[tr[q].l].cnt - tr[tr[p].l].cnt;</span><br><span class="line">    <span class="type">int</span> mid = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(k &lt;= cnt)<span class="keyword">return</span> <span class="built_in">query</span>(tr[q].l, tr[p].l, l, mid, k);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">query</span>(tr[q].r, tr[p].r, mid + <span class="number">1</span>, r, k - cnt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">        nums.<span class="built_in">push_back</span>(a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(nums.<span class="built_in">begin</span>(), nums.<span class="built_in">end</span>());</span><br><span class="line">    nums.<span class="built_in">erase</span>(<span class="built_in">unique</span>(nums.<span class="built_in">begin</span>(), nums.<span class="built_in">end</span>()), nums.<span class="built_in">end</span>());</span><br><span class="line">    root[<span class="number">0</span>] = <span class="built_in">build</span>(<span class="number">0</span>, nums.<span class="built_in">size</span>() - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        root[i] = <span class="built_in">insert</span>(root[i - <span class="number">1</span>], <span class="number">0</span>, nums.<span class="built_in">size</span>() - <span class="number">1</span>, <span class="built_in">find</span>(a[i]));</span><br><span class="line">    <span class="keyword">while</span>(m--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> l, r, k;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;l, &amp;r, &amp;k);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, nums[<span class="built_in">query</span>(root[r], root[l - <span class="number">1</span>], <span class="number">0</span>, nums.<span class="built_in">size</span>() - <span class="number">1</span>, k)]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</details>

<details class="note info"><summary><p>å¯æŒä¹…åŒ–çš„æ™®é€šçº¿æ®µæ ‘ä¾‹é¢˜</p>
</summary>
<p>Luogu P3919 ã€æ¨¡æ¿ã€‘å¯æŒä¹…åŒ–çº¿æ®µæ ‘ 1ï¼ˆå¯æŒä¹…åŒ–æ•°ç»„ï¼‰ï¼š<span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL3Byb2JsZW0vUDM5MTk=">https://www.luogu.com.cn/problem/P3919<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1000010</span>, M = N;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    <span class="type">int</span> v;</span><br><span class="line">&#125;tr[(N &lt;&lt; <span class="number">2</span>) + (M * <span class="number">20</span>)];</span><br><span class="line"><span class="type">int</span> root[M], idx = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> a[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">build</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> p = ++idx;</span><br><span class="line">    <span class="keyword">if</span>(l == r)</span><br><span class="line">    &#123;</span><br><span class="line">        tr[p].v = a[r];</span><br><span class="line">        <span class="keyword">return</span> p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    tr[p].l = <span class="built_in">build</span>(l, mid);</span><br><span class="line">    tr[p].r = <span class="built_in">build</span>(mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="comment">//tr[p].v = tr[tr[p].l].v + tr[tr[p].r].v;</span></span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">change</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> loc, <span class="type">int</span> val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> q = ++idx;</span><br><span class="line">    tr[q] = tr[p];</span><br><span class="line">    <span class="keyword">if</span>(l == r)</span><br><span class="line">    &#123;</span><br><span class="line">        tr[q].v = val;</span><br><span class="line">        <span class="keyword">return</span> q;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(loc &lt;= mid)tr[q].l = <span class="built_in">change</span>(tr[p].l, l, mid, loc, val);</span><br><span class="line">    <span class="keyword">else</span> tr[q].r = <span class="built_in">change</span>(tr[p].r, mid + <span class="number">1</span>, r, loc, val);</span><br><span class="line">    <span class="comment">//tr[q].v = tr[tr[q].l].v + tr[tr[q].r].v;</span></span><br><span class="line">    <span class="keyword">return</span> q;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">search</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> loc)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l ==r)<span class="keyword">return</span> tr[p].v;</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(loc &lt;= mid)<span class="keyword">return</span> <span class="built_in">search</span>(tr[p].l, l, mid, loc);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">search</span>(tr[p].r, mid + <span class="number">1</span>, r, loc);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">    root[<span class="number">1</span>] = <span class="built_in">build</span>(<span class="number">1</span>, n);</span><br><span class="line">    root[<span class="number">0</span>]++;</span><br><span class="line">    <span class="type">int</span> op, ver, loc, val;</span><br><span class="line">    <span class="keyword">while</span>(m--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;ver, &amp;op, &amp;loc);</span><br><span class="line">        ver++;</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;val);</span><br><span class="line">            root[++root[<span class="number">0</span>]] = <span class="built_in">change</span>(root[ver], <span class="number">1</span>, n, loc, val);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">search</span>(root[ver], <span class="number">1</span>, n, loc));</span><br><span class="line">            root[++root[<span class="number">0</span>]] = root[ver];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;Youwike AK IOI!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</details>

<h2 id="åŒºé—´æœ€å¤§å­æ®µå’Œ"><a href="#åŒºé—´æœ€å¤§å­æ®µå’Œ" class="headerlink" title="åŒºé—´æœ€å¤§å­æ®µå’Œ"></a>åŒºé—´æœ€å¤§å­æ®µå’Œ</h2><p>åŒºé—´æœ€å¤§å­æ®µå’Œä¹Ÿå¯ä»¥ä½¿ç”¨çº¿æ®µæ ‘æ¥ç»´æŠ¤ã€‚</p>
<p>æˆ‘ä»¬è€ƒè™‘è®°å½•ä¸€ä¸‹æ¯ä¸€ä¸ªåŒºé—´å†…çš„æœ€å¤§å‰ç¼€å’Œã€æœ€å¤§åç¼€å’Œã€æœ€å¤§å­æ®µå’Œä¸åŒºé—´å’Œã€‚</p>
<p>åŒºé—´åˆå¹¶çš„æ—¶å€™è¿™æ ·åˆå¹¶ï¼š</p>
<ul>
<li>æœ€å¤§å‰ç¼€å’Œï¼šå·¦å„¿å­çš„æœ€å¤§å‰ç¼€å’Œä¸ï¼ˆå³å„¿å­çš„æœ€å¤§å‰ç¼€å’Œä¸å·¦å„¿å­çš„åŒºé—´å’Œä¹‹å’Œï¼‰å–æœ€å¤§å€¼ï¼›</li>
<li>æœ€å¤§åç¼€å’Œï¼šå³å„¿å­çš„æœ€å¤§åç¼€å’Œä¸ï¼ˆå·¦å„¿å­çš„æœ€å¤§å‰ç¼€å’Œä¸å³å„¿å­çš„åŒºé—´å’Œä¹‹å’Œï¼‰å–æœ€å¤§å€¼ï¼›</li>
<li>æœ€å¤§å­æ®µå’Œï¼šå·¦å„¿å­çš„æœ€å¤§å­æ®µå’Œã€å³å„¿å­çš„æœ€å¤§å­æ®µå’Œä¸ï¼ˆå·¦å„¿å­çš„æœ€å¤§åç¼€å’Œä¸å³å„¿å­çš„æœ€å¤§å‰ç¼€å’Œä¹‹å’Œï¼‰å–æœ€å¤§å€¼ï¼›</li>
<li>åŒºé—´å’Œï¼šç›´æ¥åŠ ã€‚</li>
</ul>
<p>å†™äº†ä¸ªé‡è½½åŠ å·ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">SegTree</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    <span class="type">int</span> lms, rms;</span><br><span class="line">    <span class="type">int</span> ms, sum;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">friend</span> SegTree <span class="keyword">operator</span> + (<span class="type">const</span> SegTree &amp;lhs, <span class="type">const</span> SegTree &amp;rhs)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> </span><br><span class="line">        &#123;</span><br><span class="line">            lhs.l, </span><br><span class="line">            rhs.r,</span><br><span class="line">            <span class="built_in">max</span>(lhs.lms, rhs.lms + lhs.sum),</span><br><span class="line">            <span class="built_in">max</span>(rhs.rms, lhs.rms + rhs.sum),</span><br><span class="line">            <span class="built_in">max</span>(lhs.rms + rhs.lms, <span class="built_in">max</span>(lhs.ms, rhs.ms)),</span><br><span class="line">            lhs.sum + rhs.sum</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;tr[N &lt;&lt; <span class="number">3</span>];</span><br></pre></td></tr></table></figure>

<p>ç„¶åæŸ¥è¯¢å‡½æ•°å°±æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">SegTree <span class="title">query</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(tr[p].l &gt;= l &amp;&amp; tr[p].r &lt;= r)<span class="keyword">return</span> tr[p].ms;</span><br><span class="line">    <span class="type">int</span> mid = (tr[p].l + tr[p].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(r &lt;= mid)<span class="keyword">return</span> <span class="built_in">query</span>(p &lt;&lt; <span class="number">1</span>, l, r);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(l &gt; mid)<span class="keyword">return</span> <span class="built_in">query</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">query</span>(p &lt;&lt; <span class="number">1</span>, l, r) + <span class="built_in">query</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœç”¨çº¿æ®µæ ‘ç»´æŠ¤åŒºé—´æœ€å¤§å­æ®µå’Œçš„è¯è¿˜å¯ä»¥æ”¯æŒå•ç‚¹ä¿®æ”¹ã€‚</p>
<p>æ€è·¯è·Ÿæ­£å¸¸çš„å•ç‚¹ä¿®æ”¹ä¸€æ ·ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">modify</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> pos, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(tr[p].l == tr[p].r)</span><br><span class="line">    &#123;</span><br><span class="line">        tr[p] = &#123; tr[p].l,tr[p].r,<span class="built_in">max</span>(k,<span class="number">0</span>),<span class="built_in">max</span>(k,<span class="number">0</span>),<span class="built_in">max</span>(k,<span class="number">0</span>),k &#125;;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid = (tr[p].l + tr[p].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(pos &lt;= mid)<span class="built_in">modify</span>(p &lt;&lt; <span class="number">1</span>, pos, k);</span><br><span class="line">    <span class="keyword">if</span>(pos &gt; mid)<span class="built_in">modify</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, pos, k);</span><br><span class="line">    tr[p] = tr[p &lt;&lt; <span class="number">1</span>] + tr[p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<details class="note info"><summary><p><span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL3Byb2JsZW0vUDY3OTI=">Luogu P6792 [SNOI2020] åŒºé—´å’Œ<i class="fa fa-external-link-alt"></i></span></p>
</summary>
<p>æš´åŠ›ä¿®æ”¹ï¼Œä¸æ˜¯æ­£è§£ã€‚<br>èƒ½è¿‡å®˜æ–¹æ•°æ®ï¼Œä½†æ˜¯ä¸èƒ½è¿‡Hackæ•°æ®ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">100010</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SegTree</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    ll lms, rms;</span><br><span class="line">    ll ms, sum;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">friend</span> SegTree <span class="keyword">operator</span> + (<span class="type">const</span> SegTree &amp;lhs, <span class="type">const</span> SegTree &amp;rhs)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">        &#123;</span><br><span class="line">            lhs.l,</span><br><span class="line">            rhs.r,</span><br><span class="line">            <span class="built_in">max</span>(lhs.lms, rhs.lms + lhs.sum),</span><br><span class="line">            <span class="built_in">max</span>(rhs.rms, lhs.rms + rhs.sum),</span><br><span class="line">            <span class="built_in">max</span>(lhs.rms + rhs.lms, <span class="built_in">max</span>(lhs.ms, rhs.ms)),</span><br><span class="line">            lhs.sum + rhs.sum</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;tr[N &lt;&lt; <span class="number">3</span>];</span><br><span class="line">ll a[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tr[p].l = l, tr[p].r = r;</span><br><span class="line">    <span class="keyword">if</span>(l == r)</span><br><span class="line">    &#123;</span><br><span class="line">        tr[p] = &#123; l,r,<span class="built_in">max</span>(<span class="number">0ll</span>,a[l]),<span class="built_in">max</span>(<span class="number">0ll</span>,a[l]),<span class="built_in">max</span>(<span class="number">0ll</span>,a[l]),a[l] &#125;;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">build</span>(p &lt;&lt; <span class="number">1</span>, l, mid);</span><br><span class="line">    <span class="built_in">build</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">    tr[p] = tr[p &lt;&lt; <span class="number">1</span>] + tr[p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">modify</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> pos, ll k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(tr[p].l == tr[p].r)</span><br><span class="line">    &#123;</span><br><span class="line">        tr[p] = &#123; tr[p].l,tr[p].r,<span class="built_in">max</span>(k,<span class="number">0ll</span>),<span class="built_in">max</span>(k,<span class="number">0ll</span>),<span class="built_in">max</span>(k,<span class="number">0ll</span>),k &#125;;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid = (tr[p].l + tr[p].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(pos &lt;= mid)<span class="built_in">modify</span>(p &lt;&lt; <span class="number">1</span>, pos, k);</span><br><span class="line">    <span class="keyword">if</span>(pos &gt; mid)<span class="built_in">modify</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, pos, k);</span><br><span class="line">    tr[p] = tr[p &lt;&lt; <span class="number">1</span>] + tr[p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">SegTree <span class="title">query</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(tr[p].l &gt;= l &amp;&amp; tr[p].r &lt;= r)<span class="keyword">return</span> tr[p];</span><br><span class="line">    <span class="type">int</span> mid = (tr[p].l + tr[p].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(r &lt;= mid)<span class="keyword">return</span> <span class="built_in">query</span>(p &lt;&lt; <span class="number">1</span>, l, r);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(l &gt; mid)<span class="keyword">return</span> <span class="built_in">query</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">query</span>(p &lt;&lt; <span class="number">1</span>, l, r) + <span class="built_in">query</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> m, n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;a[i]);</span><br><span class="line">    <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">    <span class="keyword">while</span>(m--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> op, l, r;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;op, &amp;l, &amp;r);</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            ll k;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;k);</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = l; i &lt;= r; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(k &gt; a[i])</span><br><span class="line">                &#123;</span><br><span class="line">                    a[i] = k;</span><br><span class="line">                    <span class="built_in">modify</span>(<span class="number">1</span>, i, k);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            SegTree res = <span class="built_in">query</span>(<span class="number">1</span>, l, r);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, res.ms);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</details>










































































]]></content>
      <categories>
        <category>æ•°æ®ç»“æ„</category>
      </categories>
      <tags>
        <tag>æ•°æ®ç»“æ„</tag>
      </tags>
  </entry>
  <entry>
    <title>åç¼€è‡ªåŠ¨æœº</title>
    <url>/OI/suffix-avtomat/</url>
    <content><![CDATA[<p>åç¼€è‡ªåŠ¨æœº(SAM)ã€‚</p>
<span id="more"></span>

<h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><p>åç¼€è‡ªåŠ¨æœºï¼Œæ˜¯ä¸€ä¸ªèƒ½å¤Ÿè§£å†³è®¸å¤šå­—ç¬¦ä¸²ç›¸å…³é—®é¢˜çš„ï¼Œååˆ†å¼ºåŠ›çš„æ•°æ®ç»“æ„ã€‚<br>ä¸è¦è¢«åšå®¢çš„é“¾æ¥è¿·æƒ‘äº†ï¼Œåç¼€è‡ªåŠ¨æœºæ˜¯ <strong>S</strong>uffix <strong>A</strong>uto<strong>m</strong>aton ã€‚<br>ï¼ˆåšå®¢æ ‡é¢˜æ¥è‡ªä¿„è¯­ Ğ¡ÑƒÑ„Ñ„Ğ¸ĞºÑĞ½Ñ‹Ğ¹ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚ -&gt; Suffiksneyy avtomatï¼‰</p>
<p>åç¼€è‡ªåŠ¨æœºå¯ä»¥å­˜å‚¨ä¸‹ä¸€ä¸ªå­—ç¬¦ä¸²çš„æ‰€æœ‰å­ä¸²ï¼Œå¹¶ä¸”åšåˆ°çº¿æ€§æ—¶ç©ºå¤æ‚åº¦ã€‚<br>å‡†ç¡®æ¥è¯´ï¼Œå¯¹äºä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„å­—ç¬¦ä¸²æ„é€ åç¼€è‡ªåŠ¨æœºï¼Œå…¶ä¸­è‡³å¤šæœ‰ $2n-1$ ä¸ªèŠ‚ç‚¹ä¸ $3n-4$ æ¡è½¬ç§»è¾¹ã€‚</p>
<h1 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h1><p>åç¼€è‡ªåŠ¨æœºæ˜¯ä¸€ä¸ªDFAï¼ˆç¡®å®šæ€§æœ‰é™è‡ªåŠ¨æœºæˆ–ç¡®å®šæ€§æœ‰é™çŠ¶æ€è‡ªåŠ¨æœºï¼‰ã€‚å®ƒæ¥å—ä¸”åªæ¥å— $s$ çš„æ‰€æœ‰å­ä¸²ã€‚</p>
<p>å±•å¼€æ¥è¯´çš„è¯ï¼Œå¯ä»¥æ¦‚æ‹¬æˆè¿™ä¹ˆå‡ ç‚¹ï¼š</p>
<ol>
<li>åç¼€è‡ªåŠ¨æœºæ˜¯ä¸€ä¸ªæœ‰å‘æ— ç¯å›¾ã€‚å…¶ä¸­çš„èŠ‚ç‚¹å«åš<strong>çŠ¶æ€</strong>ï¼Œè¾¹å«åš<strong>è½¬ç§»</strong>ã€‚</li>
<li>å›¾ä¸­åŒ…å«ä¸€ä¸ªåˆå§‹èŠ‚ç‚¹ $t_0$ ï¼Œä»»ä½•èŠ‚ç‚¹éƒ½å¯ä»¥ç”±ä¹‹ç»è¿‡ä¸€ç³»åˆ—çš„è½¬ç§»åˆ°è¾¾ã€‚</li>
<li>æ¯ä¸€ä¸ªè½¬ç§»éƒ½æ ‡æœ‰ä¸€ä¸ªå­—æ¯ï¼Œä¸”ä»æŸä¸€ä¸ªèŠ‚ç‚¹å‡ºå‘çš„æ¯ä¸€ä¸ªè½¬ç§»éƒ½æ˜¯ä¸åŒçš„ã€‚</li>
<li>è‡ªåŠ¨æœºå­˜åœ¨å¤šä¸ªç»ˆæ­¢çŠ¶æ€ã€‚å¦‚æœæˆ‘ä»¬ä»åˆå§‹çŠ¶æ€ $t_0$ å‡ºå‘ï¼Œæœ€ç»ˆè½¬ç§»åˆ°äº†ä¸€ä¸ªç»ˆæ­¢çŠ¶æ€ï¼Œåˆ™è·¯å¾„ä¸Šçš„æ‰€æœ‰è½¬ç§»è¿æ¥èµ·æ¥ä¸€å®šæ˜¯å­—ç¬¦ä¸² $s$ çš„ä¸€ä¸ªåç¼€ã€‚ $s$ çš„æ¯ä¸ªåç¼€å‡å¯ç”¨ä¸€æ¡ä» $t_0$ åˆ°æŸä¸ªç»ˆæ­¢çŠ¶æ€çš„è·¯å¾„æ„æˆã€‚</li>
<li>åœ¨æ‰€æœ‰æ»¡è¶³ä¸Šè¿°æ¡ä»¶çš„è‡ªåŠ¨æœºä¸­ï¼Œåç¼€è‡ªåŠ¨æœºçš„ç»“ç‚¹æ•°æ˜¯æœ€å°‘çš„ã€‚</li>
</ol>
<h1 id="å­ä¸²"><a href="#å­ä¸²" class="headerlink" title="å­ä¸²"></a>å­ä¸²</h1><p>ä¸€ä¸ªå­—ç¬¦ä¸²çš„åç¼€è‡ªåŠ¨æœºåŒ…å«å…³äºè¿™ä¸ªå­—ç¬¦ä¸²å­ä¸²çš„æ‰€æœ‰ä¿¡æ¯ã€‚<br>æ›´å‡†ç¡®åœ°æ¥è¯´ï¼Œå¯¹äºä»»æ„ä»åˆå§‹èŠ‚ç‚¹ $t_0$ å¼€å§‹çš„è·¯å¾„ï¼Œæˆ‘ä»¬å°†å…¶è½¬ç§»è¾¹ä¸Šçš„å­—ç¬¦æ‹¿ä¸‹æ¥æŒ‰é¡ºåºæ’åˆ—ï¼Œéƒ½å¯ä»¥å¾—åˆ°åŸå­—ç¬¦ä¸²çš„ä¸€ä¸ªå­ä¸²ã€‚<br>è¿™é‡Œéœ€è¦æ³¨æ„ï¼šä¸€æ¡è·¯å¾„å¯¹åº”ä¸€ä¸ªå­ä¸²ï¼Œä½†æ˜¯ä¸€ä¸ªå­ä¸²ä¸ä¸€å®šåªå¯¹åº”ä¸€æ¡è·¯å¾„ã€‚</p>
<h1 id="æ€§è´¨"><a href="#æ€§è´¨" class="headerlink" title="æ€§è´¨"></a>æ€§è´¨</h1><h2 id="ç»“æŸä½ç½®-endpos"><a href="#ç»“æŸä½ç½®-endpos" class="headerlink" title="ç»“æŸä½ç½® endpos"></a>ç»“æŸä½ç½® <code>endpos</code></h2><p>å¯¹äºå­—ç¬¦ä¸² $s$ çš„ä¸€ä¸ªå­ä¸² $t$ ï¼Œæˆ‘ä»¬è®°å…¶åœ¨å­—ç¬¦ä¸² $s$ ä¸­çš„æ‰€æœ‰ç»“æŸä½ç½®ä¸º $\operatorname{endpos}(t)$ ã€‚ä¾‹å¦‚å¯¹äºå­—ç¬¦ä¸² $aabbabd$ ï¼Œæˆ‘ä»¬æœ‰ $\operatorname{endpos}(ab)&#x3D;\{ 2,4 \} $ã€‚<br>ä¸¤ä¸ªå­ä¸² $t_1$ ä¸ $t_2$ çš„endposé›†åˆå¯èƒ½ç›¸ç­‰ã€‚è¿™æ ·ï¼Œæ‰€æœ‰å­—ç¬¦ä¸² $s$<br>çš„éç©ºå­ä¸²éƒ½å¯ä»¥æ ¹æ®å…¶endposé›†åˆåˆ†ä¸ºè‹¥å¹²<strong>ç­‰ä»·ç±»</strong>ã€‚<br>è€Œæˆ‘ä»¬çŸ¥é“ï¼Œåç¼€è‡ªåŠ¨æœºä¸­çš„æ¯ä¸ªçŠ¶æ€å¯¹åº”ä¸€ä¸ªæˆ–å¤šä¸ªendposç›¸åŒçš„å­ä¸²ï¼Œå³ä¸€ä¸ªç­‰ä»·ç±»ã€‚<br>è¿™å°±å¾ˆå¥½åœ°è§£é‡Šäº†ä¸Šé¢æ‰€è¯´çš„é™¤äº†æœ€å°æ€§ä¹‹å¤–çš„æ‰€æœ‰æ€§è´¨ã€‚</p>
<p>åŸºäºendposï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ç³»åˆ—é‡è¦ç»“è®ºï¼š</p>
<blockquote>
<p><strong>å¼•ç†1</strong>ï¼š å­—ç¬¦ä¸² $s$ çš„ä¸¤ä¸ªéç©ºå­ä¸² $u$ å’Œ $v$ ï¼ˆå‡è®¾ $|u| \leq |v|$ ï¼‰çš„endposç›¸åŒï¼Œå½“ä¸”ä»…å½“å­—ç¬¦ä¸² $u$ åœ¨ $s$ ä¸­çš„æ¯æ¬¡å‡ºç°ï¼Œéƒ½æ˜¯ä»¥ $v$ åç¼€çš„å½¢å¼å­˜åœ¨çš„ã€‚</p>
</blockquote>
<p>è¯æ˜ï¼šè‡ªå·±ç”»å›¾çœ‹çœ‹ã€‚æ—¢ç„¶ $u$ ä¸ $v$ çš„endposå·²ç»ç›¸åŒäº†ï¼Œé‚£ä¹ˆè¯´æ˜ä¸¤è€…æ‹¥æœ‰ç›¸åŒçš„åç¼€ï¼ˆä¸ç†è§£å°±ç”»å›¾ï¼ï¼‰ã€‚è€Œå½“ $|u| \leq |v|$ æ—¶ï¼Œ $u$ æ˜¾ç„¶ä¸º $v$ çš„ä¸€ä¸ªåç¼€ã€‚</p>
<blockquote>
<p><strong>å¼•ç†2</strong>ï¼š è€ƒè™‘ä¸¤ä¸ªéç©ºå­ä¸² $u$ ä¸ $v$ ï¼ˆä»ç„¶å‡è®¾ $|u| \leq |v|$ ï¼‰ã€‚ä¸¤è€…çš„endposæ»¡è¶³è¿™æ ·çš„ä¸€ä¸ªå…³ç³»ï¼š<br>$$<br>\begin{cases}<br>\operatorname{endpos}(v) \subseteq \operatorname{endpos}(u) &amp; \text{if } u \text{ is a suffix of } v\\<br>\operatorname{endpos}(v) \cap \operatorname{endpos}(u) &#x3D; \varnothing &amp; \text{otherwise}<br>\end{cases}<br>$$</p>
</blockquote>
<p>è¯æ˜ï¼šå¦‚æœ $\operatorname{endpos}(u) \cap \operatorname{endpos}(v) \neq \varnothing$ ï¼Œé‚£ä¹ˆç»“åˆæˆ‘ä»¬åˆšåˆšè¯æ˜å®Œçš„å¼•ç†1ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ $u$ æ˜¯ $v$ çš„ä¸€ä¸ªåç¼€ã€‚æ—¢ç„¶ $u$ æ˜¯ $v$ çš„ä¸€ä¸ªåç¼€äº†ï¼Œé‚£ä¹ˆå¯¹äºæ‰€æœ‰ $v$ å‡ºç°çš„åœ°æ–¹ï¼Œ $u$ ä¹Ÿä¼šå‡ºç°ï¼Œå³ $\operatorname{endpos}(u) \subseteq \operatorname{endpos}(v)$ ã€‚è€Œå¦‚æœ $u$ çš„é•¿åº¦å°äº $v$ ä¸” $u$ è¿˜ä¸æ˜¯ $v$ çš„åç¼€ï¼Œé‚£ä¹ˆ $v$ å‡ºç°çš„åœ°æ–¹ $u$ ä¸€å®šä¸ä¼šå‡ºç°ï¼Œå³ $\operatorname{endpos}(u) \cap \operatorname{endpos}(v) &#x3D; \varnothing$ ã€‚</p>
<blockquote>
<p><strong>å¼•ç†3</strong>: å¯¹äºä»»æ„ä¸€ä¸ªendposç­‰ä»·ç±»ï¼ˆæˆ–è€…ä¸€ä¸ªçŠ¶æ€ï¼‰ï¼Œå…¶åŒ…å«çš„æ‰€æœ‰å­ä¸²éƒ½æ˜¯æœ€é•¿å­ä¸²çš„è¿ç»­åç¼€ã€‚</p>
</blockquote>
<p>è¯æ˜ï¼šæˆ‘ä»¬è€ƒè™‘ç­‰ä»·ç±»ä¸­ä¸¤ä¸ªå­ä¸²ï¼šæœ€é•¿çš„ï¼Œè®°ä¸º $u$ ï¼›æœ€çŸ­çš„ï¼Œè®°ä¸º $v$ ã€‚å¦‚æœ $u&#x3D;v$ é‚£ä¹ˆæ˜¾ç„¶ä¸ç”¨è¯æ˜ã€‚å¦‚æœä¸æ˜¯ï¼Œé‚£ä¹ˆå¯¹äºé•¿åº¦åœ¨åŒºé—´ $[ |u| , |v| ]$ å†…çš„å­ä¸²ã€‚æ ¹æ®å¼•ç†1ï¼Œåœ¨è¿™ä¸ªç­‰ä»·ç±»ä¸­ï¼Œå¿…å®šå­˜åœ¨å­ä¸²æœ‰ $v$ ä¸ºåç¼€ä¸”åŒæ—¶ä¸º $u$ çš„åç¼€ã€‚</p>
<h2 id="åç¼€é“¾æ¥-link"><a href="#åç¼€é“¾æ¥-link" class="headerlink" title="åç¼€é“¾æ¥ link"></a>åç¼€é“¾æ¥ <code>link</code></h2><p>æ ¹æ®å¼•ç†3ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“å¯¹äºä»»æ„çŠ¶æ€ï¼Œå…¶ä¸­åŒ…å«çš„å­—ä¸²éƒ½æ˜¯å…¶ä¸­æœ€é•¿å­ä¸²çš„ä¸€æ®µè¿ç»­åç¼€ã€‚è¿™æ®µè¿ç»­åç¼€ä¸ä¸€å®šå¯ä»¥è¦†ç›– $[ 1,|\text{æœ€é•¿å­ä¸²}| ]$ è¿™ä¸€æ•´ä¸ªåŒºé—´ï¼Œä½†ä¸€å®šæ˜¯è¿ç»­çš„ã€‚<br>æˆ‘ä»¬å¯ä»¥å°†å…¶çœ‹åšæ˜¯ä¸æ–­å°†æœ€é•¿å­ä¸²çš„é¦–ä¸ªå­—ç¬¦åˆ å»å¾—åˆ°å­ä¸²çš„ä¸€ä¸ªè¿‡ç¨‹ã€‚</p>
<p>è€Œå½“æˆ‘ä»¬ä¸æ–­åˆ å»ï¼Œç›´åˆ°åˆ å»æœ€çŸ­å­ä¸²çš„é¦–ä¸ªå­—ç¬¦çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šå‘ç°æˆ‘ä»¬å·²ç»ç¦»å¼€äº†è¿™ä¸ªçŠ¶æ€ã€‚<br>æˆ‘ä»¬å¯ä»¥æ ¹æ®è¿™æ ·ä¸€ä¸ªèµ°å‘åˆ›å»ºä¸€ç³»åˆ—çš„æ–°è¾¹ã€‚<br>è¿™äº›æ–°è¾¹å°±è¢«ç§°ä¸ºlinkè¾¹ï¼Œä¹Ÿå«åšåç¼€é“¾æ¥ã€‚<br>æœ‰äº›åœ°æ–¹ä¹Ÿå«fa&#x2F;fatherè¾¹ã€‚</p>
<blockquote>
<p><strong>å¼•ç†4</strong>ï¼š æ‰€æœ‰åç¼€é“¾æ¥æ„æˆä¸€æ£µæ ¹èŠ‚ç‚¹ä¸º $t_0$ çš„æ ‘ã€‚</p>
</blockquote>
<p>è¯æ˜ï¼šæ ¹æ®åç¼€é“¾æ¥çš„å®šä¹‰åŠå¼•ç†3ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå½“å‰çŠ¶æ€çš„åç¼€é“¾æ¥åˆ°è¾¾çš„æ˜¯ä¸¥æ ¼æ›´çŸ­çš„å­—ç¬¦ä¸²ã€‚è€Œæ²¿ç€åç¼€é“¾æ¥èµ°ï¼Œæœ€åæ€»èƒ½åˆ°è¾¾ä»£è¡¨ç€ç©ºå­—ç¬¦ä¸²çš„ $t_0$ ã€‚</p>
<p>æˆ‘ä»¬å°†åç¼€é“¾æ¥ä¸endposå…³è”ä¸€ä¸‹ã€‚<br>æ ¹æ®å¼•ç†2ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºï¼Œä¸¤ä¸ªendposç­‰ä»·ç±»ä¸æ˜¯äº’ç›¸åŒ…å«ï¼Œå°±æ˜¯äº’ä¸ç›¸äº¤ã€‚æ ¹æ®è¿™ä¸ªåŒ…å«å…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥åˆ—å‡ºä¸€æ£µendposç­‰ä»·ç±»çš„æ ‘ã€‚<br>å¯¹åº”åœ¨åç¼€è‡ªåŠ¨æœºä¸Šå°±æ˜¯å¯¹çŠ¶æ€å»ºæ ‘ã€‚</p>
<blockquote>
<p><strong>å¼•ç†5</strong>ï¼š é€šè¿‡ $\operatorname{endpos}$ é›†åˆæ„é€ çš„æ ‘ï¼ˆæ¯ä¸ªå­èŠ‚ç‚¹çš„å­é›†éƒ½åŒ…å«åœ¨çˆ¶èŠ‚ç‚¹çš„å­é›†ä¸­ï¼‰ä¸é€šè¿‡åç¼€é“¾æ¥æ„é€ çš„æ ‘ç›¸åŒã€‚</p>
</blockquote>
<p>è¯æ˜ï¼šæ˜¯æ ‘çš„è¯æ˜ä¸Šé¢æœ‰äº†ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹å¯¹äºä¸¤è€…ç›¸åŒçš„è¯æ˜ã€‚<br>è€ƒè™‘ä»»æ„é $t_0$ çš„çŠ¶æ€ $u$ åŠå…¶åç¼€é“¾æ¥ $\operatorname{link}(u)$ ã€‚æ ¹æ®å¼•ç†2å’Œåç¼€é“¾æ¥çš„å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ $\operatorname{endpos}(u) \varsubsetneqq \operatorname{endpos}(\operatorname{link}(u))$ ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬åœ¨å»ºæ ‘çš„æ—¶å€™ï¼Œå°±ä¼šåœ¨ $u$ ä¸ $\operatorname{link}(u)$ ä¹‹é—´è¿ä¸€æ¡è¾¹ã€‚</p>
<h1 id="æ„å»º"><a href="#æ„å»º" class="headerlink" title="æ„å»º"></a>æ„å»º</h1><p>ä¸‹é¢æ˜¯å¯¹å­—ç¬¦ä¸² $aabbabcd$ æ„å»ºåç¼€è‡ªåŠ¨æœºå¾—åˆ°çš„ç»“æœã€‚<br>å…¶ä¸­ï¼Œè“è‰²(#1453AD)çš„è¾¹ä»£è¡¨çš„æ˜¯è½¬ç§»ï¼Œç»¿è‰²(#14AD53)çš„è¾¹ä»£è¡¨çš„æ˜¯åç¼€é“¾æ¥ã€‚<br>è“è‰²(#1453AD)çš„ç‚¹ä»£è¡¨çŠ¶æ€ï¼Œç´«è‰²(#AD1453)çš„ç‚¹ä»£è¡¨ç»ˆæ­¢çŠ¶æ€ã€‚</p>
<p><img src="/pics/SAM.svg" alt="SAM"></p>
<h2 id="ç®—æ³•"><a href="#ç®—æ³•" class="headerlink" title="ç®—æ³•"></a>ç®—æ³•</h2><p>æ„å»ºåç¼€è‡ªåŠ¨æœºçš„ç®—æ³•æ˜¯ä¸ª<strong>åœ¨çº¿</strong>ç®—æ³•ã€‚æˆ‘ä»¬é€ä¸ªåŠ å…¥å­—ç¬¦ä¸²ä¸­çš„æ¯ä¸ªå­—ç¬¦ï¼Œå¹¶åœ¨æ¯ä¸€æ­¥ä¸­ç›¸åº”åœ°ç»´æŠ¤åˆšåˆšå¾—åˆ°çš„åç¼€è‡ªåŠ¨æœºã€‚<br>ä¸ºäº†ä¿è¯çº¿æ€§çš„ç©ºé—´å¤æ‚åº¦ï¼Œæˆ‘ä»¬åªä¿å­˜<code>len</code>ä¸<code>link</code>çš„å€¼ã€‚ç»ˆæ­¢çŠ¶æ€çš„å€¼å¯ä»¥åœ¨æ„å»ºå®Œè‡ªåŠ¨æœºä¹‹åæ±‚å‡ºã€‚</p>
<p>åœ¨æœ€å¼€å§‹ï¼Œæ•´ä¸ªåç¼€è‡ªåŠ¨æœºåªä¼šåŒ…å«ä¸€ä¸ªèŠ‚ç‚¹ï¼š $t_0$ ï¼Œç¼–å·ä¸º0ã€‚æˆ‘ä»¬æŒ‡å®š<code>len[0] = 0</code>ï¼Œ<code>link[0] = -1</code>ã€‚è¿™é‡Œçš„$-1$è¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„çŠ¶æ€ã€‚<br>ç„¶åæˆ‘ä»¬å°±å¯ä»¥å‘åç¼€è‡ªåŠ¨æœºå†…æ·»åŠ å­—ç¬¦äº†ã€‚</p>
<p>æˆ‘ä»¬å‘åç¼€è‡ªåŠ¨æœºå†…æ·»åŠ ä¸€ä¸ªå­—ç¬¦ $c$ çš„ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š</p>
<p>æˆ‘ä»¬ä»¤<code>last</code>ä¸ºå…ˆå‰å¯¹åº”æ•´ä¸ªå­—ç¬¦ä¸²çš„çŠ¶æ€ï¼ˆä¸€å¼€å§‹æˆ‘ä»¬è®¾<code>last = 0</code>ï¼‰ã€‚</p>
<p>åˆ›å»ºä¸€ä¸ªæ–°çš„çŠ¶æ€<code>cur</code>ï¼Œå¹¶ä½¿<code>len[cur] = len[last] + 1</code>ã€‚</p>
<p>ä»çŠ¶æ€<code>last</code>å¼€å§‹ï¼Œä¸æ–­éå†åç¼€é“¾æ¥ã€‚<br>å¦‚æœè¿˜æ²¡æœ‰åˆ°å­—ç¬¦ $c$ çš„è½¬ç§»ï¼Œæˆ‘ä»¬å°±æ·»åŠ ä¸€ä¸ªæŒ‡å‘<code>cur</code>çš„è½¬ç§»ã€‚<br>å¦‚æœåœ¨æŸä¸ªç‚¹å·²ç»å­˜åœ¨åˆ°å­—ç¬¦ $c$ çš„è½¬ç§»ï¼Œæˆ‘ä»¬å°±åœä¸‹æ¥ï¼Œå¹¶å°†è¿™ä¸ªçŠ¶æ€è®°ä¸º<code>p</code>ã€‚<br>å¦‚æœæ²¡æœ‰æ‰¾åˆ°è¿™æ ·çš„çŠ¶æ€<code>p</code>ï¼Œæˆ‘ä»¬æœ€ç»ˆä¼šåˆ°è¾¾è™šæ‹ŸçŠ¶æ€$-1$ï¼Œè¿™æ—¶æˆ‘ä»¬ä½¿<code>link[cur] = 0</code>å¹¶é€€å‡ºã€‚</p>
<p>å¦‚æœæˆ‘ä»¬æ‰¾åˆ°äº†ä¸€ä¸ªçŠ¶æ€<code>p</code>ï¼Œå…¶å¯ä»¥é€šè¿‡å­—ç¬¦ $c$ è½¬ç§»ï¼Œæˆ‘ä»¬å°†è¿™æ ·è½¬ç§»åˆ°çš„çŠ¶æ€æ ‡è®°ä¸º<code>q</code>ã€‚<br>ç°åœ¨æˆ‘ä»¬è€ƒè™‘æˆ‘ä»¬æ‰¾åˆ°çš„<code>q</code>æ˜¯å¦æ»¡è¶³<code>len[p] + 1 = len[q]</code>è¿™ä¸ªæ¡ä»¶ã€‚</p>
<p>å¦‚æœæ»¡è¶³ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±åªéœ€è¦ä½¿<code>link[cur] = q</code>å¹¶é€€å‡ºã€‚</p>
<p>å¦‚æœä¸æ»¡è¶³ï¼Œé‚£ä¹ˆæƒ…å†µå°±ä¼šå˜å¾—å¤æ‚ã€‚<br>æˆ‘ä»¬éœ€è¦å¤åˆ¶ä¸€ä¸ªçŠ¶æ€<code>q</code>ï¼Œæ ‡è®°ä¸º<code>nq</code>ã€‚<code>nq</code>å°†ä¼šè·å¾—<code>q</code>é™¤äº†<code>len</code>ä»¥å¤–çš„æ‰€æœ‰ä¿¡æ¯ã€‚æˆ‘ä»¬å°†<code>len[nq]</code>èµ‹å€¼ä¸º<code>len[p] + 1</code>ã€‚ä¹‹åï¼Œæˆ‘ä»¬ä½¿<code>link[cur] = link[q] = nq</code>ã€‚<br>ä¹‹åï¼Œä½¿ç”¨åç¼€é“¾æ¥ä»<code>p</code>å¾€å›èµ°ï¼Œå¹¶æŠŠæ²¿é€”æ‰€æœ‰æŒ‡å‘<code>q</code>çš„è½¬ç§»é‡å®šå‘è‡³<code>nq</code>ã€‚</p>
<p>æœ€åï¼Œæˆ‘ä»¬å°†<code>last</code>çš„å€¼æ›´æ–°ä¸º<code>cur</code>ã€‚</p>
<h3 id="å¯»æ‰¾ç»ˆæ­¢çŠ¶æ€"><a href="#å¯»æ‰¾ç»ˆæ­¢çŠ¶æ€" class="headerlink" title="å¯»æ‰¾ç»ˆæ­¢çŠ¶æ€"></a>å¯»æ‰¾ç»ˆæ­¢çŠ¶æ€</h3><p>å¦‚æœæˆ‘ä»¬è¿˜æƒ³è¦çŸ¥é“å“ªäº›çŠ¶æ€æ˜¯ç»ˆæ­¢çŠ¶æ€è€Œé‚£äº›ä¸æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ„å»ºå®Œ $s$ å¯¹åº”çš„åç¼€è‡ªåŠ¨æœºä¹‹åå†è¿›è¡Œå¯»æ‰¾ã€‚</p>
<p>æˆ‘ä»¬ä»åˆšæ‰æœ€åä¸€æ­¥å¾—åˆ°çš„<code>last</code>å¤„å¼€å§‹éå†åç¼€é“¾æ¥ï¼Œç›´åˆ°æœ€ç»ˆåˆ°è¾¾åˆå§‹èŠ‚ç‚¹ã€‚<br>æˆ‘ä»¬å°†æ²¿é€”çš„æ‰€æœ‰çŠ¶æ€éƒ½æ ‡è®°ä¸ºç»ˆæ­¢çŠ¶æ€ï¼Œå› ä¸ºä»–ä»¬å­˜å‚¨ç€åŸå­—ç¬¦ä¸² $s$ çš„è‡³å°‘ä¸€ä¸ªåç¼€ã€‚</p>
<h3 id="è¯æ˜"><a href="#è¯æ˜" class="headerlink" title="è¯æ˜"></a>è¯æ˜</h3><p>è¿™é‡Œæˆ‘ä»¬å¼•ç”¨ä¸€ä¸‹<span class="exturl" data-url="aHR0cHM6Ly9vaS13aWtpLm9yZy9zdHJpbmcvc2FtLyNfNg==">OI-Wiki<i class="fa fa-external-link-alt"></i></span>ä¸Šçš„è¯æ˜ã€‚</p>
<details class="note info"><summary><p>æ­£ç¡®æ€§è¯æ˜</p>
</summary>
<ul>
<li>è‹¥ä¸€ä¸ªè½¬ç§» $(p,q)$ æ»¡è¶³<code>len[p] + 1 =len[q]</code>ï¼Œåˆ™æˆ‘ä»¬ç§°è¿™ä¸ªè½¬ç§»æ˜¯ <strong>è¿ç»­çš„</strong>ã€‚å¦åˆ™ï¼Œå³å½“<code>len[p] + 1 &lt; len[q]</code>æ—¶ï¼Œè¿™ä¸ªè½¬ç§»è¢«ç§°ä¸º <strong>ä¸è¿ç»­çš„</strong>ã€‚ä»ç®—æ³•æè¿°ä¸­å¯ä»¥çœ‹å‡ºï¼Œè¿ç»­çš„ã€ä¸è¿ç»­çš„è½¬ç§»æ˜¯ç®—æ³•çš„ä¸åŒæƒ…å†µã€‚è¿ç»­çš„è½¬ç§»æ˜¯å›ºå®šçš„ï¼Œæˆ‘ä»¬ä¸ä¼šå†æ”¹å˜äº†ã€‚ä¸æ­¤ç›¸åï¼Œå½“å‘å­—ç¬¦ä¸²ä¸­æ’å…¥ä¸€ä¸ªæ–°çš„å­—ç¬¦æ—¶ï¼Œä¸è¿ç»­çš„è½¬ç§»å¯èƒ½ä¼šæ”¹å˜ï¼ˆè½¬ç§»è¾¹çš„ç«¯ç‚¹å¯èƒ½ä¼šæ”¹å˜ï¼‰ã€‚</li>
<li>ä¸ºäº†é¿å…å¼•èµ·æ­§ä¹‰ï¼Œæˆ‘ä»¬è®°å‘åç¼€è‡ªåŠ¨æœºä¸­æ’å…¥å½“å‰å­—ç¬¦ $c$ ä¹‹å‰çš„å­—ç¬¦ä¸²ä¸º $s$ã€‚</li>
<li>ç®—æ³•ä»åˆ›å»ºä¸€ä¸ªæ–°çŠ¶æ€<code>cur</code>å¼€å§‹ï¼Œå¯¹åº”äºæ•´ä¸ªå­—ç¬¦ä¸² $s+c$ã€‚æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„èŠ‚ç‚¹çš„åŸå› å¾ˆæ¸…æ¥šã€‚ä¸æ­¤åŒæ—¶æˆ‘ä»¬ä¹Ÿåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å­—ç¬¦å’Œä¸€ä¸ªæ–°çš„ç­‰ä»·ç±»ã€‚</li>
<li>åœ¨åˆ›å»ºä¸€ä¸ªæ–°çš„çŠ¶æ€ä¹‹åï¼Œæˆ‘ä»¬ä¼šä»å¯¹åº”æ•´ä¸ªå­—ç¬¦ä¸² $s$ çš„çŠ¶æ€é€šè¿‡åç¼€é“¾æ¥è¿›è¡Œéå†ã€‚å¯¹äºæ¯ä¸€ä¸ªçŠ¶æ€ï¼Œæˆ‘ä»¬å°è¯•æ·»åŠ ä¸€ä¸ªé€šè¿‡å­—ç¬¦ $c$ åˆ°æ–°çŠ¶æ€<code>cur</code>çš„è½¬ç§»ã€‚ç„¶è€Œæˆ‘ä»¬åªèƒ½æ·»åŠ ä¸åŸæœ‰è½¬ç§»ä¸å†²çªçš„è½¬ç§»ã€‚å› æ­¤æˆ‘ä»¬åªè¦æ‰¾åˆ°å·²å­˜åœ¨çš„ $c$ çš„è½¬ç§»ï¼Œæˆ‘ä»¬å°±å¿…é¡»åœæ­¢ã€‚</li>
<li>æœ€ç®€å•çš„æƒ…å†µæ˜¯æˆ‘ä»¬åˆ°è¾¾äº†è™šæ‹ŸçŠ¶æ€ $-1$ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬ä¸ºæ‰€æœ‰ $s$ çš„åç¼€æ·»åŠ äº† $c$ çš„è½¬ç§»ã€‚è¿™ä¹Ÿæ„å‘³ç€ï¼Œå­—ç¬¦ $c$ ä»æœªåœ¨å­—ç¬¦ä¸² $s$ ä¸­å‡ºç°è¿‡ã€‚å› æ­¤<code>cur</code>çš„åç¼€é“¾æ¥ä¸ºçŠ¶æ€ $0$ã€‚</li>
<li>ç¬¬äºŒç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†ç°æœ‰çš„è½¬ç§» $(p,q)$ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å°è¯•å‘è‡ªåŠ¨æœºå†…æ·»åŠ ä¸€ä¸ª <strong>å·²ç»å­˜åœ¨çš„</strong> å­—ç¬¦ä¸² $x+c$ï¼ˆå…¶ä¸­ $x$ ä¸º $s$ çš„ä¸€ä¸ªåç¼€ï¼Œä¸”å­—ç¬¦ä¸² $x+c$ å·²ç»ä½œä¸º $s$ çš„ä¸€ä¸ªå­ä¸²å‡ºç°è¿‡äº†ï¼‰ã€‚å› ä¸ºæˆ‘ä»¬å‡è®¾å­—ç¬¦ä¸² $s$ çš„è‡ªåŠ¨æœºçš„æ„é€ æ˜¯æ­£ç¡®çš„ï¼Œæˆ‘ä»¬ä¸åº”è¯¥åœ¨è¿™é‡Œæ·»åŠ ä¸€ä¸ªæ–°çš„è½¬ç§»ã€‚ç„¶è€Œï¼Œéš¾ç‚¹åœ¨äºï¼Œä»çŠ¶æ€<code>cur</code>å‡ºå‘çš„åç¼€é“¾æ¥åº”è¯¥è¿æ¥åˆ°å“ªä¸ªçŠ¶æ€å‘¢ï¼Ÿæˆ‘ä»¬è¦æŠŠåç¼€é“¾æ¥è¿åˆ°ä¸€ä¸ªçŠ¶æ€ä¸Šï¼Œä¸”å…¶ä¸­æœ€é•¿çš„ä¸€ä¸ªå­—ç¬¦ä¸²æ°å¥½æ˜¯ $x+c$ï¼Œå³è¿™ä¸ªçŠ¶æ€çš„<code>len</code>åº”è¯¥æ˜¯<code>len[p] + 1</code>ã€‚ç„¶è€Œè¿˜ä¸å­˜åœ¨è¿™æ ·çš„çŠ¶æ€ï¼Œå³<code>len[q] &gt; len[p] + 1</code>ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¿…é¡»é€šè¿‡æ‹†å¼€çŠ¶æ€<code>q</code>æ¥åˆ›å»ºä¸€ä¸ªè¿™æ ·çš„çŠ¶æ€ã€‚</li>
<li>å¦‚æœè½¬ç§» $(p,q)$ æ˜¯è¿ç»­çš„ï¼Œé‚£ä¹ˆ<code>len[q] = len[p] + 1</code>ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ä¸€åˆ‡éƒ½å¾ˆç®€å•ã€‚æˆ‘ä»¬åªéœ€è¦å°†<code>cur</code>çš„åç¼€é“¾æ¥æŒ‡å‘çŠ¶æ€<code>q</code>ã€‚</li>
<li>å¦åˆ™è½¬ç§»æ˜¯ä¸è¿ç»­çš„ï¼Œå³<code>len[q] &gt; len[p] + 1</code>ï¼Œè¿™æ„å‘³ç€çŠ¶æ€<code>q</code> ä¸åªå¯¹åº”äºé•¿åº¦ä¸º<code>len[p] + 1</code>çš„åç¼€ $s+c$ï¼Œè¿˜å¯¹åº”äº $s$ çš„æ›´é•¿çš„å­ä¸²ã€‚é™¤äº†å°†çŠ¶æ€<code>q</code>æ‹†æˆä¸¤ä¸ªå­çŠ¶æ€ä»¥å¤–æˆ‘ä»¬åˆ«æ— ä»–æ³•ï¼Œæ‰€ä»¥ç¬¬ä¸€ä¸ªå­çŠ¶æ€çš„é•¿åº¦å°±æ˜¯<code>len[p] + 1</code>äº†ã€‚<br>æˆ‘ä»¬å¦‚ä½•æ‹†å¼€ä¸€ä¸ªçŠ¶æ€å‘¢ï¼Ÿæˆ‘ä»¬ <strong>å¤åˆ¶</strong> çŠ¶æ€<code>q</code>ï¼Œäº§ç”Ÿä¸€ä¸ªçŠ¶æ€<code>nq</code>ï¼Œæˆ‘ä»¬å°†<code>len[nq]</code> èµ‹å€¼ä¸º<code>len[p] + 1</code>ã€‚ç”±äºæˆ‘ä»¬ä¸æƒ³æ”¹å˜éå†åˆ°<code>q</code>çš„è·¯å¾„ï¼Œæˆ‘ä»¬å°†<code>q</code>çš„æ‰€æœ‰è½¬ç§»å¤åˆ¶åˆ°<code>nq</code>ã€‚æˆ‘ä»¬ä¹Ÿå°†ä»<code>nq</code>å‡ºå‘çš„åç¼€é“¾æ¥è®¾ç½®ä¸º<code>q</code>çš„åç¼€é“¾æ¥çš„ç›®æ ‡ï¼Œå¹¶è®¾ç½®<code>q</code>çš„åç¼€é“¾æ¥ä¸º<code>nq</code>ã€‚<br>åœ¨æ‹†å¼€çŠ¶æ€åï¼Œæˆ‘ä»¬å°†ä»<code>cur</code>å‡ºå‘çš„åç¼€é“¾æ¥è®¾ç½®ä¸º<code>nq</code>$ã€‚<br>æœ€åä¸€æ­¥æˆ‘ä»¬å°†ä¸€äº›åˆ°<code>q</code>è½¬ç§»é‡å®šå‘åˆ°<code>nq</code>ã€‚æˆ‘ä»¬éœ€è¦ä¿®æ”¹å“ªäº›è½¬ç§»å‘¢ï¼Ÿåªé‡å®šå‘ç›¸å½“äºæ‰€æœ‰å­—ç¬¦ä¸² $w+c$ï¼ˆå…¶ä¸­ $w$ æ˜¯<code>p</code>çš„æœ€é•¿å­—ç¬¦ä¸²ï¼‰çš„åç¼€å°±å¤Ÿäº†ã€‚å³ï¼Œæˆ‘ä»¬éœ€è¦ç»§ç»­æ²¿ç€åç¼€é“¾æ¥éå†ï¼Œä»ç»“ç‚¹<code>p</code>ç›´åˆ°è™šæ‹ŸçŠ¶æ€ $-1$ æˆ–è€…æ˜¯è½¬ç§»åˆ°ä¸æ˜¯çŠ¶æ€<code>q</code>çš„ä¸€ä¸ªè½¬ç§»ã€‚</li>
</ul>

</details>

<details class="note info"><summary><p>æ“ä½œæ¬¡æ•°çº¿æ€§è¯æ˜</p>
</summary>
<p>é¦–å…ˆæˆ‘ä»¬å‡è®¾å­—ç¬¦é›†å¤§å°ä¸º <strong>å¸¸æ•°</strong>ã€‚å¦‚æœå­—ç¬¦é›†å¤§å°ä¸æ˜¯å¸¸æ•°ï¼ŒSAM çš„æ—¶é—´å¤æ‚åº¦å°±ä¸æ˜¯çº¿æ€§çš„ã€‚ä»ä¸€ä¸ªç»“ç‚¹å‡ºå‘çš„è½¬ç§»å­˜å‚¨åœ¨æ”¯æŒå¿«é€ŸæŸ¥è¯¢å’Œæ’å…¥çš„å¹³è¡¡æ ‘ä¸­ã€‚å› æ­¤å¦‚æœæˆ‘ä»¬è®° $\Sigma$ ä¸ºå­—ç¬¦é›†ï¼Œ$\left|\Sigma\right|$ ä¸ºå­—ç¬¦é›†å¤§å°ï¼Œåˆ™ç®—æ³•çš„æ¸è¿›æ—¶é—´å¤æ‚åº¦ä¸º $O(n\log\left|\Sigma\right|)$ï¼Œç©ºé—´å¤æ‚åº¦ä¸º $O(n)$ã€‚ç„¶è€Œå¦‚æœå­—ç¬¦é›†è¶³å¤Ÿå°ï¼Œå¯ä»¥ä¸å†™å¹³è¡¡æ ‘ï¼Œä»¥ç©ºé—´æ¢æ—¶é—´å°†æ¯ä¸ªç»“ç‚¹çš„è½¬ç§»å­˜å‚¨ä¸ºé•¿åº¦ä¸º $\left|\Sigma\right|$ çš„æ•°ç»„ï¼ˆç”¨äºå¿«é€ŸæŸ¥è¯¢ï¼‰å’Œé“¾è¡¨ï¼ˆç”¨äºå¿«é€Ÿéå†æ‰€æœ‰å¯ç”¨å…³é”®å­—ï¼‰ã€‚è¿™æ ·ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º $O(n)$ï¼Œç©ºé—´å¤æ‚åº¦ä¸º $O(n\left|\Sigma\right|)$ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬å°†è®¤ä¸ºå­—ç¬¦é›†çš„å¤§å°ä¸ºå¸¸æ•°ï¼Œå³æ¯æ¬¡å¯¹ä¸€ä¸ªå­—ç¬¦æœç´¢è½¬ç§»ã€æ·»åŠ è½¬ç§»ã€æŸ¥æ‰¾ä¸‹ä¸€ä¸ªè½¬ç§»ã€‚è¿™äº›æ“ä½œçš„æ—¶é—´å¤æ‚åº¦éƒ½ä¸º $O(1)$ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬è€ƒè™‘ç®—æ³•çš„å„ä¸ªéƒ¨åˆ†ï¼Œç®—æ³•ä¸­æœ‰ä¸‰å¤„æ—¶é—´å¤æ‚åº¦ä¸æ˜æ˜¾æ˜¯çº¿æ€§çš„ï¼š</p>
<ul>
<li>ç¬¬ä¸€å¤„æ˜¯éå†æ‰€æœ‰çŠ¶æ€<code>last</code>çš„åç¼€é“¾æ¥ï¼Œæ·»åŠ å­—ç¬¦ $c$ çš„è½¬ç§»ã€‚</li>
<li>ç¬¬äºŒå¤„æ˜¯å½“çŠ¶æ€<code>q</code>è¢«å¤åˆ¶åˆ°ä¸€ä¸ªæ–°çš„çŠ¶æ€<code>nq</code>æ—¶å¤åˆ¶è½¬ç§»çš„è¿‡ç¨‹ã€‚</li>
<li>ç¬¬ä¸‰å¤„æ˜¯ä¿®æ”¹æŒ‡å‘<code>q</code>çš„è½¬ç§»ï¼Œå°†å®ƒä»¬é‡å®šå‘åˆ°<code>nq</code>çš„è¿‡ç¨‹ã€‚</li>
</ul>
<p>æˆ‘ä»¬ä½¿ç”¨åç¼€è‡ªåŠ¨æœºçš„å¤§å°ï¼ˆçŠ¶æ€æ•°å’Œè½¬ç§»æ•°ï¼‰ä¸º <strong>çº¿æ€§çš„</strong> çš„äº‹å®ï¼ˆå¯¹çŠ¶æ€æ•°æ˜¯çº¿æ€§çš„çš„è¯æ˜å°±æ˜¯ç®—æ³•æœ¬èº«ï¼Œå¯¹è½¬ç§»æ•°ä¸ºçº¿æ€§çš„çš„è¯æ˜å°†åœ¨ç¨åå®ç°ç®—æ³•åç»™å‡ºï¼‰ã€‚</p>
<p>å› æ­¤ä¸Šè¿° <strong>ç¬¬ä¸€å¤„å’Œç¬¬äºŒå¤„</strong> çš„æ€»å¤æ‚åº¦æ˜¾ç„¶ä¸ºçº¿æ€§çš„ï¼Œå› ä¸ºå•æ¬¡æ“ä½œå‡æ‘Šåªä¸ºè‡ªåŠ¨æœºæ·»åŠ äº†ä¸€ä¸ªæ–°è½¬ç§»ã€‚</p>
<p>è¿˜éœ€ä¸º <strong>ç¬¬ä¸‰å¤„</strong> ä¼°è®¡æ€»å¤æ‚åº¦ï¼Œæˆ‘ä»¬å°†æœ€åˆæŒ‡å‘<code>q</code>çš„è½¬ç§»é‡å®šå‘åˆ°<code>nq</code>ã€‚æˆ‘ä»¬è®°<code>v = longest[p]</code>ï¼Œè¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸² $s$ çš„åç¼€ï¼Œæ¯æ¬¡è¿­ä»£é•¿åº¦éƒ½é€’å‡â€”â€”å› ä¸ºå­—ç¬¦ä¸² $s$ çš„ä½ç½®æ¯æ¬¡è¿­ä»£éƒ½å•è°ƒä¸Šå‡ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœåœ¨å¾ªç¯çš„ç¬¬ä¸€æ¬¡è¿­ä»£ä¹‹å‰ï¼Œç›¸å¯¹åº”çš„å­—ç¬¦ä¸² $v$ åœ¨è·ç¦»<code>last</code>çš„æ·±åº¦ä¸º $k$ $(k \ge 2)$ çš„ä½ç½®ä¸Šï¼ˆæ·±åº¦è®°ä¸ºåç¼€é“¾æ¥çš„æ•°é‡ï¼‰ï¼Œé‚£ä¹ˆåœ¨æœ€åä¸€æ¬¡è¿­ä»£åï¼Œå­—ç¬¦ä¸² $v+c$ å°†ä¼šæˆä¸ºè·¯å¾„ä¸Šç¬¬äºŒä¸ªä»<code>cur</code>å‡ºå‘çš„åç¼€é“¾æ¥ï¼ˆå®ƒå°†ä¼šæˆä¸ºæ–°çš„<code>last</code>çš„å€¼ï¼‰ã€‚</p>
<p>å› æ­¤ï¼Œå¾ªç¯ä¸­çš„æ¯æ¬¡è¿­ä»£éƒ½ä¼šä½¿ä½œä¸ºå½“å‰å­—ç¬¦ä¸²çš„åç¼€çš„å­—ç¬¦ä¸²<code>longest[link[link[last]]]</code>çš„ä½ç½®å•è°ƒé€’å¢ã€‚å› æ­¤è¿™ä¸ªå¾ªç¯æœ€å¤šä¸ä¼šæ‰§è¡Œè¶…è¿‡ $n$ æ¬¡è¿­ä»£ï¼Œè¿™æ­£æ˜¯æˆ‘ä»¬éœ€è¦è¯æ˜çš„ã€‚</p>

</details>

<h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><p><span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL3Byb2JsZW0vUDM4MDQ=">æ´›è°·æ¿å­é¢˜<i class="fa fa-external-link-alt"></i></span>ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_WARNINGS</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2000010</span>;</span><br><span class="line"><span class="type">int</span> tot = <span class="number">1</span>, last = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> len, fa;</span><br><span class="line">    <span class="type">int</span> s[<span class="number">26</span>];</span><br><span class="line">&#125;node[N];</span><br><span class="line"><span class="type">char</span> str[N];</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> f[N];</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> ans;</span><br><span class="line"><span class="type">int</span> h[N], e[N], ne[N], idx;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">extend</span><span class="params">(<span class="type">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> p = last, np = last = ++tot;</span><br><span class="line">    f[tot] = <span class="number">1</span>;</span><br><span class="line">    node[np].len = node[p].len + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(; (p) &amp;&amp; (!node[p].s[c]); p = node[p].fa)node[p].s[c] = np;</span><br><span class="line">    <span class="keyword">if</span>(!p)</span><br><span class="line">    &#123;</span><br><span class="line">        node[np].fa = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> q = node[p].s[c];</span><br><span class="line">        <span class="keyword">if</span>(node[q].len == node[p].len + <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            node[np].fa = q;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> nq = ++tot;</span><br><span class="line">            node[nq] = node[q];</span><br><span class="line">            node[nq].len = node[p].len + <span class="number">1</span>;</span><br><span class="line">            node[q].fa = node[np].fa = nq;</span><br><span class="line">            <span class="keyword">for</span>(; (p) &amp;&amp; (node[p].s[c] == q); p = node[p].fa)node[p].s[c] = nq;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[idx] = b, ne[idx] = h[a], h[a] = idx++;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h[u]; ~i; i = ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">dfs</span>(e[i]);</span><br><span class="line">        f[u] += f[e[i]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(f[u] &gt; <span class="number">1</span>)ans = <span class="built_in">max</span>(ans, f[u] * node[u].len);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, str);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; str[i]; i++)<span class="built_in">extend</span>(str[i] - <span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">    <span class="built_in">memset</span>(h, <span class="number">-1</span>, <span class="built_in">sizeof</span>(h));</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt;= tot; i++)<span class="built_in">add</span>(node[i].fa, i);</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h1><h2 id="æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦å‡ºç°"><a href="#æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦å‡ºç°" class="headerlink" title="æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦å‡ºç°"></a>æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦å‡ºç°</h2><blockquote>
<p>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² $S$ å’Œå¤šä¸ªæ¨¡å¼ä¸² $P$ ï¼Œæˆ‘ä»¬éœ€è¦æ£€æŸ¥æ¨¡å¼ä¸² $P$ æ˜¯å¦ä½œä¸º $S$ çš„ä¸€ä¸ªå­ä¸²å‡ºç°è¿‡ã€‚</p>
</blockquote>
<p>æˆ‘ä»¬é¦–å…ˆç»™å­—ç¬¦ä¸² $S$ æ„å»ºåç¼€è‡ªåŠ¨æœºã€‚æ„å»ºå®Œäº†ä¹‹åï¼Œæˆ‘ä»¬ä»åˆå§‹èŠ‚ç‚¹ $t_0$ å¼€å§‹ï¼Œä¸æ–­å‘éå†trieæ ‘ä¸€æ ·éå†åç¼€è‡ªåŠ¨æœºã€‚ç”±äºå­—ç¬¦ä¸² $S$ å†…çš„æ¯ä¸ªå­—ä¸²éƒ½æ˜¯å…¶æŸä¸ªåç¼€çš„å‰ç¼€ï¼Œæ‰€ä»¥æˆ‘ä»¬ä»…ä»åˆå§‹èŠ‚ç‚¹å¼€å§‹éå†å³å¯ã€‚<br>å¦‚æœéå†å®Œæ•´ä¸ªè‡ªåŠ¨æœºéƒ½æ²¡æœ‰å®Œå…¨åŒ¹é…ï¼Œé‚£ä¹ˆå°±è¯´æ˜æ¨¡å¼ä¸²æ²¡æœ‰åœ¨åŸå­—ç¬¦ä¸²é‡Œé¢å‡ºç°è¿‡ï¼Œåä¹‹äº¦ç„¶ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬åœ¨è¿™æ ·å†çš„åŒæ—¶è®°å½•ä¸‹æœ€å¤§åŒ¹é…é•¿åº¦ï¼Œé‚£ä¹ˆè¿˜å¯ä»¥å¾—åˆ°æ¨¡å¼ä¸²åœ¨å­—ç¬¦ä¸²å†…åŒ¹é…çš„æœ€å¤§å‰ç¼€é•¿åº¦ã€‚</p>
<h2 id="æ±‚ä¸åŒå­ä¸²ä¸ªæ•°"><a href="#æ±‚ä¸åŒå­ä¸²ä¸ªæ•°" class="headerlink" title="æ±‚ä¸åŒå­ä¸²ä¸ªæ•°"></a>æ±‚ä¸åŒå­ä¸²ä¸ªæ•°</h2><blockquote>
<p>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² $S$ ï¼Œè®¡ç®—å…¶ä¸åŒå­ä¸²çš„ä¸ªæ•°ã€‚</p>
</blockquote>
<p>å¯¹å…¶æ„é€ åç¼€è‡ªåŠ¨æœºã€‚<br>å­—ç¬¦ä¸² $S$ ä¸­çš„æ¯ä¸€ä¸ªå­ä¸²éƒ½ç›¸å½“äºæ˜¯è‡ªåŠ¨æœºä¸­çš„ä¸€äº›è·¯å¾„ã€‚å› æ­¤ä¸åŒå­—ä¸²çš„ä¸ªæ•°å°±ç­‰äºè‡ªåŠ¨å‡ ç§ä»¥ $t_0$ ä¸ºèµ·ç‚¹çš„ä¸åŒè·¯å¾„çš„æ¡æ•°ã€‚<br>è€ƒè™‘åˆ°åç¼€è‡ªåŠ¨æœºæ˜¯ä¸€ä¸ªæœ‰å‘æ— ç¯å›¾ï¼Œä¸åŒè·¯å¾„çš„æ¡æ•°å¯ä»¥é€šè¿‡åŠ¨æ€è§„åˆ’æ¥è®¡ç®—ã€‚<br>OIwikiä¸Šç»™çš„æ–¹æ³•æ˜¯è¿™æ ·çš„ï¼š</p>
<blockquote>
<p>ä»¤ $d_v$ ä¸ºä»çŠ¶æ€ $v$ å¼€å§‹çš„è·¯å¾„æ•°é‡ï¼ˆåŒ…æ‹¬é•¿åº¦ä¸ºé›¶çš„è·¯å¾„ï¼‰ï¼Œåˆ™æˆ‘ä»¬æœ‰å¦‚ä¸‹é€’æ¨æ–¹ç¨‹ï¼š<br>$$<br>d_v &#x3D; 1 + \sum_{w:(v,w,c)\in DAWG} d_w<br>$$<br>å³ï¼Œ $d_v$ å¯ä»¥è¡¨ç¤ºä¸ºæ‰€æœ‰ $v$ çš„è½¬ç§»çš„æœ«ç«¯çš„å’Œã€‚<br>æ‰€ä»¥ä¸åŒå­—ä¸²çš„ä¸ªæ•°ä¸º $d_{t_0}-1$ ï¼ˆå› ä¸ºéœ€è¦å»æ‰ç©ºå­—ä¸²ï¼‰</p>
</blockquote>
<p>æˆ‘ä¸ªäººæ›´å–œæ¬¢å¦ä¸€ç§æ–¹æ³•ï¼š<br>åˆ©ç”¨åç¼€è‡ªåŠ¨æœºçš„æ ‘å½¢ç»“æ„ï¼Œæ¯ä¸ªèŠ‚ç‚¹å¯¹åº”çš„å­ä¸²æ•°é‡å°±æ˜¯<code>len[i] - len[link[i]]</code>ï¼Œå¯¹è‡ªåŠ¨æœºæ‰€æœ‰èŠ‚ç‚¹æ±‚å’Œå³å¯ã€‚<br>è¿™ä¸ªåœ¨æ´›è°·ä¸Šæœ‰ä¾‹é¢˜ï¼š<span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL3Byb2JsZW0vUDM4MDQ=">Luogu P3804<i class="fa fa-external-link-alt"></i></span></p>
<p>å…¶ä»–çš„åº”ç”¨å¯ä»¥è§<span class="exturl" data-url="aHR0cHM6Ly9vaS13aWtpLm9yZy9zdHJpbmcvc2FtLyNfMTM=">OIwiki<i class="fa fa-external-link-alt"></i></span>ã€‚</p>
]]></content>
      <categories>
        <category>æ•°æ®ç»“æ„</category>
      </categories>
      <tags>
        <tag>æ•°æ®ç»“æ„</tag>
        <tag>å­—ç¬¦ä¸²</tag>
        <tag>è‡ªåŠ¨æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>Trie ä¸ ACè‡ªåŠ¨æœº</title>
    <url>/OI/trie-and-AK-avtomat/</url>
    <content><![CDATA[<p>Trieæ ‘ï¼ˆå­—å…¸æ ‘ï¼‰ä¸ACè‡ªåŠ¨æœºã€‚</p>
<span id="more"></span>

<h1 id="Trie"><a href="#Trie" class="headerlink" title="Trie"></a>Trie</h1><p>Trieæ ‘ï¼Œåˆç§°å­—å…¸æ ‘ï¼Œæ˜¯ä¸€ç§æ•°æ®ç»“æ„ã€‚</p>
<p>Trieæ ‘å¯ä»¥å­˜å‚¨å¤§é‡ä¸åŒçš„å­—ç¬¦ä¸²ï¼ŒåŒæ—¶æ”¯æŒå¯¹å…¶ä»¥ $O(|S|)$ çš„å¤æ‚åº¦è¿›è¡ŒæŸ¥è¯¢ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬å¯ä»¥æ”¾ä¸€å¼ å›¾ä¸Šæ¥ï¼š</p>
<p><img src="https://s2.loli.net/2022/04/06/DjtOJRCaSzxwZAB.png" alt="trie1.png"></p>
<p>è¿™å°±æ˜¯æˆ‘ä»¬å‘Trieä¸­é¡ºåºæ’å…¥äº†aa,aba,ba,bbc,bca,caba,cba,ccå…«ä¸ªå­—ç¬¦ä¸²ä¹‹åçš„ç»“æœã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥å‘ç°ï¼ŒTrieä½¿ç”¨è¾¹æ¥ä»£è¡¨å­—æ¯ï¼Œè€Œç”¨ç‚¹æ¥è¡¨ç¤ºå­—ç¬¦ä¸²ã€‚<br>æŸä¸€ä¸ªç‚¹è¡¨ç¤ºçš„å­—ç¬¦ä¸²å°±æ˜¯ä»æ ¹èŠ‚ç‚¹åˆ°è¯¥èŠ‚ç‚¹çš„è·¯å¾„ä¸Šçš„å­—æ¯é¡ºåºæ’åˆ—ç»„åˆè€Œæˆçš„å­—ç¬¦ä¸²ã€‚<br>æ¯”å¦‚è¯´17å·èŠ‚ç‚¹å°±ä»£è¡¨ç€cbaè¿™ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p>
<p><img src="https://s2.loli.net/2022/04/06/udZE5v41asjfBYh.png" alt="trie2.png"></p>
<p>æ¯ä¸€ä¸ªç‚¹è™½è¯´éƒ½ä»£è¡¨ç€ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä½†æ˜¯è¿™ä¸ªå­—ç¬¦ä¸²ä¸ä¸€å®šè¢«æ’å…¥è¿‡ã€‚æˆ‘ä»¬å°†å®é™…ä¸Šæœ‰çš„å­—ç¬¦ä¸²è¿›è¡Œäº†æ ‡çº¢ã€‚</p>
<h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><h3 id="å­˜å‚¨"><a href="#å­˜å‚¨" class="headerlink" title="å­˜å‚¨"></a>å­˜å‚¨</h3><p>æˆ‘ä»¬å°†æ¯ä¸€ä¸ªèŠ‚ç‚¹å­˜å‚¨åˆ°ä¸€ä¸ªç»“æ„ä½“é‡Œé¢ï¼š</p>
<div class="tabs" id="struct"><ul class="nav-tabs"><li class="tab active"><a href="#struct-1">æ•°ç»„</a></li><li class="tab"><a href="#struct-2">æŒ‡é’ˆ</a></li></ul><div class="tab-content"><div class="tab-pane active" id="struct-1"><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">trie</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> s[<span class="number">26</span>];</span><br><span class="line">    <span class="type">int</span> cnt;</span><br><span class="line">&#125;tr[N];</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="struct-2"><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">trie</span></span><br><span class="line">&#123;</span><br><span class="line">    trie *s[<span class="number">26</span>];</span><br><span class="line">    <span class="type">int</span> cnt;</span><br><span class="line">&#125;tr[N];</span><br></pre></td></tr></table></figure></div></div></div>

<p>è¿™é‡Œ <code>s</code> æ•°ç»„çš„å¤§å°æ˜¯æ ¹æ®å­—ç¬¦é›†çš„å¤§å°æ¥å®šçš„ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æ˜¯å°å†™å­—æ¯é›†ï¼Œæ‰€ä»¥è¿™é‡Œå¡«çš„æ˜¯26ã€‚</p>
<h3 id="æ’å…¥"><a href="#æ’å…¥" class="headerlink" title="æ’å…¥"></a>æ’å…¥</h3><p>å…·ä½“æ€æƒ³å°±æ˜¯ï¼Œå¦‚æœå½“å‰èŠ‚ç‚¹çš„ä¸‹ä¸€ä½æ‰€å¯¹åº”çš„å„¿å­éç©ºå°±è·³åˆ°å¯¹åº”çš„å„¿å­ï¼Œæ˜¯ç©ºçš„é‚£å°±æ–°å»ºä¸€ä¸ªå„¿å­ã€‚</p>
<div class="tabs" id="insert"><ul class="nav-tabs"><li class="tab active"><a href="#insert-1">æ•°ç»„</a></li><li class="tab"><a href="#insert-2">æŒ‡é’ˆ</a></li></ul><div class="tab-content"><div class="tab-pane active" id="insert-1"><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(string s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> u = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">length</span>(); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(tr[u].s[s[i] - <span class="string">&#x27;a&#x27;</span>] != <span class="number">0</span>)u = tr[u].s[s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            tr[u].s[s[i] - <span class="string">&#x27;a&#x27;</span>] = ++idx;</span><br><span class="line">            u = idx;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    tr[u].cnt++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="insert-2"><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(string s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> *u = &amp;tr[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">length</span>(); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(u-&gt;s[s[i] - <span class="string">&#x27;a&#x27;</span>] != <span class="number">0</span>)u = u-&gt;s[s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            u-&gt;s[s[i] - <span class="string">&#x27;a&#x27;</span>] = &amp;tr[++idx];</span><br><span class="line">            u = u-&gt;s[s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    u-&gt;cnt++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div></div>

<h3 id="åˆ é™¤"><a href="#åˆ é™¤" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h3><p>åˆ é™¤è¿™ä¸ªæ“ä½œä½¿ç”¨çš„èŒƒå›´ä¸æ˜¯å¾ˆå¹¿ã€‚å…·ä½“æ€æƒ³å°±æ˜¯å°†å¯¹åº”æˆ‘ä»¬æƒ³è¦åˆ é™¤çš„å­—ç¬¦ä¸²çš„ç‚¹çš„<code>cnt</code>å€¼å‡å»1å³å¯ã€‚</p>
<div class="tabs" id="loeschen"><ul class="nav-tabs"><li class="tab active"><a href="#loeschen-1">æ•°ç»„</a></li><li class="tab"><a href="#loeschen-2">æŒ‡é’ˆ</a></li></ul><div class="tab-content"><div class="tab-pane active" id="loeschen-1"><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">loeschen</span><span class="params">(string s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> u = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">length</span>(); i++)</span><br><span class="line">        u = tr[u].s[s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">    tr[u].cnt--;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="loeschen-2"><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">loeschen</span><span class="params">(string s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> *u = &amp;tr[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">length</span>(); i++)</span><br><span class="line">        u = u-&gt;s[s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">    u-&gt;cnt--;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div></div>

<h3 id="æŸ¥è¯¢"><a href="#æŸ¥è¯¢" class="headerlink" title="æŸ¥è¯¢"></a>æŸ¥è¯¢</h3><p>æŸ¥è¯¢æ“ä½œçš„æ€æƒ³å°±æ˜¯ï¼Œä¸æ–­ä»æ ¹èŠ‚ç‚¹æ²¿ç€å­—ç¬¦ä¸²è·³ï¼Œç›´åˆ°è°ƒåˆ°ç©ºèŠ‚ç‚¹æˆ–è€…è·³å®Œæ•´ä¸ªå­—ç¬¦ä¸²ä¸ºæ­¢ã€‚</p>
<div class="tabs" id="chq"><ul class="nav-tabs"><li class="tab active"><a href="#chq-1">æ•°ç»„</a></li><li class="tab"><a href="#chq-2">æŒ‡é’ˆ</a></li></ul><div class="tab-content"><div class="tab-pane active" id="chq-1"><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">chq</span><span class="params">(string s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> u = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">length</span>(); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(tr[u].s[s[i] - <span class="string">&#x27;a&#x27;</span>] != <span class="number">0</span>)u = tr[u].s[s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> tr[u].cnt &gt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="chq-2"><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">chq</span><span class="params">(string s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> *u = &amp;tr[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">length</span>(); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(u-&gt;s[s[i] - <span class="string">&#x27;a&#x27;</span>] != <span class="number">0</span>)u = u-&gt;s[s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> u-&gt;cnt &gt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div></div>

<h3 id="å…¨éƒ¨åŠ èµ·æ¥"><a href="#å…¨éƒ¨åŠ èµ·æ¥" class="headerlink" title="å…¨éƒ¨åŠ èµ·æ¥"></a>å…¨éƒ¨åŠ èµ·æ¥</h3><div class="tabs" id="all"><ul class="nav-tabs"><li class="tab active"><a href="#all-1">æ•°ç»„</a></li><li class="tab"><a href="#all-2">æŒ‡é’ˆ</a></li><li class="tab"><a href="#all-3">æ•°ç»„ï¼ˆå°è£…ï¼‰</a></li><li class="tab"><a href="#all-4">æŒ‡é’ˆï¼ˆå°è£…ï¼‰</a></li></ul><div class="tab-content"><div class="tab-pane active" id="all-1"><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">trie</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> s[<span class="number">26</span>];</span><br><span class="line">    <span class="type">int</span> cnt;</span><br><span class="line">&#125;tr[N];</span><br><span class="line"><span class="type">int</span> idx = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(string s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> u = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">length</span>(); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(tr[u].s[s[i] - <span class="string">&#x27;a&#x27;</span>] != <span class="number">0</span>)u = tr[u].s[s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            tr[u].s[s[i] - <span class="string">&#x27;a&#x27;</span>] = ++idx;</span><br><span class="line">            u = idx;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    tr[u].cnt++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">loeschen</span><span class="params">(string s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> u = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">length</span>(); i++)</span><br><span class="line">        u = tr[u].s[s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">    tr[u].cnt--;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">chq</span><span class="params">(string s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> u = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">length</span>(); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(tr[u].s[s[i] - <span class="string">&#x27;a&#x27;</span>] != <span class="number">0</span>)u = tr[u].s[s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> tr[u].cnt &gt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="all-2"><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">trie</span></span><br><span class="line">&#123;</span><br><span class="line">    trie *s[<span class="number">26</span>];</span><br><span class="line">    <span class="type">int</span> cnt;</span><br><span class="line">&#125;tr[N];</span><br><span class="line"><span class="type">int</span> idx = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(string s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> *u = &amp;tr[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">length</span>(); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(u-&gt;s[s[i] - <span class="string">&#x27;a&#x27;</span>] != <span class="number">0</span>)u = u-&gt;s[s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            u-&gt;s[s[i] - <span class="string">&#x27;a&#x27;</span>] = &amp;tr[++idx];</span><br><span class="line">            u = u-&gt;s[s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    u-&gt;cnt++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">loeschen</span><span class="params">(string s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> *u = &amp;tr[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">length</span>(); i++)</span><br><span class="line">        u = u-&gt;s[s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">    u-&gt;cnt--;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">chq</span><span class="params">(string s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> *u = &amp;tr[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">length</span>(); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(u-&gt;s[s[i] - <span class="string">&#x27;a&#x27;</span>] != <span class="number">0</span>)u = u-&gt;s[s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> u-&gt;cnt &gt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="all-3"><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">trie</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> s[N][<span class="number">26</span>];</span><br><span class="line">    <span class="type">int</span> cnt[N];</span><br><span class="line">    </span><br><span class="line">    <span class="type">int</span> idx = <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(string str)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="type">int</span> u = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; str.<span class="built_in">length</span>(); i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(s[u][str[i] - <span class="string">&#x27;a&#x27;</span>] != <span class="number">0</span>)u = s[u][str[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                s[u][str[i] - <span class="string">&#x27;a&#x27;</span>] = ++idx;</span><br><span class="line">                u = idx;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        cnt[u]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">loeschen</span><span class="params">(string str)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="type">int</span> u = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; str.<span class="built_in">length</span>(); i++)</span><br><span class="line">            u = s[u][str[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        cnt[u]--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">chq</span><span class="params">(string str)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="type">int</span> u = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; str.<span class="built_in">length</span>(); i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(s[u][str[i] - <span class="string">&#x27;a&#x27;</span>] != <span class="number">0</span>)u = str[u][s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> cnt[u] &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="all-4"><p>ä¸ä¼šå†™ï¼Œå’•äº†~</p></div></div></div>

<h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><p>Luogu P2580ï¼š<span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL3Byb2JsZW0vUDI1ODA=">https://www.luogu.com.cn/problem/P2580<i class="fa fa-external-link-alt"></i></span></p>
<details class="note success"><summary><p>å‚è€ƒä»£ç </p>
</summary>
<div class="tabs" id="p2580"><ul class="nav-tabs"><li class="tab active"><a href="#p2580-1">æ•°ç»„</a></li><li class="tab"><a href="#p2580-2">æ•°ç»„ï¼ˆå°è£…ï¼‰</a></li></ul><div class="tab-content"><div class="tab-pane active" id="p2580-1"><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1000010</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">trie</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> s[<span class="number">26</span>];</span><br><span class="line">    <span class="type">int</span> cnt;</span><br><span class="line">    <span class="type">int</span> vis;</span><br><span class="line">&#125;tr[N];</span><br><span class="line"><span class="type">int</span> idx = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(string s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> u = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">length</span>(); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(tr[u].s[s[i] - <span class="string">&#x27;a&#x27;</span>] != <span class="number">0</span>)u = tr[u].s[s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            tr[u].s[s[i] - <span class="string">&#x27;a&#x27;</span>] = ++idx;</span><br><span class="line">            u = idx;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    tr[u].cnt++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">chq</span><span class="params">(string s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> u = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">length</span>(); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(tr[u].s[s[i] - <span class="string">&#x27;a&#x27;</span>] != <span class="number">0</span>)u = tr[u].s[s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;WRONG&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(tr[u].cnt &lt; <span class="number">1</span>)<span class="built_in">puts</span>(<span class="string">&quot;WRONG&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(tr[u].vis == tr[u].cnt)<span class="built_in">puts</span>(<span class="string">&quot;REPEAT&quot;</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;OK&quot;</span>);</span><br><span class="line">            tr[u].vis++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> n, m;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        string s;</span><br><span class="line">        cin &gt;&gt; s;</span><br><span class="line">        <span class="built_in">insert</span>(s);</span><br><span class="line">    &#125;</span><br><span class="line">    cin &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        string s;</span><br><span class="line">        cin &gt;&gt; s;</span><br><span class="line">        <span class="built_in">chq</span>(s);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="p2580-2"><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1000010</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">trie</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> s[N][<span class="number">26</span>];</span><br><span class="line">    <span class="type">int</span> cnt[N];</span><br><span class="line">    <span class="type">int</span> vis[N];</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> idx = <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(string str)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="type">int</span> u = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; str.<span class="built_in">length</span>(); i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(s[u][str[i] - <span class="string">&#x27;a&#x27;</span>] != <span class="number">0</span>)u = s[u][str[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                s[u][str[i] - <span class="string">&#x27;a&#x27;</span>] = ++idx;</span><br><span class="line">                u = idx;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        cnt[u]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">chq</span><span class="params">(string str)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="type">int</span> u = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; str.<span class="built_in">length</span>(); i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(s[u][str[i] - <span class="string">&#x27;a&#x27;</span>] != <span class="number">0</span>)u = s[u][str[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">puts</span>(<span class="string">&quot;WRONG&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(cnt[u] &lt; <span class="number">1</span>)<span class="built_in">puts</span>(<span class="string">&quot;WRONG&quot;</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(vis[u] == cnt[u])<span class="built_in">puts</span>(<span class="string">&quot;REPEAT&quot;</span>);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">puts</span>(<span class="string">&quot;OK&quot;</span>);</span><br><span class="line">                vis[u]++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;tr;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> n, m;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        string s;</span><br><span class="line">        cin &gt;&gt; s;</span><br><span class="line">        tr.<span class="built_in">insert</span>(s);</span><br><span class="line">    &#125;</span><br><span class="line">    cin &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        string s;</span><br><span class="line">        cin &gt;&gt; s;</span><br><span class="line">        tr.<span class="built_in">chq</span>(s);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div></div>
</details>

<h2 id="01-Trie"><a href="#01-Trie" class="headerlink" title="01-Trie"></a>01-Trie</h2><p>01-Trieæ˜¯Trieçš„ä¸€ç§å˜ä½“ã€‚å…¶å­—ç¬¦é›†ä¸æ˜¯ä¸€èˆ¬è§åˆ°çš„Trieçš„å°å†™å­—ç¬¦é›†ï¼Œè€Œæ˜¯ $\lbrace 0,1 \rbrace$ã€‚</p>
<p>ç”±äº01-Trieçš„å­—ç¬¦é›†ä»…é™äº0å’Œ1ï¼Œæ‰€ä»¥å®ƒè¢«äººä»¬ç”¨æ¥å¤„ç†ä¸€äº›ä¸ä½è¿ç®—æœ‰å…³çš„ä¸œè¥¿ï¼Œæ¯”å¦‚è¯´å¼‚æˆ–å’Œæˆ–è€…é›†åˆå†…æ•°å­—ä¸¤ä¸¤å¼‚æˆ–çš„æå€¼ä»€ä¹ˆçš„ã€‚</p>
<h3 id="å¼‚æˆ–æå€¼"><a href="#å¼‚æˆ–æå€¼" class="headerlink" title="å¼‚æˆ–æå€¼"></a>å¼‚æˆ–æå€¼</h3><p>æˆ‘ä»¬å‡å®šæˆ‘ä»¬éœ€è¦ç»´æŠ¤è¿™æ ·ä¸€ä¸ªæ“ä½œï¼š<br>ç»™å‡ºä¸€ä¸ªé›†åˆ $A$ï¼Œå†ç»™å‡ºä¸€ä¸ªæ•° $k$ï¼Œæˆ‘ä»¬éœ€è¦åœ¨é›†åˆå†…æ‰¾åˆ°ä¸€ä¸ªæ•° $a_i$ï¼Œä½¿ä¹‹ä¸ $k$ çš„å¼‚æˆ–å€¼æœ€å¤§ï¼ˆæˆ–æœ€å°ï¼‰ã€‚</p>
<p>å› ä¸ºå¼‚æˆ–æ“ä½œå°±æ˜¯å°†ä¸¤ä¸ªæ•°æŒ‰ç…§äºŒè¿›åˆ¶é€ä½è¿›è¡Œæ¯”å¯¹ï¼Œç›¸åŒä¸º0ï¼Œä¸åŒä¸º1ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥å°†ä¸Šæ–‡æåˆ°çš„é‚£ä¸ªé›†åˆ $A$ å†…çš„æ‰€æœ‰æ•°æ ¹æ®äºŒè¿›åˆ¶ä½åˆ†è§£ä¹‹åå†æ’å…¥Trieä¸­ã€‚</p>
<p>ç„¶åæˆ‘ä»¬å°±åƒæŸ¥æ‰¾å­—ç¬¦ä¸²ä¸€æ ·ï¼Œå°† $k$ è¿›è¡ŒäºŒè¿›åˆ¶åˆ†è§£åå¾—åˆ°çš„01ä¸²æ”¾è¿›å»åŒ¹é…ã€‚<br>å¦‚æœæˆ‘ä»¬éœ€è¦çš„æ˜¯å¼‚æˆ–æœ€å°å€¼çš„è¯ï¼Œå°±æŒ‰ç…§æ­£å¸¸æŸ¥æ‰¾å­—ç¬¦ä¸²çš„æ–¹å¼è·³ã€‚<br>å¦‚æœæˆ‘ä»¬éœ€è¦çš„æ˜¯å¼‚æˆ–æœ€å¤§å€¼çš„è¯ï¼Œå°±è®©æ¯ä¸€æ¬¡è·³å„¿å­çš„æ—¶å€™è·³åˆ°ä¸å½“å‰ä½ç½®ä¸åŒçš„å„¿å­ã€‚</p>
<p>æˆ‘ä»¬è¿˜éœ€è¦æ³¨æ„ä¸€ç‚¹ï¼Œå°±æ˜¯æˆ‘ä»¬éœ€è¦ä¿è¯è¿™æ£µTrieçš„æ·±åº¦ä¸æ•°æ®èŒƒå›´çš„æœ€å¤§äºŒè¿›åˆ¶ä½æ•°ä¸€è‡´ã€‚</p>
<p>ç”±äºæˆ‘ä»¬æ˜¯ä»é«˜ä½åˆ°ä½ä½å»ºçš„ï¼Œè€Œé«˜ä½è¿œæ¯”ä½ä½é‡è¦ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥å¤§èƒ†è´ªå¿ƒï¼Œèƒ½è·³å°±è·³ï¼Œä¸èƒ½è·³å°±è·³åˆ°ç›¸åçš„é‚£ä¸ªå„¿å­ä¸Šã€‚è€Œä¸”æˆ‘ä»¬ä¿è¯äº†Trieçš„é«˜åº¦æ˜¯ä¸€å®šçš„ï¼Œè¿™å°±ä¿è¯äº†æˆ‘ä»¬ä¸€å®šå¯ä»¥è·³åˆ°åº•ã€‚</p>
<details class="note info"><summary><p>ä¾‹é¢˜</p>
</summary>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL3Byb2JsZW0vUDQ1NTE=">Luogu P4551 æœ€é•¿å¼‚æˆ–è·¯å¾„<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">100010</span>, M = N &lt;&lt; <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">TrieTree</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> s[<span class="number">2</span>];</span><br><span class="line">    <span class="type">int</span> occ;</span><br><span class="line">&#125;tr[N * <span class="number">32</span>];</span><br><span class="line"><span class="type">int</span> tot = <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> w[M], h[N], e[M], ne[M], idx;</span><br><span class="line"><span class="type">int</span> dis[N];</span><br><span class="line"><span class="type">int</span> ans;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[idx] = b;</span><br><span class="line">    w[idx] = v;</span><br><span class="line">    ne[idx] = h[a];</span><br><span class="line">    h[a] = idx++;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">30</span>, p = <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> c = ((x &gt;&gt; i) &amp; <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span>(!tr[p].s[c])tr[p].s[c] = ++tot;</span><br><span class="line">        p = tr[p].s[c];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">30</span>, p = <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> c = ((x &gt;&gt; i) &amp; <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span>(tr[p].s[c ^ <span class="number">1</span>])</span><br><span class="line">        &#123;</span><br><span class="line">            p = tr[p].s[c ^ <span class="number">1</span>];</span><br><span class="line">            res |= (<span class="number">1</span> &lt;&lt; i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            p = tr[p].s[c];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ans = <span class="built_in">max</span>(ans, res);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">insert</span>(dis[p]);</span><br><span class="line">    <span class="built_in">get</span>(dis[p]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h[p]; ~i; i = ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> v = e[i];</span><br><span class="line">        <span class="keyword">if</span>(v == fa)<span class="keyword">continue</span>;</span><br><span class="line">        dis[v] = dis[p] ^ w[i];</span><br><span class="line">        <span class="built_in">dfs</span>(v, p);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="built_in">memset</span>(h, <span class="number">-1</span>, <span class="built_in">sizeof</span>(h));</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> a, b, v;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;v);</span><br><span class="line">        <span class="built_in">add</span>(a, b, v);</span><br><span class="line">        <span class="built_in">add</span>(b, a, v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</details>

<h2 id="å¯æŒä¹…åŒ–Trie"><a href="#å¯æŒä¹…åŒ–Trie" class="headerlink" title="å¯æŒä¹…åŒ–Trie"></a>å¯æŒä¹…åŒ–Trie</h2><p>æœ‰çš„æ—¶å€™é¢˜ç›®è¦æ±‚æˆ‘ä»¬èƒ½å¤Ÿéšæ—¶è®¿é—®æŸä¸ªå†å²ç‰ˆæœ¬ï¼Œæˆ–ç”šè‡³å›æº¯åˆ°æŸä¸ªå†å²ç‰ˆæœ¬å¹¶å¯¹å…¶è¿›è¡Œä¿®æ”¹ã€‚</p>
<p>æš´åŠ›çš„åšæ³•æ˜¯æ¯ä¸€æ¬¡éƒ½å¼€ä¸€ä¸ªæ–°çš„Trieã€‚</p>
<p>è¿™æ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†TrieæŒä¹…åŒ–ä»¥å®Œæˆè¿™äº›é¢˜ç›®çš„è¦æ±‚ã€‚</p>
<p>ä¹‹å‰æˆ‘ä»¬æ¯ä¸€æ¬¡æ’å…¥çš„æ—¶å€™éƒ½æ˜¯ä»æ ¹èŠ‚ç‚¹å¼€å§‹çš„ï¼Œæ·»åŠ çš„å­—ç¬¦ä¸²ä¹Ÿæ˜¯ä¸€æ¡ä»æ ¹èŠ‚ç‚¹å¼€å§‹çš„è·¯å¾„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¯ä¸€æ¬¡æ’å…¥åªéœ€è¦å¢åŠ æ–°çš„ä¸€æ•´æ¡è·¯å¾„ï¼Œå¹¶æŠŠè¿™æ¡è·¯å¾„ä¸ä¸Šä¸€ä¸ªç‰ˆæœ¬ä¸­æœªè¢«æ›´æ–°çš„éƒ¨åˆ†è¿æ¥ä¸Šå³å¯ã€‚</p>
<details class="note info"><summary><p>ä¾‹é¢˜</p>
</summary>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuYWN3aW5nLmNvbS9wcm9ibGVtL2NvbnRlbnQvMjU4Lw==">https://www.acwing.com/problem/content/258/<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">600010</span>, M = N * <span class="number">25</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">trie</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> s[<span class="number">2</span>];</span><br><span class="line">    <span class="type">int</span> maxid;</span><br><span class="line">&#125;tr[M];</span><br><span class="line"><span class="type">int</span> idx;</span><br><span class="line"><span class="type">int</span> root[N];</span><br><span class="line"><span class="type">int</span> a[N];</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> k, <span class="type">int</span> p, <span class="type">int</span> q)</span></span>;</span><br><span class="line"><span class="comment">//i=index,k=length,p=previous ver.,q=present ver.;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> root, <span class="type">int</span> c, <span class="type">int</span> lim)</span></span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="built_in">init</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> x;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">        a[i] = a[i - <span class="number">1</span>] ^ x;</span><br><span class="line">        root[i] = ++idx;</span><br><span class="line">        <span class="built_in">insert</span>(i, <span class="number">23</span>, root[i - <span class="number">1</span>], root[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">char</span> op[<span class="number">2</span>];</span><br><span class="line">    <span class="type">int</span> x, l, r;</span><br><span class="line">    <span class="keyword">while</span>(m--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, op);</span><br><span class="line">        <span class="keyword">if</span>(*op == <span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">            n++;</span><br><span class="line">            a[n] = a[n - <span class="number">1</span>] ^ x;</span><br><span class="line">            root[n] = ++idx;</span><br><span class="line">            <span class="built_in">insert</span>(n, <span class="number">23</span>, root[n - <span class="number">1</span>], root[n]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(*op == <span class="string">&#x27;Q&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;l, &amp;r, &amp;x);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">query</span>(root[r - <span class="number">1</span>], a[n] ^ x, l - <span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;Youwike AK IOI!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tr[<span class="number">0</span>].maxid = <span class="number">-1</span>;</span><br><span class="line">    root[<span class="number">0</span>] = ++idx;</span><br><span class="line">    <span class="built_in">insert</span>(<span class="number">0</span>, <span class="number">23</span>, <span class="number">0</span>, root[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> k, <span class="type">int</span> p, <span class="type">int</span> q)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(k &lt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        tr[q].maxid = i;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> v = a[i] &gt;&gt; k &amp; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(p)tr[q].s[v ^ <span class="number">1</span>] = tr[p].s[v ^ <span class="number">1</span>];</span><br><span class="line">    tr[q].s[v] = ++idx;</span><br><span class="line">    <span class="built_in">insert</span>(i, k - <span class="number">1</span>, tr[p].s[v], tr[q].s[v]);</span><br><span class="line">    tr[q].maxid = <span class="built_in">max</span>(tr[tr[q].s[<span class="number">0</span>]].maxid, tr[tr[q].s[<span class="number">1</span>]].maxid);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> root, <span class="type">int</span> c, <span class="type">int</span> lim)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> p = root;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">23</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> v = c &gt;&gt; i &amp; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(tr[tr[p].s[v ^ <span class="number">1</span>]].maxid &gt;= lim) p = tr[p].s[v ^ <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">else</span> p = tr[p].s[v];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> c ^ a[tr[p].maxid];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</details>

<h1 id="ACè‡ªåŠ¨æœº"><a href="#ACè‡ªåŠ¨æœº" class="headerlink" title="ACè‡ªåŠ¨æœº"></a>ACè‡ªåŠ¨æœº</h1><p>è¿™ä¸ªACè‡ªåŠ¨æœºå•Šï¼Œä»–æ˜¯ Aho-Corasick Automatonï¼Œä¸æ˜¯ä»€ä¹ˆAutomationã€‚</p>
<p>ï¼ˆåšå®¢çš„æ ‡é¢˜æ¥è‡ªäºä¿„è¯­ ĞÑ…Ğ¾-ĞšĞ¾Ñ€Ğ°ÑĞ¸Ğº Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚ -&gt; Aho-Korasik avtomatï¼‰</p>
<p>ACè‡ªåŠ¨æœºå°±åƒæ˜¯Trieå’ŒKMPçš„ç»“åˆã€‚<br>ACè‡ªåŠ¨æœºåŸºäºçš„æ˜¯Trieï¼ŒåŒæ—¶å…¶åŒ¹é…å­—ç¬¦ä¸²æ—¶çš„è¡Œä¸ºä¸KMPæœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ã€‚</p>
<h2 id="æ€æƒ³"><a href="#æ€æƒ³" class="headerlink" title="æ€æƒ³"></a>æ€æƒ³</h2><h3 id="æ”¹é€ -Trie"><a href="#æ”¹é€ -Trie" class="headerlink" title="æ”¹é€  Trie"></a>æ”¹é€  Trie</h3><p>è¿™æ˜¯ä¸€ä¸ªç®€å•çš„Trieç»“æ„ä½“ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">trie</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> s[<span class="number">26</span>];</span><br><span class="line">    <span class="type">int</span> cnt;</span><br><span class="line">&#125;tr[N];</span><br></pre></td></tr></table></figure>

<p>å¯¹äºKMPç®—æ³•ï¼Œæˆ‘ä»¬æ˜¯æ ¹æ®å‰ç¼€å‡½æ•°æ¥å¯¹å­—ç¬¦ä¸²åŒ¹é…è¿›è¡Œä¼˜åŒ–çš„ã€‚<br>è€Œå¯¹äºTrieå‘¢ï¼Ÿ</p>
<h3 id="failæŒ‡é’ˆ"><a href="#failæŒ‡é’ˆ" class="headerlink" title="failæŒ‡é’ˆ"></a>failæŒ‡é’ˆ</h3><p>æˆ‘ä»¬è€ƒè™‘ä½¿ç”¨å‰ç¼€å‡½æ•°çš„åŸå› ï¼š</p>
<blockquote>
<p>æˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ä¸ªå‰ç¼€ï¼Œåœ¨ä¿è¯å…¶ä¸æŸä¸ªåç¼€ç›¸ç­‰çš„å‰æä¸‹ï¼Œä½¿å¾—å½“å‰åŒ¹é…çš„è¿›åº¦æœ€å¤§åœ°ä¿ç•™ä¸‹æ¥ã€‚</p>
</blockquote>
<p>æŠŠåŒæ ·çš„æ€æƒ³æŒªåˆ°Trieæ ‘ä¸Šï¼Œæˆ‘ä»¬éœ€è¦æ‰¾çš„å°±æ˜¯ï¼š</p>
<blockquote>
<p>æˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå…¶ä»£è¡¨çš„å­—ç¬¦ä¸²æ˜¯å½“å‰èŠ‚ç‚¹ä»£è¡¨çš„å­—ç¬¦ä¸²çš„æœ€é•¿åç¼€ã€‚</p>
</blockquote>
<p>äºæ˜¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®è¿™æ ·çš„æƒ…å†µæ¥æ„å»ºfailæŒ‡é’ˆã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼š</p>
<p>å¦‚ä¸‹å›¾ï¼Œæ˜¯ä¾æ¬¡å‘Trieæ ‘ä¸­æ·»åŠ he,his,him,her,hers,they,them,their,theirs,sheçš„ç»“æœï¼š</p>
<p><img src="https://s2.loli.net/2022/04/07/2QdAr9Jchl4tunG.png" alt="AC1-1.png"></p>
<p>ç„¶åæˆ‘ä»¬å¼€å§‹ä¾æ¬¡æ„å»ºfailæŒ‡é’ˆã€‚</p>
<p>æˆ‘ä»¬åˆ©ç”¨BFSæ¥å¸®åŠ©æˆ‘ä»¬æ„å»ºfailæŒ‡é’ˆã€‚</p>
<p>è€ƒè™‘ä¸€ä¸ªå·²ç»æ„å»ºäº†failæŒ‡é’ˆçš„èŠ‚ç‚¹ $u$ï¼Œå…¶å¯¹åº”å­—ç¬¦ $c$ çš„å„¿å­ $s[u][c]$ çš„failæŒ‡é’ˆçš„æ„å»ºéµå¾ªä¸‹åˆ—åŸåˆ™ï¼š</p>
<ol>
<li>å¦‚æœ $s[fail[u]][c]$ å­˜åœ¨ï¼Œåˆ™è®© $s[u][c]$ çš„failæŒ‡é’ˆæŒ‡å‘ $s[fail[u]][c]$ã€‚è¿™æ ·ç›¸å½“äºæ˜¯åœ¨ $u$ å’Œ $fail[u]$ åé¢åŠ ä¸€ä¸ªå­—ç¬¦ $c$ï¼Œåˆ†åˆ«å¯¹åº” $s[u][c]$ å’Œ $s[fail[u]][c]$ã€‚</li>
<li>å¦‚æœ $s[fail[u]][c]$ ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±é€’å½’å¯»æ‰¾ $s[fail[fail[u]]][c]$ï¼Œå¹¶é‡å¤ä¸Šé¢çš„åˆ¤æ–­è¿‡ç¨‹ï¼Œç›´åˆ°è·³åˆ°æ ¹èŠ‚ç‚¹ã€‚</li>
<li>å¦‚æœçœŸçš„ä»€ä¹ˆéƒ½æ²¡æœ‰äº†ï¼Œé‚£å°±è®© $s[u][c]$ çš„failæŒ‡é’ˆæŒ‡å‘æ ¹èŠ‚ç‚¹ã€‚</li>
</ol>
<p>ä¸‹å›¾ä¸­ç”¨ä¸åŒçš„é¢œè‰²æ¥åŒºåˆ†ä¸åŒçŠ¶æ€çš„è¾¹ã€ç‚¹ï¼š</p>
<p>#FF9955 ä»£è¡¨åœ¨é˜Ÿåˆ—ä¸­ï¼Œç­‰å¾…æ„å»ºfailæŒ‡é’ˆçš„ç‚¹ï¼›<br>#FFCC00 ä»£è¡¨æ­£åœ¨æ„å»ºfailæŒ‡é’ˆçš„ç‚¹ï¼›<br>#AAD400 ä»£è¡¨å·²ç»æ„å»ºå®ŒfailæŒ‡é’ˆçš„ç‚¹ï¼›</p>
<p>#FF0000 ä»£è¡¨æ­£åœ¨æ„å»ºçš„failæŒ‡é’ˆï¼›<br>#FFDD55 ä»£è¡¨å·²ç»æ„å»ºå®Œæˆçš„failæŒ‡é’ˆã€‚</p>
<p><img src="/pics/AC2.gif" alt="AC2.gif"></p>
<p>æœ€ç»ˆæ•ˆæœå›¾ï¼š</p>
<p><img src="https://s2.loli.net/2022/04/08/up7tvA28h9R3E5a.png" alt="AC2-38.png"></p>
<p>ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">struct trie</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">    int s[26];</span></span><br><span class="line"><span class="comment">    int cnt;</span></span><br><span class="line"><span class="comment">    int fail;</span></span><br><span class="line"><span class="comment">&#125;tr[N];</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_fail</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    queue&lt;<span class="type">int</span>&gt;q;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++)</span><br><span class="line">        <span class="keyword">if</span>(tr[<span class="number">0</span>].s[i])q.<span class="built_in">push</span>(tr[u].s[i]);</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> u = q.<span class="built_in">front</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(tr[u].s[i])</span><br><span class="line">            &#123;</span><br><span class="line">                tr[tr[u].s[i]].fail = tr[tr[u].fail].s[i];</span><br><span class="line">                q.<span class="built_in">push</span>(tr[u].s[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                tr[u].s[i] = tr[tr[u].fail].s[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šè¿°ä»£ç å¯èƒ½ä¸æˆ‘ä»¬åˆšæ‰çš„å™è¿°æœ‰éƒ¨åˆ†å‡ºå…¥ï¼ŒåŸå› æ˜¯è¿™ä»½ä»£ç åšäº†äº›è®¸ä¼˜åŒ–ã€‚<br>äº‹å®è¯æ˜è¿™äº›ä¼˜åŒ–è™½ç„¶ä¼šä¿®æ”¹Trieçš„ç»“æ„ï¼Œä½¿ä¹‹ç”±æ ‘å˜ä¸ºå›¾ï¼Œä½†æ˜¯å¯¹æˆ‘ä»¬å­˜å‚¨çš„ä¿¡æ¯æ˜¯æœ‰åˆ©æ— å®³çš„ã€‚</p>
<p>æˆ‘ä»¬é¦–å…ˆå°†æ ¹èŠ‚ç‚¹çš„æ‰€æœ‰å„¿å­å…¥é˜Ÿã€‚<br>å¦‚æœæˆ‘ä»¬ç¬¬ä¸€æ­¥å°†æ ¹èŠ‚ç‚¹å…¥é˜Ÿçš„è¯ï¼Œä¼šå¯¼è‡´æ ¹èŠ‚ç‚¹çš„æ‰€æœ‰å­èŠ‚ç‚¹çš„failæŒ‡é’ˆæŒ‡å‘è‡ªå·±ï¼Œè€Œä¸æ˜¯æŒ‡å‘æ ¹èŠ‚ç‚¹ã€‚</p>
<p>ç„¶åæ˜¯éå†åœ¨é˜Ÿåˆ—ä¸­çš„èŠ‚ç‚¹ã€‚<br>å¯¹äºå…¶éç©ºçš„å„¿å­ï¼Œæˆ‘ä»¬ç…§å¸¸æ„å»ºfailæŒ‡é’ˆã€‚ç”±äºå½“å‰èŠ‚ç‚¹çš„failæŒ‡é’ˆå·²ç»æ„å»ºå®Œæ¯•ï¼Œä¸”æ²¿ç€failæŒ‡é’ˆå½¢æˆçš„é€šå¾€æ ¹èŠ‚ç‚¹çš„é“¾ä¸Šçš„æ‰€æœ‰èŠ‚ç‚¹éƒ½å·²ç»æ„å»ºå®Œæ¯•äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥æŒ‡å‘å½“å‰èŠ‚ç‚¹çš„failæŒ‡é’ˆæŒ‡å‘çš„èŠ‚ç‚¹çš„æ‰€å¯¹åº”çš„å„¿å­ã€‚å¦‚æœæœ‰è¿™ä¸ªå„¿å­çš„è¯å°±æŒ‡å‘ä»–ï¼Œå¦‚æœæ²¡æœ‰çš„è¯å°±ç›¸å½“äºæ˜¯æŒ‡å‘æ ¹èŠ‚ç‚¹ã€‚</p>
<p>ç„¶åæˆ‘ä»¬å°†å½“å‰èŠ‚ç‚¹çš„éƒ¨åˆ†ç©ºå„¿å­æŒ‡å‘å½“å‰èŠ‚ç‚¹çš„failæŒ‡é’ˆæŒ‡å‘çš„èŠ‚ç‚¹çš„å¯¹åº”å„¿å­ä¸Šã€‚<br>åŸå› å°±æ˜¯ï¼Œåæ­£ä¹Ÿæ˜¯å¤±é…äº†ï¼Œä¸å…¶èŠ±æ—¶é—´åˆ¤å¤±é…è·³failæŒ‡é’ˆå†è®¿é—®ï¼Œä¸å¦‚ç›´æ¥è®¿é—®æˆ‘ä»¬æƒ³è¦å®ƒåˆ°çš„èŠ‚ç‚¹ã€‚<br>æ‰€ä»¥æˆ‘ä»¬åœ¨åŒ¹é…çš„æ—¶å€™ä¸€ç›´èµ°ï¼ˆç»“æ„ä½“æ„ä¹‰ä¸Šçš„ï¼‰æ ‘è¾¹ï¼Œç›´åˆ°æ•´ä¸ªè·‘å®Œå°±å¯ä»¥äº†ã€‚</p>
<p>ç…§è¿™æ ·å»ºå®ŒfailæŒ‡é’ˆä¹‹åï¼Œæˆ‘ä»¬ä¼šå°†åŸå…ˆçš„Trieæ ‘å˜ä¸ºä¸€å¼ â€œTrieå›¾â€ã€‚</p>
<p>ç”±äºè¾¹å¤ªå¤šå¤ªå¯†ï¼Œæˆ‘å°±ä¸ç”»äº†ã€‚å¯èƒ½ä¼šè¡¥ä¸Šä¸€å¼ CSAcademyçš„å›¾ã€‚<br>ï¼ˆå¤ªç³Šäº†ï¼Œæ„Ÿè§‰ä¼šä¸ä¹…åæ’¤ä¸‹ï¼Œå°±å…ˆå­˜æœ¬åœ°äº†ï¼‰</p>
<p><img src="/pics/AC3.png"></p>
<p>ï¼ˆè¿™æ˜¯åŸæ•°æ®ï¼‰</p>
<p><img src="/pics/AC4.png"></p>
<p>ï¼ˆè¿™æ˜¯å›¾ï¼‰</p>
<h2 id="åŒ¹é…"><a href="#åŒ¹é…" class="headerlink" title="åŒ¹é…"></a>åŒ¹é…</h2><p>åŒ¹é…çš„æ€è·¯æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š</p>
<ol>
<li>æ²¿ç€Trieå›¾çš„è¾¹è·³ï¼Œç›´åˆ°éå†å®Œæ•´ä¸ªå­—ç¬¦ä¸²ä¸ºæ­¢ã€‚<br> ç”±äºæˆ‘ä»¬åœ¨ä¹‹å‰å·²ç»å°†Trieæ ‘æ”¹é€ ä¸ºäº†Trieå›¾ï¼Œä¸”failæŒ‡é’ˆå·²ç»åœ¨æŸç§æ„ä¹‰ä¸Šå¤±å»äº†å…¶ä½œä¸ºå¤±é…æŒ‡é’ˆçš„æ„ä¹‰ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦è·³Trieå›¾å†…çš„è¾¹å³å¯ã€‚</li>
<li>æ¯èµ°åˆ°ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°±æ²¿ç€å½“å‰èŠ‚ç‚¹çš„failæŒ‡é’ˆç´¯åŠ ç­”æ¡ˆã€‚<br> ç”±äºfailè¾¹è·³åˆ°çš„æ˜¯å½“å‰å­—ç¬¦ä¸²åœ¨Trieå†…å­˜åœ¨çš„æœ€é•¿åç¼€ï¼Œä¸”å¦‚æœå½“å‰çš„æ¨¡å¼ä¸²å‡ºç°åœ¨äº†æ–‡æœ¬ä¸²å†…çš„è¯ï¼Œå…¶å­ä¸²ä¹Ÿä¼šå‡ºç°åœ¨æ–‡æœ¬ä¸²å†…ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ²¿ç€failæŒ‡é’ˆä¸€è·¯éå†å½“å‰æ¨¡å¼ä¸²çš„æ‰€æœ‰åç¼€ã€‚</li>
</ol>
<p>è¿™é‡Œæœ‰ä¸€ä»½å¯¹äºå¤šæ¨¡å¼ä¸²åŒ¹é…ï¼Œä¸”å…è®¸æ¨¡å¼ä¸²å¤šæ¬¡è¢«ç»Ÿè®¡çš„ï¼Œç”¨æ¥ç»Ÿè®¡æ‰€æœ‰æ¨¡å¼ä¸²çš„æ€»å‡ºç°æ¬¡æ•°çš„ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(string s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> u = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">length</span>(); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        u = tr[u].s[s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = u; j &gt; <span class="number">0</span>; j = tr[j].fail)</span><br><span class="line">            res += tr[j].cnt;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­<code>res</code>æ˜¯æ‰€æœ‰æ¨¡å¼ä¸²çš„æ€»å‡ºç°æ¬¡æ•°ã€‚</p>
<h2 id="ä¾‹é¢˜-1"><a href="#ä¾‹é¢˜-1" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><details class="note info"><summary><p>æ¿å­1</p>
</summary>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL3Byb2JsZW0vUDM4MDg=">P3808 ã€æ¨¡æ¿ã€‘ AC è‡ªåŠ¨æœºï¼ˆç®€å•ç‰ˆï¼‰<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1000010</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">trie</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> s[<span class="number">26</span>];</span><br><span class="line">    <span class="type">int</span> cnt;</span><br><span class="line">    <span class="type">int</span> fail;</span><br><span class="line">&#125;tr[N];</span><br><span class="line"><span class="type">int</span> idx = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(string s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> u = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">length</span>(); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(tr[u].s[s[i] - <span class="string">&#x27;a&#x27;</span>] != <span class="number">0</span>)u = tr[u].s[s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            tr[u].s[s[i] - <span class="string">&#x27;a&#x27;</span>] = ++idx;</span><br><span class="line">            u = idx;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    tr[u].cnt++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_fail</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    queue&lt;<span class="type">int</span>&gt;q;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++)</span><br><span class="line">        <span class="keyword">if</span>(tr[<span class="number">0</span>].s[i])q.<span class="built_in">push</span>(tr[<span class="number">0</span>].s[i]);</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> u = q.<span class="built_in">front</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(tr[u].s[i])</span><br><span class="line">            &#123;</span><br><span class="line">                tr[tr[u].s[i]].fail = tr[tr[u].fail].s[i];</span><br><span class="line">                q.<span class="built_in">push</span>(tr[u].s[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                tr[u].s[i] = tr[tr[u].fail].s[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(string s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> u = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">length</span>(); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        u = tr[u].s[s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = u; j &gt; <span class="number">0</span> &amp;&amp; tr[j].cnt &gt; <span class="number">0</span>; j = tr[j].fail)</span><br><span class="line">        &#123;</span><br><span class="line">            res += tr[j].cnt;</span><br><span class="line">            tr[j].cnt = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        string s;</span><br><span class="line">        cin &gt;&gt; s;</span><br><span class="line">        <span class="built_in">insert</span>(s);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">get_fail</span>();</span><br><span class="line">    string t;</span><br><span class="line">    cin &gt;&gt; t;</span><br><span class="line">    cout &lt;&lt; <span class="built_in">query</span>(t) &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</details>

<details class="note info"><summary><p>æ¿å­2</p>
</summary>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL3Byb2JsZW0vUDM3OTY=">P3796 ã€æ¨¡æ¿ã€‘ AC è‡ªåŠ¨æœºï¼ˆåŠ å¼ºç‰ˆ)<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">100010</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">trie</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> s[<span class="number">26</span>];</span><br><span class="line">    <span class="type">int</span> cnt;</span><br><span class="line">    <span class="type">int</span> fail;</span><br><span class="line">&#125;tr[N];</span><br><span class="line"><span class="type">int</span> idx = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> vis[N];</span><br><span class="line">vector&lt;string&gt;dic;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(string s, <span class="type">int</span> id)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> u = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">length</span>(); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(tr[u].s[s[i] - <span class="string">&#x27;a&#x27;</span>] != <span class="number">0</span>)u = tr[u].s[s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            tr[u].s[s[i] - <span class="string">&#x27;a&#x27;</span>] = ++idx;</span><br><span class="line">            u = idx;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    tr[u].cnt = id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_fail</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    queue&lt;<span class="type">int</span>&gt;q;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++)</span><br><span class="line">        <span class="keyword">if</span>(tr[<span class="number">0</span>].s[i])q.<span class="built_in">push</span>(tr[<span class="number">0</span>].s[i]);</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> u = q.<span class="built_in">front</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(tr[u].s[i])</span><br><span class="line">            &#123;</span><br><span class="line">                tr[tr[u].s[i]].fail = tr[tr[u].fail].s[i];</span><br><span class="line">                q.<span class="built_in">push</span>(tr[u].s[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                tr[u].s[i] = tr[tr[u].fail].s[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">query</span><span class="params">(string s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> u = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">length</span>(); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        u = tr[u].s[s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = u; j &gt; <span class="number">0</span>; j = tr[j].fail)</span><br><span class="line">            vis[tr[j].cnt]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    dic.<span class="built_in">clear</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt;= idx; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">26</span>; j++)tr[i].s[j] = <span class="number">0</span>;</span><br><span class="line">        tr[i].cnt = <span class="number">0</span>;</span><br><span class="line">        tr[i].fail = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    idx = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="built_in">sizeof</span>(vis));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">while</span>(n)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">init</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            string s;</span><br><span class="line">            cin &gt;&gt; s;</span><br><span class="line">            dic.<span class="built_in">push_back</span>(s);</span><br><span class="line">            <span class="built_in">insert</span>(s, i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">get_fail</span>();</span><br><span class="line">        string t;</span><br><span class="line">        cin &gt;&gt; t;</span><br><span class="line">        <span class="built_in">query</span>(t);</span><br><span class="line">        <span class="type">int</span> maxn = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            maxn = <span class="built_in">max</span>(maxn, vis[i]);</span><br><span class="line">        cout &lt;&lt; maxn &lt;&lt; endl;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            <span class="keyword">if</span>(vis[i] == maxn)</span><br><span class="line">                cout &lt;&lt; dic[i - <span class="number">1</span>] &lt;&lt; endl;</span><br><span class="line">        cin &gt;&gt; n;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</details>



































]]></content>
      <categories>
        <category>æ•°æ®ç»“æ„</category>
      </categories>
      <tags>
        <tag>æ•°æ®ç»“æ„</tag>
        <tag>å­—ç¬¦ä¸²</tag>
        <tag>è‡ªåŠ¨æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>2022å¯’å‡æµ‹è¯•8è§£æ</title>
    <url>/contestrecords/2022-wh-8/</url>
    <content><![CDATA[<p>2022å¹´å¯’å‡ç¬¬8æ¬¡æµ‹è¯•è§£æã€‚</p>
<span id="more"></span>

<h1 id="T1-ã€ŒJOISC-2016-Day-2ã€å¥³è£…å¤§ä½¬"><a href="#T1-ã€ŒJOISC-2016-Day-2ã€å¥³è£…å¤§ä½¬" class="headerlink" title="T1 ã€ŒJOISC 2016 Day 2ã€å¥³è£…å¤§ä½¬"></a>T1 ã€ŒJOISC 2016 Day 2ã€å¥³è£…å¤§ä½¬</h1><p>åŸé¢˜ä¸º JOISC 2016 Day2 T3 ã€Œãƒˆã‚¤ãƒ¬ã€ã€‚</p>
<h2 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h2><details class="note info"><summary><p>é¢˜é¢</p>
</summary>
<h3 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><blockquote>
<p>é¢˜ç›®è¯‘è‡ª JOISC 2016 Day2 T3 ã€Œãƒˆã‚¤ãƒ¬ã€<br>é¢˜é¢é­”æ”¹åŸå› ï¼šåŸé¢˜æ˜¯ç”·é€‰æ‰‹å¤ªå¤šæ‰€ä»¥è¦å€Ÿç”¨å¥³å•æ‰€ è¯‘è€…è¡¨ç¤ºæ— æ³•æ¥å—<br>IOI çš„é˜Ÿæœæœ‰ä¸¤ç§ï¼Œä¸€ç§ç”·è£…ï¼Œä¸€ç§æ˜¯å¥³è£…ã€‚ç„¶è€Œå¾ˆé—æ†¾ï¼Œæ‰€æœ‰å‚èµ›é˜Ÿä¼ä¸­å¹¶æ²¡æœ‰å¥³ç”Ÿï¼Œåªæœ‰å¥³è£…å¤§ä½¬ã€‚ç°åœ¨ IOI è®¾ç½®äº†ä¸¤ä¸ªå‘æ”¾ç‚¹ï¼Œä¸€ä¸ªç‚¹åªå‘æ”¾ç”·è£…ï¼Œå¦ä¸€ä¸ªç‚¹åªå‘æ”¾å¥³è£…ã€‚<br>ç°åœ¨ï¼Œæ‰€æœ‰é˜Ÿä¼æ€»å…± $2N$ ä¸ªå‚èµ›é˜Ÿå‘˜ï¼Œä»–ä»¬æ’æˆä¸€åˆ—æ¥é¢†å–é˜Ÿæœï¼Œé¢†å–é˜Ÿæœçš„è§„åˆ™å¦‚ä¸‹ï¼š</p>
<ol>
<li>å½“å‰é˜Ÿé¦–æ˜¯å¥³è£…å¤§ä½¬ï¼Œå¦‚æœé¢†å–å¥³è£…çš„åœ°æ–¹æ˜¯ç©ºçš„ï¼Œé‚£ä¹ˆä»–å°±ä¼šé¢†å–å¥³è£…ï¼Œå¦åˆ™å¦‚æœé¢†å–ç”·è£…çš„åœ°æ–¹æ˜¯ç©ºçš„ï¼Œä»–ä¼šå»é¢†å–ç”·è£…ï¼›</li>
<li>å½“å‰é˜Ÿé¦–æ˜¯æ­£å¸¸ç”·ç”Ÿï¼Œå¦‚æœé¢†å–ç”·è£…çš„åœ°æ–¹æ˜¯ç©ºçš„ï¼Œé‚£ä¹ˆä»–ä¼šé¢†å–ç”·è£…ï¼Œå¦åˆ™å¦‚æœå¥³è£…ä½ç©ºç€ï¼Œä»–å°±å‘æŒ¥ç»…â™‚å£«ç²¾ç¥ï¼Œç»™èº«åçš„æœ€å‰é¢çš„å¥³è£…å¤§ä½¬è®©ä½ï¼Œè®©ä»–å…ˆé¢†å–å¥³è£…ã€‚<br>å·²çŸ¥ä»»æ„ä¸€ä¸ªäººé¢†å–é˜Ÿæœéƒ½éœ€è¦ä¸€åˆ†é’Ÿçš„æ—¶é—´ï¼Œç°åœ¨ä½ éœ€è¦é‡æ’æ‰€æœ‰äººçš„é¡ºåºï¼Œä½¿ä»–ä»¬åœ¨ $N$ åˆ†é’Ÿå†…é¢†å®Œé˜Ÿæœ ã€‚<br>å®šä¹‰ä¸€ä¸ªäººçš„ Dark å€¼ä¸ºï¼šåœ¨é‡æ’é˜Ÿä¼ä¹‹å‰åœ¨ä»–åé¢ï¼Œä¸”é‡æ’é˜Ÿä¼ä¹‹ååœ¨ä»–å‰é¢çš„äººçš„æ•°é‡ã€‚<br>ä½ ç°åœ¨éœ€è¦æ‰¾å‡ºé‡æ’åæ•´ä¸ªé˜Ÿä¼æœ€å¤§çš„ Dark å€¼è‡³å°‘ä¸ºå¤šå°‘ã€‚</li>
</ol>
</blockquote>
<h3 id="è¾“å…¥æ ¼å¼"><a href="#è¾“å…¥æ ¼å¼" class="headerlink" title="è¾“å…¥æ ¼å¼"></a>è¾“å…¥æ ¼å¼</h3><blockquote>
<p>ç¬¬ä¸€è¡Œä¸ºä¸€ä¸ªæ•° $N$ ï¼Œä¸ºé¢†å®Œé˜Ÿæœçš„æ—¶é™ï¼ŒåŒæ—¶ $2N$ ä»£è¡¨ç€æ€»é¢†é˜Ÿæœäººæ•°ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸æ„å‘³ç€æ­£å¸¸ç”·ç”Ÿå’Œå¥³è£…å¤§ä½¬åˆšå¥½å„å  $N$ ä¸ªï¼›<br>ç¬¬äºŒè¡Œä¸ºä¸€ä¸ªæ•° $M$ï¼ŒæŒ‡é˜Ÿä¼å…±æœ‰ $M$ ç§ï¼›<br>ä¹‹åçš„ $M$ è¡Œï¼Œç¬¬ $i$ è¡ŒåŒ…æ‹¬ä¸€ä¸ªå­—ç¬¦ä¸²å’Œä¸€ä¸ªæ•°å­—ï¼Œæè¿°è¯¥é˜Ÿä¼çš„ç»„æˆï¼Œå…¶ä¸­ <code>M</code> è¡¨ç¤ºæ­£å¸¸ç”·ç”Ÿï¼Œ<code>F</code> è¡¨ç¤ºå¥³è£…å¤§ä½¬ï¼Œä¹‹åçš„ä¸€ä¸ªæ•°å­—ï¼Œè¡¨ç¤ºè¯¥å­—ç¬¦ä¸²è¿ç»­å‡ºç°äº†å‡ æ¬¡ã€‚æ‰€æœ‰å­—ç¬¦ä¸²é•¿åº¦ä¹˜ä¸Šå‡ºç°æ¬¡æ•°çš„å’Œç­‰äº $2N$ã€‚</p>
</blockquote>
<h3 id="è¾“å‡ºæ ¼å¼"><a href="#è¾“å‡ºæ ¼å¼" class="headerlink" title="è¾“å‡ºæ ¼å¼"></a>è¾“å‡ºæ ¼å¼</h3><blockquote>
<p>ä¸€ä¸ªæ•°ï¼Œè¡¨ç¤ºé‡æ’åæœ€å¤§ Dark å€¼çš„æœ€å°å€¼ï¼Œå¦‚æœåœ¨ $N$ åˆ†é’Ÿå†…ä¸èƒ½å®Œæˆé¢†å–é˜Ÿæœçš„ä»»åŠ¡ï¼Œè¾“å‡º $âˆ’1$ã€‚</p>
</blockquote>

</details>

<h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>ï¼ˆè¿™é‡Œçš„è¯´æ³•æ˜¯åŸºäºåŸé¢˜â€œãƒˆã‚¤ãƒ¬â€çš„èƒŒæ™¯â€”â€”æ’¤ç¡•åˆ†é…æ¥è¯´çš„ï¼‰</p>
<p>é¦–å…ˆæˆ‘ä»¬éœ€è¦åˆ¤æ–­å“ªä¸ªåºåˆ—æ˜¯ä¸€ä¸ªå¯è¡Œçš„æ–¹æ¡ˆã€‚</p>
<p>æˆ‘ä»¬è™½ç„¶å¯ä»¥ä»å¤´å¼€å§‹æ¨¡æ‹Ÿï¼Œä½†æ˜¯è¿™æ ·éœ€è¦è€—è´¹çš„æ—¶é—´å®åœ¨æ˜¯å¤ªå¤šäº†ã€‚<br>å› æ­¤ï¼Œæˆ‘ä»¬è€ƒè™‘ä»æœ€åä¸€åˆ†é’Ÿå€’æ¨ã€‚</p>
<p>æ—¢ç„¶æˆ‘ä»¬æœ‰ä¸¤ä¸ªæ’¤ç¡•ï¼Œæ€»å…± $2N$ ä¸ªäººï¼Œéœ€è¦åœ¨ $N$ åˆ†é’Ÿå†…è§£å†³é—®é¢˜ï¼Œé‚£ä¹ˆå¿…é¡»æ˜¯æ¯ä¸€åˆ†é’Ÿéƒ½æœ‰ä¸¤ä¸ªäººåœ¨ä¸Šå•æ‰€ã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬çœ‹ä¸€ä¸‹æœ€åä¸€åˆ†é’Ÿã€‚<br>å¦‚æœæœ€åä¸€åˆ†é’Ÿåœ¨é˜Ÿåˆ—é‡Œé¢ç­‰å¾…çš„æ˜¯ä¸¤ä¸ªç”·ç”Ÿï¼Œé‚£ä¹ˆä»–ä»¬å·²ç»å¯ä»¥å•†é‡è°å»å¥³å•æ‰€äº†ã€‚<br>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥çŒœæƒ³ï¼Œç”·çš„å¿…é¡»å°½é‡é å‰ã€‚</p>
<p>æˆ‘ä»¬å°è¯•å°†æ¯ä¸€ä¸ª <code>F</code> å½“åš $-1$ï¼Œ<code>M</code> å½“åš $1$ï¼ŒåŸºäºæ­¤ç»Ÿè®¡å…¶åç¼€å’Œã€‚<br>æˆ‘ä»¬éœ€è¦ç¡®ä¿æ‰€æœ‰äººåŠ èµ·æ¥ä¸å¤§äº0ï¼Œå³æœ€å¤šæœ‰ $N$ ä¸ªç”·ç”Ÿã€‚<br>æˆ‘ä»¬è¿˜éœ€è¦ç¡®ä¿æ¯ä¸€æ®µåç¼€å’Œéƒ½ä¸å¤§äº1ã€‚è‡ªå·±ç”¨æ‰‹æ¨ç®—ä¸€ä¸‹çš„è¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è½»æ˜“å‘ç°ï¼Œä¸€æ—¦æœ‰åç¼€å’Œè¶…è¿‡1çš„æƒ…å†µçš„è¯ï¼Œé‚£ä¹ˆæœ€åè‚¯å®šæœ‰ä¸¤ä¸ªï¼ˆæˆ–æ›´å¤šï¼‰ç”·ç”Ÿéœ€è¦å†³å®šè°è¿›å¥³å•æ‰€ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥é€‰æ‹©äºŒåˆ†è®©é˜Ÿå°¾å¤šå°‘ä¸ªç”·ç”Ÿå»å¾€é˜Ÿå¤´ï¼Œä¹Ÿå¯ä»¥ç»Ÿè®¡æ•´ä¸ªåºåˆ—ä¸­åç¼€å’Œæœ€å¤§å€¼ä¹‹åå†+1ã€‚</p>
<h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><p>100åˆ†ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">100010</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line">ll n, m;</span><br><span class="line">ll chq, ans, temp;</span><br><span class="line">ll t[N], p[N], maxp[N];</span><br><span class="line"><span class="type">char</span> s[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cin &gt;&gt; s + <span class="number">1</span> &gt;&gt; t[i];</span><br><span class="line">        <span class="type">int</span> lens = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = lens; j &gt;= <span class="number">1</span>; j--)</span><br><span class="line">        &#123;</span><br><span class="line">            p[i] += (s[j] == <span class="string">&#x27;F&#x27;</span> ? <span class="number">-1</span> : <span class="number">1</span>);</span><br><span class="line">            maxp[i] = <span class="built_in">max</span>(p[i], maxp[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        chq += p[i] * t[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(chq &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = m; i &gt;= <span class="number">1</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(p[i] &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            ans = <span class="built_in">max</span>(ans, temp + (t[i] - <span class="number">1</span>) * p[i] + maxp[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            ans = <span class="built_in">max</span>(ans, temp + maxp[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        temp += p[i] * t[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>, ans - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸€å‘36åˆ†çš„Java8ä»£ç ï¼š</p>
<details class="note warning"><summary><p>Java8</p>
</summary>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//import java.util.Arrays;</span></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">S2544</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> N=<span class="number">100010</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">long</span>[] t=<span class="keyword">new</span> <span class="title class_">long</span>[N];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">long</span>[] p=<span class="keyword">new</span> <span class="title class_">long</span>[N];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">long</span>[] maxp=<span class="keyword">new</span> <span class="title class_">long</span>[N];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">long</span> chq=<span class="number">0</span>,ans=<span class="number">0</span>,temp=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">        Scanner scan=<span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        <span class="type">long</span> n=scan.nextInt();</span><br><span class="line">        <span class="type">int</span> m=scan.nextInt();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">            String inp=scan.next();</span><br><span class="line">            t[i]=scan.nextInt();</span><br><span class="line">            <span class="type">int</span> len=inp.length();</span><br><span class="line">            <span class="type">char</span>[] s=inp.toCharArray();</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=len-<span class="number">1</span>;j&gt;=<span class="number">0</span>;j--)&#123;</span><br><span class="line">                p[i]+=(s[j]==<span class="string">&#x27;F&#x27;</span>?-<span class="number">1</span>:<span class="number">1</span>);</span><br><span class="line">                maxp[i]=max(p[i],maxp[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            chq+=p[i]*t[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(chq&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            ans=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=m;i&gt;=<span class="number">1</span>;i--)&#123;</span><br><span class="line">                <span class="keyword">if</span>(p[i]&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                    ans=max(ans,temp+(t[i]-<span class="number">1</span>)*p[i]+maxp[i]);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    ans=max(ans,temp+maxp[i]);</span><br><span class="line">                &#125;</span><br><span class="line">                temp+=p[i]*t[i];</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(ans-<span class="number">1</span>);</span><br><span class="line">            scan.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">long</span> <span class="title function_">max</span><span class="params">(<span class="type">long</span> a,<span class="type">long</span> b)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(a&gt;=b)&#123;</span><br><span class="line">            <span class="keyword">return</span> a;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> b;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</details>

<h1 id="T2-ã€å¸¸ä¸­20180812T3ã€‘-test"><a href="#T2-ã€å¸¸ä¸­20180812T3ã€‘-test" class="headerlink" title="T2 ã€å¸¸ä¸­20180812T3ã€‘ test"></a>T2 ã€å¸¸ä¸­20180812T3ã€‘ test</h1><h2 id="é¢˜é¢-1"><a href="#é¢˜é¢-1" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h2><details class="note info"><summary><p>é¢˜é¢</p>
</summary>
<h3 id="é¢˜ç›®èƒŒæ™¯"><a href="#é¢˜ç›®èƒŒæ™¯" class="headerlink" title="é¢˜ç›®èƒŒæ™¯"></a>é¢˜ç›®èƒŒæ™¯</h3><blockquote>
<p>Tomåœ¨å­¦å†™åŠ¨æ€æ ‘ï¼Œä½†æ˜¯åšé¢˜æ—¶è¿‡äº†æ ·ä¾‹ï¼Œæäº¤REã€‚TomæŠ“ä½Jerryè¦ä»–å†™ä¸ªæš´åŠ›æ¥å¯¹æ‹ã€‚Jerryè§‰å¾—è¿™ä»»åŠ¡å¤ªç®€å•äº†ï¼Œå°±è®©ä½ æ¥å®Œæˆä¸€ä¸‹ã€‚</p>
</blockquote>
<h3 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><blockquote>
<p>æœ‰ä¸€æ£µ $n$ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œåˆå§‹æ—¶æ ¹èŠ‚ç‚¹ä¸º1ã€‚ç°åœ¨è¦æ”¯æŒå¦‚ä¸‹æ“ä½œâ€”â€”</p>
<ol>
<li>å°†æŸèŠ‚ç‚¹è®¾ç½®ä¸ºæ ¹ï¼›</li>
<li>æ”¹å˜æŸèŠ‚ç‚¹æƒå€¼ï¼›</li>
<li>è¯¢é—®ä»¥æŸèŠ‚ç‚¹ä¸ºæ ¹çš„å­æ ‘å†…èŠ‚ç‚¹æƒå€¼ä¹‹å’Œï¼›</li>
<li>è¯¢é—®ä»¥æŸä¸¤ç‚¹ä¸ºç«¯ç‚¹çš„é“¾ä¸Šçš„èŠ‚ç‚¹æƒå€¼ä¹‹å’Œã€‚</li>
</ol>
</blockquote>
<h3 id="è¾“å…¥æ ¼å¼"><a href="#è¾“å…¥æ ¼å¼" class="headerlink" title="è¾“å…¥æ ¼å¼"></a>è¾“å…¥æ ¼å¼</h3><blockquote>
<p>ç¬¬ä¸€è¡Œä¸¤ä¸ªæ­£æ•´æ•° $n$ å’Œ $q$ ï¼Œè¡¨ç¤ºæ ‘çš„èŠ‚ç‚¹æ•°å’Œæ“ä½œä¸ªæ•°ã€‚<br>æ¥ç€ $nâˆ’1$ è¡Œæ¯è¡Œä¸¤ä¸ªæ•´æ•° $u$ å’Œ $v$ ï¼Œè¡¨ç¤ºæœ‰è¿æ¥ $u$ å’Œ $v$ çš„ä¸€æ¡è¾¹ã€‚<br>éšåä¸€è¡Œ $n$ ä¸ªæ­£æ•´æ•°ï¼Œè¡¨ç¤ºæ¯ä¸ªç‚¹çš„åˆå§‹æƒå€¼ã€‚<br>ä¹‹å $q$ è¡Œæ¯è¡Œæ ¼å¼å¦‚ä¸‹ï¼š<br>é¦–å…ˆä¸€ä¸ªèŒƒå›´ä¸º $[1,4]$ çš„æ­£æ•´æ•°ï¼Œè¡¨ç¤ºè¯¥æ“ä½œç±»å‹ã€‚<br>å¯¹äº1æ“ä½œï¼Œä¹‹åä¸€ä¸ªæ­£æ•´æ•° $x$ ï¼Œè¡¨ç¤ºå°† $x$ èŠ‚ç‚¹è®¾ç½®ä¸ºæ ¹ã€‚<br>å¯¹äº2æ“ä½œï¼Œä¹‹åä¸¤ä¸ªæ­£æ•´æ•° $x$ å’Œ $v$ ï¼Œè¡¨ç¤ºå°† $x$ èŠ‚ç‚¹çš„æƒå€¼æ”¹ä¸º $v$ ã€‚<br>å¯¹äº3æ“ä½œï¼Œä¹‹åä¸€ä¸ªæ­£æ•´æ•° $x$ ï¼Œè¡¨ç¤ºè¯¢é—®ä»¥ $x$ ä¸ºæ ¹çš„å­æ ‘å†…èŠ‚ç‚¹æƒå€¼ä¹‹å’Œã€‚<br>å¯¹äº4æ“ä½œï¼Œä¹‹åä¸¤ä¸ªæ­£æ•´æ•° $x$ å’Œ $y$ ï¼Œè¡¨ç¤ºè¯¢é—®ä»¥ $x$ å’Œ $y$ ä¸ºç«¯ç‚¹çš„é“¾ä¸Šçš„èŠ‚ç‚¹æƒå€¼ä¹‹å’Œã€‚</p>
</blockquote>
<h3 id="è¾“å‡ºæ ¼å¼"><a href="#è¾“å‡ºæ ¼å¼" class="headerlink" title="è¾“å‡ºæ ¼å¼"></a>è¾“å‡ºæ ¼å¼</h3><blockquote>
<p>å¯¹äºæ¯ä¸ªæ“ä½œ3å’Œæ“ä½œ4ï¼Œè¾“å‡ºä¸€è¡Œä¸€ä¸ªæ•´æ•°è¡¨ç¤ºè¯¢é—®çš„ç­”æ¡ˆã€‚</p>
</blockquote>

</details>

<h2 id="æ€è·¯-1"><a href="#æ€è·¯-1" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>æ ¹æ®é¢˜ç›®æ‰€ç»™å‡ºçš„è¦æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨LCTåšè¿™é“é¢˜ã€‚</p>
<p>ä½†æ˜¯LCTå¤ªéš¾äº†æˆ‘ä¸ä¼šå•ŠQwQ</p>
<p>æ‰€ä»¥æˆ‘ä»¬è€ƒè™‘é€€è€Œæ±‚å…¶æ¬¡ï¼Œä½¿ç”¨æ¢æ ¹æ ‘å‰–æ¥åšã€‚<br>å®æµ‹å¯è¡Œã€‚</p>
<p>æ¢æ ¹æ“ä½œåªä¼šå½±å“ä½œç”¨äºä¸€ä¸ªèŠ‚ç‚¹å­æ ‘ä¸Šçš„æ“ä½œï¼Œæ¯”å¦‚å­æ ‘åŠ ï¼Œå­æ ‘æ±‚å’Œç­‰ç­‰ã€‚</p>
<p>å·§äº†ï¼Œè¿™é‡Œå°±æœ‰ä¸€ä¸ªã€‚</p>
<p>é‚£å°±æœ‰ç‚¹å¤´ç–¼ã€‚</p>
<p>æˆ‘ä»¬æ ¹æ®è¦éœ€è¦æ“ä½œçš„èŠ‚ç‚¹ $x$ å’Œç°æ ¹èŠ‚ç‚¹ $rt$ çš„å…³ç³»æ¥è€ƒè™‘åˆ†ä¸‰ç§æƒ…å†µï¼š</p>
<ol>
<li><p><code>x==rt</code><br>è¿™ç§æƒ…å†µæ˜æ˜¾å¾ˆç®€å•â€”â€”å°±æ˜¯æ•´æ£µæ ‘ã€‚</p>
</li>
<li><p><code>lca(x,rt)ï¼=x</code><br>è¿™æ ·æˆ‘ä»¬å¯ä»¥çŸ¥é“ç°åœ¨çš„æ ¹ $rt$ æ²¡æœ‰åœ¨ $x$ çš„å­æ ‘é‡Œï¼Œæ­¤æ—¶ $x$ çš„å­æ ‘ä¸æ ¹ä¸º1æ—¶çš„å­æ ‘æ— å¼‚ï¼Œå¯ä»¥ç›´æ¥æ“ä½œã€‚</p>
</li>
<li><p><code>lca(x,rt)==x</code><br>è¿™æ—¶å€™æˆ‘ä»¬å‘ç° $rt$ åœ¨ $x$ çš„å­æ ‘é‡Œé¢ã€‚<br>æ­¤æ—¶ï¼Œ$x$ çš„å­æ ‘å°±ä¼šå‘ç”Ÿå¾ˆå¤§çš„æ”¹å˜ã€‚åŸå…ˆ $x$ çš„å­æ ‘åŒ…å« $rt$ çš„é‚£ä¸ªå„¿å­ç°åœ¨æˆä¸ºäº† $x$ çš„çˆ¶äº²ï¼Œè€Œå…¶ä»–å„¿å­ä¸å˜ã€‚åŸå…ˆä¸º $x$ çˆ¶äº²çš„èŠ‚ç‚¹æˆä¸ºäº† $x$ çš„å…¶ä¸­ä¸€ä¸ªå„¿å­ï¼ŒåŸå…ˆé™¤å…¶å­æ ‘ä»¥å¤–çš„èŠ‚ç‚¹éƒ½æˆä¸ºäº†å…¶å­æ ‘ã€‚<br>æˆ‘ä»¬ç§°è¿™ä¸ªå­æ ‘åŒ…å« $rt$ çš„å„¿å­ä¸º $v$ ã€‚<br>ç°åœ¨ $x$ çš„å­æ ‘æ˜¯ $[ 1 , id_v ) \cup ( id_v + sz_v - 1 , n ]$ è¿™ä¸¤æ®µè¿ç»­çš„åŒºé—´ã€‚<br>æˆ‘ä»¬å¯ä»¥è€ƒè™‘å¯¹è¿™ä¸¤æ®µåŒºé—´åˆ†åˆ«æ“ä½œï¼Œä¹Ÿå¯ä»¥é€‰æ‹©å¯¹æ•´æ£µæ ‘æ“ä½œä»¥ååœ¨å‡å»ä¸­é—´çš„é‚£ä¸€å—erã€‚</p>
</li>
</ol>
<h2 id="ä»£ç -1"><a href="#ä»£ç -1" class="headerlink" title="ä»£ç "></a>ä»£ç </h2><p>100åˆ†ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">100010</span>, M = N &lt;&lt; <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> w[N], h[N], e[M], ne[M], idx;</span><br><span class="line"><span class="type">int</span> id[N], nw[N], cnt;</span><br><span class="line"><span class="type">int</span> dep[N], sz[N], top[N], fa[N], son[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SegTree</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    ll sum;</span><br><span class="line">&#125;tr[N &lt;&lt; <span class="number">3</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[idx] = b, ne[idx] = h[a], h[a] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> vater, <span class="type">int</span> depth)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    dep[p] = depth, fa[p] = vater, sz[p] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h[p]; ~i; i = ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> j = e[i];</span><br><span class="line">        <span class="keyword">if</span>(j == vater)<span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs1</span>(j, p, depth + <span class="number">1</span>);</span><br><span class="line">        sz[p] += sz[j];</span><br><span class="line">        <span class="keyword">if</span>(sz[son[p]] &lt; sz[j])son[p] = j;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    id[p] = ++cnt, nw[cnt] = w[p], top[p] = t;</span><br><span class="line">    <span class="keyword">if</span>(!son[p])<span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">dfs2</span>(son[p], t);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h[p]; ~i; i = ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> j = e[i];</span><br><span class="line">        <span class="keyword">if</span>(j == fa[p] || j == son[p])<span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs2</span>(j, j);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tr[p].sum = tr[p &lt;&lt; <span class="number">1</span>].sum + tr[p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].sum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tr[p].l = l, tr[p].r = r;</span><br><span class="line">    <span class="keyword">if</span>(l == r)</span><br><span class="line">    &#123;</span><br><span class="line">        tr[p].sum = nw[r];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">build</span>(p &lt;&lt; <span class="number">1</span>, l, mid);</span><br><span class="line">    <span class="built_in">build</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="built_in">pushup</span>(p);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">segchg</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> ed, ll k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>((tr[p].l == ed) &amp;&amp; (tr[p].r == ed))</span><br><span class="line">    &#123;</span><br><span class="line">        tr[p].sum = k;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid = (tr[p].l + tr[p].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(ed &lt;= mid)<span class="built_in">segchg</span>(p &lt;&lt; <span class="number">1</span>, ed, k);</span><br><span class="line">    <span class="keyword">if</span>(ed &gt; mid)<span class="built_in">segchg</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, ed, k);</span><br><span class="line">    <span class="built_in">pushup</span>(p);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">segsum</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>((tr[p].l &gt;= l) &amp;&amp; (tr[p].r &lt;= r))<span class="keyword">return</span> tr[p].sum;</span><br><span class="line">    ll res = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> mid = (tr[p].l + tr[p].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid)res += <span class="built_in">segsum</span>(p &lt;&lt; <span class="number">1</span>, l, r);</span><br><span class="line">    <span class="keyword">if</span>(r &gt; mid)res += <span class="built_in">segsum</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">sumtree</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">segsum</span>(<span class="number">1</span>, id[p], id[p] + sz[p] - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">sumpath</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> q)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(top[p] != top[q])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(dep[top[p]] &lt; dep[top[q]])<span class="built_in">swap</span>(p, q);</span><br><span class="line">        res += <span class="built_in">segsum</span>(<span class="number">1</span>, id[top[p]], id[p]);</span><br><span class="line">        p = fa[top[p]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(dep[p] &lt; dep[q])<span class="built_in">swap</span>(p, q);</span><br><span class="line">    res += <span class="built_in">segsum</span>(<span class="number">1</span>, id[q], id[p]);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lca</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> q)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(top[p] != top[q])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(dep[top[p]] &lt; dep[top[q]])<span class="built_in">swap</span>(p, q);</span><br><span class="line">        p = fa[top[p]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(dep[p] &lt; dep[q])<span class="built_in">swap</span>(p, q);</span><br><span class="line">    <span class="keyword">return</span> q;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get_v</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> q)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(top[p] != top[q])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(dep[top[p]] &lt; dep[top[q]])<span class="built_in">swap</span>(p, q);</span><br><span class="line">        <span class="keyword">if</span>(fa[top[p]] == q)<span class="keyword">return</span> top[p];</span><br><span class="line">        p = fa[top[p]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(dep[p] &lt; dep[q])<span class="built_in">swap</span>(p, q);</span><br><span class="line">    <span class="keyword">return</span> son[q];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(h, <span class="number">-1</span>, <span class="built_in">sizeof</span>(h));</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> a, b;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);</span><br><span class="line">        <span class="built_in">add</span>(a, b);</span><br><span class="line">        <span class="built_in">add</span>(b, a);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;w[i]);</span><br><span class="line">    <span class="built_in">dfs1</span>(<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">dfs2</span>(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">    <span class="type">int</span> rt = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> op, x, y;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;op, &amp;x);</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            rt = x;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            ll z;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;z);</span><br><span class="line">            <span class="built_in">segchg</span>(<span class="number">1</span>, id[x], z);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">3</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(x == rt)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, tr[<span class="number">1</span>].sum);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">lca</span>(x, rt) != x)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">sumtree</span>(x));</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, tr[<span class="number">1</span>].sum - <span class="built_in">sumtree</span>(<span class="built_in">get_v</span>(rt, x)));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">4</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;y);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">sumpath</span>(x, y));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>reçš„Java8ä»£ç ï¼ˆæ±‚è°ƒï¼‰ï¼š</p>
<details class="note warning"><summary><p>Java8</p>
</summary>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span>[] w=<span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">100010</span>];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span>[] h=<span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">100010</span>];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span>[] e=<span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">200020</span>];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span>[] ne=<span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">200020</span>];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> idx=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span>[] id=<span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">100010</span>];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span>[] nw=<span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">100010</span>];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> cnt=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span>[] dep=<span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">100010</span>];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span>[] sz=<span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">100010</span>];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span>[] top=<span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">100010</span>];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span>[] fa=<span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">100010</span>];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span>[] son=<span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">100010</span>];</span><br><span class="line">    <span class="keyword">static</span> SegTree[] tr=<span class="keyword">new</span> <span class="title class_">SegTree</span>[<span class="number">800080</span>];</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Arrays.fill(h,-<span class="number">1</span>);</span><br><span class="line">        Scanner scan=<span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        <span class="type">int</span> n=scan.nextInt();</span><br><span class="line">        <span class="type">int</span> m=scan.nextInt();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;n;i++)&#123;</span><br><span class="line">            <span class="type">int</span> a=scan.nextInt();</span><br><span class="line">            <span class="type">int</span> b=scan.nextInt();</span><br><span class="line">            add(a,b);</span><br><span class="line">            add(b,a);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">            w[i]=scan.nextInt();</span><br><span class="line">        &#125;</span><br><span class="line">        dfs1(<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">        dfs2(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">        build(<span class="number">1</span>,<span class="number">1</span>,n);</span><br><span class="line">        <span class="type">int</span> rt=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">            <span class="type">int</span> op=scan.nextInt();</span><br><span class="line">            <span class="type">int</span> x=scan.nextInt();</span><br><span class="line">            <span class="keyword">if</span>(op==<span class="number">1</span>)&#123;</span><br><span class="line">                rt=x;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(op==<span class="number">2</span>)&#123;</span><br><span class="line">                <span class="type">int</span> y=scan.nextInt();</span><br><span class="line">                segchg(<span class="number">1</span>,id[x],y);</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(op==<span class="number">3</span>)&#123;</span><br><span class="line">                <span class="keyword">if</span>(x==rt)&#123;</span><br><span class="line">                    System.out.printf(<span class="string">&quot;%d\n&quot;</span>,tr[<span class="number">1</span>].sum);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">if</span>(lca(x,rt)!=x)&#123;</span><br><span class="line">                        System.out.printf(<span class="string">&quot;%d\n&quot;</span>,sumtree(x));</span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        System.out.printf(<span class="string">&quot;%d\n&quot;</span>,tr[<span class="number">1</span>].sum-sumtree(get_v(rt,x)));</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(op==<span class="number">4</span>)&#123;</span><br><span class="line">                <span class="type">int</span> y=scan.nextInt();</span><br><span class="line">                System.out.printf(<span class="string">&quot;%d\n&quot;</span>,sumpath(x,y));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span>&#123;</span><br><span class="line">        e[idx]=b;</span><br><span class="line">        ne[idx]=h[a];</span><br><span class="line">        h[a]=idx++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">dfs1</span><span class="params">(<span class="type">int</span> p,<span class="type">int</span> father,<span class="type">int</span> depth)</span>&#123;</span><br><span class="line">        dep[p]=depth;</span><br><span class="line">        fa[p]=father;</span><br><span class="line">        sz[p]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=h[p];i!=-<span class="number">1</span>;i=ne[i])&#123;</span><br><span class="line">            <span class="type">int</span> j=e[i];</span><br><span class="line">            <span class="keyword">if</span>(j==father)<span class="keyword">continue</span>;</span><br><span class="line">            dfs1(j,p,depth+<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span>(sz[son[p]]&lt;sz[j])son[p]=j;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">dfs2</span><span class="params">(<span class="type">int</span> p,<span class="type">int</span> t)</span>&#123;</span><br><span class="line">        id[p]=++cnt;</span><br><span class="line">        nw[cnt]=w[p];</span><br><span class="line">        top[p]=t;</span><br><span class="line">        <span class="keyword">if</span>(son[p]==<span class="number">0</span>)<span class="keyword">return</span>;</span><br><span class="line">        dfs2(son[p],t);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=h[p];i!=-<span class="number">1</span>;i=ne[i])&#123;</span><br><span class="line">            <span class="type">int</span> j=e[i];</span><br><span class="line">            <span class="keyword">if</span>((j==fa[p])||(j==son[p]))<span class="keyword">continue</span>;</span><br><span class="line">            dfs2(j,j);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">pushup</span><span class="params">(<span class="type">int</span> p)</span>&#123;</span><br><span class="line">        tr[p].sum=tr[p&lt;&lt;<span class="number">1</span>].sum+tr[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].sum;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">build</span><span class="params">(<span class="type">int</span> p,<span class="type">int</span> l,<span class="type">int</span> r)</span>&#123;</span><br><span class="line">        tr[p].l=l;</span><br><span class="line">        tr[p].r=r;</span><br><span class="line">        <span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">            tr[p].sum=nw[r];</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        build(p&lt;&lt;<span class="number">1</span>,l,mid);</span><br><span class="line">        build(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">        pushup(p);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">segchg</span><span class="params">(<span class="type">int</span> p,<span class="type">int</span> ed,<span class="type">int</span> k)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>((tr[p].l==ed)&amp;&amp;(tr[p].r==ed))&#123;</span><br><span class="line">            tr[p].sum=k;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> mid=(tr[p].l+tr[p].r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(ed&lt;=mid)segchg(p&lt;&lt;<span class="number">1</span>,ed,k);</span><br><span class="line">        <span class="keyword">if</span>(ed&gt;mid)segchg(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,ed,k);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">segsum</span><span class="params">(<span class="type">int</span> p,<span class="type">int</span> l,<span class="type">int</span> r)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>((tr[p].l&gt;=l)&amp;&amp;(tr[p].r&lt;=r))<span class="keyword">return</span> tr[p].sum;</span><br><span class="line">        <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> mid=(tr[p].l+tr[p].r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(l&lt;=mid)res+=segsum(p&lt;&lt;<span class="number">1</span>,l,r);</span><br><span class="line">        <span class="keyword">if</span>(r&gt;mid)res+=segsum(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">sumtree</span><span class="params">(<span class="type">int</span> p)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> segsum(<span class="number">1</span>,id[p],id[p]+sz[p]-<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">sumpath</span><span class="params">(<span class="type">int</span> p,<span class="type">int</span> q)</span>&#123;</span><br><span class="line">        <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(top[p]!=top[q])&#123;</span><br><span class="line">            <span class="keyword">if</span>(dep[top[p]]&lt;dep[top[q]])&#123;</span><br><span class="line">                <span class="type">int</span> temp=p;</span><br><span class="line">                p=q;</span><br><span class="line">                q=temp;</span><br><span class="line">            &#125;</span><br><span class="line">            res+=segsum(<span class="number">1</span>,id[top[p]],id[p]);</span><br><span class="line">            p=fa[top[p]];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(dep[p]&lt;dep[q])&#123;</span><br><span class="line">            <span class="type">int</span> temp=p;</span><br><span class="line">            p=q;</span><br><span class="line">            q=temp;</span><br><span class="line">        &#125;</span><br><span class="line">        res+=segsum(<span class="number">1</span>,id[q],id[p]);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">lca</span><span class="params">(<span class="type">int</span> p,<span class="type">int</span> q)</span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(top[p]!=top[q])&#123;</span><br><span class="line">            <span class="keyword">if</span>(dep[top[p]]&lt;dep[top[q]])&#123;</span><br><span class="line">                <span class="type">int</span> temp=p;</span><br><span class="line">                p=q;</span><br><span class="line">                q=temp;</span><br><span class="line">            &#125;</span><br><span class="line">            p=fa[top[p]];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(dep[p]&lt;dep[q])&#123;</span><br><span class="line">            <span class="type">int</span> temp=p;</span><br><span class="line">            p=q;</span><br><span class="line">            q=temp;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> q;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">get_v</span><span class="params">(<span class="type">int</span> p,<span class="type">int</span> q)</span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(top[p]!=top[q])&#123;</span><br><span class="line">            <span class="keyword">if</span>(dep[top[p]]&lt;dep[top[q]])&#123;</span><br><span class="line">                <span class="type">int</span> temp=p;</span><br><span class="line">                p=q;</span><br><span class="line">                q=temp;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(fa[top[p]]==q)<span class="keyword">return</span> top[p];</span><br><span class="line">            p=fa[top[p]];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(dep[p]&lt;dep[q])&#123;</span><br><span class="line">            <span class="type">int</span> temp=p;</span><br><span class="line">            p=q;</span><br><span class="line">            q=temp;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> son[q];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SegTree</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> l;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> r;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</details>

<h1 id="T3-ã€20180819çœé˜Ÿç­ã€‘-å–æ•°å­—"><a href="#T3-ã€20180819çœé˜Ÿç­ã€‘-å–æ•°å­—" class="headerlink" title="T3 ã€20180819çœé˜Ÿç­ã€‘ å–æ•°å­—"></a>T3 ã€20180819çœé˜Ÿç­ã€‘ å–æ•°å­—</h1><h2 id="é¢˜é¢-2"><a href="#é¢˜é¢-2" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h2><details class="note info"><summary><p>é¢˜é¢</p>
</summary>
<h3 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><blockquote>
<p>ç»™å®š $n$ ä¸ªæ•´æ•° $a_i$ï¼Œä½ éœ€è¦ä»ä¸­é€‰å–è‹¥å¹²ä¸ªæ•°ï¼Œä½¿å¾—å®ƒä»¬çš„å’Œæ˜¯ $m$ çš„å€æ•°ã€‚é—®æœ‰å¤šå°‘ç§æ–¹æ¡ˆã€‚æœ‰å¤šä¸ªè¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®ä¸€ä¸ªçš„ $m$ å¯¹åº”çš„ç­”æ¡ˆã€‚</p>
</blockquote>
<h3 id="è¾“å…¥æ ¼å¼"><a href="#è¾“å…¥æ ¼å¼" class="headerlink" title="è¾“å…¥æ ¼å¼"></a>è¾“å…¥æ ¼å¼</h3><blockquote>
<p>ç¬¬ä¸€è¡Œä¸¤ä¸ªæ­£æ•´æ•° $n$ï¼Œ$q$ï¼Œåˆ†åˆ«è¡¨ç¤ºæ•´æ•°çš„æ•°é‡å’Œè¯¢é—®çš„æ•°é‡ã€‚<br>ç¬¬äºŒè¡Œ $n$ ä¸ªæ•´æ•° $a_i$ ã€‚<br>æ¥ä¸‹æ¥ $q$ è¡Œï¼Œæ¯è¡Œè¡¨ç¤ºä¸€ä¸ª $m$ã€‚</p>
</blockquote>
<h3 id="è¾“å‡ºæ ¼å¼"><a href="#è¾“å‡ºæ ¼å¼" class="headerlink" title="è¾“å‡ºæ ¼å¼"></a>è¾“å‡ºæ ¼å¼</h3><blockquote>
<p>å¯¹äºæ¯ä¸ªè¯¢é—®ï¼Œè¾“å‡ºä¸€è¡Œç­”æ¡ˆ $\bmod{1e9+7}$ã€‚</p>
</blockquote>

</details>

<h2 id="æ€è·¯-2"><a href="#æ€è·¯-2" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>è¿™é“é¢˜æ˜¯ä¸ªèƒŒåŒ…è®¡æ•°çš„é—®é¢˜ï¼ŒèƒŒåŒ…çš„å®¹é‡æ˜¯æ¨¡må¾ªç¯çš„ã€‚<br>è®°<code>f[i][j]</code>è¡¨ç¤ºè€ƒè™‘äº†å‰ $i$ä¸ªæ•´æ•°ï¼Œå½“å‰ä½™æ•°æ˜¯ $j$ï¼Œæœ‰é€‰å’Œä¸é€‰ä¸¤ç§æƒ…å†µã€‚é‚£ä¹ˆå¯¹äºä¸€æ¬¡è¯¢é—® $q$ï¼Œæˆ‘ä»¬ç›´æ¥åšçš„å¤æ‚åº¦æ˜¯ $O(nm)$ï¼Œæ€»å¤æ‚åº¦ $O(nmq)$ã€‚è¿™æ¡£æš´åŠ›åˆ†åº”è¯¥æ‹¿åˆ°ã€‚</p>
<p>æˆ‘ä»¬æ³¨æ„åˆ°må¾ˆå°ï¼Œè€Œnå¾ˆå¤§ï¼Œä¹Ÿå°±æ˜¯è¯´æœ‰å¾ˆå¤šé‡å¤çš„å€¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬è€ƒè™‘è®¾è®¡ä¸€ä¸ªä¸‹æ ‡ä¸º<code>dp[m][m]</code>çš„DPæ–¹æ³•ï¼Œæ¯æ¬¡è€ƒè™‘ä¸€ç±»æ•°ã€‚<br>å‡è®¾ç¬¬ $i$ ç§æ•°æœ‰ <code>k[i]</code> ä¸ªï¼Œæˆ‘ä»¬çš„è½¬ç§»æ˜¯ï¼š<br>$$<br>dp[i][j]&#x3D;\sum_{h&#x3D;0}^{k[i]} C_{k[i]}^h dp[i-1][j - h \times a[i] \bmod m]<br>$$<br>æ³¨æ„åˆ° $\sum k[i]&#x3D;n$ ï¼Œä»¥åŠdpæ•°ç»„çš„ç¬¬äºŒç»´æœ€å¤§åªæœ‰mï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ¯æ¬¡ $O(k[i])$ åœ°é¢„å¤„ç†å‡ºç»„åˆæ•°çš„ç³»æ•°ï¼Œè¡¨ç¤º<code>dp[i-1][j]</code>çš„è´¡çŒ®ã€‚å†™æˆä¼ªä»£ç å°±æ˜¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">for h : [0, k[i]]</span><br><span class="line">    c[h % m] += C(k[i], h)</span><br></pre></td></tr></table></figure>

<p>ç„¶åæˆ‘ä»¬å†é€’æ¨<code>dp[i][j]</code>ï¼ŒæŠŠ $dp[i-1][j]\times c[k]\to dp[i][j+k\times i\bmod m]$ å³å¯ã€‚</p>
<p>æ€»å¤æ‚åº¦$O(q(n+m^3))$ã€‚</p>
<h2 id="ä»£ç -2"><a href="#ä»£ç -2" class="headerlink" title="ä»£ç "></a>ä»£ç </h2><p>100åˆ†ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">200020</span>, M = <span class="number">110</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line">ll T, n, m, k;</span><br><span class="line">ll a[N], fac[N], inv[N];</span><br><span class="line">ll t[M], f[M][M], pre[M];</span><br><span class="line"><span class="function">ll <span class="title">qpow</span><span class="params">(ll x, ll k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(k)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(k &amp; <span class="number">1</span>)ans = (ans * x) % mod;</span><br><span class="line">        x = (x * x) % mod;</span><br><span class="line">        k &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">C</span><span class="params">(ll b, ll a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (((fac[b] * inv[a]) % mod) * (inv[b - a])) % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    fac[<span class="number">0</span>] = <span class="number">1ll</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; N; i++)fac[i] = (fac[i - <span class="number">1</span>] * i) % mod;</span><br><span class="line">    inv[N - <span class="number">1</span>] = <span class="built_in">qpow</span>(fac[N - <span class="number">1</span>], mod - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = N - <span class="number">2</span>; i &gt;= <span class="number">0</span>; i--)inv[i] = ((i + <span class="number">1</span>) * inv[i + <span class="number">1</span>]) % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">init</span>();</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld&quot;</span>, &amp;n, &amp;T);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)<span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;a[i]);</span><br><span class="line">    <span class="keyword">while</span>(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">memset</span>(t, <span class="number">0</span>, <span class="built_in">sizeof</span>(t));</span><br><span class="line">        <span class="built_in">memset</span>(f, <span class="number">0</span>, <span class="built_in">sizeof</span>(f));</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;m);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)t[(a[i] % m + m) % m]++;</span><br><span class="line">        f[<span class="number">0</span>][<span class="number">0</span>] = <span class="built_in">qpow</span>(<span class="number">2</span>, t[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; m; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">memset</span>(pre, <span class="number">0</span>, <span class="built_in">sizeof</span>(pre));</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>; k &lt;= t[i]; k++)pre[k % m] = (pre[k % m] + <span class="built_in">C</span>(t[i], k)) % mod;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; m; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>; k &lt;= <span class="built_in">min</span>(m - <span class="number">1</span>, t[i]); k++)</span><br><span class="line">                &#123;</span><br><span class="line">                    f[i][(j + i * k) % m] = (f[i][(j + i * k) % m] + f[i - <span class="number">1</span>][j] * pre[k] % mod) % mod;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, f[m - <span class="number">1</span>][<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>reçš„Java8ä»£ç ï¼ˆæ±‚è°ƒï¼‰ï¼š</p>
<details class="note warning"><summary><p>Java8</p>
</summary>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> N=<span class="number">200020</span>,M=<span class="number">110</span>,mod=(<span class="type">int</span>)(<span class="number">1e9</span>+<span class="number">7</span>);</span><br><span class="line">    <span class="keyword">static</span> <span class="type">long</span>[] a=<span class="keyword">new</span> <span class="title class_">long</span>[N];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">long</span>[] fac=<span class="keyword">new</span> <span class="title class_">long</span>[N];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">long</span>[] inv=<span class="keyword">new</span> <span class="title class_">long</span>[N];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">long</span>[] t=<span class="keyword">new</span> <span class="title class_">long</span>[M];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">long</span>[][] f=<span class="keyword">new</span> <span class="title class_">long</span>[M][M];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">long</span>[] pre=<span class="keyword">new</span> <span class="title class_">long</span>[M];</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">        Scanner scan=<span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        init();</span><br><span class="line">        <span class="type">int</span> n=scan.nextInt();</span><br><span class="line">        <span class="type">int</span> T=scan.nextInt();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)a[i]=scan.nextInt();</span><br><span class="line">        <span class="keyword">while</span>((T--)!=<span class="number">0</span>)&#123;</span><br><span class="line">            Arrays.fill(t,<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;M;i++)&#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;M;j++)f[i][j]=<span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">int</span> m=scan.nextInt();</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)t[(<span class="type">int</span>)((a[i]%m+m)%m)]++;</span><br><span class="line">            f[<span class="number">0</span>][<span class="number">0</span>]=qpow(<span class="number">2</span>,t[<span class="number">0</span>]);</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;m;i++)&#123;</span><br><span class="line">                Arrays.fill(pre,<span class="number">0</span>);</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>;k&lt;=t[i];k++)pre[k%m]=(pre[k%m]+C((<span class="type">int</span>)t[i],k))%mod;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;m;j++)&#123;</span><br><span class="line">                    <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>;k&lt;=min(m-<span class="number">1</span>,(<span class="type">int</span>)t[i]);k++)&#123;</span><br><span class="line">                        f[i][(j+i*k)%m]=(f[i][(j+i*k)%m]+f[i-<span class="number">1</span>][j]*pre[k]%mod)%mod;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(f[m-<span class="number">1</span>][<span class="number">0</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        scan.close();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">long</span> <span class="title function_">qpow</span><span class="params">(<span class="type">long</span> x,<span class="type">long</span> k)</span>&#123;</span><br><span class="line">        <span class="type">long</span> ans=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(k!=<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>((k&amp;<span class="number">1</span>)==<span class="number">1</span>)ans=(ans*x)%mod;</span><br><span class="line">            x=(x*x)%mod;</span><br><span class="line">            k&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">long</span> <span class="title function_">C</span><span class="params">(<span class="type">int</span> b,<span class="type">int</span> a)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (((fac[b]*inv[a])%mod)*(inv[b-a]))%mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span>&#123;</span><br><span class="line">        fac[<span class="number">0</span>]=<span class="number">1l</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;N;i++)fac[i]=(fac[i-<span class="number">1</span>]*i)%mod;</span><br><span class="line">        inv[N-<span class="number">1</span>]=qpow(fac[N-<span class="number">1</span>],mod-<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=N-<span class="number">2</span>;i&gt;=<span class="number">0</span>;i--)inv[i]=((i+<span class="number">1</span>)*inv[i+<span class="number">1</span>])%mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">min</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(a&gt;=b)&#123;</span><br><span class="line">            <span class="keyword">return</span> a;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> b;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</details>

]]></content>
      <categories>
        <category>æ¯”èµ›è§£æ</category>
      </categories>
      <tags>
        <tag>æ¯”èµ›è§£æ</tag>
      </tags>
  </entry>
  <entry>
    <title>å‚…é‡Œå¶å˜æ¢</title>
    <url>/maths/fourier-transform/</url>
    <content><![CDATA[<p>ç®€ä»‹ï¼š å‚…é‡Œå¶å˜æ¢å’ŒFFTã€å¤æ•°ã€å•ä½æ ¹<br>ï¼ˆ20220321é‡ä¿®ï¼‰</p>
<span id="more"></span>

<h1 id="å¼•å…¥"><a href="#å¼•å…¥" class="headerlink" title="å¼•å…¥"></a>å¼•å…¥</h1><p>ä»Šå¤©AJç»™å¤§å®¶ç•™äº†ä¸€ä¸ªä½œä¸šï¼š</p>
<p>å¤šé¡¹å¼ç›¸ä¹˜ã€‚</p>
<p>$$<br>\begin{gather}<br>f(x) &#x3D; (x^2 + 3x - 1) \\<br>g(x) &#x3D; (2x^2 + x - 5) \\<br>f(x) \times g(x) &#x3D; ?<br>\end{gather}<br>$$</p>
<p>å¤§å®¶éƒ½å¾ˆè®¤çœŸã€å¾ˆç”¨å¿ƒåœ°åšäº†å‡ºæ¥ã€‚</p>
<p>$$<br>\begin{align}<br>f(x) \times g(x) &amp; &#x3D; (x^2 + 3x - 1) (2x^2 + x - 5) \\<br>&amp; &#x3D; x^2 \times g(x) + 3x \times g(x) - g(x) \\<br>&amp; &#x3D; (2x^4 + x^3 - 5x^2) + (6x^3 + 3x^2 - 15x) + (2x^2 + x - 5) \\<br>&amp; &#x3D; 2x^4 + x^3 - 5x^2 + 6x^3 + 3x^2 - 15x + 2x^2 + x - 5 \\<br>&amp; &#x3D; 2x^4 + 7x^3 - 4x^2 - 16x + 5<br>\end{align}<br>$$</p>
<p>çœ‹èµ·æ¥å¾ˆå¤æ‚ï¼Œå¯¹å—ï¼Ÿ</p>
<p>ä½†æ˜¯ï¼Œç²¾é€šæ•°å­¦çš„ç‹å“¥åœ¨çº¸ä¸Šå†™å†™ç”»ç”»å‡ åç§’é’Ÿä¹‹åï¼Œå¾—å‡ºæ¥çš„ç­”æ¡ˆè·Ÿæ­£ç¡®ç­”æ¡ˆä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚<br>æƒŠå‘†äº†çš„tÃ¼eé—®ç‹å“¥ä»–ç”¨çš„æ˜¯ä»€ä¹ˆåŠæ³•ã€‚<br>ç‹å“¥å›ç­”ï¼šâ€œ <strong>å‚…é‡Œå¶å˜æ¢</strong> ã€‚â€</p>
<h1 id="å¤šé¡¹å¼ä¹˜æ³•çš„æœ¬è´¨"><a href="#å¤šé¡¹å¼ä¹˜æ³•çš„æœ¬è´¨" class="headerlink" title="å¤šé¡¹å¼ä¹˜æ³•çš„æœ¬è´¨"></a>å¤šé¡¹å¼ä¹˜æ³•çš„æœ¬è´¨</h1><p>ç‹å“¥è¯´ï¼šâ€œæˆ‘ä»¬çŸ¥é“ï¼Œæ‰€æœ‰å¤šé¡¹å¼éƒ½æ‹¥æœ‰å¦‚ä¸‹çš„å½¢å¼ï¼š</p>
<p>$$<br>f(x) &#x3D; a_0 x^n + a_1 x^{n-1} + a_2 x^{n-2} + \cdots + a_{n-2} x^2 + a_{n-1} x +a_n<br>$$</p>
<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠä¸€ä¸ªå¤šé¡¹å¼å†™æˆè¿™æ ·çš„å½¢å¼ï¼š</p>
<p>$$<br>f(x) &#x3D; \sum_{i&#x3D;0}^n a_i x^{n-i}<br>$$</p>
<p>è€Œä¸¤ä¸ªå¤šé¡¹å¼ç›¸ä¹˜ $f(x) \times g(x) &#x3D; h(x)$ çš„æ—¶å€™ï¼Œç›¸ä¹˜çš„ç»“æœçš„ç¬¬ $k$ é¡¹ç³»æ•° $h_{k-1}$ ç­‰äºæ‰€æœ‰ $f_{i}$ ä¸ $g_{k-i}$ ä¹˜ç§¯ä¹‹å’Œã€‚<br>æ‰€ä»¥ï¼Œ</p>
<p>$$<br>h_k &#x3D; \sum_{i&#x3D;0}^{k-1} f_i \times g_{k-1-i}<br>$$</p>
<p>è¿™æ ·çš„æ–¹æ³•ç®—å‡ºçš„ç»“æœæ˜¯ä¸ä¸¤ä¸ªå¤šé¡¹å¼çš„æ¬¡æ•°ç›¸å…³çš„ã€‚â€</p>
<p>æˆ–è€…ï¼ˆå¯¹äºOIerï¼‰é€šä¿—ä¸€ç‚¹æ¥è¯´ï¼Œå‡è®¾ä¸¤ä¸ªå¤šé¡¹å¼çš„æ¬¡æ•°åˆ†åˆ«ä¸º $n$ å’Œ $m$ï¼Œé‚£ä¹ˆè¿™ä¸ªç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(nm)$ çš„ã€‚</p>
<p>ç»™ä¸ª<span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL3Byb2JsZW0vUDM4MDM=">æ¨¡æ¿é¢˜<i class="fa fa-external-link-alt"></i></span>çš„44åˆ†ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">100010</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> <span class="type">int</span> X = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">register</span> <span class="type">char</span> ch = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>((ch &lt; <span class="number">48</span>) || (ch &gt; <span class="number">57</span>))ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span>((ch &gt;= <span class="number">48</span>) &amp;&amp; (ch &lt;= <span class="number">57</span>))X = X * <span class="number">10</span> + (ch ^ <span class="number">48</span>), ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">return</span> X;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line">ll f[N], g[N], s[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">mul</span><span class="params">(ll *s, ll *f, ll *g)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">f_or</span>(<span class="type">int</span> k = <span class="number">0</span>; k &lt; n + m - <span class="number">1</span>; k++)</span><br><span class="line">        <span class="built_in">f_or</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt;= k; i++)</span><br><span class="line">            s[k] += f[i] * g[k - i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m); n++; m++;</span><br><span class="line">    <span class="built_in">f_or</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)f[i] = <span class="built_in">read</span>();</span><br><span class="line">    <span class="built_in">f_or</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++)g[i] = <span class="built_in">read</span>();</span><br><span class="line">    <span class="built_in">mul</span>(s, f, g);</span><br><span class="line">    <span class="built_in">f_or</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n + m - <span class="number">1</span>; i++)<span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>, s[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>$\color[rgb]{1,1,0.0625}{Ï†}$ ï¼ˆåªä¿è¯44åˆ†ï¼‰</p>
<h1 id="DFT"><a href="#DFT" class="headerlink" title="DFT"></a>DFT</h1><h2 id="å¤šé¡¹å¼çš„ç‚¹å€¼è¡¨è¾¾"><a href="#å¤šé¡¹å¼çš„ç‚¹å€¼è¡¨è¾¾" class="headerlink" title="å¤šé¡¹å¼çš„ç‚¹å€¼è¡¨è¾¾"></a>å¤šé¡¹å¼çš„ç‚¹å€¼è¡¨è¾¾</h2><p>ä¸ºäº†ç®€ä¾¿è¡¨è¾¾ï¼Œæˆ‘ä»¬ä½¿ç”¨ $f_k$ æ¥ä»£è¡¨ å¤šé¡¹å¼ $f(x)$ çš„ç¬¬ $k+1$ é¡¹ç³»æ•°ã€‚</p>
<p>ä»Šå¤©AJçš„ä½œä¸šæ˜¯æ˜¨å¤©çš„å»¶ä¼¸ï¼š<br>ç»™å®šä¸€ä¸ª $n$ æ¬¡å¤šé¡¹å¼çš„ $n+1$ ä¸ªç‚¹å€¼ï¼Œè¦æ±‚æˆ‘ä»¬æ±‚å‡ºè¿™ä¸ªå¤šé¡¹å¼ã€‚<br>ï¼ˆè¿˜è®©æ­¦å˜‰ç»™äº†æ ·ä¾‹ï¼Œè€Œæ­¦å˜‰ç»™çš„æ ·ä¾‹æ˜¯1,3,5,7,9,114514ï¼‰<br>å…¨ç­åªæœ‰ç‹å“¥å’ŒæŸç›’å­åšäº†å‡ºæ¥ã€‚å¹¿å‘Šï¼š<span class="exturl" data-url="aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vNDcwOTUyMzc5">CoolHezi<i class="fa fa-external-link-alt"></i></span><br>ä»–ä»¬ç”¨çš„æ˜¯ä»€ä¹ˆæ–¹æ³•å‘¢ï¼Ÿ</p>
<p><strong>æ‹‰æ ¼æœ—æ—¥æ’å€¼</strong>ã€‚</p>
<p>æƒ³è¦äº†è§£æ‹‰æ ¼æœ—æ—¥æ’å€¼ï¼Œå¯ä»¥å‚è€ƒæˆ‘çš„è¿™ä¸ªåšå®¢ï¼š<a href="/maths/lagrange-interpolation">æ‹‰æ ¼æœ—æ—¥æ’å€¼</a></p>
<p>ç°åœ¨æˆ‘ä»¬åªéœ€è¦çŸ¥é“ï¼Œç»™å®šäº† $n+1$ ä¸ªä»»æ„ç‚¹å€¼ï¼Œå¯ä»¥æ±‚å‡ºæ¥ç»è¿‡è¿™å‡ ä¸ªç‚¹çš„ä¸€ä¸ª $n$ æ¬¡å¤šé¡¹å¼ã€‚<br>å¦‚æœä¸¤ä¸ªå¤šé¡¹å¼ $f(x)$ å’Œ $g(x)$ åœ¨ç›¸åŒçºµåæ ‡ä¸Šå–ç‚¹ï¼ˆè®¾å…¶åˆ†åˆ«ä¸º $f(x)$  ä¸ $g(x)$ï¼‰ åç›¸ä¹˜æ‰€å¾—çš„ç»“æœï¼ˆ$f(x) \times g(x)$ï¼‰ç­‰äºä¸¤å‡½æ•°ç›¸ä¹˜åå¯¹åº”çºµåæ ‡å¤„çš„ç‚¹å€¼ï¼ˆ$h(x)$ï¼‰ã€‚</p>
<p>ä¸¾ä¸ªæ —å­ï¼š</p>
<p>$$<br>\begin{align}<br>f(x) &amp;&#x3D; x^2 + 3x - 1 \\<br>g(x) &amp;&#x3D; 2x^2 + x -5<br>\end{align}<br>$$</p>
<p>æˆ‘ä»¬åˆ†åˆ«å– $x \in [-1,1]$ å†…çš„æ•´æ•°ç‚¹æ‰€å¯¹åº”çš„ç‚¹å€¼ï¼š</p>
<img src="https://i.loli.net/2021/10/17/idm29GlQr7asBTc.png" alt="å‚…é‡Œå¶1.png" width="60%" />

<p>æˆ‘ä»¬å¯ä»¥æ¸…æ¥šçš„çœ‹åˆ°ï¼š</p>
<p>$$<br>\begin{align}<br>f(-1) &amp; &#x3D; -3 &amp; f(0) &amp; &#x3D; -1 &amp; f(1) &amp; &#x3D; 3 \\<br>g(-1) &amp; &#x3D; -4 &amp; g(0) &amp; &#x3D; -5 &amp; g(1) &amp; &#x3D; -2<br>\end{align}<br>$$</p>
<p>ç›¸ä¹˜ä¹‹åå¯å¾—ï¼š</p>
<p>$$<br>\begin{align}<br>h(-1) &amp; &#x3D; 12 &amp; h(0) &amp; &#x3D; 5 &amp; h(1) &amp; &#x3D; -6<br>\end{align}<br>$$</p>
<p>æ£€éªŒä¸€ä¸‹ï¼š</p>
<img src="https://i.loli.net/2021/10/17/AvSKMrem6QlEtIU.png" alt="å‚…é‡Œå¶2.png" width="60%" />

<p>ä½†æƒ³è¦æ±‚å‡º $h(x)$ ï¼Œæˆ‘ä»¬è‡³å°‘éœ€è¦4+1&#x3D;5ä¸ªç‚¹å€¼ã€‚</p>
<p>æ€ä¹ˆåŠï¼Ÿ</p>
<p>å¤šæ‰¾å‡ ä¸ªå•Šã€‚</p>
<p>äºæ˜¯æˆ‘ä»¬å°±å¯ä»¥æ±‚å‡ºæœ€ç»ˆçš„å¤šé¡¹å¼ã€‚</p>
<p>è¿™å°±æ˜¯FTçš„ç®—æ³•æµç¨‹ã€‚<br>â€œæŠŠ<strong>ç³»æ•°</strong>è¡¨è¾¾è½¬æ¢ä¸º<strong>ç‚¹å€¼</strong>è¡¨è¾¾â€çš„ç®—æ³•å«åš<strong>DFT</strong><br>â€œæŠŠ<strong>ç‚¹å€¼</strong>è¡¨è¾¾è½¬æ¢ä¸º<strong>ç³»æ•°</strong>è¡¨è¾¾â€çš„ç®—æ³•å«åš<strong>IDFT</strong>(DFTçš„é€†è¿ç®—)</p>
<p>P.S:</p>
<ul>
<li>ä»ä¸€ä¸ªå¤šé¡¹å¼çš„ç³»æ•°è¡¨è¾¾ç¡®å®šå…¶ç‚¹å€¼è¡¨è¾¾çš„è¿‡ç¨‹ç§°ä¸º<strong>æ±‚å€¼</strong>(æ¯•ç«Ÿæ±‚ç‚¹å€¼è¡¨è¾¾çš„è¿‡ç¨‹å°±æ˜¯å–äº† n ä¸ª x ç„¶åæ‰”è¿›äº†å¤šé¡¹å¼æ±‚äº† n ä¸ªå€¼å‡ºæ¥)ï¼›</li>
<li>è€Œæ±‚å€¼è¿ç®—çš„é€†è¿ç®—(ä¹Ÿå°±æ˜¯ä»ä¸€ä¸ªå¤šé¡¹å¼çš„ç‚¹å€¼è¡¨è¾¾ç¡®å®šå…¶ç³»æ•°è¡¨è¾¾)è¢«ç§°ä¸º<strong>æ’å€¼</strong>ã€‚</li>
</ul>
<p>F(Fourier)å’ŒT(Transform)æœ‰äº†ï¼Œé‚£F(Fast)å‘¢ï¼Ÿ</p>
<h1 id="å•ä½æ ¹ä¸å¤æ•°"><a href="#å•ä½æ ¹ä¸å¤æ•°" class="headerlink" title="å•ä½æ ¹ä¸å¤æ•°"></a>å•ä½æ ¹ä¸å¤æ•°</h1><p>ä½†æ˜¯æœ€ç»ˆæˆ‘ä»¬å¹¶æ²¡æœ‰è§‰å¾—æœ‰ä»€ä¹ˆå¯ä»¥åŠ ä»¥åˆ©ç”¨çš„è‰¯å¥½æ€§è´¨å•Šã€‚<br>æˆ‘ä»¬è¿™äº›è’Ÿè’»åªä¼šåˆ©ç”¨ä¸€äº›æœ‰ç†æ•°å’Œä¸€äº›ç®€å•çš„æ— ç†æ•°æ¥è¿›è¡Œä¸€äº›ç®€å•çš„è®¡ç®—ï¼Œå†éš¾ä¸€ç‚¹çš„å°±ä¸ä¼šäº†ã€‚</p>
<p><del>ï¼ˆè€Œä¸”è¿™ä¸ªå¤šé¡¹å¼çš„æ¬¡æ•°å’Œç³»æ•°ç¨å¾®ä¸€å¤§å°±bzäº†ï¼‰</del><br>å‡†ç¡®æ¥è¯´ï¼Œæˆ‘ä»¬æœ€ç»ˆè¿˜æ˜¯éœ€è¦ $n+m$ ä¸ªç‚¹çš„æ±‚å€¼ä¸ç›¸ä¹˜ï¼Œæœ€ç»ˆå¾—åˆ°çš„æ—¶é—´å¤æ‚åº¦ä¸ $O(mn)$ å®é™…ä¸Šå·®ä¸å¤ªå¤šï¼Œè€Œä¸”å¾ˆå¯èƒ½åœ¨æŸäº›æƒ…å†µä¸‹æ›´åŠ£ä¸€äº›ã€‚</p>
<p>ä½†æ˜¯ï¼Œæ³•å›½æ•°å­¦å®¶ <strong>å‚…é‡Œå¶</strong> æ¨ªç©ºå‡ºä¸–ï¼Œæ‰¾äº†ä¸€äº›æ¯’ç˜¤æ•°æ®ä»£å…¥ï¼Œç»“æœå‘ç°å¯ä»¥åˆ†æ²»è€Œä½¿æ—¶é—´å¤æ‚åº¦é™ä½ã€‚<br>è€Œä»–ä»£å…¥çš„æ­£æ˜¯å•ä½æ ¹ $Ï‰_{n+1}^{0 \to n}$ ã€‚</p>
<h2 id="å¤æ•°"><a href="#å¤æ•°" class="headerlink" title="å¤æ•°"></a>å¤æ•°</h2><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦ä»‹ç»å¤æ•°ã€‚</p>
<p>å·²ç»ä¼šäº†çš„å¯ä»¥<a href="/maths/fourier-transform/#%E5%8D%95%E4%BD%8D%E6%A0%B9">è·³è¿‡</a>ã€‚</p>
<p>ï¼ˆp.s.:ä¸‹é¢æˆ‘ä»¬ä½¿ç”¨çš„æ‰€æœ‰ $\sqrt{\quad}$ æ ‡è¯†éƒ½æŒ‡çš„æ˜¯å¹³æ–¹æ ¹ï¼Œç®—æœ¯å¹³æ–¹æ ¹å·²ä½¿ç”¨+-æ¥æ ‡è®°ã€‚ï¼‰</p>
<h3 id="å¤æ•°çš„æ¦‚å¿µ"><a href="#å¤æ•°çš„æ¦‚å¿µ" class="headerlink" title="å¤æ•°çš„æ¦‚å¿µ"></a>å¤æ•°çš„æ¦‚å¿µ</h3><h4 id="è™šæ•°"><a href="#è™šæ•°" class="headerlink" title="è™šæ•°"></a>è™šæ•°</h4><p>æˆ‘ä»¬æ‰€å­¦çš„æ•°è½´æ˜¯ä¸€æ¡ç›´çº¿ã€‚</p>
<p><img src="https://i.loli.net/2021/10/18/ImBF56rhAYUQ2cL.png" alt="å‚…é‡Œå¶3.png"></p>
<p>æ¯ä¸€ä¸ªæœ‰ç†æ•°éƒ½èƒ½å®Œç¾åœ°ä¸æ•°è½´ä¸Šçš„æŸä¸€ä¸ªç‚¹ä¸€ä¸€å¯¹åº”ã€‚</p>
<p><img src="https://i.loli.net/2021/10/18/GBM34h7yDVjgzSm.png" alt="å‚…é‡Œå¶4.png"></p>
<p>$+\sqrt2$ ã€ $+\sqrt3$ ç­‰æ— ç†æ•°ä¹Ÿèƒ½å¾ˆå¥½åœ°å¯¹åº”åœ¨æ•°è½´ä¸Šã€‚</p>
<p><img src="https://i.loli.net/2021/10/18/pAs2ObDQ3Mf7Bv1.png" alt="å‚…é‡Œå¶5.png"></p>
<p>ä½†æ˜¯äººä»¬è¯´ï¼šâ€œé‚£ $+\sqrt{-1}$ æ€ä¹ˆåŠå•Šï¼Ÿâ€</p>
<p>æˆ‘ä»¬æ‰¾ä¸åˆ°ä¸ $+\sqrt{-1}$ ç›¸å¯¹åº”çš„ç‚¹ã€‚<br>è€Œ $+\sqrt{-1}$ åˆçš„çš„ç¡®ç¡®å­˜åœ¨ã€‚</p>
<p>æ€ä¹ˆåŠï¼Ÿ</p>
<p>äºæ˜¯äººä»¬å‘æ˜äº†ä¸€ä¸ªæ¦‚å¿µï¼šè™šæ•°ã€‚<br>è€Œ $+\sqrt{-1}$ åœ¨è™šæ•°é‡Œé¢å«åš<strong>è™šæ•°å•ä½</strong>ï¼Œç”¨ $i$ è¡¨ç¤ºã€‚<br>æ‰€ä»¥ï¼Œ$i^2&#x3D;-1$ ã€‚</p>
<p>ä½†æ˜¯åˆæœ‰äººä¼šé—®ï¼šâ€œé‚£ $-\sqrt{-1}$ åˆæ€ä¹ˆåŠï¼Ÿâ€</p>
<p>ç”¨ $-i$ å‘—ã€‚</p>
<p>ä½†æ˜¯åœ¨æ•°è½´ä¸Šï¼Œäººä»¬ä»ç„¶æ‰¾ä¸åˆ°å¯¹åº”è™šæ•°çš„ç‚¹ã€‚æ•°è½´ä¸Šçš„æ¯ä¸€ä¸ªç‚¹éƒ½å¯¹åº”äº†ä¸€ä¸ªå®æ•°ï¼Œæ²¡æœ‰åŠæ³•æ‰¾åˆ°ä»»ä½•ä¸€ä¸ªæ–°çš„ç‚¹æ¥å¯¹åº”è™šæ•°äº†ã€‚<br>æ‰€ä»¥ï¼Œäººä»¬å°±åœ¨æ•°è½´çš„ 0 å¤„æ·»åŠ äº†ä¸€æ¡æ–°çš„æ•°è½´ï¼Œæ¥ä»£è¡¨è™šæ•°ã€‚è¿™æ¡æ–°çš„æ•°è½´å‚ç›´äºä»£è¡¨å®æ•°çš„æ•°è½´ï¼Œå•ä½æ˜¯ $i$ ã€‚</p>
<h3 id="å¤æ•°åŠå…¶è¿ç®—"><a href="#å¤æ•°åŠå…¶è¿ç®—" class="headerlink" title="å¤æ•°åŠå…¶è¿ç®—"></a>å¤æ•°åŠå…¶è¿ç®—</h3><p>å¤æ•°å½¢ä¼¼ $a+bi$ ã€‚<br>å…¶ä¸­ $a$ ç§°ä¸ºå®éƒ¨( $\Re$ )ï¼Œ $b$ ç§°ä¸ºè™šéƒ¨( $\Im $ )ã€‚<br>å¤æ•°ä¹Ÿæœ‰åŠ å‡ä¹˜é™¤ç­‰è¿ç®—ã€‚<br>å¤æ•°åŠ å‡æ—¶å®éƒ¨è™šéƒ¨åˆ†åˆ«åŠ å‡ï¼š</p>
<p>$$<br>(a+bi) \pm (c+di) &#x3D; (a \pm c) + (b \pm d)i<br>$$</p>
<p>å¤æ•°ç›¸ä¹˜æ—¶å®éƒ¨è™šéƒ¨åˆ†åˆ«ç›¸ä¹˜ï¼š</p>
<p>$$<br>\begin{align}<br>(a+bi) \times (c+di) &amp; &#x3D; a \times (c+di) + bi \times (c+di) \\<br>&amp; &#x3D; ac + adi + bci - bd \\<br>&amp; &#x3D; (ac - bd) + (ad + bc)i<br>\end{align}<br>$$</p>
<p>å¤æ•°ç›¸é™¤æ—¶å°±æœ‰ç‚¹éš¾åŠäº†ã€‚<br>ç›´è§‰å‘Šè¯‰æˆ‘ä»¬ $\dfrac{a+bi}{c+di}$ ä¸ä¼šå¥½åŒ–ç®€ã€‚</p>
<p>è¿™é‡Œéœ€è¦å¼•å…¥ä¸€ä¸ªæ¦‚å¿µï¼šå¤æ•°çš„å…±è½­ã€‚<br>$a+bi$ çš„å…±è½­æ˜¯ $a-bi$ ã€‚<br>ä¸€ä¸ªå¤æ•°ä¹˜ä»¥å…¶å…±è½­æœ€ç»ˆå¾—åˆ°çš„æ˜¯ä¸€ä¸ªå®æ•°ã€‚ï¼ˆ $(a+bi) \times (a-bi) &#x3D; a^2 + b^2$ ï¼‰</p>
<p>æ‰€ä»¥å½“æˆ‘ä»¬åŒ–ç®€ $\dfrac{a+bi}{c+di}$ çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸Šä¸‹åŒä¹˜åˆ†æ¯çš„å…±è½­å°±å¯ä»¥äº†ï¼š<br>$$<br>\begin{align}<br>\frac{a+bi}{c+di} &amp; &#x3D; \frac{(a+bi)(c-di)}{(c+di)(c-di)} \\<br>&amp; &#x3D; \frac{(ac+bd) + (bc-ad)i}{c^2+d^2} \\<br>&amp; &#x3D; \frac{ac+bd}{c^2+d^2} + \frac{bc-ad}{c^2+d^2} i<br>\end{align}<br>$$</p>
<h3 id="å¤æ•°åœ¨æ•°è½´ä¸Šçš„è¡¨ç¤º"><a href="#å¤æ•°åœ¨æ•°è½´ä¸Šçš„è¡¨ç¤º" class="headerlink" title="å¤æ•°åœ¨æ•°è½´ä¸Šçš„è¡¨ç¤º"></a>å¤æ•°åœ¨æ•°è½´ä¸Šçš„è¡¨ç¤º</h3><p>é‚£æˆ‘ä»¬æ€ä¹ˆåœ¨æ•°è½´ä¸Šè¡¨ç¤ºå¤æ•°å‘¢ï¼Ÿ</p>
<p>ä¹‹å‰æˆ‘ä»¬è¯´è¿‡äº†ï¼Œè™šæ•°å•ä½ $i$ æ‰¾ä¸åˆ°ä¸€ä¸ªåˆé€‚çš„ä¸å…¶å¯¹åº”çš„æ•°è½´ä¸Šçš„ç‚¹ã€‚</p>
<p>é‚£æˆ‘ä»¬åˆ°åº•æ€ä¹ˆåŠå‘¢ï¼Ÿ</p>
<p>äºæ˜¯æœ‰äººåŠ äº†ä¸€æ¡å‚ç›´äºåŸæœ¬æ•°è½´çš„è½´ï¼Œç”¨æ¥è¡¨ç¤ºå¤æ•°çš„è™šéƒ¨ã€‚</p>
<p>å°±åƒè¿™æ ·ï¼š</p>
<img src="https://i.loli.net/2021/10/18/L9kKUvWyAhiconp.png" alt="å‚…é‡Œå¶6.png" width="60%" />

<p>äºæ˜¯æˆ‘ä»¬ä¸¾å‡ ä¸ªä¾‹å­ï¼š</p>
<p><img src="https://i.loli.net/2021/10/19/cgUE58lZkOQJ17G.png" alt="å‚…é‡Œå¶7.png"></p>
<p>æ­¤æ—¶æˆ‘ä»¬å…³æ³¨ä¸€ä¸‹ä¸¤ä¸ªè™šæ•°çš„ç§¯ï¼š</p>
<img src="https://i.loli.net/2021/10/19/RlLhAeVbzxXkHQf.png" alt="å‚…é‡Œå¶8.png" width="60%" />

<p>å¦‚æœæˆ‘ä»¬è¿æ¥è¡¨ç¤ºå¤æ•°çš„ç‚¹å’ŒåŸç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹è§è¿™ä¸‰æ¡çº¿çš„é•¿åº¦åˆ†åˆ«æ˜¯ $\sqrt{3^2+4^2}&#x3D;\sqrt{25}&#x3D;5$ ï¼Œ$\sqrt{5^2+2^2}&#x3D;\sqrt{29}$ ä¸ $\sqrt{14^2+23^2}&#x3D;\sqrt{725} &#x3D;5\sqrt{29}$ ã€‚<br>å‡­å€Ÿå¤§å®¶åšå‡ ä½•é¢˜çš„ç›´è§‰ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ $5+2i$ ä¸ $x$ è½´çš„å¤¹è§’ä¸ $3+4i$ ä¸ $x$ è½´çš„å¤¹è§’ä¹‹å’Œç­‰äº $14+23i$ ä¸ $x$ è½´çš„å¤¹è§’ã€‚<br>è€Œä¸”ï¼Œé€šè¿‡åˆšæ‰çš„ä¾‹å­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹è§ $5+2i$ ä¸åŸç‚¹çš„è¿çº¿çš„é•¿åº¦ä¸ $3+4i$ ä¸åŸç‚¹çš„è¿çº¿çš„é•¿åº¦ä¹‹ç§¯ç­‰äº $14+23i$ ä¸åŸç‚¹è¿çº¿çš„é•¿åº¦ã€‚<br>æ•°å­¦å®¶ä»¬ä¸ºäº†ç®€ä¾¿åœ°è¡¨ç¤ºè¿™äº›ä¸œè¥¿ï¼Œå‘æ˜äº†ä¸¤ä¸ªåè¯ï¼š<strong>å¹…è§’</strong>å’Œ<strong>æ¨¡é•¿</strong>ã€‚<br>æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥è¯´ï¼Œ<strong>ä¸¤ä¸ªå¤æ•°ç›¸ä¹˜æ—¶ï¼Œå¹…è§’ç›¸åŠ ï¼Œæ¨¡é•¿ç›¸ä¹˜ã€‚</strong></p>
<p>è¯æ˜ï¼š</p>
<p>æˆ‘ä»¬è®¾ä¸‰ä¸ªç‚¹åˆ†åˆ«ä¸º $A$  ï¼Œ$B$ ä¸ $C$ ã€‚</p>
<img src="https://i.loli.net/2021/10/19/bVRTm4gy9dDhWnE.png" alt="å‚…é‡Œå¶9.png" width="40%" />

<p>æˆ‘ä»¬åˆ†åˆ«è¿æ¥ $AO$ ï¼Œ $BO$ ä¸ $CO$ ã€‚</p>
<img src="https://i.loli.net/2021/10/19/TpDc6xyqOth5r8l.png" alt="å‚…é‡Œå¶10.png" width="40%" />

<p>å› ä¸º $C$ ç‚¹ä»£è¡¨çš„æ˜¯ $(ac-bd)+(ad+bc)i$ ï¼Œæ‰€ä»¥ $AO$ ï¼Œ $BO$ ä¸ $CO$ çš„é•¿åº¦åˆ†åˆ«æ˜¯ï¼š</p>
<p>$$<br>\begin{align}<br>AO &amp;&#x3D; \sqrt{a^2 + b^2} \\<br>BO &amp;&#x3D; \sqrt{c^2 + d^2} \\<br>CO &amp;&#x3D; \sqrt{(ac - bd)^2 + (ad+bc)^2}<br>\end{align}<br>$$</p>
<p>æˆ‘ä»¬åŒ–ç®€ä¸€ä¸‹ $CO$ çš„è¡¨è¾¾å¼ï¼Œå¯å¾—ï¼š</p>
<p>$$<br>\begin{align}<br>CO &amp; &#x3D; \sqrt{(ac-bd)^2+(ad+bc)^2} \\<br>&amp; &#x3D; \sqrt{a^2 c^2 - 2abcd + b^2 d^2 + a^2 d^2 + 2abcd + b^2 c^2} \\<br>&amp; &#x3D; \sqrt{a^2 (c^2 + d^2) + b^2 (c^2 + d^2)} \\<br>&amp; &#x3D; \sqrt{(a^2 + b^2) (c^2 + d^2)} \\<br>&amp; &#x3D; \sqrt{a^2 + b^2} \times \sqrt{c^2 + d^2} \\<br>&amp; &#x3D; AO \times BO<br>\end{align}<br>$$</p>
<p>æˆ‘ä»¬å¯ä»¥å¾—å‡ºï¼Œ $CO&#x3D;AO \times BO$ è¿™ä¸€ç»“è®ºã€‚</p>
<p>æˆ‘ä»¬å†è¿æ¥ $BC$ ä¸ $AD$ ï¼Œ$D$ ç‚¹ä»£è¡¨ $1+0i$ ã€‚</p>
<img src="https://i.loli.net/2021/10/19/81gGbRmnowh5IpK.png" alt="å‚…é‡Œå¶11.png" width="40%" />

<p>å‡­å€Ÿä½ åšå‡ ä½•é¢˜çš„ç›´è§‰ï¼Œä½ åº”è¯¥çŸ¥é“ $\triangle AOD$ ä¸ $\triangle COB$ çœ‹ä¸Šå»æ˜¯ç›¸ä¼¼çš„ã€‚</p>
<p>æ²¡é”™ï¼Œä»–ä»¬å°±æ˜¯ç›¸ä¼¼çš„ã€‚</p>
<p>è¯æ˜ï¼š</p>
<p>æˆ‘ä»¬å…ˆç®—å‡ºæ¥ $AD$ å’Œ $BC$ çš„æ¨¡é•¿ï¼š</p>
<p>$$<br>\begin{align}<br>AD &amp; &#x3D; \sqrt{(a-1)^2 + b^2} \\<br>BC &amp; &#x3D; \sqrt{(ac-bd-c)^2 + (ad+bc-d)^2} \\<br>&amp; &#x3D; \sqrt{[(a-1)c-bd]^2 +[(a-1)d + bc]^2} \\<br>&amp; &#x3D; \sqrt{(a-1)^2 c^2 - 2(a-1)bcd + b^2 d^2 + (a-1)^2 d^2 + 2(a-1)bcd + b^2 c^2} \\<br>&amp; &#x3D; \sqrt{(a-1)^2 (c^2 + d^2) + b^2 (c^2 + d^2)} \\<br>&amp; &#x3D; \sqrt{[(a-1)^2 + b^2] (c^2 + d^2)} \\<br>&amp; &#x3D; \sqrt{(a-1)^2 + b^2} \times \sqrt{c^2 + d^2} \\<br>&amp; &#x3D; AD \times BO<br>\end{align}<br>$$</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬è¯æ˜ä¸¤ä¸‰è§’å½¢ç›¸ä¼¼ï¼š</p>
<p>$$<br>\begin{gather}<br>\because<br>CO &#x3D; AO \times BO , DO &#x3D; 1 \\<br>\therefore \frac{CO}{AO} &#x3D; \frac{BO}{DO} \\<br>\because BC &#x3D; AD \times BO\\<br>\therefore \frac{BC}{AD} &#x3D; BO \\<br>\therefore \frac{CO}{AO} &#x3D; \frac{BO}{DO} &#x3D; \frac{BC}{AD} \\<br>\therefore \triangle COB \sim \triangle AOD \\<br>\therefore \angle DOA &#x3D; \angle BOC \\<br>\because \angle DOC &#x3D; \angle DOB + \angle BOC \\<br>\therefore \angle DOC &#x3D; \angle DOB + \angle DOA<br>\end{gather}<br>$$</p>
<p>è¯æ¯•ã€‚</p>
<h2 id="å•ä½æ ¹"><a href="#å•ä½æ ¹" class="headerlink" title="å•ä½æ ¹"></a>å•ä½æ ¹</h2><p>ç°åœ¨æˆ‘ä»¬æ¥ä»‹ç»å•ä½æ ¹ã€‚</p>
<p>å•ä½æ ¹çš„æ„ä¹‰æ˜¯ $n$ æ¬¡æ–¹ä¸º 1 çš„å¤æ•°ï¼Œä¹Ÿå°±æ˜¯ $x^n&#x3D;1$ çš„å¤æ•°è§£ã€‚</p>
<p>å¦‚æœä½ å­¦è¿‡ä¸‰è§’å‡½æ•°çš„è¯ä½ åº”è¯¥ååˆ†æ¸…æ¥šä»€ä¹ˆæ˜¯å•ä½åœ†ã€‚<br>è€Œå•ä½åœ†å¯ä»¥å¸®æˆ‘ä»¬æ›´å¥½åœ°ç†è§£ä»€ä¹ˆæ˜¯å•ä½æ ¹å’Œå•ä½æ ¹ä¸ºä»€ä¹ˆèƒ½å¤Ÿä»£å…¥ä¹‹åèƒ½å®ç°åˆ†æ²»ã€‚</p>
<p>æˆ‘ä»¬å…ˆç”»å‡ºä¸€ä¸ªå•ä½åœ†ï¼š</p>
<img src="https://i.loli.net/2021/10/20/Eg1hOysmtHIK7YZ.png" alt="å‚…é‡Œå¶12.png" width="60%" />

<p>æˆ‘ä»¬çŸ¥é“ï¼Œ $1^n&#x3D;1$ ï¼Œæ‰€ä»¥å•ä½æ ¹çš„å…¶ä¸­ä¸€ä¸ªä¸€å®šæ˜¯ $1$ ã€‚</p>
<p>æˆ‘ä»¬è¿æ¥ $1$ å’Œ $0$ ã€‚</p>
<img src="https://i.loli.net/2021/10/20/ewkq5Hsl2Xh8iDn.png" alt="å‚…é‡Œå¶13.png" width="60%" />

<p>æˆ‘ä»¬åœ¨è¿™é‡Œä¸¾ä¸€ä¸ª $n&#x3D;4$ çš„æ —å­æ¥å¸®åŠ©æˆ‘ä»¬ç†è§£å•ä½æ ¹ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œ $(\pm i)^2 &#x3D; -1$ ï¼Œè€Œ $-1^2&#x3D;1$ ï¼Œ<br>æ‰€ä»¥ $i$ å’Œ $-i$ ä¹Ÿæ˜¯ $n&#x3D;4$ æ—¶çš„ä¸¤ä¸ªå•ä½æ ¹ã€‚<br>å½“ç„¶ï¼Œå› ä¸º $(-1)^2&#x3D;1$ ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ä¸¢ä¸‹-1ã€‚</p>
<img src="https://i.loli.net/2021/10/20/ZgXGK4ioqftFAHa.png" alt="å‚…é‡Œå¶14.png" width="60%" />

<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å°±æ‰¾é½äº† $n&#x3D;4$ æ—¶çš„æ‰€æœ‰å•ä½æ ¹ã€‚<br>æˆ‘ä»¬è®°å•ä½æ ¹åˆ†åˆ«ä¸º $Ï‰^0_4 , Ï‰^1_4 , Ï‰^2_4 , Ï‰^3_4$ ã€‚</p>
<p>ä½†å“ªä¸ªå¯¹åº”å“ªä¸ªå‘¢ï¼Ÿ</p>
<img src="https://i.loli.net/2021/10/20/pRgxdBbhqrAvweP.png" alt="å‚…é‡Œå¶15.png" width="60%" />

<p>å½“æˆ‘ä»¬è§‚å¯Ÿå›¾åƒçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°è¿™å››ä¸ªç‚¹ä¸åŸç‚¹çš„è¿çº¿å¯ä»¥å¹³åˆ†è¿™ä¸€ä¸ªå•ä½åœ†ã€‚<br>æ¯ç›¸é‚»ä¸¤æ¡çº¿ä¹‹é—´çš„å¤¹è§’éƒ½æ˜¯ $90^{\circ}$ ã€‚</p>
<p>å½“æˆ‘ä»¬æ¨å¹¿åˆ° $n&#x3D;8$ çš„æ—¶å€™ã€‚æˆ‘ä»¬å¯ä»¥å¦å¤–å¾—åˆ° $\frac{1}{\sqrt2}+\frac{1}{\sqrt2}i , \frac{1}{\sqrt2}-\frac{1}{\sqrt2}i , -\frac{1}{\sqrt2}+\frac{1}{\sqrt2}i , -\frac{1}{\sqrt2}-\frac{1}{\sqrt2}i$ å››ä¸ªå•ä½æ ¹ã€‚</p>
<p>æˆ‘ä»¬æŠŠä»–ä»¬è¡¨ç¤ºåœ¨å¤å¹³é¢ä¸Šä¹‹åä¼šæ˜¯è¿™æ ·ä¸€ä¸ªæƒ…å†µï¼š</p>
<img src="https://i.loli.net/2021/10/20/jXxYvVbk6ITR5Fc.png" alt="å‚…é‡Œå¶16.png" width="60%" />

<p>æˆ‘ä»¬ä¼šå‘ç°ï¼Œæ–°å¢çš„è¿™å››ä¸ªå•ä½æ ¹æ‰€å¯¹åº”çš„ç‚¹ä¹Ÿåœ¨åœ†ä¸Šï¼Œä¸”æ‰€æœ‰çš„è¿™å‡ ä¸ªç‚¹ä¸åœ†å¿ƒ\åŸç‚¹çš„è¿çº¿å¹³åˆ†è¿™ä¸ªå•ä½åœ†ä¸º8ä»½ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿™æ ·ç†è§£ï¼Œæ‰€æœ‰çš„ $Ï‰_n^{0 \to n-1}$ ä¸åŸç‚¹çš„è¿çº¿å¯ä»¥å¹³åˆ†å•ä½åœ†ä¸º $n$ ä»½ï¼Œä¸”æ¯ç›¸é‚»ä¸¤æ¡çº¿ä¹‹é—´çš„å¤¹è§’éƒ½æ˜¯ $\frac{2Ï€}{n}$ ï¼ˆå³ $\frac{360}{n}^{\circ}$ ï¼‰</p>
<p>è¿™æ ·å°±å¥½ç¼–å·äº†ï¼šä» $1$ å¼€å§‹ï¼Œé€†æ—¶é’ˆç¼–å·ã€‚</p>
<p>ä¸¾ä¸ªæ —å­ï¼š</p>
<p>$Ï‰_8^{0 \to 7}$ çš„å€¼åˆ†åˆ«ä¸º $1 , \frac{1}{\sqrt2} + \frac{1}{\sqrt2}i , i , -\frac{1}{\sqrt2} + \frac{1}{\sqrt2}i , -1 , -\frac{1}{\sqrt2} - \frac{1}{\sqrt2}i , -i , \frac{1}{\sqrt2} - \frac{1}{\sqrt2}$ ã€‚</p>
<p>p.s.:è™½ç„¶æˆ‘ä»¬åªæ‰¿è®¤ $Ï‰_n^k$ ä¸­çš„ $0\leq k &lt; n$ çš„æƒ…å†µï¼Œä½†æ˜¯ $k\geq n$ å’Œ $k&lt;0$ çš„æƒ…å†µè¿˜æ˜¯æœ‰çš„ï¼Œè¿™å°±è·Ÿ $\geq 2Ï€$ ï¼ˆå³ $360^{\circ}$ ï¼‰å’Œ $&lt;0$ ï¼ˆå³ $0^{\circ}$ ï¼‰çš„è§’ä¸€æ ·ã€‚</p>
<h3 id="å•ä½æ ¹çš„æ€§è´¨"><a href="#å•ä½æ ¹çš„æ€§è´¨" class="headerlink" title="å•ä½æ ¹çš„æ€§è´¨"></a>å•ä½æ ¹çš„æ€§è´¨</h3><p>å•ä½æ ¹æœ‰å¾ˆå¤šæ€§è´¨ï¼Œè¿™é‡Œä¼šåˆ—ä¸¾å‡ ä¸ªã€‚å…¶ä¸­ï¼Œæœ€åä¸€ä¸ªæ˜¯æœ€é‡è¦çš„ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬é€‰æ‹©ä»£å…¥å•ä½æ ¹çš„åŸå› ã€‚</p>
<ol>
<li>$Ï‰^a_n + Ï‰^b_n &#x3D; Ï‰_n^{a+b}$</li>
</ol>
<p>  å¯ä»¥ä»æŠŠå•ä½æ ¹ç±»æ¯”æˆåˆ‡è›‹ç³•çš„æ–¹æ³•å»ç†è§£ã€‚</p>
<ol start="2">
<li>$(Ï‰^1_n)^k &#x3D; Ï‰^k_n$</li>
</ol>
<p>  å¯ä»¥ç†è§£æˆæŠŠ $k$ å—è›‹ç³•æ‹¼èµ·æ¥ã€‚</p>
<ol start="3">
<li>$Ï‰_{Î»n}^{Î»k} &#x3D; Ï‰_n^k$</li>
</ol>
<p>  åŒå¯ä»¥ç†è§£æˆæŠŠä¸€å—è›‹ç³•å¹³å‡åˆ‡æˆ $\lambda$ å—ã€‚</p>
<ol start="4">
<li>$Ï‰^k_{2n} &#x3D; - Ï‰_{2n}^{(k+n)\bmod{n}}$</li>
</ol>
<p>  è¿™æ˜¯æœ€é‡è¦çš„ä¸€æ¡ã€‚<br>  è¿™æ¡çš„è¯æ˜å¯ä»¥åœ¨å¤å¹³é¢ä¸Šæ¸…æ™°çš„çœ‹å‡ºã€‚</p>
<img src="https://i.loli.net/2021/10/20/Huv9WglE7MbLTAj.png" alt="å‚…é‡Œå¶17.png" width="60%" />

<p>è¿™ä¸€æ¡æ€§è´¨æ˜¯æˆ‘ä»¬é€‰æ‹©ä»£å…¥å•ä½æ ¹çš„åŸå› ã€‚ä½†ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p>
<h1 id="FFT"><a href="#FFT" class="headerlink" title="FFT"></a>FFT</h1><h2 id="åˆ†æ²»"><a href="#åˆ†æ²»" class="headerlink" title="åˆ†æ²»"></a>åˆ†æ²»</h2><p>å‚…é‡Œå¶æŠŠå¤šé¡¹å¼ $f(x)$ æŒ‰ç…§æ¬¡æ•°åˆ†æˆå¥‡å¶ä¸¤éƒ¨åˆ†ã€‚ï¼ˆå¿˜äº†çš„å‘å‰ç¿»å†çœ‹ä¸€éï¼‰</p>
<p>å³ï¼Œ<br>$$<br>\begin{align}<br>f(x) &amp;&#x3D; \sum^n_{i&#x3D;0} a_i x^{n-i} \\<br>&amp;&#x3D; \sum_{i&#x3D;0}^{\frac{n}{2}} a_i x^{n-2i} + \sum_{i&#x3D;0}^{\frac{n}{2}} a_{i+1} x^{n-2i-1}<br>\end{align}<br>$$<br>æˆ‘ä»¬ç§° $\displaystyle \sum_{i&#x3D;0}^{\frac{n}{2}} a_{i+1} x^{n-2i-1}$ ä¸º $f_o(x)$ ï¼Œ ç§° $\displaystyle \sum_{i&#x3D;0}^{\frac{n}{2}} a_i x^{n-2i}$ ä¸º $f_e(x)$ ã€‚</p>
<p>æ­¤æ—¶æˆ‘ä»¬æŠŠå¼å­åŒ–ç®€ä¸€ä¸‹ï¼Œå¯å¾—<br>$$<br>f(x) &#x3D; f_e(x^2) + x f_o(x^2)<br>$$</p>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬æƒ³è¦è®¡ç®— $f(x)$ çš„è¯ï¼Œåªéœ€è¦è®¡ç®— $f_e(x)$ ä¸ $f_o(x)$ å³å¯ã€‚<br>å½“ç„¶ï¼Œæˆ‘ä»¬è®¡ç®— $f_e(x)$ ä¸ $f_o(x)$ çš„æ—¶å€™ï¼Œä¹Ÿåƒåˆšæ‰æˆ‘ä»¬åˆ†è§£ $f(x)$ ä¸€æ ·ï¼ŒæŠŠå®ƒä»¬åˆ†è§£æ‰ã€‚<br>æœ€ç»ˆæˆ‘ä»¬å¯ä»¥è¾¾åˆ°åˆ†æ²»çš„æ•ˆæœã€‚</p>
<p>è€Œæˆ‘ä»¬ä¸å¯èƒ½å¯¹äºæ‰€æœ‰çš„ç‚¹éƒ½è¿›è¡Œå®é™…çš„ä»£å…¥æ±‚å€¼è¿ç®—ï¼Œé‚£æ ·ä¼šçˆ†ç²¾åº¦ã€‚</p>
<h2 id="ä»£å…¥æ±‚å€¼"><a href="#ä»£å…¥æ±‚å€¼" class="headerlink" title="ä»£å…¥æ±‚å€¼"></a>ä»£å…¥æ±‚å€¼</h2><p>æˆ‘ä»¬åˆšåˆšä»‹ç»äº†å•ä½æ ¹çš„æ€§è´¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä»£å…¥å•ä½æ ¹æ¥ç®€åŒ–è¿ç®—ã€‚</p>
<p>æ€ä¹ˆç®€åŒ–ï¼Ÿ</p>
<p>æˆ‘ä»¬å°è¯•è¿‡ä»£å…¥å‡ ä¸ªæ•´æ•°æ¥æ±‚å€¼ï¼Œä½†æ˜¯é‚£æ ·å­å¤æ‚åº¦ä¼šçˆ†æ‰ã€‚</p>
<p>ç„¶åæˆ‘ä»¬å°±æƒ³åˆ°äº†ä»£å…¥ç›¸åæ•°ã€‚<br>è¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬åªéœ€è¦æ±‚å‡ºä¸€åŠçš„å€¼ï¼Œå°±å¯ä»¥å¾—åˆ°å¦å¤–çš„æ‰€æœ‰å€¼äº†ã€‚</p>
<p>æˆ‘ä»¬è¿˜å¯ä»¥å†å¿«ï¼Œå³è¿›è¡Œåˆ†æ²»ã€‚</p>
<p>ä½†æ˜¯ï¼Œåˆ†æ²»è¦æ±‚æˆ‘ä»¬æ¯ä¸€æ¬¡åˆ†æ²»ä»£å…¥çš„å€¼éƒ½ä¸ºç›¸åæ•°ï¼Œè¿™è¦æ±‚äº†ä¸€å¯¹ç›¸åæ•°çš„å¹³æ–¹ä»ä¸ºç›¸åæ•°ã€‚<br>äºæ˜¯æˆ‘ä»¬å°±æ‰¾åˆ°äº†å•ä½æ ¹ã€‚</p>
<p>æˆ‘ä»¬ä»£å…¥ $Ï‰^k_n$ ï¼ˆ$0 \leq k &lt; \dfrac{n}{2}$ï¼‰ï¼Œå¯å¾—ï¼š<br>$$<br>\begin{align}<br>f(Ï‰^k_n) &amp;&#x3D; f_e((Ï‰^k_n)^2) + Ï‰^k_n f_o((Ï‰^k_n)^2) \\<br>&amp;&#x3D; f_e (Ï‰^k_{\frac{n}{2}}) + Ï‰^k_n f_o(Ï‰^k_{\frac{n}{2}})<br>\end{align}<br>$$</p>
<p>æ­¤æ—¶æˆ‘ä»¬å¯¹è¿™ä¸ªå¼å­è¿›è¡Œç¨ç¨çš„å˜åŠ¨ï¼Œå¯å¾—ï¼š<br>$$<br>\begin{align}<br>f(Ï‰^k_n) &amp;&#x3D; f_e((Ï‰^k_n)^2) + Ï‰^k_n f_o((Ï‰^k_n)^2) \\<br>f(Ï‰_n^{k+\frac{n}{2}}) &amp;&#x3D; f_e((Ï‰_n^{k+\frac{n}{2}})^2) + Ï‰_n^{k+\frac{n}{2}} f_o((Ï‰_n^{k+\frac{n}{2}})^2) \\<br>&amp;&#x3D; f_e (Ï‰_n^{2k+n}) + Ï‰_n^{k+\frac{n}{2}} f_o(Ï‰_n^{2k+n}) \\<br>&amp;&#x3D; f_e (Ï‰_n^{2k}) + Ï‰_n^{k+\frac{n}{2}} f_o(Ï‰_n^{2k}) \\<br>&amp;&#x3D; f_e (Ï‰_{\frac{n}{2}}^k) + Ï‰_n^{k+\frac{n}{2}} f_o(Ï‰_{\frac{n}{2}}^k) \\<br>&amp;&#x3D; f_e (Ï‰_{\frac{n}{2}}^k) - Ï‰^k_n f_o(Ï‰_{\frac{n}{2}}^k) \\<br>\end{align}<br>$$</p>
<p>é€šè¿‡ $\begin{cases} f(Ï‰_n^k)&#x3D;f_e(Ï‰_{\frac{n}{2}}^k)+Ï‰^k_nf_o(Ï‰_{\frac{n}{2}}^k) \\ f(Ï‰_n^{k+\frac{n}{2}})&#x3D;f_e (Ï‰_{\frac{n}{2}}^k) - Ï‰_n^k f_o(Ï‰_{\frac{n}{2}}^k)\end{cases}$ è¿™ä¸¤ä¸ªå¼å­ï¼Œæˆ‘ä»¬ç†è®ºä¸Šæ˜¯å¯ä»¥æ±‚å‡ºæ‰€æœ‰ç‚¹å€¼çš„ã€‚å› ä¸º $f_e(x)$ ä¸ $f_o(x)$ ç†è®ºä¸Šåªæœ‰ $f(x)$ æ¬¡æ•°çš„ä¸€åŠï¼Œåªèƒ½å¾—åˆ°å®Œæ•´åœ°æ±‚å‡º $f(x)$ æ‰€éœ€è¦çš„ç‚¹å€¼çš„ä¸€åŠã€‚è€Œä¸¤ä¸ªå¼å­åˆ†åˆ«èƒ½æ±‚å‡ºä¸€åŠä¸”äº’ä¸é‡å¤ï¼Œåˆèµ·æ¥å°±æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„æ‰€æœ‰ç‚¹å€¼äº†ã€‚</p>
<p>ä½†æ˜¯å½“æˆ‘ä»¬é‡åˆ°æŸä¸€å±‚çš„ $f(x)$ æ˜¯å¥‡æ•°æ¬¡çš„æ—¶å€™ï¼Œæˆ‘ä»¬åº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p>
<p>ç­”æ¡ˆæ˜¯ï¼šè‡ªå·±è¡¥ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨ä¸ºè¿™ä¸ªå¤šé¡¹å¼è¡¥æˆ2çš„æ•´æ•°æ¬¡å¹‚æ¬¡ã€‚å½“ç„¶ï¼Œæ˜¯åœ¨ä¸å½±å“å¤šé¡¹å¼æ•´ä½“çš„å€¼å¾—å‰æä¸‹ï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹©è¡¥0ï¼Œå³æˆ‘ä»¬è¡¥ä¸Šå»çš„æ‰€æœ‰çš„ $a_k$ éƒ½æ˜¯0ã€‚</p>
<h1 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h1><h2 id="DFT-1"><a href="#DFT-1" class="headerlink" title="DFT"></a>DFT</h2><h3 id="å¤æ•°ç»“æ„ä½“"><a href="#å¤æ•°ç»“æ„ä½“" class="headerlink" title="å¤æ•°ç»“æ„ä½“"></a>å¤æ•°ç»“æ„ä½“</h3><p>ä¸ºäº†è¡¨ç¤ºæ–¹ä¾¿ï¼Œæˆ‘ä»¬ä½¿ç”¨ç»“æ„ä½“æ¥è¡¨ç¤ºå¤æ•°ã€‚</p>
<p>æˆ‘ä»¬åŒæ—¶é‡è½½ä¸€ä¸‹è¿ç®—ç¬¦ï¼Œä»¥ä¾¿åšå¤æ•°ä¹‹é—´çš„å››åˆ™è¿ç®—ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> str;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Comp</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">Comp</span>(<span class="type">double</span> xx = <span class="number">0</span>, <span class="type">double</span> yy = <span class="number">0</span>) &#123; x = xx, y = yy; &#125;</span><br><span class="line">    <span class="type">double</span> x, y;</span><br><span class="line">    Comp <span class="keyword">operator</span> + (Comp <span class="type">const</span> &amp;B) <span class="type">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Comp</span>(x + B.x, y + B.y);</span><br><span class="line">    &#125;</span><br><span class="line">    Comp <span class="keyword">operator</span> - (Comp <span class="type">const</span> &amp;B) <span class="type">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Comp</span>(x - B.x, y - B.y);</span><br><span class="line">    &#125;</span><br><span class="line">    Comp <span class="keyword">operator</span> * (Comp <span class="type">const</span> &amp;B) <span class="type">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Comp</span>(x * B.x - y * B.y, x * B.y + y * B.x);</span><br><span class="line">    &#125;</span><br><span class="line">    Comp <span class="keyword">operator</span> / (Comp <span class="type">const</span> &amp;B) <span class="type">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">double</span> t = B.x * B.x + B.y * B.y;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Comp</span>((x * B.x + y * B.y) / t, (y * B.x - x * B.y) / t);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;a, b;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">write</span><span class="params">(Comp n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">bool</span> flag = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span>(n.x &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; n.x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(n.x &lt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;(&#x27;</span>);</span><br><span class="line">        flag = <span class="literal">true</span>;</span><br><span class="line">        cout &lt;&lt; n.x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(n.y &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(n.x != <span class="number">0</span>)<span class="built_in">putchar</span>(<span class="string">&#x27;+&#x27;</span>);</span><br><span class="line">        cout &lt;&lt; n.y;</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;i&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(n.x == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">putchar</span>(<span class="string">&#x27;(&#x27;</span>);</span><br><span class="line">            flag = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; n.y;</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;i&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(flag)<span class="built_in">putchar</span>(<span class="string">&#x27;)&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; a.x &gt;&gt; a.y &gt;&gt; b.x &gt;&gt; b.y;</span><br><span class="line">    Comp c;</span><br><span class="line">    c = a + b;</span><br><span class="line">    <span class="built_in">write</span>(a), <span class="built_in">putchar</span>(<span class="string">&#x27;+&#x27;</span>), <span class="built_in">write</span>(b), <span class="built_in">putchar</span>(<span class="string">&#x27;=&#x27;</span>), <span class="built_in">write</span>(c), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    c = a - b;</span><br><span class="line">    <span class="built_in">write</span>(a), <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), <span class="built_in">write</span>(b), <span class="built_in">putchar</span>(<span class="string">&#x27;=&#x27;</span>), <span class="built_in">write</span>(c), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    c = a * b;</span><br><span class="line">    <span class="built_in">write</span>(a), <span class="built_in">putchar</span>(<span class="string">&#x27;*&#x27;</span>), <span class="built_in">write</span>(b), <span class="built_in">putchar</span>(<span class="string">&#x27;=&#x27;</span>), <span class="built_in">write</span>(c), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    c = a / b;</span><br><span class="line">    <span class="built_in">write</span>(a), <span class="built_in">putchar</span>(<span class="string">&#x27;/&#x27;</span>), <span class="built_in">write</span>(b), <span class="built_in">putchar</span>(<span class="string">&#x27;=&#x27;</span>), <span class="built_in">write</span>(c), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>$\color[rgb]{1,1,0.0625}{Ï†}$</p>
<h3 id="é¢„å¤„ç†å•ä½æ ¹"><a href="#é¢„å¤„ç†å•ä½æ ¹" class="headerlink" title="é¢„å¤„ç†å•ä½æ ¹"></a>é¢„å¤„ç†å•ä½æ ¹</h3><p>æˆ‘ä»¬ä¹‹å‰åº”è¯¥æåˆ°è¿‡ä»€ä¹ˆæ˜¯å•ä½æ ¹ã€‚ä½†æ˜¯æ€ä¹ˆå¿«é€Ÿæ±‚å‡ºæˆ‘ä»¬éœ€è¦ç”¨çš„æ‰€æœ‰å•ä½æ ¹å‘¢ï¼Ÿ<br>å¼€æ ¹å·çš„æ–¹æ³•å¤ªæ…¢äº†ï¼Œæ‰“è¡¨åˆå¤ªéš¾ã€‚<br>æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ä¸‰è§’å‡½æ•°ã€‚<br>æ²¡å­¦è¿‡ä¸‰è§’å‡½æ•°çš„å¯ä»¥è‡ªå·±å…ˆå­¦ä¸€ä¸‹<del>ï¼ˆè¯è¯´ä¸ºä»€ä¹ˆä½ ä¼šå…ˆå­¦å‚…é‡Œå¶å˜æ¢ï¼Ÿï¼‰</del><br>æˆ‘ä»¬é¦–å…ˆæ±‚å‡º $Ï‰^1_n$ ã€‚</p>
<p>[anime here]</p>
<p>C++çš„ä¸‰è§’å‡½æ•°é‡‡ç”¨çš„æ˜¯å¼§åº¦åˆ¶ã€‚è€Œåˆšæ‰æˆ‘ä»¬å·²ç»ä»‹ç»è¿‡ä»€ä¹ˆæ˜¯å¼§åº¦äº†ã€‚</p>
<p>æ‰€ä»¥ï¼Œ $Ï‰^1_n$ å°±ç­‰äº $\cos(\dfrac{2Ï€}{n})+\sin(\dfrac{2Ï€}{n})i$ ã€‚</p>
<p>æŠŠå¾—åˆ°çš„ç»“æœä¾æ¬¡ä¹˜èµ·æ¥å°±æ˜¯æ‰€æœ‰çš„å•ä½æ ¹ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> Maxn 1000500</span></span><br><span class="line"><span class="comment">//ç”¨è¿™å¥è¯èƒ½å¾—åˆ°å¾—åˆ°ç²¾ç¡®çš„Ï€</span></span><br><span class="line"><span class="comment">//ä½†æ˜¯å®é™…ä¸Šå¹¶æ²¡æœ‰è‡ªå·±æ‰‹åŠ¨æ‰“æ›´ç²¾ç¡®</span></span><br><span class="line"><span class="comment">//æ¯”å¦‚è¯´ä¸‹ä¸€ä¸ªä»£ç å°±æ˜¯æˆ‘è‡ªå·±æ‰‹æ‰“çš„</span></span><br><span class="line"><span class="type">const</span> <span class="type">double</span> Pi = <span class="built_in">acos</span>(<span class="number">-1</span>);</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CP</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">CP</span>(<span class="type">double</span> xx = <span class="number">0</span>, <span class="type">double</span> yy = <span class="number">0</span>) &#123; x = xx, y = yy; &#125;</span><br><span class="line">    <span class="type">double</span> x, y;</span><br><span class="line">    CP <span class="keyword">operator</span> + (CP <span class="type">const</span> &amp;B) <span class="type">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">CP</span>(x + B.x, y + B.y);</span><br><span class="line">    &#125;</span><br><span class="line">    CP <span class="keyword">operator</span> - (CP <span class="type">const</span> &amp;B) <span class="type">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">CP</span>(x - B.x, y - B.y);</span><br><span class="line">    &#125;</span><br><span class="line">    CP <span class="keyword">operator</span> * (CP <span class="type">const</span> &amp;B) <span class="type">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">CP</span>(x * B.x - y * B.y, x * B.y + y * B.x);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//é™¤æ³•æ²¡ç”¨</span></span><br><span class="line">&#125;w[Maxn];</span><br><span class="line"><span class="comment">//wé•¿å¾—æ˜¯ä¸æ˜¯å¾ˆåƒÏ‰?</span></span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="function">CP <span class="title">sav</span><span class="params">(cos(<span class="number">2</span> * Pi / n), sin(<span class="number">2</span> * Pi / n))</span>, <span class="title">buf</span><span class="params">(<span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="built_in">f_or</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        w[i] = buf;</span><br><span class="line">        buf = buf * sav;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">f_or</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;w[%d][n]=(%.4lf,%.4lf)\n&quot;</span>, i, w[i].x, w[i].y);</span><br><span class="line">    <span class="comment">//ç”±äºç²¾åº¦é—®é¢˜ä¼šå‡ºç°-0.0000çš„æƒ…å†µ,å°†å°±çœ‹å§</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3Uub3JnL2Jsb2cvY29tbWFuZC1ibG9jay9mZnQteHVlLXhpLWJpLWpp">$\blacktriangleright$<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="é€’å½’å®ç°"><a href="#é€’å½’å®ç°" class="headerlink" title="é€’å½’å®ç°"></a>é€’å½’å®ç°</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> Maxn 1350000</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> Pi = <span class="number">3.1415926535897932394626433832795</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CP</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">CP</span>(<span class="type">double</span> xx = <span class="number">0</span>, <span class="type">double</span> yy = <span class="number">0</span>) &#123; x = xx, y = yy; &#125;</span><br><span class="line">    <span class="type">double</span> x, y;</span><br><span class="line">    CP <span class="keyword">operator</span> + (CP <span class="type">const</span> &amp;B) <span class="type">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">CP</span>(x + B.x, y + B.y);</span><br><span class="line">    &#125;</span><br><span class="line">    CP <span class="keyword">operator</span> - (CP <span class="type">const</span> &amp;B) <span class="type">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">CP</span>(x - B.x, y - B.y);</span><br><span class="line">    &#125;</span><br><span class="line">    CP <span class="keyword">operator</span> * (CP <span class="type">const</span> &amp;B) <span class="type">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">CP</span>(x * B.x - y * B.y, x * B.y + y * B.x);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//é™¤æ³•è¿™é‡Œæ²¡ç”¨</span></span><br><span class="line">&#125;f[Maxn &lt;&lt; <span class="number">1</span>], sav[Maxn &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dft</span><span class="params">(CP *f, <span class="type">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(len == <span class="number">1</span>)<span class="keyword">return</span>;<span class="comment">//è¾¹ç•Œ</span></span><br><span class="line">    <span class="comment">//æŒ‡é’ˆçš„ä½¿ç”¨æ¯”è¾ƒå·§å¦™ </span></span><br><span class="line">    CP *fl = f, *fr = f + len / <span class="number">2</span>;</span><br><span class="line">    <span class="built_in">f_or</span>(<span class="type">int</span> k = <span class="number">0</span>; k &lt; len; k++)sav[k] = f[k];</span><br><span class="line">    <span class="built_in">f_or</span>(<span class="type">int</span> k = <span class="number">0</span>; k &lt; len / <span class="number">2</span>; k++)<span class="comment">//åˆ†å¥‡å¶æ‰“ä¹±</span></span><br><span class="line">    &#123;</span><br><span class="line">        fl[k] = sav[k &lt;&lt; <span class="number">1</span>]; fr[k] = sav[k &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dft</span>(fl, len / <span class="number">2</span>);</span><br><span class="line">    <span class="built_in">dft</span>(fr, len / <span class="number">2</span>);<span class="comment">//å¤„ç†å­é—®é¢˜</span></span><br><span class="line">    <span class="comment">//ç”±äºæ¯æ¬¡ä½¿ç”¨çš„å•ä½æ ¹æ¬¡æ•°ä¸åŒ(lenæ¬¡å•ä½æ ¹),æ‰€ä»¥è¦é‡æ–°æ±‚ã€‚</span></span><br><span class="line">    <span class="function">CP <span class="title">tG</span><span class="params">(cos(<span class="number">2</span> * Pi / len), sin(<span class="number">2</span> * Pi / len))</span>, <span class="title">buf</span><span class="params">(<span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="built_in">f_or</span>(<span class="type">int</span> k = <span class="number">0</span>; k &lt; len / <span class="number">2</span>; k++)</span><br><span class="line">    &#123;</span><br><span class="line"><span class="comment">//è¿™é‡Œbuf = (lenæ¬¡å•ä½æ ¹çš„ç¬¬kä¸ª) </span></span><br><span class="line">        sav[k] = fl[k] + buf * fr[k];<span class="comment">//(1)</span></span><br><span class="line">        sav[k + len / <span class="number">2</span>] = fl[k] - buf * fr[k];<span class="comment">//(2)</span></span><br><span class="line">        <span class="comment">//è¿™ä¸¤æ¡è¯­å¥å…·ä½“è§ä¸Šé¢çš„å¼å­</span></span><br><span class="line">        buf = buf * tG;<span class="comment">//å¾—åˆ°ä¸‹ä¸€ä¸ªå•ä½æ ¹ã€‚</span></span><br><span class="line">    &#125;<span class="built_in">f_or</span>(<span class="type">int</span> k = <span class="number">0</span>; k &lt; len; k++)f[k] = sav[k];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="built_in">f_or</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)<span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>, &amp;f[i].x);</span><br><span class="line">    <span class="comment">//ä¸€å¼€å§‹éƒ½æ˜¯å®æ•°,è™šéƒ¨ä¸º0</span></span><br><span class="line">    <span class="built_in">f_or</span>(m = <span class="number">1</span>; m &lt; n; m &lt;&lt;= <span class="number">1</span>);</span><br><span class="line">    <span class="comment">//æŠŠé•¿åº¦è¡¥åˆ°2çš„å¹‚,ä¸å¿…æ‹…å¿ƒé«˜æ¬¡é¡¹çš„ç³»æ•°,å› ä¸ºé»˜è®¤ä¸º0</span></span><br><span class="line">    <span class="built_in">dft</span>(f, m);</span><br><span class="line">    <span class="built_in">f_or</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; ++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;(%.4f,%.4f)\n&quot;</span>, f[i].x, f[i].y);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3Uub3JnL2Jsb2cvY29tbWFuZC1ibG9jay9mZnQteHVlLXhpLWJpLWpp">$\blacktriangleright$<i class="fa fa-external-link-alt"></i></span></p>
<p>å¥½äº†ï¼Œæˆ‘ç›¸ä¿¡ä½ å·²ç»å­¦ä¼šäº†åˆ©ç”¨DFTæŠŠå¤šé¡¹å¼æ‹†æˆä¸€ç³»åˆ—ç‚¹å€¼äº†ã€‚</p>
<p>ä½†æ˜¯æˆ‘ä»¬æ€ä¹ˆæŠŠè¿™äº›ç‚¹å€¼è¿˜åŸä¸ºå¤šé¡¹å¼å‘¢ï¼Ÿ</p>
<h1 id="IDFT"><a href="#IDFT" class="headerlink" title="IDFT"></a>IDFT</h1><p>IDFTåªéœ€è¦æ”¹å˜DFTä¸­çš„ä¸€ç‚¹ä¸œè¥¿å°±å¯ä»¥å¾—åˆ°ã€‚</p>
<p>å› ä¸ºæˆ‘ä»¬ä»£å…¥çš„æ—¶å€™ï¼Œå¾—åˆ°äº†ä¸€ä¸ªç‚¹å€¼åºåˆ—ï¼Œæˆ‘ä»¬åœ¨æ­¤ç§°å…¶ä¸º $u$ ï¼Œè€Œ $\displaystyle u[k]&#x3D;\sum_{i&#x3D;0}^{n-1} (Ï‰^k_n)^i f(i)$ ï¼Œæ‰€ä»¥ $\displaystyle f(i) &#x3D; \frac{\sum\limits_{i&#x3D;0}^{n-1} (Ï‰_n^{-k})^i u[i]}{n}$ ã€‚</p>
<p>å…·ä½“çš„è¯æ˜è¿‡ç¨‹ç›®å‰è¯·è§<span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3UuY29tLmNuL2Jsb2cvY29tbWFuZC1ibG9jay9mZnQteHVlLXhpLWJpLWpp">è¿™é‡Œ<i class="fa fa-external-link-alt"></i></span> ã€‚è¿™ä¸ªè¯æ˜æ¶‰åŠåˆ°äº†å•ä½æ ¹åæ¼”ï¼Œå¯ä»¥å†å†™ä¸€ç¯‡åšå®¢ï¼Œæ‰€ä»¥æˆ‘ç­‰å†™åˆ°çš„æ—¶å€™å†è¡¥å…¨è¯æ˜ã€‚</p>
<p>ä¸Šä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1350010</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> Pi = <span class="number">3.1415926535897932384626433832795</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CP</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">CP</span>(<span class="type">double</span> xx = <span class="number">0</span>, <span class="type">double</span> yy = <span class="number">0</span>) &#123; x = xx, y = yy; &#125;</span><br><span class="line">    <span class="type">double</span> x, y;</span><br><span class="line">    CP <span class="keyword">operator</span> + (CP <span class="type">const</span> &amp;B) <span class="type">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">CP</span>(x + B.x, y + B.y);</span><br><span class="line">    &#125;</span><br><span class="line">    CP <span class="keyword">operator</span> - (CP <span class="type">const</span> &amp;B) <span class="type">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">CP</span>(x - B.x, y - B.y);</span><br><span class="line">    &#125;</span><br><span class="line">    CP <span class="keyword">operator</span> * (CP <span class="type">const</span> &amp;B) <span class="type">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">CP</span>(x * B.x - y * B.y, x * B.y + y * B.x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;f[N &lt;&lt; <span class="number">1</span>], p[N &lt;&lt; <span class="number">1</span>], sav[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> tr[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">fft</span><span class="params">(CP *f, <span class="type">bool</span> flag)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">f_or</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        <span class="keyword">if</span>(i &lt; tr[i])<span class="built_in">swap</span>(f[i], f[tr[i]]);</span><br><span class="line">    <span class="built_in">f_or</span>(<span class="type">int</span> p = <span class="number">2</span>; p &lt;= n; p &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> len = p &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="function">CP <span class="title">tG</span><span class="params">(cos(<span class="number">2</span> * Pi / p), sin(<span class="number">2</span> * Pi / p))</span></span>;</span><br><span class="line">        <span class="keyword">if</span>(!flag)tG.y *= <span class="number">-1</span>;</span><br><span class="line">        <span class="built_in">f_or</span>(<span class="type">int</span> k = <span class="number">0</span>; k &lt; n; k += p)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="function">CP <span class="title">buf</span><span class="params">(<span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">            <span class="built_in">f_or</span>(<span class="type">int</span> l = k; l &lt; k + len; l++)</span><br><span class="line">            &#123;</span><br><span class="line">                CP tt = buf * f[len + l];</span><br><span class="line">                f[len + l] = f[l] - tt;</span><br><span class="line">                f[l] = f[l] + tt;</span><br><span class="line">                buf = buf * tG;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="built_in">f_or</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n; i++)<span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>, &amp;f[i].x);</span><br><span class="line">    <span class="built_in">f_or</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt;= m; i++)<span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>, &amp;p[i].x);</span><br><span class="line">    <span class="built_in">f_or</span>(m += n, n = <span class="number">1</span>; n &lt;= m; n &lt;&lt;= <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">f_or</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        tr[i] = (tr[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) ? n &gt;&gt; <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">fft</span>(f, <span class="number">1</span>); <span class="built_in">fft</span>(p, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">f_or</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i)f[i] = f[i] * p[i];</span><br><span class="line">    <span class="built_in">fft</span>(f, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">f_or</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt;= m; ++i)<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, ( <span class="type">int</span> )(f[i].x / n + <span class="number">0.49</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><span class="exturl" data-url="aHR0cHM6Ly93d3cubHVvZ3Uub3JnL2Jsb2cvY29tbWFuZC1ibG9jay9mZnQteHVlLXhpLWJpLWpp">$\blacktriangleright$<i class="fa fa-external-link-alt"></i></span></p>
]]></content>
      <categories>
        <category>æ•°å­¦</category>
      </categories>
      <tags>
        <tag>æ•°å­¦</tag>
      </tags>
  </entry>
  <entry>
    <title>åšå¼ˆè®ºï¼ˆå¹¿ä¹‰ï¼‰å­¦ä¹ ç¬”è®°</title>
    <url>/notes/game-strategy/</url>
    <content><![CDATA[<p>ç®€ä»‹ï¼š åšå¼ˆè®º</p>
<span id="more"></span>

<h2 id="å¯¼å…¥"><a href="#å¯¼å…¥" class="headerlink" title="å¯¼å…¥"></a>å¯¼å…¥</h2><p>æˆ‘ä»¬å…ˆä¸¾ä¸€ä¸ªæ —å­ï¼š</p>
<p>å‡å¦‚ä½ å’Œæzenä¸€èµ·ç©ä¸€ä¸ªæ¸¸æˆï¼›<br>ä½ ä»¬é¢å‰éƒ½æœ‰ä¸€ä¸ªå¼€å…³ï¼Œä½ ä»¬éƒ½å¯ä»¥é€‰æ‹©è®©è¿™ä¸ªå¼€å…³å¤„äºæ–­å¼€æˆ–é—­åˆä¸¤ç§çŠ¶æ€çš„å…¶ä¸­ä»»æ„ä¸€ç§ã€‚<br>è€Œæˆ‘ä¼šæ ¹æ®å¼€å…³çš„çŠ¶æ€ç»™ä½ ä»¬è¯„çº§ï¼š<br>å½“ä¸¤ä¸ªå¼€å…³éƒ½é—­åˆæ—¶ï¼Œä½ ä»¬éƒ½å¾— $C$ ï¼›<br>å½“ä¸¤ä¸ªå¼€å…³éƒ½æ–­å¼€æ—¶ï¼Œä½ ä»¬éƒ½å¾— $B$ ï¼›<br>å½“ä¸¤ä¸ªå¼€å…³ä¸€å¼€ä¸€æ–­æ—¶ï¼Œæ–­å¼€çš„å¾— $D$ ï¼Œé—­åˆçš„å¾— $A$ ã€‚<br>ååˆ†ç®€å•ã€‚</p>
<p>ä½ ä¼šæ€ä¹ˆé€‰å‘¢ï¼Ÿ</p>
<p>é¦–å…ˆæˆ‘ä»¬åˆ—ä¸€ä¸ªè¡¨æ ¼ï¼Œè¡¨ç¤ºå‡ºæ‰€æœ‰ç»“æœï¼š</p>
<p><img src="https://i.loli.net/2021/09/22/PugFZ2BDdAqo5zw.png" alt="åšå¼ˆ1.png"></p>
<p>ç°åœ¨ä½ ä¼šåšå‡ºä»€ä¹ˆé€‰æ‹©å‘¢ï¼Ÿ</p>
<p>ä½ çŠ¹è±«äº†ä¸€ä¸‹ï¼Œç„¶åé—­åˆäº†å¼€å…³ã€‚<br>æ¯•ç«Ÿè¿™æ ·ä½ å¯ä»¥<del>è¿«å®³æzen</del>å¾—åˆ°æ›´é«˜çš„è¯„çº§ã€‚<br>ä½†æ˜¯ä½ çš„å†…å¿ƒæ·±å¤„è¿˜æ˜¯æœ‰ä¸€ä¸ªå£°éŸ³ï¼š<br>â€œæ–­å¼€å¼€å…³å§ï¼Œæ¯•ç«Ÿæzenä¹‹å‰è¢«è¿«å®³å¤ªå¤šæ¬¡äº†ï¼Œä»–ä¼š<del>å¼€å§‹åå›´å‰¿</del>ä¼¤å¿ƒçš„â€<br>é©±ä½¿ç€ä½ æ–­å¼€å¼€å…³ã€‚<br>æ˜¯ä¸æ˜¯ï¼Ÿ</p>
<p>ä½ ä»ç„¶åœ¨çŠ¹è±«ã€‚</p>
<p>é‚£ä¹ˆï¼Œå¦‚æœç°åœ¨æˆ‘ä»¬è§„å®šï¼Œæœ¬æ¬¡æ¸¸æˆç»“æœè®¡å…¥ä»Šå¹´çš„æœŸæœ«è€ƒè¯•ï¼Œåªæœ‰æ‹¿åˆ° $C$ çº§æ‰èƒ½åŠæ ¼ï¼Œè€Œä½ åˆä¸æƒ³æŒ‚ç§‘ï¼Œæ€ä¹ˆæ ·ï¼Ÿ</p>
<p>ä¸ºäº†æ›´ç›´è§‚ä¸€ç‚¹ï¼Œæˆ‘ä»¬ç”¨ $[-1,2]$ èŒƒå›´å†…çš„æ•´æ•°æ¥ä»£æ›¿è¯„çº§ï¼Œæ˜¯ä¸æ˜¯ä¼šæ›´å¥½ä¸€äº›ï¼Ÿ</p>
<p><img src="https://i.loli.net/2021/09/22/OSmtUF89Hs5covl.png" alt="åšå¼ˆ2.png"></p>
<p>è¿™æ—¶å€™ï¼Œä½ å°±å¯ä»¥è¿›è¡Œä¸€ä¸‹æ¯”è¾ƒï¼š</p>
<p>å¦‚æœä½ é—­åˆå¼€å…³ï¼Œé‚£ä¹ˆæ— è®ºæzenå¹²ä»€ä¹ˆï¼Œä½ éƒ½å¯ä»¥æ‹¿åˆ°æ›´é«˜çš„åˆ†æ•°<del>ï¼ˆé™¤éä»–ç›´æ¥æ¥æ‰¾ä½ ï¼‰</del> ï¼š<br>$0&gt;-1,2&gt;1$</p>
<p>æ­¤æ—¶ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªç­–ç•¥ $Î±$ ä¸ $Î²$ ï¼Œæ— è®ºä»–äººé€‰æ‹©ä»€ä¹ˆï¼Œæˆ‘ä»¬é€‰ $Î±$ å¾—åˆ°çš„ç»“æœéƒ½ä¸¥æ ¼ä¼˜äºé€‰ $Î²$ ï¼Œé‚£æˆ‘ä»¬å°±ç§° $Î±$ ç›¸å¯¹äº $Î²$ æ˜¯ä¸€ä¸ª <strong>ä¸¥æ ¼ä¼˜åŠ¿ç­–ç•¥(Strictly dominant strategy)</strong> ã€‚</p>
<p>æ¯”å¦‚è¿™é“é¢˜é‡Œçš„â€œé—­åˆå¼€å…³â€å°±æ˜¯ä¸ªç›¸å¯¹äºâ€œæ–­å¼€å¼€å…³â€çš„ä¸¥æ ¼ä¼˜åŠ¿ç­–ç•¥ã€‚</p>
<p>å‡å¦‚ä½ é€‰æ‹©äº†æ–­å¼€å¼€å…³ï¼Œè€Œæzené€‰æ‹©é—­åˆå¼€å…³ï¼Œä½ æŒ‚ç§‘äº†ã€‚<br>è¿™æ—¶å€™ä½ å°±ä¼šå¾—åˆ°ä¸€æ¡é‡è¦çš„ç»“è®ºï¼š</p>
<h3 id="ç»“è®º-1"><a href="#ç»“è®º-1" class="headerlink" title="ç»“è®º 1"></a>ç»“è®º 1</h3><p><strong>æ°¸è¿œï¼Œæ°¸è¿œä¸è¦é€‰æ‹©åŠ£åŠ¿ç­–ç•¥ã€‚</strong><br>è¿™é‡Œçš„ <strong>â€œä¸¥æ ¼åŠ£åŠ¿ç­–ç•¥(Strictly dominated strategy)â€</strong> æ˜¯ç›¸å¯¹äº <strong>â€œä¸¥æ ¼ä¼˜åŠ¿ç­–ç•¥â€</strong> è€Œè¯´çš„ï¼ŒæŒ‡æœ‰ä¸€ä¸ªç­–ç•¥ï¼Œä¸ç®¡åˆ«äººé€‰æ‹©ä»€ä¹ˆï¼Œä½ é€‰å®ƒçš„ç»“æœéƒ½ä¸¥æ ¼åŠ£äºé€‰å…¶ä»–çš„ç­–ç•¥ã€‚</p>
<p>æ‡‚çš„éƒ½æ‡‚ã€‚</p>
<hr>
<p>æ‰€ä»¥è¯´ï¼Œä½ ä»¬ä¸¤ä¸ªäººéƒ½é€‰æ‹©æ–­å¼€å¼€å…³ï¼Œéƒ½å¾—Bï¼Œä¸æ˜¯å¾ˆå¥½çš„å—ï¼Ÿ</p>
<p>è¿™æ—¶å€™éœ€è¦å¼•å…¥å¦ä¸€æ¡é‡è¦çš„ç»“è®ºï¼š</p>
<h3 id="ç»“è®º-2"><a href="#ç»“è®º-2" class="headerlink" title="ç»“è®º 2"></a>ç»“è®º 2</h3><p><strong>ç†æ€§çš„é€‰æ‹©æœ€ç»ˆä¸€å®šå¯¼è‡´éæœ€ä¼˜ç»“æœã€‚</strong></p>
<p>å¯¹äºzenæ¥è¯´ï¼Œä¸ç®¡ä½ æ€ä¹ˆé€‰ï¼Œé€‰æ‹©é—­åˆå¼€å…³æ€»æ˜¯å¯¹ä»–æœ‰åˆ©çš„ã€‚ä½†ä½ ä¸çŸ¥é“ä»–ä¼šé€‰ä»€ä¹ˆï¼Œä¹Ÿä¸å¯ä»¥ä¸å®ƒäº¤æµï¼Œæ‰€ä»¥ä½ ä¸èƒ½ä¸ä»–ä¸€èµ·çº¦å¥½äº†é€‰æ‹©æ–­å¼€å¼€å…³ã€‚</p>
<hr>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬æ›´æ”¹ä¸€ä¸‹æ¸¸æˆçš„ç»“æœã€‚</p>
<p>å‡å¦‚ä½ è€ƒç ¸äº†ï¼Œä½ å°±ä¼šå—åˆ°å®¶é•¿çš„è¯˜é—®ï¼Œå› è€Œå˜å¾—ä¼¤å¿ƒï¼Œè¿™ä¸€éƒ¨åˆ†ä¹Ÿè¦ç®—åœ¨æœŸæœ›æ”¶ç›Šé‡Œï¼›</p>
<p>å‡å¦‚ä½ è®©æzenè€ƒç ¸äº†ï¼Œä½ å°±ä¼šå¿ƒç”Ÿæ„§ç–š<del>åŒæ—¶è¢«æ„¤æ€’çš„zenåå›´å‰¿</del>ï¼Œä¹Ÿä¼šå˜å¾—ä¼¤å¿ƒï¼Œè¿™ä¸€éƒ¨åˆ†ä¹Ÿè¦ç®—åœ¨æœŸæœ›æ”¶ç›Šé‡Œã€‚</p>
<p>äºæ˜¯ï¼Œæˆ‘ä»¬çš„è¡¨æ ¼å˜æˆäº†ï¼š</p>
<p><img src="https://i.loli.net/2021/09/22/16dpGnyJa9uB3vM.png" alt="åšå¼ˆ3.png"></p>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å°±ä¸ä¼šæœ‰ä»»ä½•ä¼˜åŠ¿ç­–ç•¥æˆ–åŠ£åŠ¿ç­–ç•¥ã€‚</p>
<p>è¿™ä¸ªåšå¼ˆå«åš <strong>â€œåå’Œè°¬è¯¯(Coordination problem)â€</strong> ã€‚</p>
<p>è¿™ä¸ªæ—¶å€™ä½ å°±ä¸çŸ¥é“æ€ä¹ˆåŠäº†ã€‚</p>
<p>ä½ ä¸çŸ¥é“æzenä¼šæ€ä¹ˆåšï¼Œä½ ä»¬ä¸¤ä¸ªäººä¹Ÿæ— æ³•äº¤æµï¼Œå› æ­¤ä½ å°±æ— æ³•åšå‡ºå†³å®šã€‚</p>
<p>è¿™å°±å¼•å‡ºäº†å¦å¤–ä¸€æ¡å¾ˆå¥½çš„ç»“è®ºï¼š</p>
<h3 id="ç»“è®º-3"><a href="#ç»“è®º-3" class="headerlink" title="ç»“è®º 3"></a>ç»“è®º 3</h3><p><strong>æ±æ¬²æ±‚ä¹‹ï¼Œå¿…å…ˆçŸ¥ä¹‹ã€‚</strong></p>
<p>ä½ åœ¨åšå‡ºå†³å®šä¹‹å‰ï¼Œæœ€å¥½å…ˆäº†è§£ä¸€ä¸‹ä½ çš„å¯¹æ‰‹çš„åŸºæœ¬ä¿¡æ¯ã€‚</p>
<p>åœ¨è¿™å±€æ¸¸æˆé‡Œï¼Œä½ çš„å¯¹æ‰‹æ˜¯æzenã€‚</p>
<p>ç¢°å·§ï¼Œä½ çŸ¥é“æzenå¯Œæœ‰çˆ±å¿ƒï¼Œä»–æ€»ä¼šè€ƒè™‘ä½ çš„æ„Ÿå—ã€‚å¦‚æœä»–é—­åˆäº†å¼€å…³ä½†ä½ æ²¡æœ‰è€Œä½¿å¾—ä½ è¾“äº†ï¼Œä»–ä¼šä¸å¼€å¿ƒçš„ã€‚</p>
<p>è¿™å°±å¯¼è‡´ä»–ä¹‹å‰å’Œé³–ç©çš„æ—¶å€™è¢«é‚ªæ¶çš„é³–æ‰“åˆ°è‡ªé—­ã€‚ï¼ˆä¹‹å‰çš„ä¸è®¡å…¥æœŸæœ«æˆç»©awaï¼‰</p>
<p>ä½ ä»¬ä¸¤ä¸ªä¼šç©çš„ååˆ†æ„‰å¿«ã€‚ï¼ˆä½ è¾“äº†ä»–ä¼šå®‰æ…°ä½ awaï¼‰</p>
<p>ä½†æ˜¯å¦‚æœä½ è·Ÿé³–ç©å‘¢ï¼Ÿ</p>
<p>é³–ä¸ä¼šæœ‰æƒ…æ„ŸæŸä¼¤çš„å‡ç›Šã‚ˆã€‚</p>
<p>é‚£ä¹ˆï¼Œä½ çš„æœŸæœ›æ”¶ç›Šå°±å˜æˆäº†è¿™æ ·ï¼š</p>
<p><img src="https://i.loli.net/2021/09/22/ElJjYIQzXW8mtdO.png" alt="åšå¼ˆ4.png"></p>
<p>æ­¤æ—¶ï¼Œä½ å°±éœ€è¦å¯¹ä½ çš„ç­–ç•¥è¿›è¡Œä¸€äº›æ”¹å˜ï¼š</p>
<p>å› ä¸ºæ— è®ºä½ é€‰æ‹©ä»€ä¹ˆï¼Œé³–æ€»ä¼šé—­åˆå¼€å…³ï¼Œå› ä¸ºè¿™ç›¸å¯¹äºä»–æ¥è¯´æ˜¯ä¸€ç§ä¼˜åŠ¿ç­–ç•¥ã€‚</p>
<p>æ‰€ä»¥ï¼Œä½ åº”å½“é—­åˆå¼€å…³ï¼Œä½¿å¾—é³–çš„æ”¶ç›Šæœ€å°ã€‚</p>
<p>è¿™æ—¶å€™ï¼Œä½ å°±å­¦ä¼šäº†ä¸€æ¡é‡è¦çš„ç»“è®ºï¼š</p>
<h3 id="ç»“è®º-4"><a href="#ç»“è®º-4" class="headerlink" title="ç»“è®º 4"></a>ç»“è®º 4</h3><p><strong>ç«™åœ¨ä»–äººçš„ç«‹åœºä¸Šå»åˆ†æä»–ä»¬ä¼šåšå‡ºçš„å†³ç­–</strong> ï¼Œæˆ–è€…ï¼Œ <strong>å­¦ä¼šæ¢ä½æ€è€ƒ</strong> ã€‚</p>
<p>ç°åœ¨ï¼Œä½ å¤§æ¦‚å°±å¯ä»¥ä¸é³–è¿™æ ·çš„äººå‹å¥½åœ°æ¸¸ç©äº†ï¼Œç”šè‡³èƒ½è·Ÿtueã€zhuaè¿‡ä¸Šå‡ æ‹›äº†ã€‚</p>
<p>ä½†æ˜¯ï¼Œå¦‚æœè¿™ä¸ªæ¸¸æˆçš„ç»“æœä¸ä½ çš„æœŸæœ«è€ƒè¯•æˆç»©æŒ‚é’©å‘¢ï¼Ÿ<br>é‚£ä¹ˆï¼Œå°±è¿zenä¹Ÿä¼šé—­åˆå¼€å…³ï¼Œæ¥é˜²æ­¢æŒ‚ç§‘çš„ã€‚</p>
<p>æ‰€ä»¥è®°ä½ï¼š</p>
<h3 id="ç»“è®º-5"><a href="#ç»“è®º-5" class="headerlink" title="ç»“è®º 5"></a>ç»“è®º 5</h3><p><strong>äººæ˜¯è‡ªç§çš„ã€‚äººéƒ½æƒ³å·æ‡’ã€‚</strong></p>
<p>è‡³æ­¤ï¼Œä½ å°±åŸºæœ¬ä¸Šå¼€å§‹æ¥è§¦äº†åšå¼ˆè®ºã€‚</p>
<hr>
<p>å¤§å®¶åº”è¯¥éƒ½å¬è¯´è¿‡å›šå¾’å›°å¢ƒç½¢ã€‚<br>ä¸å‡ºæ„å¤–çš„è¯ï¼Œä¸¤ä¸ªå›šå¾’éƒ½ä¼šé€‰æ‹©ä¾›å‡ºå¯¹æ–¹ã€‚<br>é‚£ä¹ˆï¼Œå¦‚ä½•æ”¹å˜è¿™ä¸ªåšå¼ˆçš„ç»“æœå‘¢ï¼Ÿ</p>
<h3 id="å¦‚ä½•æ”¹å˜åšå¼ˆç»“æœ"><a href="#å¦‚ä½•æ”¹å˜åšå¼ˆç»“æœ" class="headerlink" title="å¦‚ä½•æ”¹å˜åšå¼ˆç»“æœ"></a>å¦‚ä½•æ”¹å˜åšå¼ˆç»“æœ</h3><p>æˆ‘ä»¬æœ‰ä¸‰ç§æ–¹æ³•ï¼š</p>
<p><strong>1. ç­¾è®¢æ¡çº¦ï¼Œåˆ¶å®šè§„ç« åˆ¶åº¦ç­‰ï¼›</strong><br><strong>2. å¤šæ¬¡é‡å¤åšå¼ˆï¼›</strong><br><strong>3. æ•™è‚²ã€‚ï¼ˆå¦‚é›†ä½“ä¸»ä¹‰æ•™è‚²ï¼‰</strong></p>
<p>ä¸ç®¡å“ªä¸€æ¡ï¼Œæœ¬è´¨ä¸Šéƒ½æ˜¯æ”¹å˜äº†å‚ä¸è€…çš„æ”¶ç›Šæˆ–å‚ä¸è€…çš„åŠ¨æœºã€‚</p>
<hr>
<h2 id="æ›´æ·±çš„å±‚æ¬¡"><a href="#æ›´æ·±çš„å±‚æ¬¡" class="headerlink" title="æ›´æ·±çš„å±‚æ¬¡"></a>æ›´æ·±çš„å±‚æ¬¡</h2><p>æˆ‘ä»¬åˆšæ‰é€šè¿‡ä¸¾ä¾‹å­çŸ¥é“äº†ä»€ä¹ˆæ˜¯åšå¼ˆï¼Œä½†æˆ‘ä»¬çœŸçš„çŸ¥é“ä»€ä¹ˆæ˜¯åšå¼ˆå—ï¼Ÿ</p>
<h3 id="åšå¼ˆçš„ç»„æˆ"><a href="#åšå¼ˆçš„ç»„æˆ" class="headerlink" title="åšå¼ˆçš„ç»„æˆ"></a>åšå¼ˆçš„ç»„æˆ</h3><p>ä¸€ä¸ªåšå¼ˆç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š</p>
<h4 id="1-å‚ä¸äºº-Players"><a href="#1-å‚ä¸äºº-Players" class="headerlink" title="1. å‚ä¸äºº(Players)"></a>1. å‚ä¸äºº(Players)</h4><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨å°å†™å­—æ¯ $i$ , $j$ ç­‰æ¥ä»£è¡¨å‚ä¸äººã€‚</p>
<h4 id="2-ç­–ç•¥-Strategy"><a href="#2-ç­–ç•¥-Strategy" class="headerlink" title="2. ç­–ç•¥(Strategy)"></a>2. ç­–ç•¥(Strategy)</h4><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨å¸¦æœ‰ä¸‹æ ‡çš„å°å†™å­—æ¯ $s_i$ æ¥ä»£è¡¨å‚ä¸äºº $i$ çš„æŸä¸€ä¸ªç­–ç•¥ã€‚</p>
<p>æˆ‘ä»¬ä½¿ç”¨å¸¦æœ‰ä¸‹æ ‡çš„å¤§å†™å­—æ¯ $S_i$ æ¥ä»£è¡¨å‚ä¸äºº $i$ çš„æ‰€æœ‰å¯èƒ½çš„ç­–ç•¥é›†åˆã€‚</p>
<p>æˆ‘ä»¬ä½¿ç”¨å°å†™å­—æ¯ $s_{-i}$ æ¥è¡¨ç¤ºé™¤å‚ä¸äºº $i$ ä¹‹å¤–çš„æ‰€æœ‰å‚ä¸äººçš„ç­–ç•¥ã€‚</p>
<h4 id="3-æ”¶ç›Š-Payoff"><a href="#3-æ”¶ç›Š-Payoff" class="headerlink" title="3. æ”¶ç›Š(Payoff)"></a>3. æ”¶ç›Š(Payoff)</h4><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨å¸¦æœ‰ä¸‹æ ‡çš„å¤§å†™å­—æ¯ $U_i (s)$ æ¥ä»£è¡¨å‚ä¸äºº $i$ åœ¨æ‰€æœ‰å‚ä¸è€…ä½¿ç”¨çš„ç­–ç•¥ä¸º $s$ æ—¶æ‰€èƒ½å¾—åˆ°çš„æ”¶ç›Šã€‚ï¼ˆè¿™ä¸€æ®µå¥½é•¿å•Šï¼‰</p>
<p>å¦å¤–çš„ï¼Œæˆ‘ä»¬ä½¿ç”¨å°å†™å­—æ¯ $s$ æ¥è¡¨ç¤ºä¸€ä¸ªåšå¼ˆã€‚</p>
<p>å¥½äº†ï¼Œç°åœ¨è®©æˆ‘ä»¬æ¥ä½¿ç”¨æˆ‘ä»¬åˆšåˆšå­¦ä¼šçš„è¡¨ç¤ºæ–¹æ³•æ¥è¡¨ç¤ºæˆ‘ä»¬ä¹‹å‰å­¦è¿‡çš„ä¸œè¥¿ã€‚</p>
<p>é‚£ä¹ˆï¼Œå¦‚æœç­–ç•¥ $s_i$ ç›¸å¯¹äºç­–ç•¥ $s_iâ€™$ æ˜¯ä¸€ä¸ªä¸¥æ ¼ä¼˜åŠ¿ç­–ç•¥çš„è¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å†™ä¸‹</p>
<p>$$<br>\begin{equation}<br>U_i (s_i , s_{-i}) &gt; U_i (s_iâ€™ , s_{-i})<br>\end{equation}<br>$$</p>
<p>ç±»ä¼¼çš„ï¼Œå¦‚æœç­–ç•¥ $s_i$ ç›¸å¯¹äºç­–ç•¥ $s_iâ€™$ æ˜¯ä¸€ä¸ªä¸¥æ ¼åŠ£åŠ¿ç­–ç•¥çš„è¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å†™ä¸‹</p>
<p>$$<br>\begin{equation}<br>U_i (s_i , s_{-i}) &lt; U_i (s_iâ€™ , s_{-i})<br>\end{equation}<br>$$</p>
<h3 id="å¼±ä¼˜ä¸å¼±åŠ£"><a href="#å¼±ä¼˜ä¸å¼±åŠ£" class="headerlink" title="å¼±ä¼˜ä¸å¼±åŠ£"></a>å¼±ä¼˜ä¸å¼±åŠ£</h3><p>å¦‚æœç­–ç•¥ $s_i$ ç›¸å¯¹äºç­–ç•¥ $s_iâ€™$ æ˜¯ä¸€ä¸ªä¸¥æ ¼ä¼˜åŠ¿ç­–ç•¥ï¼Œé‚£ä¹ˆæ— è®ºä»–äººé€‰æ‹©ä½•ç§ç­–ç•¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬é€‰ $s_i$ å¾—åˆ°çš„ç»“æœéƒ½ä¸¥æ ¼ä¼˜äºé€‰ $s_iâ€™$ã€‚</p>
<p>ä½†æœ‰æ—¶å€™æˆ‘ä»¬å¹¶ä¸èƒ½æ€»è§åˆ°è¿™æ ·çš„ç­–ç•¥ã€‚</p>
<p>é‚£æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªç­–ç•¥ $s_i$ ä¸ºç›¸å¯¹äºå¦ä¸€ä¸ªç­–ç•¥ $s_iâ€™$ ä¸º <strong>å¼±ä¼˜ç­–ç•¥(Weakly dominant strategy)</strong> ï¼Œæ­¤æ—¶åªéœ€è¦å°†å¤§äºå·å¡«ä¸Šç­‰äºå³å¯ã€‚<br>å°±åƒä¸‹é¢è¿™æ ·ï¼š</p>
<p>$$<br>\begin{equation}<br>U_i (s_i , s_{-i}) \leq U_i (s_iâ€™ , s_{-i})<br>\end{equation}<br>$$</p>
<p>ç±»ä¼¼çš„ï¼Œ <strong>å¼±åŠ£ç­–ç•¥(Weakly dominated strategy)</strong> çš„å®šä¹‰å¦‚ä¸‹ï¼š</p>
<p>$$<br>\begin{equation}<br>U_i (s_i , s_{-i}) \geq U_i (s_iâ€™ , s_{-i})<br>\end{equation}<br>$$</p>
<p>æ‰€ä»¥è¯´ï¼Œå¯¹äºåˆšæ‰ä½ å’Œæzenåšçš„æ¸¸æˆï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è¿™äº›è¡¨ç¤ºæ¥æ›¿æ¢ä¹‹å‰çš„è¯´æ³•ï¼š</p>
<p>ï¼ˆå…ˆæ”¾å›¾ï¼‰</p>
<p><img src="https://i.loli.net/2021/09/22/OSmtUF89Hs5covl.png" alt="åšå¼ˆ2.png"></p>
<p>å…¶ä¸­ï¼Œ<br>$S_{you} &#x3D; \lbrace 1,0 \rbrace $<br>$S_{zen} &#x3D; \lbrace 1,0 \rbrace $<br>$U_{you} (1,1) &#x3D; 0 $<br>$U_{zen} (1,1) &#x3D; 0 $<br>$U_{you} (1,0) &#x3D; 2 $<br>$U_{zen} (1,0) &#x3D; -1 $<br>$U_{you} (0,1) &#x3D; -1 $<br>$U_{zen} (0,1) &#x3D; 2 $<br>$U_{you} (0,0) &#x3D; 1 $<br>$U_{zen} (0,0) &#x3D; 1 $<br>$U_{zen} (1,s_{-zen}) &gt; U_{zen} (0,s_{-zen}) $<br>$U_{you} (1,s_{-you}) &gt; U_{you} (0,s_{-you}) $</p>
<p>ç°åœ¨ä½ å°±å¯ä»¥ç†è§£åˆšæ‰æˆ‘ä»¬è®²çš„ç¬¦å·æ˜¯ä»€ä¹ˆæ„æ€äº†ã€‚</p>
<h3 id="è¿­ä»£å‰”é™¤åŠ£åŠ¿ç­–ç•¥"><a href="#è¿­ä»£å‰”é™¤åŠ£åŠ¿ç­–ç•¥" class="headerlink" title="è¿­ä»£å‰”é™¤åŠ£åŠ¿ç­–ç•¥"></a>è¿­ä»£å‰”é™¤åŠ£åŠ¿ç­–ç•¥</h3><p>è®©æˆ‘ä»¬æ¥åšä¸€ä¸ªæ–°çš„æ¸¸æˆã€‚</p>
<p>ä½ ï¼Œæzenï¼Œé³–ï¼Œtueï¼Œzhuaï¼Œè¿˜æœ‰å¹¿å¤§å››ç­äººæ°‘ç¾¤ä¼—ä¸€èµ·åšä¸€ä¸ªæ¸¸æˆã€‚æ¯ä¸€ä¸ªäººéƒ½éœ€è¦ä»èŒƒå›´ä¸º $[1,100]$ çš„æ•´æ•°é‡Œé¢é€‰ä¸€ä¸ªæ•°ã€‚<br>AJå°†ä¼šç»Ÿè®¡å¤§å®¶çš„ç»“æœï¼Œå¹¶è¿›è¡Œæ€»ç»“ã€‚<br>æ€»ç»“åå–å¹³å‡æ•°çš„ $\dfrac{2}{3}$ ä½œä¸ºåŸºå‡†æ•°ï¼ˆå‘ä¸Šå–æ•´ï¼‰ã€‚åŸºå‡†æ•°å‡å»ï¼ˆä½ çš„ç»“æœä¸åŸºå‡†æ•°çš„å·®ï¼‰å†é™¤ä»¥åŸºå‡†æ•°ï¼Œå¾—åˆ°ä¸€ä¸ªç™¾åˆ†æ•°ã€‚è¿™ä¸ªç™¾åˆ†æ•°å†ä¹˜ä»¥120å°±æ˜¯ä½ æœ¬æ¬¡æœŸæœ«çš„æ•°å­¦æˆç»©ã€‚</p>
<p>åŒæ—¶ï¼ŒAJæŒ‡å®šä½ å’Œæzenä¸ºæŒ‘æˆ˜å¯¹è±¡ã€‚è¿™æ„å‘³ç€ä½ å¦‚æœæ¯”ä¸è¿‡ä»–ï¼Œä½ å°±å¾—æ‰¿åŒ…ä»–æ˜å¹´çš„å·§å…‹åŠ›ä¾›åº”äº†ã€‚</p>
<p>æ‰€ä»¥ï¼Œä½ ä¼šé€‰æ‹©å“ªä¸€ä¸ªæ•°å‘¢ï¼Ÿ</p>
<ul>
<li>é¦–å…ˆï¼Œä½ çŸ¥é“å³ä½¿å¤§å®¶éƒ½é€‰æ‹©100ï¼ŒåŸºå‡†æ•°ä¹Ÿæ˜¯ $67\dfrac{1}{3}$ ï¼Œæ‰€ä»¥è¯´é€‰æ‹©67ä»¥ä¸Šçš„æ•°å­—æ˜¯ä¸æ˜æ™ºçš„é€‰æ‹©ã€‚</li>
</ul>
<p>ç°åœ¨ä½ æŠŠç›®å…‰èšé›†åˆ°äº† $[1,67]$ èŒƒå›´å†…çš„æ•´æ•°ä¸Šã€‚</p>
<ul>
<li>å…¶æ¬¡ï¼Œå³ä½¿å¤§å®¶éƒ½é€‰æ‹©67ï¼Œé‚£ä¹ˆåŸºå‡†æ•°ä¹Ÿå°†ä¼šæ˜¯ $44$ ï¼Œæ‰€ä»¥é€‰æ‹©44ä»¥ä¸Šçš„æ•°å­—ä¹Ÿæ˜¯ä¸å¤ªæ˜æ™ºçš„é€‰æ‹©ã€‚</li>
</ul>
<p> ç°åœ¨ä½ æŠŠç›®å…‰èšé›†åˆ°äº† $[1,44]$ èŒƒå›´å†…çš„æ•´æ•°ä¸Šã€‚</p>
<ul>
<li>ç„¶åï¼Œå³ä½¿å¤§å®¶éƒ½é€‰æ‹©äº†44ï¼Œé‚£ä¹ˆåŸºå‡†æ•°ä¹Ÿå°†ä¼šæ˜¯ $28$ ï¼Œæ‰€ä»¥é€‰æ‹©28ä»¥ä¸Šçš„æ•°å­—ä¹Ÿæ˜¯ä¸å¾ˆæ˜æ™ºçš„é€‰æ‹©ã€‚</li>
</ul>
<p>â€¦â€¦</p>
<p>æœ€åï¼Œè¿™ä¸ªåŸºå‡†æ•°å­—å°†ä¼šè¿­ä»£åˆ°1ã€‚<br>ä¸æ–­å‰”é™¤æ˜æ˜¾çœ‹èµ·æ¥åŠ£åŠ¿çš„ç­–ç•¥ï¼Œæ‰¾å‡ºæ¥æ­¤æ—¶æ–°å‡ºç°çš„åŠ£åŠ¿ç­–ç•¥å¹¶äºˆä»¥å‰”é™¤ï¼Œè¿™å°±å« <strong>è¿­ä»£å‰”é™¤åŠ£åŠ¿ç­–ç•¥(Iterative deletion of dominated strategies)</strong> ã€‚</p>
<h3 id="å…¬å…±çŸ¥è¯†ä¸ç›¸äº’çŸ¥è¯†"><a href="#å…¬å…±çŸ¥è¯†ä¸ç›¸äº’çŸ¥è¯†" class="headerlink" title="å…¬å…±çŸ¥è¯†ä¸ç›¸äº’çŸ¥è¯†"></a>å…¬å…±çŸ¥è¯†ä¸ç›¸äº’çŸ¥è¯†</h3><p>æ‰€ä»¥1æ˜¯ä¸ªæ˜æ™ºçš„é€‰æ‹©å—ï¼Ÿ</p>
<p>å…¶å®ä¸æ˜¯çš„ã€‚</p>
<p>å¤§å®¶éƒ½é€‰æ‹©1çš„å‰ææ˜¯ï¼ŒåŒå­¦ä»¬éƒ½è®¤ä¸ºè‡ªå·±ä¼šé€‰æ‹©1ï¼Œä¸”ä»–äººä¼šé€‰æ‹©1ï¼Œä¸”ä»–äººçŸ¥é“è‡ªå·±ä¼šé€‰æ‹©1ï¼Œä¸”è‡ªå·±çŸ¥é“ä»–äººçŸ¥é“è‡ªå·±ä¼šé€‰æ‹©1ï¼Œä¸”ä»–äººçŸ¥é“è‡ªå·±çŸ¥é“ä»–äººçŸ¥é“è‡ªå·±ä¼šé€‰æ‹©1â€¦â€¦</p>
<p>æ˜¯ä¸æ˜¯ç»•èµ·æ¥äº†ï¼Ÿ</p>
<p>æœ‰ä¸€ä¸ªç›¸ä¼¼çš„ä¸œè¥¿å«åš <strong>çŒœç–‘é“¾</strong> ã€‚</p>
<p>é•¿åº¦ä¸º2n+1çš„çŒœç–‘é“¾å¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼š</p>
<p>ä½ ä¸çŸ¥é“æˆ‘ä¸çŸ¥é“ä½ ä¸çŸ¥é“æˆ‘ä¸çŸ¥é“ä½ ä¸çŸ¥é“â€¦â€¦æˆ‘ä¸çŸ¥é“ä½ ä¸çŸ¥é“æˆ‘ä¸çŸ¥é“ä½ åœ¨æƒ³ä»€ä¹ˆã€‚</p>
<p>çœç•¥çš„éƒ¨åˆ†å°±ä¸å†™å‡ºæ¥äº†ã€‚</p>
<p>åˆšæ‰æˆ‘ä»¬é‡è§çš„ä¸œè¥¿çœ‹èµ·æ¥å¾ˆåƒçŒœç–‘é“¾ï¼Œåªä¸è¿‡â€œä¸çŸ¥é“â€æ¢æˆäº†â€œçŸ¥é“â€ã€‚è¿™å°±å«åš <strong>å…¬å…±çŸ¥è¯†(Common knowledge)</strong> ã€‚</p>
<p>ä½†æ˜¯åœ¨è¿™ä¸ªæƒ…å†µä¸‹ï¼ŒåŒå­¦ä»¬ä»¬æ— æ³•å’Œå¯¹æ–¹æ²Ÿé€šï¼Œæ— æ³•çŸ¥é“åˆ«äººçš„ç»“æœï¼Œæ‰€ä»¥è¿™ä¸ªä¸œè¥¿æ˜¯ä¸èƒ½æˆç«‹çš„ã€‚</p>
<p>AJåœ¨ç»Ÿè®¡å®Œç»“æœåè®©æŒ‘æˆ˜å¯¹è±¡äº’ç›¸çœ‹äº†å¯¹æ–¹çš„ç­”æ¡ˆï¼Œä½†æ˜¯ä½ ä¸çŸ¥é“æzençœ‹äº†ä½ çš„ç­”æ¡ˆï¼ŒåŒæ—¶æzenä¹Ÿä¸çŸ¥é“ä½ çœ‹äº†ä»–çš„ç­”æ¡ˆã€‚</p>
<p>è¿™æ—¶å€™ï¼Œå…¬å…±çŸ¥è¯†çš„æ„å»ºå°±åœæ­¢åœ¨äº†æŸä¸€å±‚ã€‚è¿™æ—¶å€™ï¼Œæˆ‘ä»¬å°±ç§°å…¶ä¸º <strong>ç›¸äº’çŸ¥è¯†(Mutual knowledge)</strong> ã€‚</p>
<p>æ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼Ÿ</p>
<h3 id="ä¸­ä½é€‰æ°‘å®šç†"><a href="#ä¸­ä½é€‰æ°‘å®šç†" class="headerlink" title="ä¸­ä½é€‰æ°‘å®šç†"></a>ä¸­ä½é€‰æ°‘å®šç†</h3><p>ç­é•¿è½®æ¢æ—¶é—´åˆ°ï¼</p>
<p>ç°åœ¨æˆ‘ä»¬æœ‰ä¸¤ä½ç­é•¿å€™é€‰äººï¼šboboä¸æ­¦å˜‰ã€‚</p>
<p>è€Œç­çº§å†…å°†ä¼šäº§ç”Ÿåä¸ªä¸åŒçš„å°å›¢ä½“ï¼Œæ¯ä¸ªå›¢ä½“æŠ•ä¸€ç¥¨ã€‚ä»–ä»¬åªä¼šæŠ•ç»™è‡ªå·±ç†æƒ³ä¸­çš„ç­é•¿â€”â€”ä¹Ÿå°±æ˜¯ä¸è‡ªå·±äº¤é›†æœ€å¤šçš„äººã€‚</p>
<p>å°å›¢ä½“ä¹‹é—´äº’æ— äº¤é›†ã€‚<br>boboå’Œæ­¦å˜‰éœ€è¦å°†è‡ªå·±å®šä½åˆ°æŸä¸€ä¸ªå°å›¢ä½“å†…ï¼Œä»¥è®¡ç®—é€‰ç¥¨ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬å°†è¿™äº›å°å›¢ä½“åˆ†åˆ«å‘½åä¸º $Î±,Î²,Î³,Î´,Îµ,Î¶,Î·,Î¸,Î¹,Îº$ ã€‚</p>
<p>å‡å¦‚boboé€‰äº†Î·ï¼Œè€Œæ­¦å˜‰é€‰äº†Î³ï¼Œé‚£ä¹ˆä»–ä»¬ä¸¤ä¸ªäººåˆ†åˆ«å¾—åˆ° $5.5$ ç¥¨ä¸ $4.5$ ç¥¨ã€‚boboä¼šèµ¢ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬æ¥æ¨¡æ‹Ÿä¸€ä¸‹æ‰€æœ‰å¯èƒ½çš„ç»“æœã€‚</p>
<p><img src="https://i.loli.net/2021/09/24/7rGpuJPQ4eTLN6n.png" alt="åšå¼ˆ5.png"></p>
<p>å¾ˆæ˜æ˜¾ï¼Œç­–ç•¥ $Î±$ åŠ£åŠ¿äºç­–ç•¥ $Î²$ ï¼›å»é™¤ç­–ç•¥ $Î±$ åï¼Œç­–ç•¥ $Î²$ åŠ£åŠ¿äºç­–ç•¥ $Î³$ ï¼›å»é™¤ç­–ç•¥ $Î²$ åï¼Œç­–ç•¥ $Î³$ åŠ£åŠ¿äºç­–ç•¥ $Î´$ ï¼›å»é™¤ç­–ç•¥ $Î³$ åï¼Œç­–ç•¥ $Î´$ åŠ£åŠ¿äºç­–ç•¥ $Îµ$ ã€‚</p>
<p>åŒæ ·çš„ï¼Œç­–ç•¥ $Îº$ åŠ£åŠ¿äºç­–ç•¥ $Î¹$ ï¼›å»é™¤ç­–ç•¥ $Îº$ åï¼Œç­–ç•¥ $Î¹$ åŠ£åŠ¿äºç­–ç•¥ $Î¸$ ï¼›å»é™¤ç­–ç•¥ $Î¹$ åï¼Œç­–ç•¥ $Î¸$ åŠ£åŠ¿äºç­–ç•¥ $Î·$ ï¼›å»é™¤ç­–ç•¥ $Î¸$ åï¼Œç­–ç•¥ $Î·$ åŠ£åŠ¿äºç­–ç•¥ $Î¶$ ã€‚</p>
<p>è€Œç­–ç•¥ $Îµ$ ä¸ç­–ç•¥ $Î¶$ æ²¡æœ‰ä¼˜åŠ£å…³ç³»ã€‚</p>
<p>æ‰€ä»¥è¯´ï¼Œæœ€åboboå’Œæ­¦å˜‰åœ¨è¿›è¡Œç©è¿­ä»£å‰”é™¤åŠ£åŠ¿ç­–ç•¥åï¼Œåªèƒ½é€‰æ‹©èå…¥ $Îµ$ å’Œ $Î¶$ ä¸¤ä¸ªå°å›¢ä½“ä¹‹ä¸€äº†ã€‚</p>
<p>è¿™å°±æ˜¯è‘—åçš„ <strong>ä¸­ä½é€‰æ°‘å®šç†(Median Voter Theorem)</strong> äº†ã€‚</p>
<h3 id="æœ€ä½³å¯¹ç­–ä¸æœŸæœ›æ”¶ç›Š"><a href="#æœ€ä½³å¯¹ç­–ä¸æœŸæœ›æ”¶ç›Š" class="headerlink" title="æœ€ä½³å¯¹ç­–ä¸æœŸæœ›æ”¶ç›Š"></a>æœ€ä½³å¯¹ç­–ä¸æœŸæœ›æ”¶ç›Š</h3><p>ç°åœ¨è®©æˆ‘ä»¬ç©ä¸€ä¸ªéšæœºçš„æ¸¸æˆã€‚<br>é¢˜é¢å¦‚ä¸‹ï¼š</p>
<p><img src="https://i.loli.net/2021/09/24/ftmEhcYzuSdZkyI.png" alt="åšå¼ˆ6.png"></p>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ²¡æœ‰æ˜æ˜¾çš„ä¼˜åŠ¿ç­–ç•¥æˆ–åŠ£åŠ¿ç­–ç•¥ã€‚</p>
<p>é‚£æˆ‘ä»¬è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå½“æzené€‰æ‹©â†æ—¶ï¼Œé€‰â†‘æ˜¯æˆ‘ä»¬çš„æœ€ä½³å¯¹ç­–ï¼›å½“æzené€‰æ‹©â†’æ—¶ï¼Œé€‰â†“æ˜¯æˆ‘ä»¬çš„æœ€ä½³å¯¹ç­–ã€‚</p>
<p>ä½†æ˜¯ä½ å¹¶ä¸çŸ¥é“zenä¼šé€‰æ‹©ä»€ä¹ˆã€‚</p>
<p>ä½ å¼€å§‹ç”¨AJæ•™ä½ çš„æ•°å­¦çŸ¥è¯†æ¥å¯¹æ¯ä¸€ä¸ªé€‰é¡¹çš„æœŸæœ›æ”¶ç›Šè¿›è¡Œä¸€ä¸ªæ¨¡æ‹Ÿã€‚</p>
<p>å‡è®¾æzené€‰æ‹©â†å’Œâ†’çš„å‡ ç‡æ˜¯ç›¸ç­‰çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„æœŸæœ›æ”¶ç›Šå¦‚ä¸‹ï¼š</p>
<p>$$<br>\begin{align}<br>U_{top} \  vs \  (\frac{1}{2} , \frac{1}{2} ) &amp; &#x3D; 5 \times \frac{1}{2} + 0 \times \frac{1}{2} &#x3D; 2 \frac{1}{2} \\<br>U_{middle} \  vs \  (\frac{1}{2} , \frac{1}{2} ) &amp; &#x3D; 1 \times \frac{1}{2} + 4 \times \frac{1}{2} &#x3D; 2 \frac{1}{2} \\<br>U_{down} \  vs \  (\frac{1}{2} , \frac{1}{2} ) &amp; &#x3D; 4 \times \frac{1}{2} + 2 \times \frac{1}{2} &#x3D; 3<br> \end{align}<br>$$</p>
<p>æ­¤æ—¶æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œé€‰æ‹©â†“æ˜¯æˆ‘ä»¬çš„æœ€ä½³å¯¹ç­–ï¼ˆä¹Ÿæ˜¯æœ€å®‰å…¨çš„å¯¹ç­–ï¼‰ï¼Œå› ä¸º $2 \dfrac{1}{2} &lt; 3 $ ã€‚</p>
<p>ä½†æ˜¯å¦‚æœä½ çŸ¥é“äº†æzené€‰æ‹©â†æˆ–â†’çš„æ¦‚ç‡å‘¢ï¼Ÿ</p>
<p>ä¸Šå›¾ã€‚</p>
<p><img src="https://i.loli.net/2021/09/24/mroUEi69tjgV1Cu.png" alt="åšå¼ˆ7.png"></p>
<p>å›¾ä¸­çš„æ¨ªè½´ä»£è¡¨æzené€‰â†çš„æ¦‚ç‡ï¼ŒåŒæ—¶é€‰â†’çš„æ¦‚ç‡æ˜¯ï¼ˆ1-é€‰â†çš„æ¦‚ç‡ï¼‰ã€‚çºµè½´ä»£è¡¨ä¸åŒé€‰æ‹©çš„æœŸæœ›æ”¶ç›Šã€‚</p>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨æzené€‰æ‹©æŸä¸€ç­–ç•¥çš„æ¦‚ç‡ä¸åŒæ—¶ï¼Œæˆ‘ä»¬çš„æœ€ä½³å¯¹ç­–æ˜¯ä¸ä¸€æ ·çš„ã€‚</p>
<p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å®šä¹‰ <strong>æœ€ä½³å¯¹ç­–(Best Responce)</strong> :<br>å½“</p>
<p>$$<br>U_i ( \hat{s_i} ,s_{-i} ) \geq U_i ( s_iâ€™ ,s_{-i} ) \quad (s_iâ€™ \in S_i )<br>$$</p>
<p>æˆ–</p>
<p>$$<br>U_i ( \hat{s_i} ,s_{-i} ) &#x3D; max( U_i ( S_i , s_{-i}))<br>$$</p>
<p>æˆ–</p>
<p>$$<br>EU_i ( \hat{s_i} ,p ) \geq max( EU_i ( s_iâ€™ , p)) \quad (s_iâ€™ \in S_i )<br>$$</p>
<p>æ—¶ï¼Œæˆ‘ä»¬ç§° $ \hat{s_i} $ æ˜¯ç­–ç•¥ $s_{-i} $ çš„æœ€ä½³å¯¹ç­–ã€‚</p>
<p>å…¶ä¸­ï¼Œ $EU_i ( s_i , p ) $ æŒ‡çš„æ˜¯ç­–ç•¥ $s_i$ åœ¨å‚ä¸äºº $i$ æŒä¿¡å¿µ $p$ æ—¶çš„æœŸæœ›æ”¶ç›Šã€‚</p>
<p>åŒæ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ³¨æ„ä¸€ä¸‹ï¼Œå¯¹äºä¸åŒçš„ç­–ç•¥é›†åˆ $s_{-i}$ ï¼Œå…¶æœ€ä½³å¯¹ç­–çš„æ•°é‡å¯èƒ½æ˜¯ä¸åŒçš„ï¼Œä¸”å¯èƒ½ä¸ä¸ºä¸€ï¼ˆå°±æ˜¯æœ€ä½³å¯¹ç­–ä¸ä¼šåªæœ‰ä¸€ä¸ªï¼‰ã€‚</p>
<h2 id="çº³ä»€å‡è¡¡"><a href="#çº³ä»€å‡è¡¡" class="headerlink" title="çº³ä»€å‡è¡¡"></a>çº³ä»€å‡è¡¡</h2><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>å‡è®¾ä½ éœ€è¦å’Œæzenä¸€èµ·å®Œæˆä¸€ä¸ªé¡¹ç›®ã€‚ä½ å°†ä¼šä»˜å‡º $s_y$ ä¸ªå°æ—¶çš„æ—¶é—´ï¼Œè€Œzenå°†ä¼šä»˜å‡º $s_z$ ä¸ªå°æ—¶ï¼Œå…¶ä¸­ $s_y , s_z \in [0,10] $ ã€‚</p>
<p>ä½ ä»¬çš„æ”¶ç›Šä¸ºï¼š</p>
<p>$$<br>\begin{align}<br>U_y &amp; &#x3D; 2 ( s_y + s_z + b s_y s_z ) - s_y^2 \\<br>U_z &amp; &#x3D; 2 ( s_y + s_z + b s_y s_z ) - s_z^2<br>\end{align}<br>$$</p>
<p>æ­¤æ—¶è®©æˆ‘ä»¬æ¥ç®—ä¸€ä¸‹æˆ‘ä»¬æ€ä¹ˆæœ€å¤§åŒ–æˆ‘ä»¬çš„æ”¶ç›Šã€‚</p>
<p>é¦–å…ˆæ±‚ä¸€ä¸‹å¯¼ï¼ŒæŠŠ $s_z$ å½“åšå¸¸æ•°ï¼š</p>
<p>$$<br>\begin{align}<br>U_yâ€™ &amp; &#x3D; 2 ( 1 + b s_z ) - 2 s_y \\<br>U_yâ€™â€™ &amp; &#x3D; -2 &lt; 0<br>\end{align}<br>$$</p>
<p>æ­¤æ—¶ä»¤ $U_yâ€™ &#x3D; 0 $ ï¼Œå¯ä»¥æ±‚å‡ºæœ€ä½³å¯¹ç­–ï¼š</p>
<p>$$<br>\begin{align}<br>2 ( 1 + b s_z ) - 2 s_y &amp; &#x3D; 0 \\<br>1 + b s_z &amp; &#x3D; s_y \\<br>s_y &amp; &#x3D; \frac{1}{1-b}<br>\end{align}<br>$$</p>
<p>æ­¤æ—¶ç”»ä¸€ä¸‹å›¾ï¼š</p>
<p><img src="https://i.loli.net/2021/09/25/mwYX56SC4WaQtcT.png" alt="åšå¼ˆ8.png"></p>
<p>æ­¤æ—¶æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œä¸¤ä¸ªäººçš„æœ€ä½³å¯¹ç­–å‡½æ•°äº¤äºäº†ä¸€ç‚¹ã€‚</p>
<p>åœ¨å®é™…æƒ…å†µä¸­ï¼Œå› ä¸ºä½ ä»¬ä¸¤ä¸ªéƒ½æƒ³å·æ‡’ï¼Œæ‰€ä»¥ä½ ä»¬ä¼šä¸æ–­å‰”é™¤æ‰åŒæ–¹ä»˜å‡ºè¿‡å¤šçš„ç­–ç•¥ï¼Œæœ€ç»ˆç›´åˆ°é€‰æ‹©é‚£ä¸ªäº¤ç‚¹ã€‚</p>
<p>è¿™ä¸ªå°±å«åš <strong>çº³ä»€å‡è¡¡(Nash Equilibrium)</strong> ã€‚</p>
<p>å…¶å®šä¹‰æ˜¯ï¼š</p>
<p>å¯¹äºä¸€ä¸ªå·²é€‰å¯¹ç­–çš„é›†åˆ$ \lbrace s_1^* , s_2^* , s_3^* , \dots , s_m^* \rbrace $ ï¼Œå…¶çº³ä»€å‡è¡¡æ˜¯æ»¡è¶³ä¸‹åˆ—æ¡ä»¶çš„ç­–ç•¥é›†åˆï¼š</p>
<p>å¯¹äº $ \forall $ å‚ä¸äºº $i$ æ¥è¯´ï¼Œå…¶ç­–ç•¥ $ s_i^* $ æ˜¯ $ s_{-i}^* $ çš„æœ€ä½³å¯¹ç­–ã€‚</p>
<p>è¦å®ç°çº³ä»€å‡è¡¡ï¼Œæˆ‘ä»¬éœ€è¦å‡ ä¸ªåŠ¨æœºã€‚</p>
<h4 id="åŠ¨æœº-1"><a href="#åŠ¨æœº-1" class="headerlink" title="åŠ¨æœº 1"></a>åŠ¨æœº 1</h4><p><strong>äººä»¬æ°¸ä¸åæ‚”ã€‚</strong></p>
<p>æˆ–è€…è¯´ï¼Œåœ¨æ‰€æœ‰äººéƒ½å·²ç»é€‰å®šå¥½æ¯ä¸ªäººçš„ç­–ç•¥äº†ä¹‹åï¼Œæ”¹å˜è‡ªå·±çš„ç­–ç•¥å¹¶ä¸ä¼šæœ‰é¢å¤–æ”¶ç›Šã€‚</p>
<h4 id="åŠ¨æœº-2"><a href="#åŠ¨æœº-2" class="headerlink" title="åŠ¨æœº 2"></a>åŠ¨æœº 2</h4><p><strong>çº³ä»€å‡è¡¡å¯ä»¥è¢«çœ‹åšä¸€ç§è‡ªæˆ‘å®æ–½çš„ä¿¡å¿µã€‚</strong></p>
<h4 id="åŠ¨æœº-3"><a href="#åŠ¨æœº-3" class="headerlink" title="åŠ¨æœº 3"></a>åŠ¨æœº 3</h4><p>tbc</p>
<h3 id="æ‰¾å‡ºåšå¼ˆä¸­çš„çº³ä»€å‡è¡¡"><a href="#æ‰¾å‡ºåšå¼ˆä¸­çš„çº³ä»€å‡è¡¡" class="headerlink" title="æ‰¾å‡ºåšå¼ˆä¸­çš„çº³ä»€å‡è¡¡"></a>æ‰¾å‡ºåšå¼ˆä¸­çš„çº³ä»€å‡è¡¡</h3><p>å‡è®¾æˆ‘ä»¬ç°åœ¨ä¸æzenç©ä¸€ä¸ªæ–°çš„æ¸¸æˆï¼Œé¢˜é¢å¦‚ä¸‹ï¼š</p>
<p><img src="https://i.loli.net/2021/09/26/Qlx73OLrFZEYH9K.png" alt="åšå¼ˆ9.png"></p>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬ç”¨ç»¿è‰²çš„åœ†åœˆå’Œçº¢è‰²çš„æ–¹æ¡†æ¥åˆ†åˆ«è¡¨ç¤ºä½ å’Œæzençš„æœ€ä½³å¯¹ç­–ï¼š</p>
<p><img src="https://i.loli.net/2021/09/26/wo6Lc3VPdbTRvsX.png" alt="åšå¼ˆ10.png"></p>
<p>é‚£ä¹ˆï¼Œè¿™ä¸ªåšå¼ˆé‡Œçš„çº³ä»€å‡è¡¡æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå½“ä½ é€‰æ‹©â†“æ—¶ï¼Œzençš„æœ€ä½³å¯¹ç­–æ˜¯é€‰æ‹©â†’ï¼› å½“æzené€‰æ‹©â†’æ—¶ï¼Œä½ çš„æœ€ä½³å¯¹ç­–æ˜¯é€‰æ‹©â†“ã€‚</p>
<p>ä¸€æ—¦ä½ ä»¬ä¸¤ä¸ªäººä¸­çš„å…¶ä¸­ä¸€ä¸ªé€‰å®šäº†ä¹‹åï¼Œå¦ä¸€ä¸ªäººå°±ä¸ä¼šè½»æ˜“è·³å‡ºè¿™ä¸ªå¾ªç¯ã€‚</p>
<p>æ‰€ä»¥è¯´ï¼Œ $(â†“,â†’)$ å°±æ˜¯è¿™åœºåšå¼ˆé‡Œçš„çº³ä»€å‡è¡¡ã€‚</p>
<p>å½“ç„¶ï¼Œä¸€åœºåšå¼ˆçš„çº³ä»€å‡è¡¡ä¹Ÿå¯èƒ½ä¸åªæœ‰ä¸€ä¸ªã€‚<br>æ¯”å¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://i.loli.net/2021/09/26/NLsOb3oUgT26yM7.png" alt="åšå¼ˆ11.png"></p>
<p>å¾ˆç®€å•æ˜¯ä¸æ˜¯ï¼Ÿ</p>
<p>è¿™æ—¶ä½ ä»¬ä¼šå‘ç°ï¼Œåœ¨è¿™åœºåšå¼ˆä¸­ï¼Œè™½ç„¶çœ‹èµ·æ¥ $(â†,â†‘)$ æ˜æ˜¾æ˜¯çº³ä»€å‡è¡¡ <del>ï¼ˆå…¶å®ä¹ŸçœŸçš„æ˜¯ï¼‰</del> ï¼Œä½†æ˜¯å¦‚æœä½ ä»”ç»†çœ‹çš„è¯ï¼Œå³ä¸‹è§’çš„é‚£ä¸ªé›¶é›¶ä¹Ÿç¬¦åˆçº³ä»€å‡è¡¡çš„å®šä¹‰ï¼Œè™½ç„¶ä¸¤ä¸ªäººä»€ä¹ˆéƒ½å¾—ä¸åˆ°ä¸”å‚»å­ä¹Ÿä¼šçŸ¥é“é€‰æ‹©æœ‰æ”¶ç›Šçš„é‚£ä¸ªç­–ç•¥è€Œä¸æ˜¯ä¸€ç‚¹æ”¶ç›Šéƒ½æ²¡æœ‰çš„ï¼Œä½†æ˜¯ä¸€æ—¦ä¸¤ä¸ªäººçŸ¥é“å¯¹æ–¹ä¼šé€‰æ‹©è¿™ä¸ªé›¶é›¶ï¼Œé‚£å°±ä¸ä¼šè½»æ˜“æ›´æ”¹è‡ªå·±çš„ç­–ç•¥ï¼Œä¸è¦å¿˜äº†<a href="/game_strategy/#%E5%8A%A8%E6%9C%BA-1">åŠ¨æœº1</a>ã€<a href="/game_strategy/#%E5%8A%A8%E6%9C%BA-2">åŠ¨æœº2</a>å’Œ<a href="/game_strategy/#%E7%BB%93%E8%AE%BA-5">ç»“è®º5</a>ã€‚</p>
<p>è¿™å°±ç±»ä¼¼å…¨å±€æœ€ä¼˜è§£å’Œå±€éƒ¨æœ€ä¼˜è§£ã€‚</p>
<h3 id="å¸•ç´¯æ‰˜ä¼˜åŠ¿"><a href="#å¸•ç´¯æ‰˜ä¼˜åŠ¿" class="headerlink" title="å¸•ç´¯æ‰˜ä¼˜åŠ¿"></a>å¸•ç´¯æ‰˜ä¼˜åŠ¿</h3><p>åœ¨åˆšæ‰ä¸Šé¢é‚£ä¸ªåšå¼ˆä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ¸…æ¥šçš„çœ‹åˆ°ï¼Œå·¦ä¸Šçš„é‚£ä¸ªçº³ä»€å‡è¡¡çš„æ”¶ç›Šæ˜¯ä¸¥æ ¼å¤§äºå³ä¸‹çš„é‚£ä¸ªçš„ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬é‡å¤è¿™æ¬¡åšå¼ˆã€‚é‚£ä¹ˆæœ€ç»ˆé€‰æ‹©å·¦ä¸Šçš„å‡ ç‡ä¼šæ˜¯ç™¾åˆ†ä¹‹ç™¾ã€‚</p>
<p>è¿™å°±å«åš <strong>å¸•ç´¯æ‰˜ä¼˜åŠ¿(Pareto Dominate)</strong> ã€‚</p>
<hr>
<p>å’•äº†ã€‚</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>çº¿æ€§ä»£æ•°</title>
    <url>/notes/linar-algebra/</url>
    <content><![CDATA[<p>ç®€ä»‹ï¼šçº¿æ€§ä»£æ•°</p>
<span id="more"></span>

<h1 id="æ’åˆ—ç›¸å…³"><a href="#æ’åˆ—ç›¸å…³" class="headerlink" title="æ’åˆ—ç›¸å…³"></a>æ’åˆ—ç›¸å…³</h1><h2 id="æ’åˆ—"><a href="#æ’åˆ—" class="headerlink" title="æ’åˆ—"></a>æ’åˆ—</h2><p>æ’åˆ—æŒ‡ç”± $[1,n]$ èŒƒå›´å†…çš„æ‰€æœ‰æ•´æ•°ç»„æˆçš„ä¸€ä¸ªæœ‰åºæ•°åˆ—å«åš $n$ çº§æ’åˆ—ã€‚</p>
<h2 id="é€†åºç›¸å…³"><a href="#é€†åºç›¸å…³" class="headerlink" title="é€†åºç›¸å…³"></a>é€†åºç›¸å…³</h2><h3 id="é€†åº"><a href="#é€†åº" class="headerlink" title="é€†åº"></a>é€†åº</h3><p><strong>é€†åº</strong>æŒ‡å¤§æƒæ’åœ¨å°æƒåé¢ã€‚</p>
<h3 id="é€†åºæ•°"><a href="#é€†åºæ•°" class="headerlink" title="é€†åºæ•°"></a>é€†åºæ•°</h3><p><strong>é€†åºæ•°</strong>æŒ‡é€†åºçš„æ€»æ•°ï¼Œç”¨ $N(A_n)$ æ¥è¡¨ç¤ºï¼Œå…¶ä¸­æ‹¬å·é‡Œçš„æ˜¯ä¸€ä¸ªnçº§æ’åˆ—ã€‚</p>
<p>å¦‚æœ $N(A_n)&#x3D;0$ ï¼Œé‚£æˆ‘ä»¬ç§°è¿™ä¸ªæ’åˆ—ä¸º<strong>æ ‡å‡†æ’åˆ—</strong>æˆ–è€…<strong>è‡ªç„¶æ’åˆ—</strong>ï¼Œå…¶ä¸­æ‰€æœ‰å…ƒç´ éƒ½æ˜¯æŒ‰ç…§é¡ºåºæ’åˆ—ã€‚</p>
<h3 id="å¥‡å¶æ’åˆ—"><a href="#å¥‡å¶æ’åˆ—" class="headerlink" title="å¥‡å¶æ’åˆ—"></a>å¥‡å¶æ’åˆ—</h3><p>å¯¹äºä¸€ä¸ªnçº§æ’åˆ— $A_n$ ï¼Œå¦‚æœ $N(A_n)  \% 2 &#x3D; 1 $ ï¼ˆå³é€†åºæ•°ä¸ºå¥‡æ•°ï¼‰ï¼Œé‚£å®ƒæ˜¯ä¸€ä¸ªå¥‡æ’åˆ—ï¼›åä¹‹ï¼ˆ $N(A_n) \% 2 &#x3D; 0 $ ï¼Œé€†åºæ•°ä¸ºå¶æ•°ï¼‰åˆ™æ˜¯ä¸€ä¸ªå¶æ’åˆ—ã€‚</p>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„å®šç†ï¼š</p>
<p>$n$ çº§æ’åˆ—ä¸­ï¼Œå¥‡æ’åˆ—ä¸å¶æ’åˆ—å„æœ‰ $\dfrac{n!}{2}$ ä¸ªã€‚</p>
<h3 id="å¯¹æ¢"><a href="#å¯¹æ¢" class="headerlink" title="å¯¹æ¢"></a>å¯¹æ¢</h3><p><strong>å¯¹æ¢</strong>å³äº¤æ¢ä¸¤ä¸ªæ•°çš„é¡ºåºï¼Œä¸æˆ‘ä»¬å¸¸ç”¨çš„<code>swap()</code>å‡½æ•°ç±»ä¼¼ã€‚</p>
<p>å¯¹æ¢ä¸€æ¬¡ä¹‹åä¼šä½¿æ’åˆ—çš„å¥‡å¶æ€§<strong>ç¿»è½¬</strong>ã€‚</p>
<h1 id="è¡Œåˆ—å¼"><a href="#è¡Œåˆ—å¼" class="headerlink" title="è¡Œåˆ—å¼"></a>è¡Œåˆ—å¼</h1><p>ï¼ˆæœ¬éƒ¨åˆ†æŒ‰ç…§å®‹æµ©è€å¸ˆè®²è¯¾é¡ºåºæ’°å†™ï¼Œä¼šå‡ºç°éƒ¨åˆ†å¼•ç”¨ï¼‰</p>
<p>ä»Šå¤©AJåªç»™åŒå­¦ä»¬ç•™äº†ä¸€é“é¢˜ç›®ä½œä¸ºä½œä¸šï¼š</p>
<p>è§£æ–¹ç¨‹ã€‚</p>
<p>$$<br>\begin{cases}<br>5x+6y&#x3D;7 \\<br>9x+4y&#x3D;3<br>\end{cases}<br>\tag {2.0.1}<br>$$<br>ç®€å•ã€‚</p>
<p>å­¦è¿‡äºŒå…ƒä¸€æ¬¡æ–¹ç¨‹ç»„çš„äººéƒ½èƒ½åšå¾—å‡ºæ¥ã€‚</p>
<p>æˆ‘ä»¬é¦–å…ˆæ¶ˆæ‰ $x$ ï¼ŒæŠŠæ–¹ç¨‹ç»„å˜æˆè¿™ä¸ªæ ·å­ï¼š</p>
<p>$$<br>\begin{cases}<br>9 \times 5x + 9 \times 6y &#x3D; 7 \times 9 \\<br>5 \times 9x + 5 \times 4y &#x3D; 3 \times 5<br>\end{cases}<br>\tag{2.0.2}<br>$$</p>
<p>å¯å¾—</p>
<p>$$<br>\begin{align}<br>x &amp; &#x3D; \frac{7 \times 4 - 6 \times 3}{5 \times 4 - 6 \times 9} \tag{2.0.3} \\<br>y &amp; &#x3D; \frac{3 \times 5 - 7 \times 9}{5 \times 4 - 6 \times 9} \tag{2.0.4}<br>\end{align}<br>$$</p>
<p>ç„¶è€Œç­é‡Œå”¯ä¸€å­¦è¿‡é«˜ç­‰æ•°å­¦ï¼ˆç°åœ¨ä¸æ˜¯äº†ï¼‰çš„ç‹å“¥ç”¨å¦ä¸€ç§æ–¹æ³•åšäº†å‡ºæ¥ã€‚</p>
<h2 id="äºŒé˜¶è¡Œåˆ—å¼"><a href="#äºŒé˜¶è¡Œåˆ—å¼" class="headerlink" title="äºŒé˜¶è¡Œåˆ—å¼"></a>äºŒé˜¶è¡Œåˆ—å¼</h2><p>$$<br>\begin{align}<br>x &amp; &#x3D; \frac{\begin{vmatrix} 7 &amp; 6 \\ 3 &amp; 4 \end{vmatrix}}{\begin{vmatrix} 5 &amp; 6 \\ 9 &amp; 4 \end{vmatrix}} \tag{2.1.1} \\<br>y &amp; &#x3D; \frac{\begin{vmatrix} 3 &amp; 7 \\ 9 &amp; 5 \end{vmatrix}}{\begin{vmatrix} 5 &amp; 6 \\ 9 &amp; 4 \end{vmatrix}} \tag{2.1.2}<br>\end{align}<br>$$</p>
<p>ç‹å“¥åæ¥è§£é‡Šé“ï¼šâ€œè¿™ç©æ„å«åšäºŒé˜¶è¡Œåˆ—å¼ã€‚äºŒé˜¶è¡Œåˆ—å¼æ˜¯è¿™ä¹ˆç”¨çš„ï¼š<br>$$<br>\begin{vmatrix} a &amp; b \\ c &amp; d \end{vmatrix} &#x3D; ad - bc<br>\tag{2.1.3}<br>$$<br>æ‰€ä»¥æœ€ç»ˆå±•å¼€ä¹‹åæ˜¯å¤§å®¶å¾—åˆ°çš„ç­”æ¡ˆã€‚â€</p>
<p>äºæ˜¯ï¼ŒåŒå­¦ä»¬å¼€å§‹å¹¿æ³›åœ°<del>çç©</del>ä½¿ç”¨äºŒé˜¶è¡Œåˆ—å¼ã€‚</p>
<h2 id="ä¸‰é˜¶è¡Œåˆ—å¼"><a href="#ä¸‰é˜¶è¡Œåˆ—å¼" class="headerlink" title="ä¸‰é˜¶è¡Œåˆ—å¼"></a>ä¸‰é˜¶è¡Œåˆ—å¼</h2><p>ä½†æ˜¯tueä¸æ»¡è¶³äºäºŒé˜¶è¡Œåˆ—å¼ã€‚ä»–è¿½é—®ï¼šâ€œæœ‰äºŒé˜¶çš„ï¼Œæ˜¯ä¸æ˜¯è¿˜ä¼šæœ‰ä¸‰é˜¶çš„ï¼Ÿâ€</p>
<p>ç‹å“¥ï¼šâ€œæ˜¯çš„ã€‚ä½†æ˜¯ä¸‰é˜¶è¡Œåˆ—å¼æ›´åŠ å¤æ‚ã€‚æ¯”å¦‚è¿™ä¸ªï¼š</p>
<p>$$<br>\begin{vmatrix}<br>a &amp; b &amp; c \\<br>d &amp; e &amp; f \\<br>g &amp; h &amp; i<br>\end{vmatrix}<br>&#x3D; aei+bfg+cdh-afh-bdi-ceg<br>\tag{2.2.1}<br>$$</p>
<p>äºŒé˜¶è¡Œåˆ—å¼å±•å¼€åçš„ç»“æœæ˜¯ä¸»å¯¹è§’çº¿ä¸Šçš„æ•°å­—ç›¸ä¹˜å‡å»æ¬¡å¯¹è§’çº¿ä¸Šçš„æ•°å­—ç›¸ä¹˜ï¼Œååˆ†ç®€å•ï¼›ä½†æ˜¯ä¸‰é˜¶è¡Œåˆ—å¼å°±ä¸ä¸€æ ·äº†ã€‚å®ƒå±•å¼€åçš„ç»“æœæ˜¯è¿™æ ·çš„ï¼š</p>
<p>æˆ‘ä»¬è¦æŠŠè¿™ä¸ªè¡Œåˆ—å¼åœ¨å®ƒçš„å³è¾¹èªŠå†™ä¸€éï¼Œåƒè¿™æ ·ï¼š</p>
<p>$$<br>\begin{vmatrix}<br>a &amp; b &amp; c \\<br>d &amp; e &amp; f \\<br>g &amp; h &amp; i<br>\end{vmatrix}<br>\begin{vmatrix}<br>a &amp; b &amp; c \\<br>d &amp; e &amp; f \\<br>g &amp; h &amp; i<br>\end{vmatrix}<br>\tag{2.2.2}<br>$$</p>
<p>ç„¶åè¿çº¿ï¼š</p>
<p>å…ˆè¿ä¸ä¸»å¯¹è§’çº¿å¹³è¡Œçš„ä¸‰æ¡ï¼Œä¸é‡å¤çš„è¿ç»“æ‰€æœ‰æ•°å­—</p>
<p><img src="https://i.loli.net/2021/10/01/ydZtcIBgCxRmSvr.png" alt="çº¿ä»£1.png"></p>
<p>å†è¿ä¸æ¬¡å¯¹è§’çº¿å¹³è¡Œçš„ä¸‰æ¡ï¼Œä¸é‡å¤çš„è¿ç»“æ‰€æœ‰æ•°å­—</p>
<p><img src="https://i.loli.net/2021/10/01/SMFi3Y2otIxq1Tl.png" alt="çº¿ä»£2.png"></p>
<p>æœ€åæŠŠä¸‰æ¡è“è‰²çº¿ï¼ˆä¸ä¸»å¯¹è§’çº¿å¹³è¡Œï¼‰ä¸Šçš„æ•°å­—åˆ†åˆ«ç›¸ä¹˜åæ±‚å’Œå‡å»ä¸‰æ¡ç»¿è‰²çº¿ï¼ˆä¸æ¬¡å¯¹è§’çº¿å¹³è¡Œï¼‰ä¸Šçš„æ•°å­—åˆ†åˆ«ç›¸ä¹˜ä¹‹åçš„ç§¯ä¹‹å’Œã€‚</p>
<p>å°±æ˜¯è¿™æ ·ï¼š</p>
<p>$$<br>\begin{vmatrix}<br>a &amp; b &amp; c \\<br>d &amp; e &amp; f \\<br>g &amp; h &amp; i<br>\end{vmatrix}<br>&#x3D; \color{blue}{(aei+bfg+cdh)} - \color{green}{(afh+bdi+ceg)}<br>\tag{2.2.3}<br>$$</p>
<p>è¿™æ ·ç®—èµ·æ¥ååˆ†éº»çƒ¦ï¼Œè¿˜å®¹æ˜“ç®—é”™ï¼Œæ‰€ä»¥ï¼Œç°é˜¶æ®µæˆ‘ä¸å»ºè®®ä½¿ç”¨ä¸‰é˜¶è¡Œåˆ—å¼ã€‚â€</p>
<h2 id="né˜¶è¡Œåˆ—å¼"><a href="#né˜¶è¡Œåˆ—å¼" class="headerlink" title="né˜¶è¡Œåˆ—å¼"></a>né˜¶è¡Œåˆ—å¼</h2><p>$n$ é˜¶è¡Œåˆ—å¼çš„å±•å¼€éµå¾ªè¿™æ ·çš„è§„åˆ™ï¼š</p>
<ul>
<li>é¦–å…ˆåˆ—å‡ºæ‰€æœ‰åˆ—æ ‡çš„æ’åˆ—ç»„åˆå¯èƒ½ï¼›</li>
<li>ç„¶åå†åˆ†åˆ«ç®—å‡ºæ¯ä¸€ä¸ªæ’åˆ—çš„å¥‡å¶æ€§ï¼›</li>
<li>å°†æ¯ä¸€ä¸ªåˆ—æ ‡æ‰€å¯¹åº”çš„æ’åˆ—ä¸­çš„å…ƒç´ ç›¸ä¹˜ï¼Œå…¶ä¸­ä¿è¯å…ƒç´ ä¸é‡å¤ï¼ˆæˆ–è€…è¯´è¡Œæ ‡å–æ ‡å‡†æ’åˆ—ï¼‰ï¼›</li>
<li>æœ€åå†å°†å¶æ’åˆ—çš„å’Œå‡å»å¥‡æ’åˆ—çš„å’Œã€‚</li>
</ul>
<p>ç”¨å¼å­è¡¨ç¤ºå¤§æ¦‚å°±æ˜¯è¿™æ ·ï¼š</p>
<p>$$<br>\begin{vmatrix}<br>a_{1,1} &amp; a_{1,2} &amp; a_{1,3} &amp; \dots &amp; a_{1,n} \\<br>a_{2,1} &amp; a_{2,2} &amp; a_{2,3} &amp; \dots &amp; a_{2,n} \\<br>a_{3,1} &amp; a_{3,2} &amp; a_{3,3} &amp; \dots &amp; a_{3,n} \\<br>\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\<br>a_{n,1} &amp; a_{n,2} &amp; a_{n,3} &amp; \dots &amp; a_{n,n}<br>\end{vmatrix}<br>&#x3D;<br>\sum_{j1 , j2 , \dots , jn} (-1)^{N(j1 , j2 , \dots , jn)}<br>a_1 j_1 \ a_2 j_2 \ \dots a_n j_n<br>\tag{2.3.1}</p>
<p>$$</p>
<p>æˆ‘ä»¬é€šå¸¸è¿™æ ·è¡¨ç¤ºï¼š$D (æˆ– Det(a))&#x3D; |a_{i,j}| $ ã€‚</p>
<p>å¹¶ä¸”ï¼Œæ˜¾è€Œæ˜“è§çš„ï¼Œç‰¹åˆ«åœ°ï¼Œ$|a_{1,1}| &#x3D; a_{1,1}$ ã€‚</p>
<p>ç„¶åæˆ‘ä»¬ä¼šçœ‹è§ï¼š $\exists |a| \neq |a|$<br>æ¯”å¦‚ï¼š$|-1| \neq |-1|$ ã€‚<br>å› ä¸ºå·¦å³ä¸¤è¾¹ä¸€ä¸ªæ˜¯è¡Œåˆ—å¼ï¼Œå¦ä¸€ä¸ªæ˜¯ç»å¯¹å€¼ã€‚<br>è¿™ä¸ªä¸€å®šè¦åˆ†æ¸…ã€‚</p>
<h2 id="ç‰¹æ®Šå½¢æ€çš„è¡Œåˆ—å¼"><a href="#ç‰¹æ®Šå½¢æ€çš„è¡Œåˆ—å¼" class="headerlink" title="ç‰¹æ®Šå½¢æ€çš„è¡Œåˆ—å¼"></a>ç‰¹æ®Šå½¢æ€çš„è¡Œåˆ—å¼</h2><p>æœ‰ä¸€äº›ç‰¹æ®Šçš„è¡Œåˆ—å¼ï¼Œä»–ä»¬å…·æœ‰ç‰¹æ®Šçš„ç»“æ„ï¼š</p>
<h3 id="å¯¹è§’å½¢è¡Œåˆ—å¼"><a href="#å¯¹è§’å½¢è¡Œåˆ—å¼" class="headerlink" title="å¯¹è§’å½¢è¡Œåˆ—å¼"></a>å¯¹è§’å½¢è¡Œåˆ—å¼</h3><p>å½¢å¦‚<br>$$<br>\begin{vmatrix}<br>a_{1,1} &amp; &amp; \\<br>&amp; \ddots &amp; \\<br>&amp; &amp; a_{n,n}<br>\end{vmatrix}<br>\tag{2.4.1}<br>\label{main}<br>$$</p>
<p>çš„è¡Œåˆ—å¼ç§°ä¸ºå¯¹è§’å½¢è¡Œåˆ—å¼ã€‚</p>
<p>å±•å¼€åçš„ç»“æœæ˜¯ï¼š $D_{å¯¹è§’å½¢} &#x3D; \prod\limits_{i&#x3D;1}^n a_{i,i} $ ã€‚</p>
<h3 id="ä¸Šã€ä¸‹ä¸‰è§’è¡Œåˆ—å¼"><a href="#ä¸Šã€ä¸‹ä¸‰è§’è¡Œåˆ—å¼" class="headerlink" title="ä¸Šã€ä¸‹ä¸‰è§’è¡Œåˆ—å¼"></a>ä¸Šã€ä¸‹ä¸‰è§’è¡Œåˆ—å¼</h3><p>å½¢å¦‚<br>$$<br>\begin{vmatrix}<br>a_{1,1} &amp; a_{1,2} &amp; a_{1,3} &amp; \cdots &amp; a_{1,n} \\<br>&amp; a_{2,2} &amp; a_{2,3} &amp; \cdots &amp; a_{2,n} \\<br>&amp;&amp; a_{3,3} &amp; \cdots &amp; a_{3,n} \\<br>&amp;&amp;&amp; \ddots &amp; \vdots \\<br>&amp;&amp;&amp;&amp; a_{n,n}<br>\end{vmatrix}<br>\tag{2.4.2}<br>$$<br>çš„è¡Œåˆ—å¼ç§°ä½œ<strong>ä¸Šä¸‰è§’è¡Œåˆ—å¼</strong>ï¼Œè€Œå½¢å¦‚<br>$$<br>\begin{vmatrix}<br>a_{1,1} &amp;&amp;&amp;&amp; \\<br>a_{2,1} &amp; a_{2,2} &amp;&amp;&amp; \\<br>a_{3,1} &amp; a_{3,2} &amp; a_{3,3} &amp;&amp; \\<br>\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \\<br>a_{n,1} &amp; a_{n,2} &amp; a_{n,3} &amp; \cdots &amp; a_{n,n}<br>\end{vmatrix}<br>\tag{2.4.3}<br>$$<br>çš„ç§°ä½œ<strong>ä¸‹ä¸‰è§’è¡Œåˆ—å¼</strong>ã€‚</p>
<p>å±•å¼€åçš„ç»“æœæ˜¯ï¼š$D_{ä¸Šä¸‰è§’}&#x3D;(-1)^{\frac{n(n-1)}{2}}\prod\limits_{i-1}^n a_{i,i}$ ï¼Œ$D_{ä¸‹ä¸‰è§’}&#x3D;(-1)^{\frac{n(n-1)}{2}}\prod\limits_{i-1}^n a_{i,i}$</p>
<p>è®°ä½ï¼šä¸è®ºæ˜¯å¯¹è§’å½¢è¿˜æ˜¯ä¸Šä¸‹ä¸‰è§’ï¼Œç”¨çš„éƒ½æ˜¯<strong>ä¸»å¯¹è§’çº¿</strong>ã€‚</p>
<h3 id="èŒƒå¾·è’™å¾·è¡Œåˆ—å¼"><a href="#èŒƒå¾·è’™å¾·è¡Œåˆ—å¼" class="headerlink" title="èŒƒå¾·è’™å¾·è¡Œåˆ—å¼"></a>èŒƒå¾·è’™å¾·è¡Œåˆ—å¼</h3><p>è·³è½¬ï¼š<a href="/notes/linar-algebra/#%E8%8C%83%E5%BE%B7%E8%92%99%E5%BE%B7(Vandermonde)%E8%A1%8C%E5%88%97%E5%BC%8F">èŒƒå¾·è’™å¾·è¡Œåˆ—å¼</a></p>
<h3 id="å¯¹ç§°è¡Œåˆ—å¼"><a href="#å¯¹ç§°è¡Œåˆ—å¼" class="headerlink" title="å¯¹ç§°è¡Œåˆ—å¼"></a>å¯¹ç§°è¡Œåˆ—å¼</h3><p>è·³è½¬ï¼š<a href="/notes/linar-algebra/#%E5%AF%B9%E7%A7%B0%E8%A1%8C%E5%88%97%E5%BC%8F">å¯¹ç§°è¡Œåˆ—å¼</a></p>
<h3 id="åå¯¹ç§°è¡Œåˆ—å¼"><a href="#åå¯¹ç§°è¡Œåˆ—å¼" class="headerlink" title="åå¯¹ç§°è¡Œåˆ—å¼"></a>åå¯¹ç§°è¡Œåˆ—å¼</h3><p>è·³è½¬ï¼š<a href="/notes/linar-algebra/#%E5%8F%8D%E5%AF%B9%E7%A7%B0%E8%A1%8C%E5%88%97%E5%BC%8F">åå¯¹ç§°è¡Œåˆ—å¼</a></p>
<h2 id="è¡Œåˆ—å¼çš„æ€§è´¨"><a href="#è¡Œåˆ—å¼çš„æ€§è´¨" class="headerlink" title="è¡Œåˆ—å¼çš„æ€§è´¨"></a>è¡Œåˆ—å¼çš„æ€§è´¨</h2><h3 id="è½¬ç½®"><a href="#è½¬ç½®" class="headerlink" title="è½¬ç½®"></a>è½¬ç½®</h3><p>ä¸çŸ©é˜µä¸€æ ·ï¼Œè¡Œåˆ—å¼ä¹Ÿå¯ä»¥è¿›è¡Œè½¬ç½®ã€‚</p>
<p>è¡Œåˆ—å¼ $D$ è½¬ç½®ä¹‹åçš„è¡Œåˆ—å¼ï¼Œæˆ‘ä»¬ç§°å…¶ä¸º è¡Œåˆ—å¼ $D$ çš„è½¬ç½®è¡Œåˆ—å¼ï¼Œè®°ä½œ $D^T$ æˆ–è€… $Dâ€™$ ï¼ˆå°‘ç”¨ï¼‰ã€‚</p>
<h4 id="æ€§è´¨"><a href="#æ€§è´¨" class="headerlink" title="æ€§è´¨"></a>æ€§è´¨</h4><p>$(D^T)^T \equiv D$ .</p>
<h3 id="æ€§è´¨-1"><a href="#æ€§è´¨-1" class="headerlink" title="æ€§è´¨"></a>æ€§è´¨</h3><h4 id="æ€§è´¨1"><a href="#æ€§è´¨1" class="headerlink" title="æ€§è´¨1"></a>æ€§è´¨1</h4><p>$D^T&#x3D;D$ .</p>
<p>è¿™é‡Œæˆ‘ä»¬è¦æ³¨æ„ï¼šåœ¨è¡Œåˆ—å¼ä¸­ï¼Œ<strong>å¯¹è¡Œæˆç«‹çš„æ€§è´¨ï¼Œå¯¹åˆ—ä¹Ÿæˆç«‹ã€‚</strong></p>
<h4 id="æ€§è´¨2"><a href="#æ€§è´¨2" class="headerlink" title="æ€§è´¨2"></a>æ€§è´¨2</h4><p><strong>ä¸¤è¡Œï¼ˆåˆ—ï¼‰äº’æ¢ï¼Œè¡Œåˆ—å¼çš„å€¼è¦å˜å·ã€‚</strong></p>
<p>æ¨è®ºï¼š<strong>ä¸¤è¡Œï¼ˆåˆ—ï¼‰ç›¸ç­‰ï¼Œ</strong>$D &#x3D; 0$ <strong>.</strong></p>
<h4 id="æ€§è´¨3"><a href="#æ€§è´¨3" class="headerlink" title="æ€§è´¨3"></a>æ€§è´¨3</h4><p><strong>æŸä¸€è¡Œï¼ˆåˆ—ï¼‰éƒ½ä¹˜kï¼Œç›¸å½“äºkä¹˜ä»¥Dã€‚</strong><br>$$<br>\begin{vmatrix}a&amp;b&amp;c\\kd&amp;ke&amp;kf\\g&amp;h&amp;i\end{vmatrix}<br>&#x3D;k<br>\begin{vmatrix}a&amp;b&amp;c\\d&amp;e&amp;f\\g&amp;h&amp;i\end{vmatrix}<br>\tag{2.5.1}<br>$$</p>
<p>æ¨è®ºï¼š<strong>æŸä¸€è¡Œï¼ˆåˆ—ï¼‰æœ‰å…¬å› å­kï¼Œkå¯ä»¥æåˆ°å¤–é¢å»ã€‚</strong></p>
<h4 id="æ€§è´¨4"><a href="#æ€§è´¨4" class="headerlink" title="æ€§è´¨4"></a>æ€§è´¨4</h4><p><strong>ä¸¤è¡Œï¼ˆåˆ—ï¼‰å¯¹åº”æˆæ¯”ä¾‹ï¼Œè¡Œåˆ—å¼çš„å€¼ç­‰äº0ã€‚</strong></p>
<p>æ¨è®ºï¼š<strong>å¦‚æœè¡Œåˆ—å¼æŸä¸€è¡Œï¼ˆåˆ—ï¼‰ç­‰äº0ï¼Œè¡Œåˆ—å¼ç­‰äº0ã€‚</strong></p>
<h4 id="æ€§è´¨5"><a href="#æ€§è´¨5" class="headerlink" title="æ€§è´¨5"></a>æ€§è´¨5</h4><p>$$<br>\begin{vmatrix}<br>a&amp;b&amp;c\\d+dâ€™&amp;e+eâ€™&amp;f+fâ€™\\g&amp;h&amp;i<br>\end{vmatrix}<br>&#x3D;<br>\begin{vmatrix}<br>a&amp;b&amp;c\\d&amp;e&amp;f\\g&amp;h&amp;i<br>\end{vmatrix}<br>+<br>\begin{vmatrix}<br>a&amp;b&amp;c\\dâ€™&amp;eâ€™&amp;fâ€™\\g&amp;h&amp;i<br>\end{vmatrix}<br>\tag{2.5.2}<br>$$</p>
<p><em><strong>æ³¨æ„</strong></em>ï¼šè¿™ä¸ªåªé’ˆå¯¹äº<strong>æŸä¸€è¡Œï¼ˆåˆ—ï¼‰</strong>ï¼Œå…¶ä½™çš„è¡Œï¼ˆåˆ—ï¼‰<strong>ä¸å˜</strong>ï¼</p>
<h4 id="æ€§è´¨6"><a href="#æ€§è´¨6" class="headerlink" title="æ€§è´¨6"></a>æ€§è´¨6</h4><p><strong>æŸä¸€è¡Œï¼ˆåˆ—ï¼‰ä¹˜ä»¥ä¸€ä¸ªæ•°ï¼ŒåŠ åˆ°å¦ä¸€è¡Œï¼ˆåˆ—ï¼‰ä¸Šå»ï¼Œè¡Œåˆ—å¼çš„å€¼ä¸å˜ã€‚</strong></p>
<p>å¥½äº†ï¼Œç°åœ¨è®©æˆ‘ä»¬åˆ©ç”¨è¿™äº›æ€§è´¨ï¼Œå°†è¿™ä¸ªè¡Œåˆ—å¼å˜ä¸ºä¸Šä¸‰è§’è¡Œåˆ—å¼å§ï¼</p>
<p>$$<br>\begin{align}<br>D&#x3D;{} &amp;<br>\begin{vmatrix}<br>1&amp;2&amp;0&amp;1\\2&amp;3&amp;10&amp;0\\0&amp;3&amp;5&amp;18\\5&amp;10&amp;15&amp;4<br>\end{vmatrix}\\<br>&#x3D;{} &amp;<br>\begin{vmatrix}<br>1&amp;2&amp;0&amp;1\\2+1\times(-2)&amp;3+2\times(-2)&amp;10+0\times(-2)&amp;0+1\times(-2)\\0&amp;3&amp;5&amp;18\\5&amp;10&amp;15&amp;4<br>\end{vmatrix}\\<br>&#x3D;{} &amp;<br>\begin{vmatrix}<br>1&amp;2&amp;0&amp;1\\\color{red}{0}&amp;-1&amp;10&amp;-2\\0&amp;3&amp;5&amp;18\\5+1\times(-5)&amp;10+2\times(-5)&amp;15+0\times(-5)&amp;4+1\times(-5)<br>\end{vmatrix}\\<br>&#x3D;{} &amp;<br>\begin{vmatrix}<br>1&amp;2&amp;0&amp;1\\\color{red}{0}&amp;-1&amp;10&amp;-2\\0+0\times 3&amp;3+(-1)\times 3&amp;5+10\times 3&amp;18+(-2)\times 3\\0&amp;0&amp;15&amp;-1<br>\end{vmatrix}\\<br>&#x3D;{} &amp;<br>\begin{vmatrix}<br>1&amp;2&amp;0&amp;1\\\color{red}{0}&amp;-1&amp;10&amp;-2\\\color{red}{0}&amp;\color{red}{0}&amp;35&amp;12\\0+0\times(-\frac{3}{7})&amp;0+0\times(-\frac{3}{7})&amp;15+35\times(-\frac{3}{7})&amp;-1+12\times(-\frac{3}{7})<br>\end{vmatrix}\\<br>&#x3D;{} &amp;<br>\begin{vmatrix}<br>1&amp;2&amp;0&amp;1\\\color{red}{0}&amp;-1&amp;10&amp;-2\\\color{red}{0}&amp;\color{red}{0}&amp;35&amp;12\\\color{red}{0}&amp;\color{red}{0}&amp;\color{red}{0}&amp;-\frac{43}{7}<br>\end{vmatrix}\\<br>&#x3D;{} &amp; 215<br>\end{align}<br>\tag{2.5.3}<br>$$<br>åœ¨è§£è¿™ä¸€äº›è¡Œåˆ—å¼çš„æ—¶å€™ï¼Œæˆ‘ä»¬é€šå¸¸ç”¨è¿™ä¸ªé¡ºåºæ¥è§£ï¼š</p>
<p><img src="https://i.loli.net/2021/10/02/kM5ZneSjdmqylBI.gif" alt="çº¿ä»£4.gif"></p>
<h2 id="å­å¼ä¸ä½™å­å¼"><a href="#å­å¼ä¸ä½™å­å¼" class="headerlink" title="å­å¼ä¸ä½™å­å¼"></a>å­å¼ä¸ä½™å­å¼</h2><p>æˆ‘ä»¬å»æ‰ä¸€ä¸ª$n$é˜¶è¡Œåˆ—å¼$D_{n \times n}$çš„ $k$ è¡Œä¸ $k$ åˆ—ä¹‹åï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†å®ƒçš„ä¸€ä¸ª $k$ é˜¶ä½™å­å¼ã€‚</p>
<p>ä¾‹å¦‚è¿™ä¸ªè¡Œåˆ—å¼ï¼š<br>$$<br>\begin{vmatrix}<br>a_{1,1} &amp; a_{1,2} &amp; a_{1,3} &amp; a_{1,4} \\<br>a_{2,1} &amp; a_{2,2} &amp; a_{2,3} &amp; a_{2,4} \\<br>a_{3,1} &amp; a_{3,2} &amp; a_{3,3} &amp; a_{3,4} \\<br>a_{4,1} &amp; a_{4,2} &amp; a_{4,3} &amp; a_{4,4}<br>\end{vmatrix}<br>\tag{2.6.1}<br>$$<br>æˆ‘ä»¬å–èµ° $a_{3,2}$ æ‰€åœ¨çš„è¡Œä¸åˆ—ä¹‹åï¼Œå¾—åˆ°çš„è¡Œåˆ—å¼æ˜¯è¿™æ ·çš„ï¼š<br>$$<br>\begin{vmatrix}<br>a_{1,1} &amp; a_{1,3} &amp; a_{1,4} \\<br>a_{2,1} &amp; a_{2,3} &amp; a_{2,4} \\<br>a_{4,1} &amp; a_{4,3} &amp; a_{4,4}<br>\end{vmatrix}<br>\tag{2.6.2}<br>$$<br>æˆ‘ä»¬ç§°è¿™æ ·å¾—åˆ°çš„ä½™å­å¼ä¸º $M_{3,2}$ ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬å°† $M_{3,2} \times (-1)^{3+2}$ çš„è¯ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†åŸè¡Œåˆ—å¼çš„ä»£æ•°ä½™å­å¼ï¼Œè®°ä½œ$A_{3,2}$ ã€‚</p>
<h3 id="å®šç†1"><a href="#å®šç†1" class="headerlink" title="å®šç†1"></a>å®šç†1</h3><p>$D &#x3D; \sum\limits_{j&#x3D;1}^{n} a_{i,j}A_{i,j}$ï¼Œ æˆ– $D &#x3D; \sum\limits_{i&#x3D;1}^{n} a_{i,j}A_{i,j}$</p>
<h3 id="å®šç†2"><a href="#å®šç†2" class="headerlink" title="å®šç†2"></a>å®šç†2</h3><p>æŸä¸€è¡Œå…ƒç´ ä¸å¦ä¸€è¡Œå…ƒç´ çš„ä»£æ•°ä½™å­å¼ä¹˜ç§¯ä¹‹å’Œä¸º0ã€‚</p>
<h3 id="å­å¼"><a href="#å­å¼" class="headerlink" title="å­å¼"></a>å­å¼</h3><p>å¯¹äºä¸€ä¸ª$n$é˜¶è¡Œåˆ—å¼$D_{n \times n}$ï¼Œæˆ‘ä»¬å–å…¶ä¸­çš„$k$è¡Œ$k$åˆ—çš„äº¤ç‚¹ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ª$k$é˜¶çš„è¡Œåˆ—å¼ã€‚</p>
<p>å¦‚ï¼š<br>$$<br>\begin{vmatrix}<br>a_{1,1} &amp; a_{1,2} &amp; a_{1,3} &amp; \dots &amp; a_{1,n} \\<br>a_{2,1} &amp; a_{2,2} &amp; a_{2,3} &amp; \dots &amp; a_{2,n} \\<br>a_{3,1} &amp; a_{3,2} &amp; a_{3,3} &amp; \dots &amp; a_{3,n} \\<br>\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\<br>a_{n,1} &amp; a_{n,2} &amp; a_{n,3} &amp; \dots &amp; a_{n,n}<br>\end{vmatrix}<br>\tag{2.6.3}<br>$$<br>è¿™ä¸ªè¡Œåˆ—å¼çš„ä¸€ä¸ª$k$é˜¶å­å¼å¯ä»¥æ˜¯<br>$$<br>\begin{vmatrix}<br>a_{i,j} &amp; \cdots &amp; a_{i,j+k} \\<br>\vdots &amp; \ddots &amp; \vdots \\<br>a_{i+k,j} &amp; \cdots &amp; a_{i+k,j+k}<br>\end{vmatrix}<br>\tag{2.6.4}<br>$$</p>
<h2 id="æ‹‰æ™®æ‹‰æ–¯-Laplace-å®šç†"><a href="#æ‹‰æ™®æ‹‰æ–¯-Laplace-å®šç†" class="headerlink" title="æ‹‰æ™®æ‹‰æ–¯(Laplace)å®šç†"></a>æ‹‰æ™®æ‹‰æ–¯(Laplace)å®šç†</h2><p>å–å®š$k$è¡Œï¼Œç”±$k$è¡Œå…ƒç´ ç»„æˆçš„æ‰€æœ‰$k$é˜¶å­å¼ä¸ä»£æ•°ä½™å­å¼ä¹˜ç§¯ä¹‹å’Œ$&#x3D;D$ ã€‚</p>
<p>ä¾‹ï¼š</p>
<p>è¡Œåˆ—å¼<br>$$<br>\begin{vmatrix}<br>1&amp;2&amp;0&amp;0&amp;0\\3&amp;4&amp;0&amp;0&amp;0\\1&amp;2&amp;3&amp;4&amp;5\\1&amp;1&amp;1&amp;1&amp;1\\6&amp;6&amp;8&amp;3&amp;1<br>\end{vmatrix}<br>\tag{2.7.1}<br>$$<br>å¯ä»¥è¢«åˆ†è§£ä¸º<br>$$<br>\begin{vmatrix}<br>1&amp;2\\3&amp;4<br>\end{vmatrix}<br>+(-1)^{1+2+1+2}\<br>\begin{vmatrix}<br>3&amp;4&amp;5\\1&amp;1&amp;1\\8&amp;3&amp;1<br>\end{vmatrix}<br>\tag{2.7.2}<br>$$<br>ï¼Œå³</p>
<p>$$<br>\begin{vmatrix}<br>1&amp;2&amp;0&amp;0&amp;0\\3&amp;4&amp;0&amp;0&amp;0\\1&amp;2&amp;3&amp;4&amp;5\\1&amp;1&amp;1&amp;1&amp;1\\6&amp;6&amp;8&amp;3&amp;1<br>\end{vmatrix}<br>&#x3D;\begin{vmatrix}<br>1&amp;2\\3&amp;4<br>\end{vmatrix}<br>+(-1)^{1+2+1+2}\<br>\begin{vmatrix}<br>3&amp;4&amp;5\\1&amp;1&amp;1\\8&amp;3&amp;1<br>\end{vmatrix}<br>\tag{2.7.3}<br>$$</p>
<h2 id="è¡Œåˆ—å¼çš„è¿ç®—"><a href="#è¡Œåˆ—å¼çš„è¿ç®—" class="headerlink" title="è¡Œåˆ—å¼çš„è¿ç®—"></a>è¡Œåˆ—å¼çš„è¿ç®—</h2><h3 id="è¡Œåˆ—å¼ç›¸ä¹˜"><a href="#è¡Œåˆ—å¼ç›¸ä¹˜" class="headerlink" title="è¡Œåˆ—å¼ç›¸ä¹˜"></a>è¡Œåˆ—å¼ç›¸ä¹˜</h3><p>åŒé˜¶è¡Œåˆ—å¼ç›¸ä¹˜ç±»ä¼¼çŸ©é˜µçš„ç‚¹ä¹˜ã€‚</p>
<p>ä¾‹ï¼š<br>$$<br>\begin{gather}<br>\begin{vmatrix}<br>a_{1,1} &amp; a_{1,2} &amp; a_{1,3} \\ a_{2,1} &amp; a_{2,2} &amp; a_{2,3} \\ a_{3,1} &amp; a_{3,2} &amp; a_{3,3}<br>\end{vmatrix}<br>\times<br>\begin{vmatrix}<br>b_{1,1} &amp; b_{1,2} &amp; b_{1,3} \\ b_{2,1} &amp; b_{2,2} &amp; b_{2,3} \\ b_{3,1} &amp; b_{3,2} &amp; b_{3,3}<br>\end{vmatrix}<br>&#x3D; \\ \notag<br>\begin{vmatrix}<br>a_{1,1}b_{1,1}+a_{1,2}b_{2,1}+a_{1,3}b_{3,1} &amp;  a_{1,1}b_{1,2}+a_{1,2}b_{2,2}+a_{1,3}b_{3,2} &amp;<br>a_{1,1}b_{1,3}+a_{1,2}b_{2,3}+a_{1,3}b_{3,3} \\<br>a_{2,1}b_{1,1}+a_{2,2}b_{2,1}+a_{2,3}b_{3,1} &amp;  a_{2,1}b_{1,2}+a_{2,2}b_{2,2}+a_{2,3}b_{3,2} &amp;<br>a_{2,1}b_{1,3}+a_{2,2}b_{2,3}+a_{2,3}b_{3,3} \\<br>a_{3,1}b_{1,1}+a_{3,2}b_{2,1}+a_{3,3}b_{3,1} &amp;  a_{3,1}b_{1,2}+a_{3,2}b_{2,2}+a_{3,3}b_{3,2} &amp;<br>a_{3,1}b_{1,3}+a_{3,2}b_{2,3}+a_{3,3}b_{3,3}<br>\end{vmatrix} \notag<br>\end{gather}<br>\tag{2.8.1}<br>$$</p>
<p>å¦‚æœè¡Œåˆ—å¼ä¸åŒé˜¶ï¼Œé‚£ä¹ˆå°±æŠŠé«˜é˜¶çš„é™é˜¶ã€‚</p>
<h3 id="åŠ è¾¹æ³•"><a href="#åŠ è¾¹æ³•" class="headerlink" title="åŠ è¾¹æ³•"></a>åŠ è¾¹æ³•</h3><p>å‡å¦‚æœ‰ä¸€ä¸ªè¡Œåˆ—å¼å¦‚ä¸‹ï¼š<br>$$<br>\begin{vmatrix}<br>1+a_1 &amp; 1 &amp; 1 &amp; \cdots &amp; 1 \\<br>1 &amp; 1+a_2 &amp; 1 &amp; \cdots &amp; 1 \\<br>1 &amp; 1 &amp; 1+a_3 &amp; \cdots &amp; 1 \\<br>\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\<br>1 &amp; 1 &amp; 1 &amp; \cdots &amp; 1+a_n<br>\end{vmatrix}<br>\tag{2.8.2}<br>$$<br>æˆ‘ä»¬åœ¨è§£è¿™ä¸ªè¡Œåˆ—å¼çš„æ—¶å€™ï¼Œå¯ä»¥ç»™è¿™ä¸ªè¡Œåˆ—å¼åœ¨æœ€å·¦é¢åŠ ä¸€åˆ—0ï¼Œå†åœ¨æœ€ä¸Šé¢åŠ ä¸€è¡Œ1ï¼Œå¦‚ä¸‹ï¼š<br>$$<br>\begin{vmatrix}<br>1 &amp; 1 &amp; 1 &amp; 1 &amp; \cdots &amp; 1\\<br>0 &amp; 1+a_1 &amp; 1 &amp; 1 &amp; \cdots &amp; 1 \\<br>0 &amp; 1 &amp; 1+a_2 &amp; 1 &amp; \cdots &amp; 1 \\<br>0 &amp; 1 &amp; 1 &amp; 1+a_3 &amp; \cdots &amp; 1 \\<br>\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\<br>0 &amp; 1 &amp; 1 &amp; 1 &amp; \cdots &amp; 1+a_n<br>\end{vmatrix}<br>\tag{2.8.3}<br>$$<br>æ­¤æ—¶ï¼Œæˆ‘ä»¬å†å¯¹è¿™ä¸ªè¡Œåˆ—å¼åšå‡ºè¿›ä¸€æ­¥çš„è®¡ç®—ï¼š<br>$$<br>&#x3D; \begin{vmatrix}1&amp;1&amp;1&amp;\cdots&amp;1\\-1&amp;a_1&amp;&amp;&amp;\\-1&amp;&amp;a_2&amp;&amp;\\\vdots&amp;&amp;&amp;\ddots&amp;\\-1&amp;&amp;&amp;&amp;a_n\end{vmatrix}<br>\tag{2.8.4}<br>\label{tri}<br>$$<br>$$<br>&#x3D; \begin{vmatrix}x&amp;1&amp;1&amp;\cdots&amp;1\\&amp;a_1&amp;&amp;&amp;\\&amp;&amp;a_2&amp;&amp;\\&amp;&amp;&amp;\ddots&amp;\\&amp;&amp;&amp;&amp;a_n\end{vmatrix}<br>\tag{2.8.5}<br>$$<br>å…¶ä¸­ï¼Œ$x&#x3D;1+ \sum\limits_{i&#x3D;1}^{n} \dfrac{1}{a_i}$ ã€‚</p>
<p>æ³¨æ„ï¼š<strong>åŠ è¾¹çš„æ—¶å€™ä¸èƒ½æ”¹å˜è¡Œåˆ—å¼çš„å€¼ï¼</strong></p>
<p>å…¶ä¸­çš„$\ref{tri}$ å«åšâ€œä¸‰å‰å½¢è¡Œåˆ—å¼â€ã€‚</p>
<h2 id="ç‰¹æ®Šè¡Œåˆ—å¼-2"><a href="#ç‰¹æ®Šè¡Œåˆ—å¼-2" class="headerlink" title="ç‰¹æ®Šè¡Œåˆ—å¼(2)"></a>ç‰¹æ®Šè¡Œåˆ—å¼(2)</h2><h3 id="èŒƒå¾·è’™å¾·-Vandermonde-è¡Œåˆ—å¼"><a href="#èŒƒå¾·è’™å¾·-Vandermonde-è¡Œåˆ—å¼" class="headerlink" title="èŒƒå¾·è’™å¾·(Vandermonde)è¡Œåˆ—å¼"></a>èŒƒå¾·è’™å¾·(Vandermonde)è¡Œåˆ—å¼</h3><p>å½¢å¦‚<br>$$<br>\begin{vmatrix}<br>1 &amp; 1 &amp; 1 &amp; \cdots &amp; 1 \\<br>x_1 &amp; x_2 &amp; x_3 &amp; \cdots &amp; x_n \\<br>x^2_1 &amp; x^2_2 &amp; x^2_3 &amp; \cdots &amp;x^2_n\\<br>\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\<br>x_1^{n-1} &amp; x_2^{n-1} &amp; x_3^{n-1} &amp; \cdots &amp; x_n^{n-1}<br>\end{vmatrix}<br>\tag{2.9.1}<br>$$</p>
<p>çš„è¡Œåˆ—å¼å«åš<strong>èŒƒå¾·è’™å¾·è¡Œåˆ—å¼</strong>ã€‚</p>
<p>å…¶ç»“æœæ˜¯è¿™æ ·çš„ï¼š<br>$$<br>\begin{vmatrix} x_1^0 &amp; \cdots &amp; x_n^0 \\ \vdots &amp; \ddots &amp; \vdots \\ x_1^{n-1} &amp; \cdots &amp; x_n^{n-1} \end{vmatrix} &#x3D; \prod_{i&#x3D;j&#x3D;1}^n (x_i-x_j) \tag{2.9.2}<br>$$</p>
<h3 id="å¯¹ç§°è¡Œåˆ—å¼-1"><a href="#å¯¹ç§°è¡Œåˆ—å¼-1" class="headerlink" title="å¯¹ç§°è¡Œåˆ—å¼"></a>å¯¹ç§°è¡Œåˆ—å¼</h3><p>å½¢å¦‚<br>$$<br>\begin{vmatrix}<br>x &amp; a_{1,1} &amp; a_{1,2} &amp; \cdots &amp; a_{1,n} \\<br>a_{1,1} &amp; x &amp; a_{2,2} &amp; \cdots &amp; a_{2,n} \\<br>a_{1,2} &amp; a_{2,2} &amp; x &amp; \cdots &amp; a_{3,n} \\<br>\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\<br>a_{1,n} &amp; a_{2,n} &amp; a_{3,n} &amp; \cdots &amp; x<br>\end{vmatrix}<br>\tag{2.9.3}<br>$$<br>çš„è¡Œåˆ—å¼å«åšå¯¹ç§°è¡Œåˆ—å¼ï¼Œå³$a_{i,j}&#x3D;a_{j,i}$ã€‚</p>
<p>å¯¹ç§°è¡Œåˆ—å¼ä¸­ï¼š</p>
<ul>
<li>ä¸»å¯¹è§’çº¿å…ƒç´ æ²¡æœ‰è¦æ±‚ï¼›</li>
<li>å³ä¸Šã€å·¦ä¸‹ä½ç½®å¯¹åº”ç›¸ç­‰ã€‚</li>
</ul>
<h3 id="åå¯¹ç§°è¡Œåˆ—å¼-1"><a href="#åå¯¹ç§°è¡Œåˆ—å¼-1" class="headerlink" title="åå¯¹ç§°è¡Œåˆ—å¼"></a>åå¯¹ç§°è¡Œåˆ—å¼</h3><p>å½¢å¦‚<br>$$<br>\begin{vmatrix}<br>0 &amp; a_{1,1} &amp; a_{1,2} &amp; \cdots &amp; a_{1,n} \\<br>-a_{1,1} &amp; 0 &amp; a_{2,2} &amp; \cdots &amp; a_{2,n} \\<br>-a_{1,2} &amp; -a_{2,2} &amp; 0 &amp; \cdots &amp; a_{3,n} \\<br>\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\<br>-a_{1,n} &amp; -a_{2,n} &amp; -a_{3,n} &amp; \cdots &amp; 0<br>\end{vmatrix}<br>\tag{2.9.4}<br>$$<br>çš„è¡Œåˆ—å¼å«åšåå¯¹ç§°è¡Œåˆ—å¼ï¼Œå³$a_{i,j}&#x3D;-a_{j,i}$ã€‚</p>
<p>åå¯¹ç§°è¡Œåˆ—å¼ä¸­ï¼š</p>
<ul>
<li>ä¸»å¯¹è§’çº¿å…¨ä¸º0ï¼›</li>
<li>å³ä¸Šã€å·¦ä¸‹ä½ç½®å¯¹åº”æˆç›¸åæ•°ã€‚</li>
</ul>
<p>åœ¨å¥‡æ•°é˜¶åå¯¹ç§°è¡Œåˆ—å¼ä¸­ï¼Œ$D&#x3D;0$ ï¼›</p>
<p>è¯æ˜ï¼š<br>$$<br>\begin{gathered}<br>\because<br>\begin{cases}<br>D&#x3D;D^T \\<br>D&#x3D;-D^T<br>\end{cases}<br>\\<br>\therefore D&#x3D;-D \\<br>\therefore 2D&#x3D;0 \\<br>\therefore D&#x3D;0<br>\end{gathered}<br>\tag{2.9.5}<br>$$</p>
<h2 id="å…‹æ‹‰é»˜-Cramer-æ³•åˆ™"><a href="#å…‹æ‹‰é»˜-Cramer-æ³•åˆ™" class="headerlink" title="å…‹æ‹‰é»˜(Cramer)æ³•åˆ™"></a>å…‹æ‹‰é»˜(Cramer)æ³•åˆ™</h2><p>å°±åƒ<a href="/notes/linar-algebra/#%E4%BA%8C%E9%98%B6%E8%A1%8C%E5%88%97%E5%BC%8F">è¿™é‡Œ</a>æ‰€è¯´çš„é‚£æ ·ï¼Œè¡Œåˆ—å¼å¯ä»¥ç”¨æ¥è§£å¤šå…ƒä¸€æ¬¡æ–¹ç¨‹ç»„ã€‚</p>
<p>æ¯”å¦‚ä¸‹é¢è¿™ä¸ªï¼š<br>$$<br>\begin{cases}<br>x_1+x_2+x_3&#x3D;1\\<br>x_1-x_2+5x_3&#x3D;6\\<br>-x_1+x_2+6x_3&#x3D;9<br>\end{cases}<br>$$</p>
<p>å…¶ä¸­ï¼Œ<br>$$<br>\begin{cases}<br>x_1&#x3D;\frac{D_1}{D}\\<br>x_2&#x3D;\frac{D_2}{D}\\<br>x_3&#x3D;\frac{D_3}{D}<br>\end{cases}<br>\tag{2.10.1}<br>$$<br>å…¶ä¸­ï¼Œ<br>$$<br>\begin{cases}<br>D&#x3D;\begin{vmatrix}1&amp;1&amp;1\\1&amp;-1&amp;5\\-1&amp;1&amp;6\end{vmatrix}\\<br>D_1&#x3D;\begin{vmatrix}1&amp;1&amp;1\\6&amp;-1&amp;5\\9&amp;1&amp;6\end{vmatrix}\\<br>D_2&#x3D;\begin{vmatrix}1&amp;1&amp;1\\1&amp;6&amp;5\\-1&amp;9&amp;6\end{vmatrix}\\<br>D_3&#x3D;\begin{vmatrix}1&amp;1&amp;1\\1&amp;-1&amp;6\\-1&amp;1&amp;9\end{vmatrix}<br>\end{cases}<br>\tag{2.10.2}<br>$$<br>ç®€åŒ–ä¸€ç‚¹ï¼Œå°±æ˜¯è¿™æ ·ï¼š<br>$$<br>\begin{gather}<br>\begin{cases}<br>a_1x_1+b_1x_2+c_1x_3&#x3D;d_1\\<br>a_2x_1+b_2x_2+c_2x_3&#x3D;d_2\\<br>a_3x_1+b_3x_2+c_3x_3&#x3D;d_3<br>\end{cases}\\<br>\tag{2.10.3}<br>\text{å…¶ä¸­ï¼Œ}\\<br>\begin{cases}<br>x_1&#x3D;\frac{D_1}{D}\\<br>x_2&#x3D;\frac{D_2}{D}\\<br>x_3&#x3D;\frac{D_3}{D}<br>\end{cases}\\<br>\tag{2.10.4}<br>\text{å…¶ä¸­ï¼Œ}\\<br>\begin{cases}<br>D&#x3D;\begin{vmatrix}a_1&amp;b_1&amp;c_1\\a_2&amp;b_2&amp;c_2\\a_3&amp;b_3&amp;c_3\end{vmatrix}\\<br>D_1&#x3D;\begin{vmatrix}d_1&amp;b_1&amp;c_1\\d_2&amp;b_2&amp;c_2\\d_3&amp;b_3&amp;c_3\end{vmatrix}\\<br>D_2&#x3D;\begin{vmatrix}a_1&amp;d_1&amp;c_1\\a_2&amp;d_2&amp;c_2\\a_3&amp;d_3&amp;c_3\end{vmatrix}\\<br>D_3&#x3D;\begin{vmatrix}a_1&amp;b_1&amp;d_1\\a_2&amp;b_2&amp;d_2\\a_3&amp;b_3&amp;d_3\end{vmatrix}<br>\end{cases}<br>\tag{2.10.5}<br>\end{gather}<br>$$</p>
<h1 id="çŸ©é˜µ"><a href="#çŸ©é˜µ" class="headerlink" title="çŸ©é˜µ"></a>çŸ©é˜µ</h1><p>å½¢å¦‚<br>$$<br>A &#x3D;<br>\begin{bmatrix}<br>a_{1,1} &amp; a_{1,2} &amp; a_{1,3} &amp; \dots &amp; a_{1,n} \\<br>a_{2,1} &amp; a_{2,2} &amp; a_{2,3} &amp; \dots &amp; a_{2,n} \\<br>a_{3,1} &amp; a_{3,2} &amp; a_{3,3} &amp; \dots &amp; a_{3,n} \\<br>\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\<br>a_{m,1} &amp; a_{m,2} &amp; a_{m,3} &amp; \dots &amp; a_{m,n}<br>\end{bmatrix}<br>\tag{3.0.1}<br>$$</p>
<p>çš„æ•°æ®ç»“æ„ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºå¤§å°ä¸º $m \times n$ çš„çŸ©é˜µï¼Œå¯ä»¥ç®€è®°ä¸º $A_{m \times n}$ ã€‚</p>
<p>æ˜¾è€Œæ˜“è§ï¼Œ$\begin{bmatrix}n\end{bmatrix}&#x3D;n$ã€‚</p>
<h2 id="ç‰¹æ®Šå½¢æ€çš„çŸ©é˜µ"><a href="#ç‰¹æ®Šå½¢æ€çš„çŸ©é˜µ" class="headerlink" title="ç‰¹æ®Šå½¢æ€çš„çŸ©é˜µ"></a>ç‰¹æ®Šå½¢æ€çš„çŸ©é˜µ</h2><h3 id="è¡ŒçŸ©é˜µ"><a href="#è¡ŒçŸ©é˜µ" class="headerlink" title="è¡ŒçŸ©é˜µ"></a>è¡ŒçŸ©é˜µ</h3><p>åªæœ‰ä¸€è¡Œçš„çŸ©é˜µã€‚</p>
<p>ä¾‹ï¼š$A_{1 \times 3}&#x3D;\begin{bmatrix}1&amp;1&amp;1\end{bmatrix}$</p>
<h3 id="åˆ—çŸ©é˜µ"><a href="#åˆ—çŸ©é˜µ" class="headerlink" title="åˆ—çŸ©é˜µ"></a>åˆ—çŸ©é˜µ</h3><p>åªæœ‰ä¸€åˆ—çš„çŸ©é˜µã€‚</p>
<p>ä¾‹ï¼š$A_{3 \times 1}&#x3D;\begin{bmatrix}1\\1\\1\end{bmatrix}$</p>
<h3 id="é›¶çŸ©é˜µ"><a href="#é›¶çŸ©é˜µ" class="headerlink" title="é›¶çŸ©é˜µ"></a>é›¶çŸ©é˜µ</h3><p>åªæœ‰é›¶çš„çŸ©é˜µã€‚</p>
<p>ä¾‹ï¼š$A_{2 \times 2}&#x3D;\begin{bmatrix}0&amp;0\\0&amp;0\end{bmatrix}$</p>
<p>é›¶çŸ©é˜µå¯ä»¥è®°ä½œ$0$ã€‚</p>
<h3 id="è´ŸçŸ©é˜µ"><a href="#è´ŸçŸ©é˜µ" class="headerlink" title="è´ŸçŸ©é˜µ"></a>è´ŸçŸ©é˜µ</h3><p>å‡è®¾æœ‰ä¸€ä¸ªçŸ©é˜µ$A$ï¼Œå…¶è´ŸçŸ©é˜µä¸º$-A$ ã€‚</p>
<p>æŸä¸€ä¸ªçŸ©é˜µçš„è´ŸçŸ©é˜µä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½ä¸åŸçŸ©é˜µçš„å¯¹åº”å…ƒç´ äº’ä¸ºç›¸åæ•°ã€‚</p>
<h3 id="æ–¹é˜µ"><a href="#æ–¹é˜µ" class="headerlink" title="æ–¹é˜µ"></a>æ–¹é˜µ</h3><p>è¡Œæ•°ç­‰äºåˆ—æ•°çš„çŸ©é˜µã€‚</p>
<p>ä¾‹ï¼š$A_{2 \times 2}&#x3D;\begin{bmatrix}1&amp;1\\1&amp;1\end{bmatrix}$</p>
<p>$n$é˜¶çŸ©é˜µ$A_{n \times n}$ç®€ä¾¿è®°ä½œ$A_n$ã€‚</p>
<h3 id="å•ä½çŸ©é˜µ"><a href="#å•ä½çŸ©é˜µ" class="headerlink" title="å•ä½çŸ©é˜µ"></a>å•ä½çŸ©é˜µ</h3><p>ä¸å•ä½è¡Œåˆ—å¼ç±»ä¼¼ï¼Œå³ä¸»å¯¹è§’çº¿ä¸Šå‡ä¸º1ï¼Œå…¶ä½™å‡ä¸º0çš„çŸ©é˜µã€‚</p>
<p>ä¾‹ï¼š$A_{n \times n}&#x3D;\begin{bmatrix}1&amp;&amp;\\&amp;\ddots&amp;\\&amp;&amp;1\end{bmatrix}$</p>
<p>å•ä½çŸ©é˜µå¯ä»¥è®°ä½œ$E$æˆ–$I$ã€‚</p>
<h2 id="çŸ©é˜µçš„è¿ç®—"><a href="#çŸ©é˜µçš„è¿ç®—" class="headerlink" title="çŸ©é˜µçš„è¿ç®—"></a>çŸ©é˜µçš„è¿ç®—</h2><p>çŸ©é˜µæœ‰è¿™æ ·å‡ ç§è¿ç®—ï¼š</p>
<h3 id="çŸ©é˜µçš„ç›¸ç­‰"><a href="#çŸ©é˜µçš„ç›¸ç­‰" class="headerlink" title="çŸ©é˜µçš„ç›¸ç­‰"></a>çŸ©é˜µçš„ç›¸ç­‰</h3><p><del>æ²¡æƒ³åˆ°å§çŸ©é˜µçš„ç›¸ç­‰åœ¨æˆ‘è¿™é‡Œä¹Ÿç®—ä½œä¸€ç§è¿ç®—</del></p>
<p>ä¸¤ä¸ªçŸ©é˜µç›¸ç­‰çš„å‰ææ˜¯ä»–ä»¬æ˜¯åŒå‹çŸ©é˜µã€‚å¦‚ï¼š<br>å¦‚æœ$A_{m,n}&#x3D;B_{p,q}$ï¼Œ<br>é‚£ä¹ˆ$m&#x3D;p,n&#x3D;q$ï¼Œä¸”$\forall a_{i,j}&#x3D;b_{i,j}$</p>
<h3 id="åŠ æ³•ã€å‡æ³•"><a href="#åŠ æ³•ã€å‡æ³•" class="headerlink" title="åŠ æ³•ã€å‡æ³•"></a>åŠ æ³•ã€å‡æ³•</h3><p>$$<br>\begin{bmatrix}<br>a &amp; b &amp; c \\<br>d &amp; e &amp; f<br>\end{bmatrix}<br>\pm<br>\begin{bmatrix}<br>g &amp; h &amp; i \\<br>j &amp; k &amp; l<br>\end{bmatrix}<br>&#x3D;<br>\begin{bmatrix}<br>a \pm g &amp; b \pm h &amp; c \pm i \\<br>d \pm j &amp; e \pm k &amp; f \pm l<br>\end{bmatrix}<br>\tag{3.1.1}<br>$$</p>
<p>çŸ©é˜µçš„åŠ æ³•æ»¡è¶³äº¤æ¢å¾‹å’Œç»“åˆå¾‹ã€‚</p>
<p>æ³¨æ„ï¼šåªæœ‰åŒå‹çŸ©é˜µä¹‹é—´æ‰èƒ½åŠ å‡ã€‚</p>
<h3 id="æ•°ä¹˜"><a href="#æ•°ä¹˜" class="headerlink" title="æ•°ä¹˜"></a>æ•°ä¹˜</h3><p>$$<br>k \times<br>\begin{bmatrix}<br>a &amp; b &amp; c \\<br>d &amp; e &amp; f<br>\end{bmatrix}<br>&#x3D;<br>\begin{bmatrix}<br>ka &amp; kb &amp; kc \\<br>kd &amp; ke &amp; kf<br>\end{bmatrix}<br>\tag{3.2.1}<br>$$</p>
<p>çŸ©é˜µçš„æ•°ä¹˜æ»¡è¶³äº¤æ¢å¾‹ã€ç»“åˆå¾‹å’Œåˆ†é…å¾‹ã€‚</p>
<h4 id="çŸ©é˜µæå…¬å› å­"><a href="#çŸ©é˜µæå…¬å› å­" class="headerlink" title="çŸ©é˜µæå…¬å› å­"></a>çŸ©é˜µæå…¬å› å­</h4><p>ä¸è¡Œåˆ—å¼ä¸åŒï¼ˆè¿™ä¸€ç‚¹å¯ä»¥åœ¨ä¸Šé¢çš„æ•°ä¹˜éƒ¨åˆ†çœ‹åˆ°ï¼‰ï¼ŒçŸ©é˜µæå…¬å› å­çš„è¯æ˜¯æ•´ä½“æå–çš„ã€‚å¦‚ï¼š<br>$$<br>\begin{bmatrix}<br>ka &amp; kb &amp; kc \\<br>kd &amp; ke &amp; kf<br>\end{bmatrix}<br>&#x3D;k\times<br>\begin{bmatrix}<br>a &amp; b &amp; c \\<br>d &amp; e &amp; f<br>\end{bmatrix}<br>\tag{3.2.2}<br>$$</p>
<h3 id="ç‚¹ä¹˜"><a href="#ç‚¹ä¹˜" class="headerlink" title="ç‚¹ä¹˜"></a>ç‚¹ä¹˜</h3><p>å¦‚æœ<br>$$<br>A_{i,n} \times B_{n,j} &#x3D; C_{i,j}<br>\tag{3.3.1}<br>$$<br>çš„è¯ï¼Œé‚£ä¹ˆ<br>$$<br>c_{i,j}&#x3D;\sum_{k&#x3D;1}^{n} \  a_{i,k} \times b_{k,j}<br>\tag{3.3.2}<br>$$<br>ï¼Œå…¶ä¸­ $ a_{i,k} \in A , b_{k,j} \in B , c_{i,j} \in C $ ã€‚</p>
<p>çŸ©é˜µçš„ç‚¹ä¹˜è¦æ±‚AçŸ©é˜µçš„é•¿ä¸BçŸ©é˜µçš„å®½ç›¸ç­‰ã€‚</p>
<p>ä¾‹ï¼š<br>$$<br>\begin{gather}<br>\begin{bmatrix}<br>a_{1,1} &amp; a_{1,2} &amp; a_{1,3} \\ a_{2,1} &amp; a_{2,2} &amp; a_{2,3} \\ a_{3,1} &amp; a_{3,2} &amp; a_{3,3} \\ a_{4,1} &amp; a_{4,2} &amp; a_{4,3}<br>\end{bmatrix}<br>\times<br>\begin{bmatrix}<br>b_{1,1} &amp; b_{1,2} \\ b_{2,1} &amp; b_{2,2} \\ b_{3,1} &amp; b_{3,2}<br>\end{bmatrix}\\ \notag<br>&#x3D;\\ \notag<br>\begin{bmatrix}<br>a_{1,1}b_{1,1}+a_{1,2}b_{2,1}+a_{1,3}b_{3,1} &amp; a_{2,1}b_{1,1}+a_{2,2}b_{2,1}+a_{2,3}b_{3,1} &amp; a_{3,1}b_{1,1}+a_{3,2}b_{2,1}+a_{3,3}b_{3,1} &amp; a_{4,1}b_{1,1}+a_{4,2}b_{2,1}+a_{4,3}b_{3,1} \\<br>a_{1,1}b_{1,2}+a_{1,2}b_{2,2}+a_{1,3}b_{3,2} &amp;  a_{2,1}b_{1,2}+a_{2,2}b_{2,2}+a_{2,3}b_{3,2} &amp; a_{3,1}b_{1,2}+a_{3,2}b_{2,2}+a_{3,3}b_{3,2} &amp; a_{4,1}b_{1,2}+a_{4,2}b_{2,2}+a_{4,3}b_{3,2}<br>\end{bmatrix} \notag<br>\end{gather}<br>\tag{3.3.3}<br>\label{dt}<br>$$</p>
<p>åœ¨ç‚¹ä¹˜ä¸­ï¼Œæœ‰è®¸å¤šéœ€è¦æ³¨æ„çš„ç‚¹ï¼š</p>
<h4 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h4><p>1.çŸ©é˜µçš„ç‚¹ä¹˜ä¸æ»¡è¶³äº¤æ¢å¾‹ã€‚<br>å³ï¼Œ$A \times B$ä¸ä¸€å®š$&#x3D;B \times A$ã€‚<br>æ‰€ä»¥ï¼Œç‰¹åˆ«çš„ï¼Œåœ¨ç®—å¼$A \times B$ä¸­ï¼Œæˆ‘ä»¬ç§°$A$å·¦ä¹˜$B$ï¼ŒåŒæ—¶$B$å³ä¹˜$A$ã€‚<br>å¦‚æœæ­£å¥½$A \times B&#x3D;B \times A$ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç§°$A,B$æ˜¯å¯äº¤æ¢çš„ã€‚</p>
<p>ä½†æ˜¯ï¼ŒçŸ©é˜µçš„ç‚¹ä¹˜æ»¡è¶³ç»“åˆå¾‹å’Œåˆ†é…å¾‹ï¼Œå³ï¼š</p>
<p>$(A \times B) \times C&#x3D;A \times (B \times C)$</p>
<p>è¿ç”¨åˆ†é…ç‡çš„æ—¶å€™éœ€è¦æ³¨æ„ï¼ŒçŸ©é˜µçš„ä½ç½®è¦å¯¹åº”ã€‚</p>
<p>$(A+B) \times C &#x3D; A \times C + B \times C $</p>
<p>$C \times (A \times B) &#x3D; C \times A + C \times B$</p>
<p>2.$A \times B&#x3D;0 \ \nRightarrow A&#x3D;0 \ or \ B&#x3D;0$.</p>
<p>3.$if \ A \times B&#x3D;A \times C , A \neq 0 \nRightarrow B&#x3D;C$</p>
<h4 id="æ€§è´¨-2"><a href="#æ€§è´¨-2" class="headerlink" title="æ€§è´¨"></a>æ€§è´¨</h4><ol>
<li>$A \times 0 &#x3D; 0$.</li>
<li>$A \times E&#x3D;E \times A&#x3D;A$.</li>
<li>$k(A \times B) &#x3D; (kA) \times B &#x3D; A \times (kB)$</li>
</ol>
<h3 id="è½¬ç½®-1"><a href="#è½¬ç½®-1" class="headerlink" title="è½¬ç½®"></a>è½¬ç½®</h3><p>å°†çŸ©é˜µçš„è¡Œå’Œåˆ—äº’ç›¸äº¤æ¢ä¹‹åï¼Œå°±å®Œæˆäº†çŸ©é˜µçš„è½¬ç½®ã€‚<br>å¦‚ï¼š<br>$$<br>\begin{bmatrix}<br>a &amp; b &amp; c \\<br>d &amp; e &amp; f<br>\end{bmatrix}^T&#x3D;<br>\begin{bmatrix}<br>a &amp; d\\<br>b &amp; e\\<br>c &amp; f<br>\end{bmatrix}<br>\tag{3.4.1}<br>$$</p>
<p>çŸ©é˜µ $A$ çš„è½¬ç½®ç”¨ç¬¦å· $A^T$ è¡¨ç¤ºã€‚</p>
<h4 id="æ€§è´¨-3"><a href="#æ€§è´¨-3" class="headerlink" title="æ€§è´¨"></a>æ€§è´¨</h4><ol>
<li>$(A^T)^T&#x3D;A$.</li>
<li>$(A+B)^T&#x3D;A^T+B^T$.</li>
<li>$(kA)^T&#x3D;kA^T$.</li>
<li>$(AB)^T&#x3D;B^T \times A^T$.</li>
</ol>
<h3 id="å¹‚è¿ç®—"><a href="#å¹‚è¿ç®—" class="headerlink" title="å¹‚è¿ç®—"></a>å¹‚è¿ç®—</h3><p>ä¸å¸¸æ•°ç±»ä¼¼ï¼ŒçŸ©é˜µä¹Ÿæœ‰å¹‚è¿ç®—ã€‚</p>
<p>æˆ‘ä»¬å®šä¹‰çŸ©é˜µ$A$çš„$k$æ¬¡å¹‚ä¸º$A$ $k$æ¬¡è‡ªä¹˜åæ‰€å¾—çš„ç»“æœã€‚<br>ç‰¹åˆ«çš„ï¼Œæˆ‘ä»¬å®šä¹‰$A^0&#x3D;E$ã€‚</p>
<p>çŸ©é˜µçš„å¹‚è¿ç®—ä¸å¸¸æ•°çš„å¹‚è¿ç®—ä¸æ˜¯å¾ˆç±»ä¼¼ã€‚</p>
<p>çŸ©é˜µçš„å¹‚è¿ç®—ä¸æ»¡è¶³è¿™äº›å®šå¾‹ï¼š</p>
<p>$(A \times B)^k \neq A^k \times B^k$</p>
<p>$(A \pm B)^2 \neq A^2 \pm 2A \times B +B^2$</p>
<p>ä½†æ˜¯ï¼ŒçŸ©é˜µæ»¡è¶³è¿™æ ·ä¸€ä¸ªå¥‡æ€ªçš„ä¸œè¥¿ï¼š</p>
<p>$(A+E)^2 &#x3D; A^2 + 2A \times E + E^2$</p>
<p>æˆ‘ä»¬æ¨å¯¼ä¸€ä¸‹ï¼Œå¯ä»¥å¾—åˆ°è¿™æ ·ä¸€ä¸ªç»“æœï¼š</p>
<p>$$<br>\begin{align}<br>(A+E)^2 &#x3D;{} &amp; (A+E) \times (A+E) \\<br>&#x3D;{} &amp; (A^2 + E \times A) + (A \times E + E^2) \\<br>\end{align}<br>$$<br>$$<br>\because A \times E &#x3D; E \times A &#x3D; A<br>$$<br>$$<br>\begin{align}<br>\therefore<br>(A+E)^2 &#x3D;{} &amp; (A^2 + A \times E) + (A \times E + E^2) \\<br>&#x3D;{} &amp; A^2 + 2A \times E + E^2<br>\end{align}<br>$$</p>
]]></content>
      <categories>
        <category>æ•°å­¦</category>
      </categories>
      <tags>
        <tag>æ•°å­¦</tag>
      </tags>
  </entry>
</search>
